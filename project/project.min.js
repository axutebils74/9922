var data_a1e2fb4a_e986_4524_b0da_9b7ba7c0874d={main:{floorIds:["BMT20","BMT19","BMT18","BMT17","BMT16","BMT15","BMT14","BMT13","BMT12","BMT11","BMT10","BMT9","BMT8","BMT7","BMT6","BMT5","BMT4","BMT4_2","BMT4_3","BMT3","BMT2","BMT1","MT0","MT1","MT2","MT3","MT4","MT5","MT6","MT7","MT8","MT9","MT10","MT11","MT12","MT13","MT14","MT15","MT16","MT17","MT18","MT19","MT20","MT21","MT22","MT23","MT24","MT25","MT26","MT27","MT28","MT29","MT30","MT31","MT32","MT33","MT34","MT35","MT36","MT37","MT38","MT39","MT40","MT41","MT42","MT43","MT44","MT45","MT46","MT47","MT48","MT49","MT50","MT51","MT52","MT53","MT54","MT55","MT5X","MT56","MT57","MT58","MT59","MT60","MT61","MT62","MT6X","MT63","MT64","MT65","MT66","MT67","MT68","MT69","MT70","MT70_2","South1","South2","South3","South4","South5","South6","South7","South8","South9","South10","South11","South12","Dungeon1","Dungeon2","Village","West1","West2","West3","West4","West5","West6","West7","West8","West9","West10","West11","East1","East2","East3","East4","East5","East6","East7","East8","East9","East10","East11","East12","East13","East14","East15","North1","North2","North3","North4","North5","North6","North7","North8","North9","North10","North11","East16","Cave15","Cave14","Cave13","Cave12","Cave11","Cave10","Cave9","Cave8","Cave7","Cave6","Cave5","Cave4","Cave3","Cave2","Cave1","Cave6_2","Cave16","Cave17","Cave18","Cave19","Cave20","Ch_D1","Ch_D2","Ch4_1","Ch4_2","Ch4_3","Ch4_4","Ch4_5","Ch4_6","Ch4_7","Ch4_8","Ch4_9","Ch4_10","Ch4_11","Ch4_12","Ch4_13","Ch4_14","Ch4_15","Ch4_16","Ch4_17","Ch4_18","Ch4_19","Ch4_1A","Ch4_1B","Ch4_20","Ch4_21","Ch4_22","Ch4_23","Ch4_24","Ch4_25","Ch4_26","Ch4_27","Ch4_28","Ch4_29","Ch4_2A","Ch4_2B","Ch4_2C","Ch4_2D","Ch4_30","Ch4_31","Ch4_32","Ch4_33","Ch4_34","Ch4_35","Ch4_36","Ch4_37","Ch4_38","Ch4_39","Ch4_3A","Ch4_3B","Ch4_3C","Ch4_3D","Ch4_40","MusicRoom","Ch4_41","Ch4_42","Ch4_50","Ch4_51","Ch4_52","Ch4_53","Ch4_54","Ch4_55","Ch4_56","Ch4_57","Ch4_58","Ch4_59","Ch4_5A","Ch4_5B","Ch4_5C","Ch4_5D","Ch4_5E","Ch4_5F","Ch4_5G","Ch4_5H","Ch4_60","Ch4_61","Ch4_62","Ch4_63","Ch4_64","Ch4_65","Ch4_66","Ch4_67","Ch4_68","Ch4_69","Ch4_70","Ch4_70_2","Ch4_71","Ch4_72","Ch4_73","Ch4_74","Ch4_75","Ch4_76","Ch4_77","Ch4_78","Ch4_79","Ch4_7A","Ch4_car","Ch4_80","Ch4_81","Ch4_82","Ch4_83","Ch4_84","Ch4_85","Ch4_86","Ch4_93","Ch4_94","Ch4_95","Ch4_87","Ch4_88","Ch4_89","Ch4_90","Ch4_91","Ch4_92","Ch4_92_2","Ch4_99","Ch4_100","Ch4_101","Ch4_102","Ch4_103","Ch4_104","Ch4_96","Ch4_97","Ch4_98","Ch4_105","Ch4_106","Ch4_107","Ch4_108","Ch4_109","Ch4_110","Ch4_111","Ch4_112","Ch4_113","Ch4_114","Ch4_115","Ch4_116","Ch4_117","Ch4_118","Ch4_119","Ch4_120","Ch4_121","Ch4_122","Ch4_123","Ch4_124","Ch4_125","Ch4_126","Ch4_127","Ch4_128","Ch4_129","Ch4_129_2","Ch4_130","Ch4_131"],images:["2221.png","22212.png","70F_skills.png","CP060AB.png","CP376AB.png","CP414AB.png","CP451AB.png","CP452AB.png","CP453AB.png","CP612AB.png","CP746AB.png","CP748AB.png","CP751AB.png","CP811AB.png","CP815AB.png","CP864AB.png","CP866AB.png","CP871AB.png","CP873AB.png","CP894AB.png","Cthulhu.jpg","DIronfan.png","DKN_HoK01.png","DMechspider.png","Dball1.png","Dbot002.png","Dbot003.png","Dbot004-1.png","Dbot004.png","Dbot006.png","Dbot007.png","Dbot008.png","Dbot010.png","Dbot011.png","Dbot013-1.png","Dbot013.png","Dbotrome.png","Dbotturrent.png","E798.png","Monster001.png","Monster002.png","Monster003.png","Ocast.png","Ocast_d.png","Opollux.png","Opollux_d.png","RTP510.png","area11.jpg","area16.jpg","area19.jpg","area19_2.png","area19_3.jpg","area21.jpg","area22.png","area5.jpg","area6.jpg","area7.jpg","area7_0.png","area7_2.jpg","bg.jpg","bg2.jpg","danger.png","debug007.png","debug008.png","debug009.png","debug_boss.png","downArrow.png","guangbiao.png","h_ky_thug3.png","hero.png","hero2.png","hero3.png","hero3_2.png","hero_gold.png","hero_rage.png","hero_rage2.png","iceMissileDown.png","light1.png","m_eura_ag2-1.png","rightArrow.png","skill12explain.png","talent0.png","talent1.png","talent10.png","talent11.png","talent12.png","talent13.png","talent2.png","talent3.png","talent4.png","talent5.png","talent6.png","talent7.png","talent8.png","talent9.png","talentT2_0.png","talentT2_1.png","talentT2_2.png","talentT2_3.png","talentT2_4.png","talentT2_5.png","talentT2_6.png","talentT2_7.png","talentT3_0.png","talentT3_1.png","talentT3_2.png","talentT3_3.png","talentT3_6.png","warning.png","winskin.png"],tilesets:["010-CastleTown02.png","018-MineTown02.png","top.png","003-Forest01.png","001-Grassland01.png","005-Beach01.png","046-Cave04.png","004-Mountain01.png","043-Cave01.png","Vilarejo_Noite.png","shiro_m001naiso.png","Heaven.png","Map-Desert01.png","Modern.png","town18.png","city19.png"],animates:["E_angry","E_dots","E_embarrass","E_love","E_question","E_surprise","E_sweat","E_unhappy","anti_rage","blackmagic","blueattack","crossattack","dark","dark2","dark3","dark_mute","darkexplode","darkexplode_mute","def_buff","dispel","electronic","explosion","explosion_small","fire","fire2","fire3","fire3_mute","fire4","fire4_mute","fire_mute","hand","heal","heal2","ice","ice2","jianji","jianji2","light2","mdef_buff","morphattack","rage_buff","rage_disp","roar","seal","skill1","skill10","skill12","skill13down","skill13up","skill2","skill3","skill6","skill7","slash","slash2","snipe","spe50","spe62","supernova","sword","sword1","sword2","sword3","sword4","sword8","thunder","thunder3","thunder4","yidaoliangduan","yongchang","zhanji","zhanji2","zone","zone2"],bgms:["CutterUp.mp3","area1.mp3","area10.mp3","area11.mp3","area12.mp3","area13.mp3","area14.mp3","area15.mp3","area16.mp3","area17.mp3","area18.mp3","area19.mp3","area19_2.mp3","area19_3.mp3","area2.mp3","area20.mp3","area21.mp3","area3.mp3","area4.mp3","area5.mp3","area6.mp3","area7.mp3","area8.mp3","area9.mp3","boss10.mp3","boss11.mp3","boss16.mp3","boss17.mp3","boss18.mp3","boss2.mp3","boss2221.mp3","boss4.mp3","boss5.mp3","boss7_2.mp3","dungeon1.mp3","dungeon2.mp3","secret.mp3","story.mp3","story2.mp3","sunrise.mp3","tenshi.mp3","village.mp3"],sounds:["001-System01.ogg","002-System02.ogg","004-System04.ogg","008-System08.ogg","011-System11.ogg","015-Jump01.ogg","037-Switch06.ogg","044-Chest01.ogg","048-Explosion01.ogg","049-Explosion02.ogg","050-Explosion03.ogg","051-Explosion04.ogg","053-Cannon02.ogg","054-Cannon03.ogg","055-Right01.ogg","057-Wrong01.ogg","058-Wrong02.ogg","059-Applause01.ogg","061-Thunderclap01.ogg","079-Monster01.ogg","086-Action01.ogg","087-Action02.ogg","092-Attack04.ogg","094-Attack06.ogg","095-Attack07.ogg","096-Attack08.ogg","098-Attack10.ogg","1045.mp3","105-Heal01.ogg","109-Heal05.ogg","112-Heal08.ogg","118-Fire02.ogg","119-Fire03.ogg","120-Ice01.ogg","124-Thunder02.ogg","125-Thunder03.ogg","132-Wind01.ogg","136-Light02.ogg","138-Darkness01.ogg","139-Darkness02.ogg","152-Support10.ogg","153-Support11.ogg","154-Support12.ogg","157-Skill01.ogg","158-Skill02.ogg","159-Skill03.ogg","161-Skill05.ogg","163-Skill07.ogg","165-Skill09.ogg","Annihilation2.wav","DF_e_1.mp3","DF_e_2.mp3","DF_q_1.mp3","DF_q_2.mp3","Darkness3.ogg","Elevator.ogg","MSLASH.ogg","Monster1.ogg","Quake.ogg","Raise1.ogg","Saint1.ogg","Sand.ogg","VX_Crash.ogg","VX_Explosion5.ogg","VX_Ice8.ogg","VX_Slash1.ogg","VX_Slash4.ogg","VX_Slash6.ogg","VX_Slash8.ogg","VX_Sword1.ogg","VX_Thunder8.ogg","VX_Wind10.ogg","ak47.mp3","attack.mp3","billy.mp3","bomb.mp3","buy.mp3","cancel.mp3","centerFly.mp3","confirm.mp3","cursor.mp3","door.mp3","drink.mp3","equip.mp3","error.mp3","floor.mp3","ha.mp3","hint.mp3","icePickaxe.mp3","item.mp3","jump.mp3","kn_sword.wav","load.mp3","mteleport.wav","open_ui.mp3","pickGem.wav","pickKey.wav","pickPotion.wav","pickPotion2.wav","pickaxe.mp3","recovery.mp3","save.mp3","se_alert.wav","se_power0.wav","shop.mp3","skill10.mp3","skill10pre.mp3","smallExplosion.mp3","startup.wav","timestop.wav","wind.mp3","wrong2.mp3","zone.mp3"],fonts:[],nameMap:{"确定":"confirm.mp3","取消":"004-System04.ogg","操作失败":"wrong2.mp3","光标移动":"cursor.mp3","打开界面":"open_ui.mp3","读档":"load.mp3","存档":"save.mp3","获得道具":"item.mp3","回血":"recovery.mp3","炸弹":"bomb.mp3","飞行器":"centerFly.mp3","开关门":"door.mp3","上下楼":"floor.mp3","跳跃":"jump.mp3","破墙镐":"pickaxe.mp3","阻激夹域":"zone.mp3","穿脱装备":"equip.mp3","背景音乐":"bgm.mp3","攻击":"attack.mp3","背景图":"bg.jpg","领域":"zone"},levelChoose:[{title:"简化",name:"Simple",hard:1,color:[255,255,255,1],action:[{type:"comment",text:"在这里写该难度需执行的事件"}]},{title:"普通",name:"Normal",hard:2,color:[99,255,99,1],action:[]}],equipName:["武器","盾牌"],startBgm:null,styles:{startBackground:"project/images/bg.jpg",startVerticalBackground:"project/images/bg2.jpg",startLogoStyle:"display: none",startButtonsStyle:"background-color: #32369F; opacity: 0.85; color: #FFFFFF; border: #FFFFFF 2px solid; caret-color: #FFD700;",statusLeftBackground:"url(project/materials/ground.png) repeat",statusTopBackground:"url(project/materials/ground.png) repeat",toolsBackground:"url(project/materials/ground.png) repeat",floorChangingStyle:"background-color: black; color: white",statusBarColor:[255,255,255,1],borderColor:[0,0,0,1],selectColor:[255,215,0,1],font:"Verdana"},floorPartitions:[["BMT20","MT20"],["MT21","MT35"],["MT36","MT55"],["MT5X","MT70_2"],["South1","East16"],["Cave15","Cave6_2"],["Cave16","Cave20"],["Ch_D1","Ch_D2"],["Ch4_1","Ch4_10"],["Ch4_11","Ch4_20"],["Ch4_21","Ch4_30"],["Ch4_31","Ch4_40"],["Ch4_41","Ch4_5H"],["Ch4_60","Ch4_car"],["Ch4_80","Ch4_110"],["Ch4_111","Ch4_120"],["Ch4_121","Ch4_129"],["Ch4_130","Ch4_131"]]},firstData:{title:"咕工智障",name:"9922",version:"Ver 4.0",floorId:"MT0",hero:{image:"hero.png",animate:false,name:"9922",lv:1,hpmax:9922,hp:500,manamax:-1,mana:0,atk:8,def:5,mdef:0,money:0,exp:0,equipment:[],items:{constants:{},tools:{},equips:{}},loc:{direction:"down",x:6,y:1},flags:{},followers:[],steps:0},startCanvas:[{type:"comment",text:"在这里可以用事件来自定义绘制标题界面的背景图等"},{type:"comment",text:"也可以直接切换到其他楼层（比如某个开始剧情楼层）进行操作。"},{type:"showImage",code:1,image:"bg.jpg",loc:[0,0],opacity:1,time:0},{type:"while",condition:"1",data:[{type:"comment",text:"给用户提供选择项，这里简单的使用了choices事件"},{type:"comment",text:"也可以贴按钮图然后使用等待操作来完成"},{type:"choices",choices:[{text:"开始游戏",action:[{type:"comment",text:"检查bgm状态，下同"},{type:"function","function":"function(){\ncore.control.checkBgm()\n}"},{type:"if",condition:"main.levelChoose.length == 0","true":[{type:"comment",text:"直接开始游戏"}],"false":[{type:"comment",text:"动态生成难度选择项"},{type:"function","function":'function(){\nvar choices = [];\nmain.levelChoose.forEach(function (one) {\n\tchoices.push({\n\t\t"text": one.title || \'\',\n\t\t"action": [\n\t\t\t{ "type": "function", "function": "function() { core.status.hard = \'" + (one.name || \'\') + "\'; }" }\n\t\t]\n\t});\n})\ncore.insertAction({ "type": "choices", "choices": choices });\n}'}]},{type:"hideImage",code:1,time:0},{type:"comment",text:"成功选择难度"},{type:"break"}]},{text:"读取存档",action:[{type:"function","function":"function(){\ncore.control.checkBgm()\n}"},{type:"comment",text:"简单的使用“呼出读档界面”来处理"},{type:"callLoad"}]},{text:"回放录像",action:[{type:"function","function":"function(){\ncore.control.checkBgm()\n}"},{type:"comment",text:"这段代码会弹框选择录像文件"},{type:"if",condition:"(!core.isReplaying())","true":[{type:"function","function":"function(){\ncore.chooseReplayFile()\n}"}]}]}]}]},{type:"comment",text:"接下来会执行startText中的事件"}],startText:[{type:"comment",text:"初始剧情"},{type:"setText",background:"winskin.png",time:37,animateTime:50},{type:"if",condition:"(!core.platform.isPC)","true":["\t[系统提示]建议使用PC进行游戏。"]},{type:"if",condition:"(!core.musicStatus.bgmStatus)","true":["\t[系统提示]当前音乐处于关闭状态。"]},"\t[系统提示]进入游戏后不捡手册连续撞击上方机关门，可以跳到后面的章节。",{type:"if",condition:"(flags.hard==1)","true":["\t[系统提示]检测到当前是\r[aqua]简化难度\r。\n在这个难度下敌人的能力值比较低，并且有少量机制上的删减，适合萌新玩家或大佬初见探路用。"],"false":["\t[系统提示]检测到当前是\r[aqua]普通难度\r。\n正常的游戏难度，只要肯咸绿就非常简单。全绿通关略有难度，要求思路正确、转换及格。"]},{type:"setValue",name:"flag:heroLight",value:"1"},{type:"setValue",name:"flag:lightRadius",value:"0"},{type:"setValue",name:"flag:fire_light_a",value:"0.1"},{type:"setValue",name:"item:I_config",value:"1"}],shops:[{id:"Chap4Shop4",text:"\t[神像,moneyShop]你可以在这里把钥匙兑换成血量！",textInList:"第四章神像",mustEnable:true,disablePreview:false,choices:[{text:"1黄钥匙换375万血",need:"item:yellowKey>0",color:[110,255,90,1],action:[{type:"setValue",name:"status:hp",operator:"+=",value:"3750000"},{type:"playSound",name:"pickPotion2.wav"},{type:"setValue",name:"item:yellowKey",operator:"-=",value:"1"}]},{text:"1黄钥匙换125能量",need:"item:yellowKey>0",color:[162,0,197,1],action:[{type:"setValue",name:"status:mana",operator:"+=",value:"125"},{type:"playSound",name:"pickPotion2.wav"},{type:"setValue",name:"item:yellowKey",operator:"-=",value:"1"}]},{text:"3黄钥匙换1蓝钥匙",need:"item:yellowKey>=3",color:[190,182,30,1],action:[{type:"playSound",name:"pickKey.wav"},{type:"setValue",name:"item:blueKey",operator:"+=",value:"1"},{type:"setValue",name:"item:yellowKey",operator:"-=",value:"3"}]},{text:"1蓝钥匙换3黄钥匙",need:"item:blueKey>0",color:[106,103,255,1],action:[{type:"playSound",name:"pickKey.wav"},{type:"setValue",name:"item:blueKey",operator:"-=",value:"1"},{type:"setValue",name:"item:yellowKey",operator:"+=",value:"3"}]}]},{id:"Chap3End",text:"\t[计分点,X30023]你可以在这里把钥匙和能量兑换成血量！\n黄钥匙兑换血量自动取较高值。",textInList:"第三章计分点",mustEnable:true,disablePreview:false,choices:[{text:"1黄钥匙换250万血或5%当前生命值",need:"item:yellowKey>0",color:[255,247,90,1],action:[{type:"if",condition:"core.status.hero.hp <= 50000000","true":[{type:"setValue",name:"status:hp",operator:"+=",value:"2500000"}],"false":[{type:"setValue",name:"status:hp",operator:"*=",value:"1.05"}]},{type:"playSound",name:"pickPotion2.wav"},{type:"setValue",name:"item:yellowKey",operator:"-=",value:"1"}]},{text:"1蓝钥匙换3黄钥匙",need:"item:blueKey>0",color:[106,103,255,1],action:[{type:"playSound",name:"pickKey.wav"},{type:"setValue",name:"item:blueKey",operator:"-=",value:"1"},{type:"setValue",name:"item:yellowKey",operator:"+=",value:"3"}]},{text:"1红钥匙换9黄钥匙",need:"item:redKey>0",color:[255,78,78,1],action:[{type:"playSound",name:"pickKey.wav"},{type:"setValue",name:"item:redKey",operator:"-=",value:"1"},{type:"setValue",name:"item:yellowKey",operator:"+=",value:"9"}]},{text:"1能量换25000血（全部兑换）",need:"status:mana > 0",color:[162,0,197,1],action:[{type:"animate",name:"heal2",loc:"hero"},{type:"function","function":"function(){\ncore.status.hero.hp += core.status.hero.mana * 25000;\ncore.status.hero.mana = 0;\ncore.updateStatusBar();\n}"}]}]},{id:"South8Shop",item:true,textInList:"魔法装备商店",use:"money",mustEnable:true,choices:[{id:"sword5",number:1,money:"2000",condition:"!(item:sword5 || item:sword6 || item:sword7 || equip:0)"},{id:"sword6",number:1,money:"2000",condition:"!(item:sword5 || item:sword6 || item:sword7 || equip:0)"},{id:"sword7",number:1,money:"2000",condition:"!(item:sword5 || item:sword6 || item:sword7 || equip:0)"}]},{id:"shop1",text:"\t[神像,moneyShop]给我25金币就可以：",textInList:"4F金币商店",mustEnable:true,disablePreview:false,choices:[{text:"攻击+1（剩余${flag:shop1_1}次）",need:"status:money>=25&&flag:shop1_1>0",icon:"sword1",color:[255,119,119,1],action:[{type:"if",condition:"(flag:shop1_1>0)","true":[{type:"comment",text:"新版商店中需要手动扣减金币和增加访问次数"},{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"25"},{type:"setValue",name:"flag:shop1_1",operator:"-=",value:"1"},{type:"setValue",name:"status:atk",operator:"+=",value:"1"},{type:"if",condition:"((flag:shop1_1 == 0 )&&( flag:shop1_2 == 0))","true":[{type:"disableShop",id:"shop1"},{type:"setBlock",number:"closedMoneyShop",loc:[[6,5]],floorId:"MT4"}]}],"false":["\t[神像,blueShop]已经到次数上限了。"]}]},{text:"防御+1（剩余${flag:shop1_2}次）",need:"status:money>=25&&flag:shop1_2>0",icon:"shield1",color:[119,119,255,1],action:[{type:"if",condition:"(flag:shop1_2>0)","true":[{type:"comment",text:"新版商店中需要手动扣减金币和增加访问次数"},{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"25"},{type:"setValue",name:"flag:shop1_2",operator:"-=",value:"1"},{type:"setValue",name:"status:def",operator:"+=",value:"1"},{type:"if",condition:"((flag:shop1_1 == 0 )&&( flag:shop1_2 == 0))","true":[{type:"disableShop",id:"shop1"},{type:"setBlock",number:"closedMoneyShop",loc:[[6,5]],floorId:"MT4"}]}],"false":["\t[神像,blueShop]已经到次数上限了。"]}]}]},{id:"13FShop",text:"\t[钥匙商人,trader]低价甩卖钥匙！",textInList:"钥匙商人",mustEnable:true,disablePreview:false,choices:[{text:"黄钥匙（${flag:yellowKey_price}金币，剩余${flag:yellowKey_storage}把）",need:"status:money>=flag:yellowKey_price",icon:"yellowKey",color:[250,247,71,1],condition:"flag:yellowKey_storage>0",action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"flag:yellowKey_price"},{type:"setValue",name:"flag:bought_yellowKey",operator:"+=",value:"1"},{type:"setValue",name:"flag:yellowKey_storage",operator:"-=",value:"1"},{type:"setValue",name:"item:yellowKey",operator:"+=",value:"1"},{type:"if",condition:"((flag:yellowKey_storage <= 0 )&&((flag:redKey_storage <= 0 )&&( flag:blueKey_storage <= 0)))","true":[{type:"disableShop",id:"13FShop"},{type:"if",condition:"flag:15Fboss","true":["\t[钥匙商人,trader]这么多钥匙竟然都卖完了，非常感谢两位美女的支持，我们后会有期，嘿嘿。",{type:"hide",loc:[[8,6]],floorId:"MT0",remove:true},{type:"exit"}]}]}]},{text:"蓝钥匙（${flag:blueKey_price}金币，剩余${flag:blueKey_storage}把）",need:"status:money>=flag:blueKey_price",icon:"blueKey",color:[119,119,255,1],condition:"flag:blueKey_storage>0",action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"flag:blueKey_price"},{type:"setValue",name:"flag:bought_blueKey",operator:"+=",value:"1"},{type:"setValue",name:"flag:blueKey_storage",operator:"-=",value:"1"},{type:"setValue",name:"item:blueKey",operator:"+=",value:"1"},{type:"if",condition:"((flag:yellowKey_storage <= 0 )&&((flag:redKey_storage <= 0 )&&( flag:blueKey_storage <= 0)))","true":[{type:"disableShop",id:"13FShop"},{type:"if",condition:"flag:15Fboss","true":["\t[钥匙商人,trader]这么多钥匙竟然都卖完了，非常感谢两位美女的支持，我们后会有期，嘿嘿。",{type:"hide",loc:[[8,6]],floorId:"MT0",remove:true},{type:"exit"}]}]}]},{text:"红钥匙（${flag:redKey_price}金币，剩余${flag:redKey_storage}把）",need:"status:money>=flag:redKey_price",icon:"redKey",color:[255,119,119,1],condition:"flag:redKey_storage>0",action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"flag:redKey_price"},{type:"setValue",name:"flag:bought_redKey",operator:"+=",value:"1"},{type:"setValue",name:"flag:redKey_storage",operator:"-=",value:"1"},{type:"setValue",name:"item:redKey",operator:"+=",value:"1"},{type:"if",condition:"((flag:yellowKey_storage <= 0 )&&((flag:redKey_storage <= 0 )&&( flag:blueKey_storage <= 0)))","true":[{type:"disableShop",id:"13FShop"},{type:"if",condition:"flag:15Fboss","true":["\t[钥匙商人,trader]这么多钥匙竟然都卖完了，非常感谢两位美女的支持，我们后会有期，嘿嘿。",{type:"hide",loc:[[8,6]],floorId:"MT0",remove:true},{type:"exit"}]}]}]}]},{id:"12FShop",item:true,textInList:"技能商店",use:"money",mustEnable:true,choices:[{id:"skill1",number:1,money:"300"},{id:"skill2",number:1,money:"300"}]},{id:"12FShop_easy",item:true,textInList:"技能商店",use:"money",mustEnable:true,choices:[{id:"skill0",number:1,money:"300"},{id:"skill0_buff",number:3,money:"100",condition:"item:skill0 > 0"},{id:"I343",number:1,money:"300",condition:"item:skill0 > 0"}]},{id:"B3FShop",text:"\t[回收钥匙商店,expShop]不限量收购钥匙！",textInList:"回收钥匙",mustEnable:true,disablePreview:false,choices:[{text:"黄钥匙（+${flag:yellowKey_price}金币）",need:"item:yellowKey > 0",icon:"yellowKey",color:[250,247,71,1],action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"+=",value:"flag:yellowKey_price"},{type:"setValue",name:"item:yellowKey",operator:"-=",value:"1"}]},{text:"蓝钥匙（+${flag:blueKey_price}金币）",need:"item:blueKey > 0",icon:"blueKey",color:[119,119,255,1],action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"+=",value:"flag:blueKey_price"},{type:"setValue",name:"item:blueKey",operator:"-=",value:"1"}]},{text:"红钥匙（+${flag:redKey_price}金币）",need:"item:redKey > 0",icon:"redKey",color:[255,119,119,1],action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"+=",value:"flag:redKey_price"},{type:"setValue",name:"item:redKey",operator:"-=",value:"1"}]}]},{id:"B4FShop",text:"\t[杜衡,N340]你很快就会找到自己存在的意义。\n只需${50+5*flag:shop2}金币：",textInList:"能力商店",mustEnable:true,disablePreview:false,choices:[{text:"热情（基础攻击+2%，剩余${15-flag:shop2_bought_atk}次）",need:"status:money>=50+5*flag:shop2 && flag:shop2_bought_atk <15",icon:"I401",color:[255,119,119,1],action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"50+5*flag:shop2"},{type:"function","function":"function(){\ncore.plugin.addValpp('atk', 2);\n}"},{type:"setValue",name:"flag:shop2",operator:"+=",value:"1"},{type:"setValue",name:"flag:shop2_bought_atk",operator:"+=",value:"1"},{type:"if",condition:"((flag:shop2_bought_atk==15 )&&(( flag:shop2_bought_def == 15 )&&( flag:shop2_bought_mdef== 15)))","true":[{type:"setValue",name:"flag:B4FShop_finish",value:"1"},{type:"disableShop",id:"B4FShop"},"\t[系统提示]所有强化完成，B4F支线任务已开启。",{type:"exit"}]}]},{text:"坚毅（基础防御+2%，剩余${15-flag:shop2_bought_def}次）",need:"status:money>=50+5*flag:shop2&&flag:shop2_bought_def<15",icon:"I409",color:[119,119,255,1],action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"50+5*flag:shop2"},{type:"function","function":"function(){\ncore.plugin.addValpp('def', 2);\n}"},{type:"setValue",name:"flag:shop2",operator:"+=",value:"1"},{type:"setValue",name:"flag:shop2_bought_def",operator:"+=",value:"1"},{type:"if",condition:"((flag:shop2_bought_atk==15 )&&(( flag:shop2_bought_def == 15 )&&( flag:shop2_bought_mdef== 15)))","true":[{type:"setValue",name:"flag:B4FShop_finish",value:"1"},{type:"disableShop",id:"B4FShop"},"\t[系统提示]所有强化完成，B4F支线任务已开启。",{type:"exit"}]}]},{text:"活力（基础护盾+4%，修复+10，剩余${15-flag:shop2_bought_mdef}次）",need:"status:money>=50+5*flag:shop2 && flag:shop2_bought_mdef<15",icon:"I397",color:[119,255,119,1],condition:"flag:hard == 1",action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"50+5*flag:shop2"},{type:"function","function":"function(){\ncore.plugin.addValpp('mdef', 4);\n}"},{type:"setValue",name:"flag:skill0_val",operator:"+=",value:"10"},{type:"setValue",name:"flag:shop2",operator:"+=",value:"1"},{type:"setValue",name:"flag:shop2_bought_mdef",operator:"+=",value:"1"},{type:"if",condition:"((flag:shop2_bought_atk==15 )&&(( flag:shop2_bought_def == 15 )&&( flag:shop2_bought_mdef== 15)))","true":[{type:"setValue",name:"flag:B4FShop_finish",value:"1"},{type:"disableShop",id:"B4FShop"},"\t[系统提示]所有强化完成，B4F支线任务已开启。",{type:"exit"}]}]},{text:"活力（基础护盾+4%，剩余${15-flag:shop2_bought_mdef}次）",need:"status:money>=50+5*flag:shop2 && flag:shop2_bought_mdef<15",icon:"I397",color:[119,255,119,1],condition:"flag:hard > 1",action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"50+5*flag:shop2"},{type:"function","function":"function(){\ncore.plugin.addValpp('mdef', 4);\n}"},{type:"setValue",name:"flag:shop2",operator:"+=",value:"1"},{type:"setValue",name:"flag:shop2_bought_mdef",operator:"+=",value:"1"},{type:"if",condition:"((flag:shop2_bought_atk==15 )&&(( flag:shop2_bought_def == 15 )&&( flag:shop2_bought_mdef== 15)))","true":[{type:"setValue",name:"flag:B4FShop_finish",value:"1"},{type:"disableShop",id:"B4FShop"},"\t[系统提示]所有强化完成，B4F支线任务已开启。",{type:"exit"}]}]}]},{id:"B12FShop",text:"\t[杜衡,N340]为了达成目标，足够的实力必不可少。\n只需400金币：",textInList:"能力商店",mustEnable:true,disablePreview:false,choices:[{text:"力量（攻击+10，剩余${10-flag:shop3_bought_atk}次）",need:"status:money>=400 && flag:shop3_bought_atk <10",color:[255,119,119,1],action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"400"},{type:"setValue",name:"status:atk",operator:"+=",value:"10"},{type:"setValue",name:"flag:shop3_bought_atk",operator:"+=",value:"1"},{type:"if",condition:"((flag:shop3_bought_atk==10)&&( flag:shop3_bought_def ==10))","true":[{type:"setValue",name:"flag:B12FShop_finish",value:"1"},{type:"disableShop",id:"B12FShop"},{type:"exit"}]}]},{text:"韧性（防御+8，剩余${10-flag:shop3_bought_def}次）",need:"status:money>=400 && flag:shop3_bought_def <10",color:[119,119,255,1],action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"400"},{type:"setValue",name:"status:def",operator:"+=",value:"8"},{type:"setValue",name:"flag:shop3_bought_def",operator:"+=",value:"1"},{type:"if",condition:"((flag:shop3_bought_atk==10)&&( flag:shop3_bought_def ==10))","true":[{type:"setValue",name:"flag:B12FShop_finish",value:"1"},{type:"disableShop",id:"B12FShop"},{type:"exit"}]}]}]},{id:"20FShop",text:"\t[杜衡,N340]500金币，帮你优化能量流动：",textInList:"技能商店",mustEnable:true,disablePreview:false,choices:[{text:"护盾爆发（倍率+0.1，消耗+1，剩余${5-flag:shop4_bought_atk}次）",need:"status:money>=500 && flag:shop4_bought_atk <5",icon:"skill1",color:[255,119,119,1],action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"500"},{type:"setValue",name:"flag:shop4_bought_atk",operator:"+=",value:"1"},{type:"setValue",name:"flag:skill1_ratio",operator:"*=",value:"10"},{type:"setValue",name:"flag:skill1_ratio",operator:"+=",value:"1"},{type:"setValue",name:"flag:skill1_ratio",operator:"/=",value:"10"},{type:"setValue",name:"flag:skill1_cost",operator:"+=",value:"1"},{type:"if",condition:"(flag:shop4_bought_atk==5)","true":["\t[hero]（感觉技能发生了质变……）","\t[系统提示]现在护盾爆发还会使对手1回合不能行动。",{type:"setValue",name:"flag:skill1_stun",value:"1"},{type:"function","function":'function(){\ncore.setFlag("skill1_extra_text", "，并使对手1回合不能行动");\n}'}]},{type:"if",condition:"(((flag:shop4_bought_atk==5)&&( flag:shop4_bought_def ==5))&&(flag:shop4_bought_mdef==5))","true":[{type:"setValue",name:"flag:20FShop_finish",value:"1"},{type:"disableShop",id:"20FShop"},{type:"exit"}]}]},{text:"集中防御（效果+5%，消耗+2，剩余${5-flag:shop4_bought_def}次）",need:"status:money>=500 && flag:shop4_bought_def <5",icon:"skill2",color:[119,119,255,1],action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"500"},{type:"setValue",name:"flag:shop4_bought_def",operator:"+=",value:"1"},{type:"setValue",name:"flag:skill2_val",operator:"+=",value:"5"},{type:"setValue",name:"flag:skill2_cost",operator:"+=",value:"2"},{type:"if",condition:"(flag:shop4_bought_def==5)","true":["\t[hero]（感觉能量的流动变得更顺畅了……）","\t[系统提示]蓄力所需的回合数-1。",{type:"setValue",name:"flag:skill2_charge",operator:"-=",value:"1"}]},{type:"if",condition:"(((flag:shop4_bought_atk==5)&&( flag:shop4_bought_def ==5))&&(flag:shop4_bought_mdef==5))","true":[{type:"setValue",name:"flag:20FShop_finish",value:"1"},{type:"disableShop",id:"20FShop"},{type:"exit"}]}]},{text:"能量回复（战后回复能量+1，剩余${5-flag:shop4_bought_mdef}次）",need:"status:money>=500 && flag:shop4_bought_mdef <5",icon:"I62",color:[119,255,119,1],action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"500"},{type:"setValue",name:"flag:shop4_bought_mdef",operator:"+=",value:"1"},{type:"setValue",name:"flag:mana_regen",operator:"+=",value:"1"},{type:"setValue",name:"item:I62",value:"1"},{type:"if",condition:"(((flag:shop4_bought_atk==5)&&( flag:shop4_bought_def ==5))&&(flag:shop4_bought_mdef==5))","true":[{type:"setValue",name:"flag:20FShop_finish",value:"1"},{type:"disableShop",id:"20FShop"},{type:"exit"}]}]}]},{id:"20FShop_easy",text:"\t[杜衡,N340]1000金币，帮你优化能量流动：",textInList:"技能商店",mustEnable:true,disablePreview:false,choices:[{text:"修复（基础值+200，剩余${5-flag:shop4_bought_atk}次）",need:"status:money>=1000 && flag:shop4_bought_atk <5",icon:"skill0",color:[255,255,255,1],action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"1000"},{type:"setValue",name:"flag:shop4_bought_atk",operator:"+=",value:"1"},{type:"setValue",name:"flag:skill0_val",operator:"+=",value:"200"},{type:"if",condition:"((flag:shop4_bought_atk==5)&&(flag:shop4_bought_mdef==3))","true":[{type:"setValue",name:"flag:20FShop_finish",value:"1"},{type:"disableShop",id:"20FShop_easy"},{type:"exit"}]}]},{text:"能量回复（战后回复能量+1，剩余${3-flag:shop4_bought_mdef}次）",need:"status:money>=1000 && flag:shop4_bought_mdef <3",icon:"I62",color:[119,255,119,1],action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"1000"},{type:"setValue",name:"flag:shop4_bought_mdef",operator:"+=",value:"1"},{type:"setValue",name:"flag:mana_regen",operator:"+=",value:"1"},{type:"setValue",name:"item:I62",value:"1"},{type:"if",condition:"((flag:shop4_bought_atk==5)&&(flag:shop4_bought_mdef==3))","true":[{type:"setValue",name:"flag:20FShop_finish",value:"1"},{type:"disableShop",id:"20FShop_easy"},{type:"exit"}]}]}]},{id:"20FEquipShop",item:true,textInList:"杂货商店",use:"money",mustEnable:true,choices:[{id:"I425",number:5,money:"250",condition:"flag:hard == 2"},{id:"sword1",number:0,sell:"50"},{id:"shield1",number:0,sell:"50"},{id:"sword2",number:0,sell:"200"},{id:"shield2",number:0,sell:"200"}]},{id:"36FShop",text:"\t[七彩侍卫,N407]用各种稀有金属改造，只需1500金币：",textInList:"强化商店",mustEnable:true,disablePreview:false,choices:[{text:"镉红（攻击+50，剩余${10-flag:shop5_bought_atk}次）",need:"status:money>=1500 && flag:shop5_bought_atk <10",color:[255,119,119,1],condition:"flag:hard == 2",action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"1500"},{type:"setValue",name:"status:atk",operator:"+=",value:"50"},{type:"setValue",name:"flag:shop5_bought_atk",operator:"+=",value:"1"},{type:"if",condition:"((flag:shop5_bought_atk==10)&&( flag:shop5_bought_def ==10)&&( flag:shop5_bought_mdef ==10))","true":[{type:"setValue",name:"flag:36FShop_finish",value:"1"},{type:"disableShop",id:"36FShop"},{type:"exit"}]}]},{text:"钴蓝（防御+50，剩余${10-flag:shop5_bought_def}次）",need:"status:money>=1500 && flag:shop5_bought_def <10",color:[119,119,255,1],condition:"flag:hard == 2",action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"1500"},{type:"setValue",name:"status:def",operator:"+=",value:"50"},{type:"setValue",name:"flag:shop5_bought_def",operator:"+=",value:"1"},{type:"if",condition:"((flag:shop5_bought_atk==10)&&( flag:shop5_bought_def ==10)&&( flag:shop5_bought_mdef ==10))","true":[{type:"setValue",name:"flag:36FShop_finish",value:"1"},{type:"disableShop",id:"36FShop"},{type:"exit"}]}]},{text:"铬绿（护盾承伤+0.2，剩余${10-flag:shop5_bought_mdef}次）",need:"status:money>=1500 && flag:shop5_bought_mdef <10",color:[119,255,119,1],condition:"flag:hard==2",action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"1500"},{type:"setValue",name:"flag:mdef_ratio",operator:"*=",value:"10"},{type:"setValue",name:"flag:mdef_ratio",operator:"+=",value:"2"},{type:"setValue",name:"flag:mdef_ratio",operator:"/=",value:"10"},{type:"setValue",name:"flag:shop5_bought_mdef",operator:"+=",value:"1"},{type:"setValue",name:"item:I437",value:"1"},{type:"if",condition:"((flag:shop5_bought_atk==10)&&( flag:shop5_bought_def ==10)&&( flag:shop5_bought_mdef ==10))","true":[{type:"setValue",name:"flag:36FShop_finish",value:"1"},{type:"disableShop",id:"36FShop"},{type:"exit"}]}]},{text:"镉红（攻击+40，剩余${10-flag:shop5_bought_atk}次）",need:"status:money>=1500 && flag:shop5_bought_atk <10",color:[255,119,119,1],condition:"flag:hard == 1",action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"1500"},{type:"setValue",name:"status:atk",operator:"+=",value:"40"},{type:"setValue",name:"flag:shop5_bought_atk",operator:"+=",value:"1"},{type:"if",condition:"((flag:shop5_bought_atk==10)&&( flag:shop5_bought_def ==10)&&( flag:shop5_bought_mdef ==10))","true":[{type:"setValue",name:"flag:36FShop_finish",value:"1"},{type:"disableShop",id:"36FShop"},{type:"exit"}]}]},{text:"钴蓝（防御+40，剩余${10-flag:shop5_bought_def}次）",need:"status:money>=1500 && flag:shop5_bought_def <10",color:[119,119,255,1],condition:"flag:hard == 1",action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"1500"},{type:"setValue",name:"status:def",operator:"+=",value:"40"},{type:"setValue",name:"flag:shop5_bought_def",operator:"+=",value:"1"},{type:"if",condition:"((flag:shop5_bought_atk==10)&&( flag:shop5_bought_def ==10)&&( flag:shop5_bought_mdef ==10))","true":[{type:"setValue",name:"flag:36FShop_finish",value:"1"},{type:"disableShop",id:"36FShop"},{type:"exit"}]}]},{text:"铬绿（护盾承伤+0.2，技能+100，剩余${10-flag:shop5_bought_mdef}次）",need:"status:money>=1500 && flag:shop5_bought_mdef <10",color:[119,255,119,1],condition:"flag:hard==1",action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"1500"},{type:"setValue",name:"item:I437",value:"1"},{type:"setValue",name:"flag:mdef_ratio",operator:"*=",value:"10"},{type:"setValue",name:"flag:mdef_ratio",operator:"+=",value:"2"},{type:"setValue",name:"flag:mdef_ratio",operator:"/=",value:"10"},{type:"setValue",name:"flag:skill0_val",operator:"+=",value:"100"},{type:"setValue",name:"flag:shop5_bought_mdef",operator:"+=",value:"1"},{type:"if",condition:"((flag:shop5_bought_atk==10)&&( flag:shop5_bought_def ==10)&&( flag:shop5_bought_mdef ==10))","true":[{type:"setValue",name:"flag:36FShop_finish",value:"1"},{type:"disableShop",id:"36FShop"},{type:"exit"}]}]}]},{id:"37FShop",item:true,textInList:"杂货商店",use:"money",mustEnable:true,choices:[{id:"I438",number:99,money:"159",sell:"159",condition:"flag:hard == 2"},{id:"I439",number:99,money:"119",sell:"119",condition:"flag:hard == 2"},{id:"I441",number:99,money:"139",sell:"139",condition:"flag:hard == 2"},{id:"I438",number:99,money:"139",sell:"139",condition:"flag:hard == 1"},{id:"I439",number:99,money:"89",sell:"89",condition:"flag:hard == 1"},{id:"I441",number:99,money:"39",sell:"39",condition:"flag:hard == 1"},{id:"I440",number:9,money:"1188",sell:"1188"}]},{id:"57FShop",text:"\t[神像,moneyShop]给我3000金币：",textInList:"强化商店",mustEnable:true,disablePreview:false,choices:[{text:"护盾强化（护盾承伤+0.3，剩余${10-flag:shop6_bought_mdef}次）",need:"status:money>=3000 && flag:shop6_bought_mdef <10",icon:"I437",color:[119,255,119,1],action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"status:money",operator:"-=",value:"3000"},{type:"setValue",name:"item:I437",value:"1"},{type:"setValue",name:"flag:mdef_ratio",operator:"*=",value:"10"},{type:"setValue",name:"flag:mdef_ratio",operator:"+=",value:"3"},{type:"setValue",name:"flag:mdef_ratio",operator:"/=",value:"10"},{type:"setValue",name:"flag:shop6_bought_mdef",operator:"+=",value:"1"},{type:"if",condition:"flag:shop6_bought_mdef ==10","true":[{type:"setValue",name:"flag:57FShop_finish",value:"1"},{type:"setBlock",number:"closedMoneyShop",loc:[[6,1]],floorId:"MT57"},{type:"disableShop",id:"57FShop"},{type:"exit"}]}]}]},{id:"69FShop",text:"\t[粉色神像,expShop]出售大量\\i[superPotion_s]，每瓶都可以让你的生命值提升5%！",textInList:"灵液商店",mustEnable:true,disablePreview:false,choices:[{text:"1黄钥匙换1瓶",need:"item:yellowKey>0",color:[255,247,90,1],action:[{type:"playSound",name:"pickPotion2.wav"},{type:"setValue",name:"status:hp",operator:"*=",value:"1.05"},{type:"setValue",name:"item:yellowKey",operator:"-=",value:"1"}]},{text:"1蓝钥匙换3瓶",need:"item:blueKey>0",color:[106,103,255,1],action:[{type:"playSound",name:"pickPotion2.wav"},{type:"setValue",name:"status:hp",operator:"*=",value:"1.05"},{type:"setValue",name:"status:hp",operator:"*=",value:"1.05"},{type:"setValue",name:"status:hp",operator:"*=",value:"1.05"},{type:"setValue",name:"item:blueKey",operator:"-=",value:"1"}]},{text:"1红钥匙换9瓶",need:"item:redKey>0",color:[255,78,78,1],action:[{type:"playSound",name:"pickPotion2.wav"},{type:"setValue",name:"status:hp",operator:"*=",value:"1.05"},{type:"setValue",name:"status:hp",operator:"*=",value:"1.05"},{type:"setValue",name:"status:hp",operator:"*=",value:"1.05"},{type:"setValue",name:"status:hp",operator:"*=",value:"1.05"},{type:"setValue",name:"status:hp",operator:"*=",value:"1.05"},{type:"setValue",name:"status:hp",operator:"*=",value:"1.05"},{type:"setValue",name:"status:hp",operator:"*=",value:"1.05"},{type:"setValue",name:"status:hp",operator:"*=",value:"1.05"},{type:"setValue",name:"status:hp",operator:"*=",value:"1.05"},{type:"setValue",name:"item:redKey",operator:"-=",value:"1"}]},{text:"50能量换1瓶",need:"status:mana >= 50",color:[162,0,197,1],condition:"0 == 1",action:[{type:"playSound",name:"pickPotion2.wav"},{type:"setValue",name:"status:hp",operator:"*=",value:"1.05"},{type:"setValue",name:"status:mana",operator:"-=",value:"50"}]}]}],levelUp:[{need:"0",title:"",action:[{type:"comment",text:"此处是初始等级，只需填写称号"}]},{need:"20",title:"",action:[{type:"setValue",name:"status:atk",operator:"+=",value:"10"},{type:"setValue",name:"status:def",operator:"+=",value:"10"}]},{need:"40",title:"",action:[{type:"tip",text:"恭喜升级"}]}]},values:{lavaDamage:22221,poisonDamage:10,weakValue:20,redGem:1,blueGem:1,greenGem:5,redPotion:100,bluePotion:250,yellowPotion:500,greenPotion:800,breakArmor:2,counterAttack:0.1,purify:1,hatred:2,animateSpeed:400,statusCanvasRowsOnMobile:3,floorChangeTime:null,moveSpeed:null},flags:{statusBarItems:["enableFloor","enableHP","enableMana","enableAtk","enableDef","enableMDef","enableMoney","enableKeys","enableDebuff","enableSkill"],flyNearStair:false,flyRecordPosition:false,steelDoorWithoutKey:false,itemFirstText:true,equipboxButton:false,enableAddPoint:false,enableNegativeDamage:false,betweenAttackMax:false,useLoop:false,startUsingCanvas:false,statusCanvas:true,displayEnemyDamage:true,displayCritical:true,displayExtraDamage:true,enableGentleClick:true,ignoreChangeFloor:true,canGoDeadZone:true,enableMoveDirectly:true,disableShopOnDamage:false,blurFg:true,enableRouteFolding:false,enableEnemyPoint:false,extendToolbar:null}};var enemys_fcae963b_31c9_42b4_b48c_bb48d09f3f80={greenSlime:{name:"绿头怪",hp:100,atk:18,def:1,money:1,exp:0,point:0,special:[]},redSlime:{name:"红头怪",hp:120,atk:20,def:2,money:2,exp:0,point:0,special:0,value:null},blackSlime:{name:"黑头怪",hp:200,atk:35,def:10,money:6,exp:0,point:0,special:0},slimelord:{name:"胖头怪",hp:666,atk:62,def:26,money:12,exp:0,point:0,special:0},bat:{name:"小蝙蝠",hp:70,atk:38,def:3,money:3,exp:0,point:0,special:1},bigBat:{name:"大蝙蝠",hp:130,atk:70,def:7,money:7,exp:0,point:0,special:1},skeleton:{name:"骷髅人",hp:100,atk:42,def:6,money:5,exp:0,point:0,special:0},skeletonCaptain:{name:"骷髅队长",hp:300,atk:65,def:25,money:10,exp:0,point:0,special:[25],atkValue:50,add:false},rock:{name:"石头怪",hp:30,atk:75,def:30,money:15,exp:0,point:0,special:[3]},bluePriest:{name:"初级法师",hp:118,atk:18,def:6,money:4,exp:0,point:0,special:2},redPriest:{name:"高级法师",hp:1600,atk:400,def:250,money:39,exp:0,point:0,special:[2]},brownWizard:{name:"初级巫师",hp:300,atk:77,def:33,money:16,exp:0,point:0,special:[18],value:10,range:null},swordsman:{name:"双剑兵",hp:600,atk:330,def:50,money:31,exp:0,point:0,special:[4,30],value:100,range:2,zoneSquare:true},soldier:{name:"重甲战士",hp:13000,atk:1800,def:900,money:50,exp:0,point:0,special:0},yellowKnight:{name:"英勇骑士",hp:7500,atk:2200,def:600,money:52,exp:0,point:0,special:[26]},redKnight:{name:"热忱骑士",hp:9300,atk:3000,def:1200,money:60,exp:0,point:0,special:[25,26],range:null,zoneSquare:false,add:true,atkValue:5},darkKnight:{name:"机械骑士",hp:42000,atk:12400,def:4600,money:75,exp:0,point:0,special:[45],value45:1},blueKnight:{name:"冷酷骑士",hp:8800,atk:2600,def:1500,money:58,exp:0,point:0,special:[25,26],range:null,zoneSquare:false,defValue:5,add:true},poisonBat:{name:"紫蝙蝠",hp:550,atk:310,def:50,money:27,exp:0,point:0,special:[1],value28:2},evilHero:{name:"爆匙勇者",hp:1000,atk:999,def:333,money:40,exp:0,point:0,special:[36]},goldHornSlime:{name:"金角怪",hp:800,atk:2000,def:44,money:0,exp:0,point:0,special:[22,34],value:null,damage:1000},silverSlime:{name:"银头怪",hp:750,atk:220,def:90,money:26,exp:0,point:0,special:[]},whiteHornSlime:{name:"尖角怪",hp:600,atk:1600,def:41,money:0,exp:0,point:0,special:[18,22],value:0,damage:1000},redSwordsman:{name:"双剑战士",hp:1313,atk:888,def:266,money:45,exp:0,point:0,special:[4,30],n:null,zoneSquare:true,range:3,value:100,atkValue:30,defValue:null},steelGuard:{name:"铁守卫",hp:1000,atk:300,def:200,money:100,exp:0,point:0,special:[33],value:null},evilBat:{name:"操儡者",hp:4000,atk:500,def:250,money:300,exp:0,point:0,special:[25,32],atkValue:20,value:null,defValue:20,value28:null,value32:600,add:true,hpValue:50},silverSlimelord:{name:"银怪王",hp:1300,atk:3000,def:50,money:0,exp:0,point:0,special:[18,32],value32:1000,range:2,zoneSquare:true,value:0,damage:null},goldSlimelord:{name:"金怪王",hp:1500,atk:5000,def:100,money:0,exp:0,point:0,special:[32,34],value32:2000,range:3,zoneSquare:true,damage:null},skeletonWarrior:{name:"骷髅士兵",hp:150,atk:60,def:15,money:8,exp:0,point:0,special:0},ghostWarrior:{name:"冥队长",hp:100,atk:120,def:0,money:8,exp:0,point:0,special:7},whiteSlimeman:{name:"窃魂",hp:1500,atk:940,def:180,money:42,exp:0,point:0,special:[29,103],value29:90,range:null,zoneSquare:false},slimeman:{name:"窃灵",hp:625,atk:450,def:50,money:35,exp:0,point:0,special:[29,102],atkValue:null,defValue:null,range:1,value29:90},yellowGateKeeper:{name:"初级卫兵",hp:200,atk:48,def:22,money:9,exp:0,point:0,special:0},blueGateKeeper:{name:"窃匙傀儡",hp:400,atk:480,def:220,money:32,exp:0,point:0,special:[33,101],value:null,atkValue:null},blueMS:{name:"舒爽侍卫",hp:40000,atk:8000,def:5000,money:72,exp:0,point:0,special:[18,25],defValue:-10,zoneSquare:true,range:2,add:true},skeletonKnight:{name:"弟人法师",hp:400,atk:40,def:40,money:23,exp:0,point:0,special:[2,25],range:2,zoneSquare:true,atkValue:25,add:true},ironRock:{name:"铁头怪",hp:50,atk:105,def:50,money:24,exp:0,point:0,special:[3]},grayRock:{name:"灰石怪",hp:200,atk:363,def:0,money:34,exp:0,point:0,special:[3]},yellowPriest:{name:"中级法师",hp:600,atk:50,def:150,money:28,exp:0,point:0,special:[2]},blueRock:{name:"寒石怪",hp:50,atk:900,def:0,money:48,exp:0,point:0,special:[3,35],value:null,value35:3},greenKnight:{name:"强盾骑士",hp:10000,atk:4600,def:2500,money:68,exp:0,point:0,special:[43]},bowman:{name:"弓兵",hp:900,atk:150,def:100,money:29,exp:0,point:0,special:[30,31],atkValue:10,value31:50,range:2,zoneSquare:true},liteBowman:{name:"射手",hp:2400,atk:500,def:350,money:43,exp:0,point:0,special:[30,31],value31:50,range:3,zoneSquare:true,atkValue:15,value:200},watcherSlime:{name:"邪眼怪",hp:2500,atk:730,def:210,money:37,exp:0,point:0,special:[]},greenGateKeeper:{name:"青玉雕像",hp:111111,atk:11111,def:11111,money:82,exp:0,point:0,special:[46,49],value46:1000,add:true,value35:10000},frostBat:{name:"寒蝙蝠",hp:1450,atk:840,def:220,money:38,exp:0,point:0,special:[1,35],value:null,value35:2},blueButterfly:{name:"蓝蝶",hp:210,atk:122,def:20,money:18,exp:0,point:0,special:[29],value29:60},sworm:{name:"毛毛虫",hp:250,atk:73,def:19,money:11,exp:0,point:0,special:[],damage:null},bigfly:{name:"大飞虫",hp:150,atk:128,def:2,money:14,exp:0,point:0,special:[29],value:null,value1:null,value29:50},turtle:{name:"大乌龟",hp:995,atk:95,def:65,money:20,exp:0,point:0,special:0,notBomb:false},smallish:{name:"小弟人",hp:450,atk:110,def:35,money:19,exp:0,point:0,special:0},smallPriest:{name:"弟人祭司",hp:480,atk:20,def:60,money:22,exp:0,point:0,special:[2,28],range:2,value28:5,zoneSquare:true,add:true},smallWarrior:{name:"弟人战士",hp:580,atk:137,def:47,money:25,exp:0,point:0,special:0},bigFairy:{name:"大妖精",hp:260,atk:75,def:25,money:21,exp:0,point:0,special:[1,2],range:null,zoneSquare:false,value28:3},smallFairy:{name:"小妖精",hp:220,atk:45,def:10,money:13,exp:0,point:0,special:[1,2],value:null,value28:3},bigFlower:{name:"大花花",hp:388,atk:98,def:33,money:17,exp:0,point:0,special:0},Thief:{name:"奇怪的人",hp:200,atk:90,def:54,money:100,exp:0,point:0,special:[29],value29:80},thief_20:{name:"窃匙大盗",hp:400,atk:170,def:95,money:145,exp:0,point:0,special:[4,29],value29:80},thief_20_2:{name:"窃匙大盗",hp:1495,atk:145,def:95,money:145,exp:0,point:0,special:[5,29],value29:80},E344:{name:"机械刺客",hp:240000,atk:36500,def:6000,money:89,exp:0,point:0,special:[]},E345:{name:"机械杀手",hp:320000,atk:52000,def:26000,money:98,exp:0,point:0,special:[1],value31:null,n:null,value:null,value28:5},E346:{name:"机械防暴者",hp:500000,atk:34000,def:27000,money:95,exp:0,point:0,special:[]},E347:{name:"机械枪手",hp:180000,atk:40000,def:16000,money:94,exp:0,point:0,special:[24],value:null,snipe_damage:40000},E352:{name:"初级速攻傀儡",hp:690,atk:400,def:20,money:33,exp:0,point:0,special:[1,5]},E353:{name:"中级速攻傀儡",hp:1818,atk:833,def:133,money:41,exp:0,point:0,special:[5,37],value28:null,atkValue:20,value:20},E354:{name:"高级速攻傀儡",hp:3333,atk:2333,def:233,money:54,exp:0,point:0,special:[1,4],n:null,value28:5},E355:{name:"钢甲战士",hp:25000,atk:2550,def:2250,money:59,exp:0,point:0,special:[]},E360:{name:"剑盾兵",hp:1300,atk:230,def:150,money:30,exp:0,point:0,special:[30],defValue:5,range:2,zoneSquare:true,atkValue:5},E367:{name:"初级战矛傀儡",hp:750,atk:600,def:200,money:36,exp:0,point:0,special:[]},E368:{name:"高级战矛傀儡",hp:1600,atk:1350,def:650,money:46,exp:0,point:0,special:[36]},E369:{name:"神射手",hp:12000,atk:2000,def:1000,money:56,exp:0,point:0,special:[31,39],zoneSquare:true,range:2,value31:50},E370:{name:"战矛精英",hp:15000,atk:4000,def:2500,money:65,exp:0,point:0,special:[]},E375:{name:"白银斗士",hp:20000,atk:1800,def:1500,money:53,exp:0,point:0,special:[34,41],atkValue:null},E376:{name:"黄金斗士",hp:11000,atk:2400,def:1600,money:61,exp:0,point:0,special:[34,44],value:null,range:null,zoneSquare:false,atkValue:10,add:false},E377:{name:"白银禁卫",hp:28000,atk:2800,def:2400,money:63,exp:0,point:0,special:[34,41],atkValue:null},E378:{name:"黄金禁卫",hp:14400,atk:3200,def:2500,money:64,exp:0,point:0,special:[34,44],atkValue:10},E379:{name:"暴掠士兵",hp:10000,atk:2200,def:800,money:51,exp:0,point:0,special:[40],value40:4},E380:{name:"暴掠十夫长",hp:12000,atk:2400,def:1100,money:55,exp:0,point:0,special:[40],value40:6},E381:{name:"暴掠百夫长",hp:15000,atk:3200,def:1400,money:62,exp:0,point:0,special:[40],value40:8},E382:{name:"暴掠千夫长",hp:20000,atk:3700,def:1900,money:67,exp:0,point:0,special:[40],value40:10},E251:{name:"剑盾战士",hp:3300,atk:740,def:440,money:44,exp:0,point:0,special:[30],zoneSquare:true,range:3,atkValue:30,defValue:20},Emoli1:{name:"茉莉",hp:5000,atk:2000,def:1250,money:0,exp:0,point:0,special:[35,38],value:null,value38_1:100,value38_2:200,value35:5},Emoli2:{name:"茉莉",hp:8000,atk:1400,def:600,money:0,exp:0,point:0,special:[30],value:200,atkValue:30,defValue:20,range:null,zoneSquare:false},Emoli3:{name:"茉莉",hp:4000,atk:1500,def:500,money:1000,exp:0,point:0,special:[2,36]},blueGateKeeper2:{name:"借匙傀儡",hp:2020,atk:1080,def:770,money:47,exp:0,point:0,special:[33,37],atkValue:20,defValue:20},redGateKeeper:{name:"血战卫兵",hp:6000,atk:2500,def:2500,money:57,exp:0,point:0,special:[32,33],value32:5000},E278:{name:"剑王",hp:13131,atk:3333,def:1313,money:66,exp:0,point:0,special:[7,45],n:null,value28:null,damage:null,defValue:2,value45:1},Egule1:{name:"孤勒",hp:10000,atk:9999,def:4000,money:0,exp:0,point:0,special:[44,45],value45:10},Egule2:{name:"孤勒",hp:99999,atk:5000,def:4000,money:221,exp:0,point:0,special:[8,41],value31:null,atkValue:20},iceMS:{name:"清凉侍卫",hp:50000,atk:13500,def:3500,money:76,exp:0,point:0,special:[18,35],value:null,value35:5},sWarrior:{name:"机械厨师",hp:30000,atk:9500,def:2500,money:73,exp:0,point:0,special:[7,45],value45:1,defValue:1},ssWarrior:{name:"机械屠夫",hp:45000,atk:14500,def:4500,money:83,exp:0,point:0,special:[7,45],value45:2,defValue:1},mage1:{name:"魔术师",hp:25000,atk:4000,def:5000,money:74,exp:0,point:0,special:[2,9],n:1},mage2:{name:"颂唱者",hp:83000,atk:3000,def:8000,money:80,exp:0,point:0,special:[2,51],value46:1000},machine:{name:"搬运工",hp:80000,atk:7000,def:3000,money:69,exp:0,point:0,special:[],value:null,add:false,notBomb:false},redMS:{name:"热诚侍卫",hp:30000,atk:12000,def:4000,money:71,exp:0,point:0,special:[18,25],range:2,zoneSquare:true,atkValue:-10,add:true},greenMS:{name:"迅捷侍卫",hp:33000,atk:9900,def:3300,money:70,exp:0,point:0,special:[18,28],value28:-3,zoneSquare:true,range:2,add:true},redKing:{name:"挥霍之主",hp:200000,atk:20500,def:12500,money:87,exp:0,point:0,special:[45],value45:4},blackKing:{name:"奢靡之主",hp:180000,atk:29500,def:9500,money:88,exp:0,point:0,special:[1],value28:-5},noble1:{name:"机械贵族",hp:28000,atk:14500,def:8500,money:79,exp:0,point:0,special:[33,47],value40:7,atkValue:null,defValue:null,zoneSquare:false,range:null},noble2:{name:"机械权贵",hp:64000,atk:21600,def:12800,money:85,exp:0,point:0,special:[33,47],value40:10,atkValue:null,defValue:null,zoneSquare:false,range:null},butler:{name:"仆役长",hp:110000,atk:14000,def:7000,money:81,exp:0,point:0,special:[48],atkValue:500,defValue:500,range:2,zoneSquare:true,add:true},housekeeper:{name:"管家",hp:150000,atk:20000,def:10000,money:86,exp:0,point:0,special:[48],value:null,zoneSquare:true,range:2,atkValue:500,defValue:500,add:true},clown:{name:"杂耍舞者",hp:66666,atk:22222,def:4444,money:84,exp:0,point:0,special:[4,29],value29:33},greenMS2:{name:"洁净侍卫",hp:65000,atk:11500,def:6000,money:77,exp:0,point:0,special:[18,49],value40:null,value35:10000},goldMS:{name:"极奢侍卫",hp:100000,atk:10500,def:7000,money:78,exp:0,point:0,special:[18,50],defValue:null,value28:null,value40:null},E422:{name:"搬运工头",hp:200000,atk:10000,def:5000,money:300,exp:0,point:0,special:[]},E427:{name:"大魔术师",hp:67000,atk:6000,def:7000,money:400,exp:0,point:0,special:[2,9],n:2},E430:{name:"机械屠夫-改",hp:95000,atk:15500,def:5500,money:600,exp:0,point:0,special:[7,45],defValue:4,value45:4},E431:{name:"领唱者",hp:96000,atk:4000,def:10000,money:500,exp:0,point:0,special:[2,51],value46:2000},E433:{name:"杂耍大师",hp:66666,atk:26666,def:6666,money:666,exp:0,point:0,special:[4,29],value29:66},E436:{name:"侍卫总领",hp:250000,atk:30000,def:10000,money:800,exp:0,point:0,special:[25,39],zoneSquare:false,range:null,value:null,atkValue:null,hpValue:20},Eancang:{name:"安苍",hp:666666,atk:26666,def:16666,money:2221,exp:0,point:0,special:[48,51],atkValue:null,defValue:-10000,value46:10000,zoneSquare:true,range:3,add:true},E428:{name:"刚毅镜像",hp:9999,atk:99999,def:999,money:0,exp:0,point:0,special:[43],value28:null,value35:null},E432:{name:"沉醉镜像",hp:100000,atk:35000,def:15000,money:0,exp:0,point:0,special:[4,47],value40:90},E442:{name:"生息镜像",hp:400000,atk:25000,def:12000,money:0,exp:0,point:0,special:[46],value46:3000},E446:{name:"天罚镜像",hp:150000,atk:33000,def:16000,money:0,exp:0,point:0,special:[39,49],value35:10000,range:3,zoneSquare:true},E448:{name:"自行爆弹",hp:100000,atk:50000,def:10000,money:91,exp:0,point:0,special:[22,33],damage:80000},E449:{name:"破盾械卫",hp:120000,atk:49000,def:33000,money:97,exp:0,point:0,special:[1,9],n:4,value28:-4},E450:{name:"深暗之瞳",hp:300000,atk:10000,def:22000,money:93,exp:0,point:0,special:[2]},E451:{name:"苍白之惧",hp:400000,atk:16000,def:32000,money:102,exp:0,point:0,special:[2]},E452:{name:"离子球",hp:390000,atk:50000,def:30000,money:106,exp:0,point:0,special:[55]},E453:{name:"煦风仙子",hp:370000,atk:35000,def:17000,money:92,exp:0,point:0,special:[46],zoneSquare:true,value:null,range:3,value46:3000,add:true},E454:{name:"无人侦察机",hp:140000,atk:38000,def:3000,money:90,exp:0,point:0,special:[26,29],value29:30,value28:1},E455:{name:"火线侦察机",hp:190000,atk:55000,def:16000,money:99,exp:0,point:0,special:[26,29],value29:50,value28:2},E456:{name:"秘银图腾",hp:800000,atk:40000,def:20000,money:96,exp:0,point:0,special:[]},E457:{name:"鎏金图腾",hp:990000,atk:58000,def:32000,money:103,exp:0,point:0,special:[41]},E458:{name:"活体地雷",hp:160000,atk:60000,def:20000,money:100,exp:0,point:0,special:[22,33],value:null,value32:null,damage:200000},E459:{name:"合金骁骑",hp:300000,atk:65000,def:27000,money:104,exp:0,point:0,special:[45],value45:3},E460:{name:"狂暴因子",hp:1,atk:0,def:0,money:0,exp:0,point:0,special:[25,52],value:null,zoneSquare:true,range:3,atkValue:20,value52:500,add:true},E461:{name:"坚韧因子",hp:1,atk:0,def:0,money:0,exp:0,point:0,special:[25,53],value53:500,zoneSquare:true,range:3,defValue:20,add:true},E462:{name:"活力因子",hp:1,atk:0,def:0,money:0,exp:0,point:0,special:[25,54],value54:2000,value:null,zoneSquare:true,range:3,add:true,hpValue:20},E519:{name:"冰洁仙子",hp:500000,atk:60000,def:25000,money:101,exp:0,point:0,special:[56],value35:4},E348:{name:"破盾械王",hp:150000,atk:67000,def:46000,money:105,exp:0,point:0,special:[1,9],n:5,value28:-5},E2221:{name:"？？？！",hp:2221222,atk:122221,def:22221,money:0,exp:0,point:0,special:[15,38],value38_1:1000,value38_2:2221,value:2221,zoneSquare:true,range:21,category:"BOSS",title:"BOSS"},E363:{name:"至尊爆弹",hp:2221,atk:1222223,def:2221,money:0,exp:0,point:0,special:[57,58],damage:1222223},E2221_down:{name:"？？？！",hp:12222221,atk:122221,def:122221,money:0,exp:0,point:0,special:[104,105,106,107,108],title:"BOSS"},E2221_left:{name:",,,.",hp:12222221,atk:122221,def:122221,money:0,exp:0,point:0,special:[],displayIdInBook:"E2221_down",title:"BOSS"},E2221_right:{name:",,,.",hp:12222221,atk:122221,def:122221,money:0,exp:0,point:0,special:[],displayIdInBook:"E2221_down",title:"BOSS"},E2221_up:{name:",,,.",hp:12222221,atk:122221,def:122221,money:0,exp:0,point:0,special:[],displayIdInBook:"E2221_down",title:"BOSS"},E399:{name:"兽人",hp:440000,atk:55000,def:22000,money:6,exp:0,point:0,special:[45],value45:2},E400:{name:"兽人武士",hp:550000,atk:65000,def:30000,money:8,exp:0,point:0,special:[45],title:null,value45:2},E429:{name:"绿法师",hp:333333,atk:13333,def:40000,money:3,exp:0,point:0,special:[2]},E434:{name:"青泡泡",hp:250000,atk:45000,def:45000,money:5,exp:0,point:0,special:[1,59],title:"普通",value28:-5},E435:{name:"林间蝠",hp:140000,atk:64000,def:16000,money:4,exp:0,point:0,special:[1],title:null,value28:5},E443:{name:"青凝胶",hp:300000,atk:60000,def:60000,money:9,exp:0,point:0,special:[1,59],value28:-5},E444:{name:"强绿姆",hp:300000,atk:48000,def:21000,money:1,exp:0,point:0,special:[]},E445:{name:"强红姆",hp:360000,atk:52000,def:24000,money:2,exp:0,point:0,special:[]},E465:{name:"强黑姆",hp:450000,atk:73000,def:37000,money:7,exp:0,point:0,special:[],title:null},E467:{name:"强胖姆",hp:500000,atk:150000,def:50000,money:13,exp:0,point:0,special:[],title:"胖"},E471:{name:"翡翠灵铠",hp:200000,atk:160000,def:60000,money:11,exp:0,point:0,special:[31,45],title:"沉重",value31:30,value45:1},E472:{name:"小绿龙",hp:600000,atk:240000,def:60000,money:28,exp:0,point:0,special:[1],value28:10},E474:{name:"小蓝龙",hp:640000,atk:400000,def:160000,money:35,exp:0,point:0,special:[1,31],value28:8,value31:20},E475:{name:"枯叶蝶",hp:260000,atk:170000,def:30000,money:17,exp:0,point:0,special:[1,29],value29:50,value28:2},E476:{name:"流体",hp:1200000,atk:144000,def:84000,money:20,exp:0,point:0,special:[29],value29:20},E477:{name:"蓝法灵",hp:800000,atk:30000,def:100000,money:19,exp:0,point:0,special:[2,15],value:50000},E479:{name:"怪海草",hp:540000,atk:180000,def:90000,money:22,exp:0,point:0,special:[4]},E480:{name:"多爪藤",hp:700000,atk:250000,def:140000,money:32,exp:0,point:0,special:[5]},E481:{name:"野怪",hp:900000,atk:120000,def:40000,money:12,exp:0,point:0,special:[7],defValue:1},E482:{name:"橙泡泡",hp:450000,atk:140000,def:80000,money:14,exp:0,point:0,special:[1,59],value28:-3},E483:{name:"大野怪",hp:2900000,atk:210000,def:140000,money:29,exp:0,point:0,special:[7],defValue:2},E485:{name:"强野怪",hp:3700000,atk:320000,def:160000,money:36,exp:0,point:0,special:[7],defValue:3},E486:{name:"绿法灵",hp:490000,atk:14500,def:54100,money:10,exp:0,point:0,special:[2]},E487:{name:"新敌人",hp:0,atk:0,def:0,money:0,exp:0,point:0,special:[]},E488:{name:"绿法魂",hp:1300000,atk:100000,def:160000,money:30,exp:0,point:0,special:[2,15],zoneSquare:true,range:1,value:120000},E496:{name:"天才莱姆",hp:7121,atk:71,def:81,money:0,exp:0,point:0,special:[25],defValue:-20,atkValue:-20,range:2,title:null,zoneSquare:true},E497:{name:"白骨",hp:250,atk:250,def:55,money:0,exp:0,point:0,special:[]},E498:{name:"大蝠",hp:100,atk:320,def:55,money:0,exp:0,point:0,special:[1]},E500:{name:"黑球",hp:400,atk:185,def:40,money:0,exp:0,point:0,special:[]},E501:{name:"法师",hp:400,atk:180,def:30,money:0,exp:0,point:0,special:[2]},E502:{name:"铁卫",hp:1150,atk:115,def:15,money:0,exp:0,point:0,special:[41]},E503:{name:"磐石",hp:42,atk:80,def:95,money:0,exp:0,point:0,special:[3]},E504:{name:"红衣",hp:5000,atk:200,def:80,money:0,exp:0,point:0,special:[],title:"BOSS",range:null,value:null},E505:{name:"橙软泥",hp:1400000,atk:130000,def:30000,money:15,exp:0,point:0,special:[]},E507:{name:"下级鏖战尖兵",hp:900000,atk:178000,def:95000,money:24,exp:0,point:0,special:[31],value31:20},E509:{name:"下级突进铠甲",hp:400000,atk:200000,def:80000,money:23,exp:0,point:0,special:[1],value28:5},E510:{name:"下级守护卫士",hp:1000000,atk:160000,def:132000,money:25,exp:0,point:0,special:[8],atkValue:10,title:null},E511:{name:"橙刺球",hp:800000,atk:120000,def:70000,money:16,exp:0,point:0,special:[8],atkValue:10},E512:{name:"强海龟",hp:960000,atk:150000,def:100000,money:21,exp:0,point:0,special:[60],value60:20},E513:{name:"胖头鱼",hp:900000,atk:145000,def:85000,money:18,exp:0,point:0,special:[]},Exl_A:{name:"A型械灵",hp:1222221,atk:122221,def:22221,money:21,exp:0,point:0,special:[25],add:true,atkValue:21,title:null},Exl_B:{name:"B型械灵",hp:444200,atk:122200,def:22100,money:22,exp:0,point:0,special:[1,2],value:null,value32:null,damage:null,value28:5},Exl_C:{name:"C型械灵",hp:999891,atk:100000,def:100000,money:23,exp:0,point:0,special:[31,38],value38_1:20,value38_2:20000,value31:50},Exl_D:{name:"D型械灵",hp:4444444,atk:222221,def:84444,money:24,exp:0,point:0,special:[25],defValue:21,add:true},E527:{name:"魔力莱姆",hp:1005,atk:10,def:5,money:0,exp:0,point:0,special:[25],range:2,zoneSquare:true,atkValue:-10,defValue:-10,hpValue:-15},E528:{name:"林间清影",hp:660000,atk:440000,def:220000,money:43,exp:0,point:0,special:[29],n:null,value29:95},E529:{name:"龙人",hp:2200000,atk:350000,def:130000,money:34,exp:0,point:0,special:[45],value29:null,value45:1},E530:{name:"龙人长老",hp:3000000,atk:400000,def:150000,money:38,exp:0,point:0,special:[45],value45:1},E531:{name:"龙人法师",hp:2100000,atk:240000,def:180000,money:37,exp:0,point:0,special:[31],value31:80},E535:{name:"除灵者Ⅰ型",hp:3000000,atk:350000,def:150000,money:30,exp:0,point:0,special:[22,61],zoneSquare:true,range:2,atkValue:10000,damage:1000000,defValue:10000,value:null,hpValue:500000},E536:{name:"除灵者Ⅲ型",hp:1500000,atk:500000,def:100000,money:40,exp:0,point:0,special:[24,61],value:null,atkValue:50000,zoneSquare:true,range:2,hpValue:200000,snipe_damage:500000},E537:{name:"除灵者Ⅳ型",hp:2400000,atk:370000,def:230000,money:45,exp:0,point:0,special:[16,61],defValue:null,atkValue:null,zoneSquare:true,range:2,value60:null,hpValue:500000,value:10},E538:{name:"除灵者Ⅱ型",hp:4000000,atk:380000,def:180000,money:35,exp:0,point:0,special:[22,61],zoneSquare:true,range:3,atkValue:20000,defValue:20000,title:"喽啰",damage:2000000,value:null,hpValue:600000},E539:{name:"莱姆战士",hp:1400000,atk:240000,def:85000,money:26,exp:0,point:0,special:[]},E540:{name:"红姆战士",hp:1550000,atk:250000,def:95000,money:27,exp:0,point:0,special:[]},E541:{name:"黑姆战士",hp:1700000,atk:285000,def:110000,money:31,exp:0,point:0,special:[]},E542:{name:"胖姆战士",hp:2000000,atk:340000,def:120000,money:33,exp:0,point:0,special:[],title:"很胖"},E543:{name:"中级突进铠甲",hp:1800000,atk:600000,def:150000,money:45,exp:0,point:0,special:[1],value28:8},E544:{name:"上级突进铠甲",hp:2000000,atk:1280000,def:550000,money:71,exp:0,point:0,special:[1],value28:10,title:"喽啰"},E545:{name:"中级鏖战尖兵",hp:4500000,atk:450000,def:200000,money:46,exp:0,point:0,special:[29,31],value31:30,value29:20},E546:{name:"上级鏖战尖兵",hp:9000000,atk:840000,def:600000,money:72,exp:0,point:0,special:[29,31],value31:35,value29:25,title:"喽啰"},E547:{name:"中级守护卫士",hp:4000000,atk:420000,def:280000,money:47,exp:0,point:0,special:[8],value:null,atkValue:15},E548:{name:"上级守护卫士",hp:4800000,atk:1080000,def:800000,money:73,exp:0,point:0,special:[8,16],zoneSquare:false,atkValue:20,value:null,title:"喽啰",damage:null,damage2:5377000},Exl_E:{name:"E型械灵",hp:1919810,atk:89191,def:114514,money:26,exp:0,point:0,special:[2,29],value31:null,value29:75},Exl_F:{name:"F型械灵",hp:3333333,atk:366666,def:114514,money:28,exp:0,point:0,special:[15],value:300000,zoneSquare:true,range:2},Exl_G:{name:"G型械灵",hp:1500000,atk:450000,def:150000,money:30,exp:0,point:0,special:[6,18],value:1000000,n:4},E549:{name:"除灵者Ⅴ型",hp:15000000,atk:600000,def:200000,money:50,exp:0,point:0,special:[45,61],zoneSquare:true,range:4,atkValue:50000,defValue:50000,hpValue:2000000,title:"精英",value45:10},E551:{name:"大眼",hp:2560000,atk:640000,def:160000,money:40,exp:0,point:0,special:[]},E552:{name:"坚果",hp:4400000,atk:400000,def:100000,money:41,exp:0,point:0,special:[60],value60:50},E553:{name:"虹光莱姆",hp:3600000,atk:450000,def:180000,money:39,exp:0,point:0,special:[]},E554:{name:"虹光胖姆",hp:4500000,atk:550000,def:250000,money:48,exp:0,point:0,special:[],title:"特别胖"},E555:{name:"蓝凝胶",hp:3000000,atk:400000,def:200000,money:44,exp:0,point:0,special:[1,59],value28:-5},E556:{name:"蓝法魂",hp:2900000,atk:150000,def:220000,money:42,exp:0,point:0,special:[2,25],zoneSquare:true,range:2,defValue:15,add:true},E557:{name:"H型械灵",hp:5500000,atk:880000,def:440000,money:0,exp:0,point:0,special:[15,31],zoneSquare:true,range:1,value28:null,value:880000,value31:44},E558:{name:"打工人-996",hp:10000000,atk:1350000,def:200000,money:0,exp:0,point:0,special:[45],title:"精英",value28:null,value45:3},E559:{name:"打工人-996",hp:30000000,atk:870000,def:240000,money:981,exp:0,point:0,special:[15,22],title:"精英",zoneSquare:true,range:5,value:2000000,value32:null,damage:8000000},E560:{name:"除灵者Ⅸ型",hp:14000000,atk:1800000,def:1200000,money:99,exp:0,point:0,special:[31,61],range:2,zoneSquare:true,atkValue:80000,defValue:80000,hpValue:4000000,value31:50,title:"精英",bigImage:"debug009.png"},E561:{name:"除灵者Ⅶ型",hp:13330000,atk:1770000,def:1330000,money:85,exp:0,point:0,special:[22,61],zoneSquare:true,value:null,range:2,title:"精英",atkValue:50000,defValue:100000,hpValue:2000000,value45:null,damage:2221000,bigImage:"debug007.png"},E562:{name:"除灵者首领",hp:114000000,atk:8100000,def:5140000,money:996,exp:0,point:0,special:[15,61],title:"BOSS",zoneSquare:true,range:9,atkValue:114514,defValue:114514,hpValue:1919810,value45:9,value:1145140,bigImage:"debug_boss.png"},E563:{name:"除灵者Ⅷ型",hp:19990000,atk:1990000,def:990000,money:92,exp:0,point:0,special:[45,61],title:"精英",zoneSquare:true,range:2,atkValue:100000,defValue:50000,hpValue:2000000,value45:2,bigImage:"debug008.png"},E564:{name:"打工支援机",hp:3000000,atk:450000,def:150000,money:40,exp:0,point:0,special:[25],zoneSquare:true,value:null,range:2,atkValue:15,defValue:null,add:true},E570:{name:"高级支援机",hp:3600000,atk:900000,def:400000,money:0,exp:0,point:0,special:[25,33],zoneSquare:true,range:2,atkValue:10,defValue:10,hpValue:10,auraName:"全能光环",add:true},E576:{name:"晦暗剑魔",hp:6400000,atk:1400000,def:460000,money:0,exp:0,point:0,special:[],value45:null,zoneSquare:false,atkValue:null,add:false},E577:{name:"灰光死眼",hp:6666666,atk:666666,def:66666,money:0,exp:0,point:0,special:[2,65],value:null,value31:null,range:null,zoneSquare:false,value65:1},E578:{name:"索魂使者",hp:9000000,atk:1222000,def:600000,money:0,exp:0,point:0,special:[34,63],title:"精英"},E579:{name:"封源暗龙",hp:4800000,atk:820000,def:160000,money:0,exp:0,point:0,special:[62]},E580:{name:"多头怪蛇",hp:6200000,atk:1040000,def:260000,money:0,exp:0,point:0,special:[4]},E581:{name:"晦暗教徒",hp:11000000,atk:400000,def:350000,money:0,exp:0,point:0,special:[2,18],value:1000000},E582:{name:"无谋战士",hp:9900000,atk:1200000,def:300000,money:0,exp:0,point:0,special:[],value29:null},E583:{name:"泥土巨像",hp:10000000,atk:1150000,def:680000,money:0,exp:0,point:0,special:[16],value:40,title:"沉重"},E584:{name:"漆黑软泥",hp:5500000,atk:580000,def:220000,money:49,exp:0,point:0,special:[]},E585:{name:"迅捷小蝠",hp:4150000,atk:850000,def:50000,money:0,exp:0,point:0,special:[28],zoneSquare:true,range:2,value28:5,add:true},E586:{name:"迅捷大蝠",hp:4800000,atk:1200000,def:200000,money:0,exp:0,point:0,special:[28],value28:8,range:2,zoneSquare:true,add:true},E587:{name:"全知之眼",hp:6000000,atk:1280000,def:320000,money:67,exp:0,point:0,special:[67],zoneSquare:true,range:3,title:"喽啰"},E588:{name:"通天之眼",hp:6410000,atk:1740000,def:670000,money:82,exp:0,point:0,special:[67],title:"精英",range:3,zoneSquare:true,damage:2221,value:2221},E589:{name:"毁灭魔偶",hp:5000000,atk:500000,def:0,money:0,exp:0,point:0,special:[45,64],range:1,zoneSquare:true,damage:2000000,value45:5},E590:{name:"I型械灵",hp:11111111,atk:1111111,def:111111,money:0,exp:0,point:0,special:[31,64],zoneSquare:true,range:2,damage:2221222,value31:11},E593:{name:"泥土傀儡",hp:7500000,atk:1000000,def:600000,money:0,exp:0,point:0,special:[16],value:20},E594:{name:"电眼绝姆",hp:9600000,atk:1080000,def:360000,money:0,exp:0,point:0,special:[]},E595:{name:"红海先锋",hp:5700000,atk:1250000,def:520000,money:0,exp:0,point:0,special:[9],value:null,add:false,n:2,value31:null},E599:{name:"失去魔力的莱姆",hp:1005,atk:10,def:5,money:0,exp:0,point:0,special:[]},E604:{name:"黑泡泡",hp:5300000,atk:800000,def:420000,money:0,exp:0,point:0,special:[1,59],value28:-1},E626:{name:"禁魔节点",hp:5000000,atk:500000,def:500000,money:0,exp:0,point:0,special:[33,109],title:"精英"},E627:{name:"至尊爆弹-激活态",hp:1,atk:22,def:21,money:0,exp:0,point:0,special:[64,110],damage:1919810,range:1,zoneSquare:true},E628:{name:"至尊爆弹-休眠态",hp:1,atk:22,def:21,money:0,exp:0,point:0,special:[20]},E629:{name:"2 2 2 1",hp:1,atk:2221,def:2221,money:0,exp:0,point:0,special:[64,111,112,113],damage:6700417,range:2,zoneSquare:true,title:"械灵之王"},E630:{name:"水球怪",hp:310,atk:255,def:50,money:0,exp:0,point:0,special:[]},E631:{name:"水法怪",hp:500,atk:300,def:0,money:0,exp:0,point:0,special:[2]},E632:{name:"水鱼怪",hp:1500,atk:130,def:15,money:0,exp:0,point:0,special:[]},E633:{name:"水骑怪",hp:120,atk:380,def:60,money:0,exp:0,point:0,special:[1],value28:2},E634:{name:"水泡怪",hp:440,atk:225,def:75,money:0,exp:0,point:0,special:[]},E635:{name:"水卫怪",hp:1300,atk:140,def:95,money:0,exp:0,point:0,special:[8],atkValue:10},E636:{name:"水石怪",hp:500,atk:110,def:80,money:0,exp:0,point:0,special:[],title:"沉重"},E637:{name:"水魔怪",hp:5000,atk:230,def:80,money:0,exp:0,point:0,special:[],title:"BOSS"},A11boss_p1:{name:"996-p1",hp:10000000,atk:1350000,def:200000,money:0,exp:0,point:0,special:[45],displayIdInBook:"E558",value45:3,title:"精英"},A11boss_p2:{name:"996-p2",hp:30000000,atk:870000,def:240000,money:981,exp:0,point:0,special:[15,22],displayIdInBook:"E559",value:2000000,damage:8000000,title:"精英",zoneSquare:true,range:5},E642:{name:"魔影",hp:5600000,atk:660000,def:370000,money:56,exp:0,point:0,special:[29],value29:50},E643:{name:"狱马",hp:4000000,atk:750000,def:280000,money:52,exp:0,point:0,special:[]},E644:{name:"鎏金骑士",hp:5500000,atk:1450000,def:550000,money:74,exp:0,point:0,special:[45],title:"喽啰",value45:2},E645:{name:"牛头",hp:3500000,atk:700000,def:450000,money:54,exp:0,point:0,special:[]},E646:{name:"铁王八",hp:2500000,atk:880000,def:820000,money:63,exp:0,point:0,special:[]},E647:{name:"龙蝠",hp:1440000,atk:960000,def:240000,money:50,exp:0,point:0,special:[1],value28:3},E648:{name:"鬼灵",hp:7200000,atk:100000,def:360000,money:51,exp:0,point:0,special:[2]},E649:{name:"黑剑",hp:1000000,atk:970000,def:530000,money:55,exp:0,point:0,special:[]},E650:{name:"J型械灵",hp:7500000,atk:500000,def:500000,money:62,exp:0,point:0,special:[16,31],value:50,value31:50},E651:{name:"触手",hp:2400000,atk:600000,def:360000,money:53,exp:0,point:0,special:[5]},E262:{name:"械灵-Moe",hp:12000000,atk:1000000,def:600000,money:200,exp:0,point:0,special:[38],title:"领主",value38_1:500,value38_2:20000},E671:{name:"目力莱姆",hp:1919000,atk:810810,def:114514,money:81,exp:0,point:0,special:[67,68],value:null,zoneSquare:true,range:3},E672:{name:"械蟹",hp:10000000,atk:750000,def:250000,money:57,exp:0,point:0,special:[],value:null,range:null,zoneSquare:false},E673:{name:"尖壳旋螺",hp:2400000,atk:960000,def:640000,money:58,exp:0,point:0,special:[1],value28:-5},E674:{name:"M型械灵",hp:7500000,atk:1250000,def:500000,money:68,exp:0,point:0,special:[71],atkValue:null,zoneSquare:false,range:null,value:null,title:null},E675:{name:"蓝袍法师",hp:3000000,atk:150000,def:600000,money:60,exp:0,point:0,special:[2,39],range:1,zoneSquare:true,value:null,add:false,defValue:null},E676:{name:"红袍法师",hp:4400000,atk:400000,def:330000,money:63,exp:0,point:0,special:[2,25],zoneSquare:true,range:1,atkValue:10,add:true},E677:{name:"绿袍法师",hp:7000000,atk:200000,def:700000,money:69,exp:0,point:0,special:[2,39],zoneSquare:true,range:1,value46:null,title:"喽啰",add:true},E678:{name:"异种蝠",hp:1200000,atk:1300000,def:540000,money:59,exp:0,point:0,special:[1],value28:2},E679:{name:"K型械灵",hp:1919000,atk:810000,def:640000,money:66,exp:0,point:0,special:[63,66],value:null,zoneSquare:true,range:1,title:"Killer"},E680:{name:"青铜斗士",hp:6000000,atk:760000,def:580000,money:60,exp:0,point:0,special:[69],zoneSquare:true,range:2,atkValue:50000,defValue:null,hpValue:1000000,title:"喽啰"},E681:{name:"白银斗士",hp:8000000,atk:880000,def:640000,money:64,exp:0,point:0,special:[69],value:null,atkValue:30000,defValue:20000,zoneSquare:true,range:2,hpValue:1000000,title:"喽啰"},E682:{name:"黄金斗士",hp:11000000,atk:1050000,def:750000,money:70,exp:0,point:0,special:[69],title:"喽啰"},E684:{name:"N型械灵",hp:5600000,atk:1140000,def:560000,money:77,exp:0,point:0,special:[46,73],title:"喽啰",zoneSquare:true,range:1,add:true,value46:200000},E685:{name:"圣洁侍女",hp:11110000,atk:250000,def:800000,money:79,exp:0,point:0,special:[2,15],title:"精英",range:1,zoneSquare:true,value:2221000},E686:{name:"光明主教",hp:10500000,atk:1500000,def:750000,money:80,exp:0,point:0,special:[],title:"精英"},E687:{name:"复仇圣战",hp:12000000,atk:1330000,def:1050000,money:81,exp:0,point:0,special:[72],title:"精英"},E688:{name:"食人魔",hp:9600000,atk:840000,def:720000,money:65,exp:0,point:0,special:[27]},E689:{name:"湛蓝枪兵",hp:3200000,atk:1800000,def:900000,money:75,exp:0,point:0,special:[],title:"喽啰"},E261:{name:"械灵-Evil",hp:11450000,atk:1919000,def:810000,money:114,exp:0,point:0,special:[66,67],title:"领主",zoneSquare:true,range:3},E695:{name:"血海魔灵",hp:5800000,atk:3430,def:343000,money:34,exp:0,point:0,special:[2,70],title:"Lifestealer"},E696:{name:"械莱姆",hp:6000000,atk:990000,def:440000,money:61,exp:0,point:0,special:[]},Exl_L:{name:"L型械灵",hp:2221000,atk:1400000,def:400000,money:66,exp:0,point:0,special:[1,11],defValue:null,zoneSquare:false,range:null,value:0.5,value28:3},E697:{name:"O型械灵",hp:2221000,atk:2221000,def:114514,money:78,exp:0,point:0,special:[74],title:"易爆",zoneSquare:true,range:1,damage:21000022},E698:{name:"R型械灵",hp:8100000,atk:1800000,def:456500,money:90,exp:0,point:0,special:[25,79],title:"精英",zoneSquare:true,range:18,atkValue:10,defValue:5,value:222100,add:true,auraName:"至尊光环"},E699:{name:"P型械灵",hp:4565000,atk:2221000,def:456500,money:83,exp:0,point:0,special:[75,77],value:2221000,damage:2221000,title:"精英",snipe_damage:1919810},E700:{name:"Q型械灵",hp:8100000,atk:1919000,def:810000,money:84,exp:0,point:0,special:[18,78],title:"精英",value:222100},E701:{name:"狂热信徒",hp:25000000,atk:1250000,def:400000,money:76,exp:0,point:0,special:[],title:"精英"},E704:{name:"械灵-Angel",hp:22210000,atk:2221000,def:1250000,money:2221,exp:0,point:0,special:[4],title:"领主"},E705:{name:"S型械灵",hp:19198100,atk:1919810,def:1145140,money:97,exp:0,point:0,special:[39,76],range:2,zoneSquare:true,title:"精英"},E706:{name:"天启战儡",hp:22210000,atk:2221000,def:1222000,money:2221,exp:0,point:0,special:[48],defValue:-122200,atkValue:-222100,title:"领主",zoneSquare:true,range:2,bigImage:"CP894AB.png",add:true},E707:{name:"永恒魔体",hp:114514000,atk:114514,def:191981,money:86,exp:0,point:0,special:[2],title:"精英"},E708:{name:"星空球藻",hp:4950000,atk:2250000,def:1450000,money:87,exp:0,point:0,special:[],title:"精英",n:null},E709:{name:"银河之影",hp:8800000,atk:1880000,def:880000,money:88,exp:0,point:0,special:[6],title:"精英",n:4},E711:{name:"烈焰战车",hp:22210000,atk:2221000,def:222100,money:2221,exp:0,point:0,special:[74],title:"领主",zoneSquare:true,range:2,damage:222101222,bigImage:"CP864AB.png"},E712:{name:"星界战机",hp:9500000,atk:1750000,def:1250000,money:89,exp:0,point:0,special:[59],atkValue:null,title:"精英",bigImage:"Monster002.png"},E713:{name:"筋肉巨人",hp:50000000,atk:2500000,def:1250000,money:2221,exp:0,point:0,special:[67,68],title:"领主",range:3,zoneSquare:true,bigImage:"CP376AB.png"},E714:{name:"星界战舰",hp:9500000,atk:1850000,def:1400000,money:95,exp:0,point:0,special:[25,59],atkValue:null,title:"精英",zoneSquare:true,range:2,defValue:10,add:true,bigImage:"Monster001.png"},E715:{name:"精铁骑士",hp:9850000,atk:2110000,def:980000,money:91,exp:0,point:0,special:[45],title:"精英",value45:3},E716:{name:"断钢裁决",hp:10000000,atk:2500000,def:1000000,money:93,exp:0,point:0,special:[16,63],title:"精英",value:99.98909999999999},E717:{name:"金刚堡垒",hp:4000000,atk:2200000,def:1800000,money:94,exp:0,point:0,special:[],title:"精英",bigImage:"Monster003.png"},E9961_1:{name:"9961-p1",hp:99610000,atk:996100,def:996100,money:0,exp:0,point:0,special:[2,73],title:"T-proto"},E9961_2:{name:"9961-p2",hp:71210000,atk:3222000,def:1222000,money:0,exp:0,point:0,special:[18,78],title:"T-proto",value:71210000},E9961_3:{name:"9961-p3",hp:53770000,atk:5377000,def:1222000,money:0,exp:0,point:0,special:[75,77],title:"T-proto",value:null,damage:5377000,snipe_damage:5377000},E9961_4:{name:"9961-p4",hp:10050000,atk:4961000,def:496100,money:20,exp:0,point:0,special:[74,114],zoneSquare:true,range:5,damage:222101222,title:"T-proto",bigImage:"CP748AB.png"},E9961_5:{name:"9961-final",hp:9922,atk:9922,def:9922,money:221,exp:0,point:0,special:[77,79],title:"T-proto",value:992200,range:null,zoneSquare:false,snipe_damage:2299000},E730:{name:"渴血双翼",hp:6000000,atk:3550000,def:550000,money:110,exp:0,point:0,special:[1,82],value28:5,value52:null,value53:30},E731:{name:"亡纹狂兽",hp:15000000,atk:3800000,def:2100000,money:135,exp:0,point:0,special:[80],value53:null,value52:100,value45:null},E732:{name:"暴怒野兽",hp:61610000,atk:191981,def:1451400,money:114,exp:0,point:0,special:[2]},E733:{name:"哀怨白骨",hp:12000000,atk:2800000,def:1180000,money:100,exp:0,point:0,special:[]},E734:{name:"狂躁黄骨",hp:22500000,atk:3750000,def:1750000,money:132,exp:0,point:0,special:[],value52:100},E735:{name:"活体黏液",hp:46660000,atk:2660000,def:880000,money:115,exp:0,point:0,special:[]},E736:{name:"不眠亡魂",hp:4200000,atk:2900000,def:1840000,money:105,exp:0,point:0,special:[],damage:null,value29:null},E737:{name:"畸变怪人",hp:8100000,atk:3220000,def:2221000,money:122,exp:0,point:0,special:[]},E739:{name:"无头骑士",hp:12000000,atk:3550000,def:1130000,money:111,exp:0,point:0,special:[45],value45:1,value52:null},E740:{name:"失败作",hp:7300000,atk:4560000,def:2300000,money:130,exp:0,point:0,special:[1,9],value28:-9,n:1.5},E741:{name:"石像鬼",hp:8000000,atk:4000000,def:1800000,money:127,exp:0,point:0,special:[1,82],value28:3,value52:null,value53:30},E742:{name:"夹击恐惧症",hp:58000000,atk:2900000,def:1450000,money:128,exp:0,point:0,special:[16],value:100},E743:{name:"不要过来",hp:48000000,atk:400000,def:1600000,money:120,exp:0,point:0,special:[2,18],value:400000,zoneSquare:false,range:null},E744:{name:"具现鬼影",hp:7700000,atk:3990000,def:770000,money:126,exp:0,point:0,special:[5]},E745:{name:"疫狂飞虫",hp:11000000,atk:4800000,def:1800000,money:150,exp:0,point:0,special:[82],bigImage:"CP751AB.png",value52:null,value53:30},E746:{name:"噩厄",hp:14000000,atk:4600000,def:2200000,money:160,exp:0,point:0,special:[81],bigImage:"CP871AB.png",title:"喽啰",faceIds:{}},E747:{name:"荒原之灾",hp:45000000,atk:3650000,def:1550000,money:155,exp:0,point:0,special:[],bigImage:"CP746AB.png",title:"喽啰"},E748:{name:"沙土暴君",hp:40000000,atk:4000000,def:2500000,money:400,exp:0,point:0,special:[80],bigImage:"CP612AB.png",value52:200,title:"领主",description:null},E756:{name:"无常",hp:25000000,atk:2500000,def:2500000,money:250,exp:0,point:0,special:[2,38],title:"第零公民",value31:null,value38_1:740,value38_2:36001},E757:{name:"沙石魔像",hp:12500000,atk:2950000,def:1000000,money:124,exp:0,point:0,special:[60],value60:50},E766:{name:"无常",hp:60000000,atk:3500000,def:2950000,money:325,exp:0,point:0,special:[46,48],defValue:-1145140,range:21,zoneSquare:true,add:true,title:"第零公民",hpValue:-19198100,value46:360000},E767:{name:"狂暴天舌狗",hp:360010000,atk:7400000,def:7400000,money:740,exp:0,point:0,special:[2,9],bigImage:"CP815AB.png",title:"第零公民",n:2},E771:{name:"虎魔甲士",hp:40000000,atk:4000000,def:2400000,money:205,exp:0,point:0,special:[],zoneSquare:true,range:2,defValue:200000},E772:{name:"虎魔剑士",hp:30000000,atk:5100000,def:1500000,money:200,exp:0,point:0,special:[],range:2,zoneSquare:true,atkValue:200000},E773:{name:"虎魔死士",hp:36000000,atk:4750000,def:2250000,money:225,exp:0,point:0,special:[84],title:"喽啰",n:1,damage2:500000},E774:{name:"虎魔骁骑",hp:25000000,atk:4850000,def:3550000,money:230,exp:0,point:0,special:[],title:"喽啰",value45:1},E775:{name:"虎魔刺客",hp:17500000,atk:5750000,def:1400000,money:210,exp:0,point:0,special:[4]},E776:{name:"虎魔猛士",hp:65000000,atk:5600000,def:3000000,money:255,exp:0,point:0,special:[],add:true,range:2,zoneSquare:true,hpValue:10,title:"精英",n:null,damage2:500000},E777:{name:"铁面机兵",hp:96000000,atk:4160000,def:1760000,money:215,exp:0,point:0,special:[],title:"喽啰"},E778:{name:"浮游枢纽",hp:64000000,atk:720000,def:2800000,money:224,exp:0,point:0,special:[2],title:"喽啰"},E779:{name:"破门打工人",hp:9922,atk:2221,def:1188,money:1,exp:0,point:0,special:[83],range:1,zoneSquare:true,damage:2221000,title:null,description:"\\r[yellow]携带破门专用的炸弹，虎魔帮扫荡一切私人空间！\\r"},E780:{name:"堡垒",hp:128000000,atk:5120000,def:2560000,money:265,exp:0,point:0,special:[],title:"精英"},E782:{name:"匿大鬼",hp:40010000,atk:6000000,def:3600000,money:266,exp:0,point:0,special:[39,76],zoneSquare:true,range:2,title:"精英"},E783:{name:"匿小鬼",hp:11450000,atk:1919000,def:810000,money:191,exp:0,point:0,special:[25,79],atkValue:10,add:true,zoneSquare:true,range:21,value:1145140},E784:{name:"戾气斩除者",hp:21000000,atk:6300000,def:1000000,money:233,exp:0,point:0,special:[1,80],value28:3,title:"喽啰",value52:100},E790:{name:"贵物",hp:24000000,atk:6000000,def:3600000,money:500,exp:0,point:0,special:[],title:"喽啰"},E791:{name:"援天使",hp:62400000,atk:1200000,def:3760000,money:270,exp:0,point:0,special:[2,69],bigImage:"CP452AB.png",title:"精英"},E792:{name:"助天使",hp:41600000,atk:5920000,def:3840000,money:260,exp:0,point:0,special:[],bigImage:"CP453AB.png",title:"精英",value31:50},E793:{name:"恐天使",hp:45600000,atk:8000000,def:2400000,money:280,exp:0,point:0,special:[],bigImage:"CP451AB.png",title:"精英"},E794:{name:"魔怔人",hp:44000000,atk:7500000,def:2500000,money:275,exp:0,point:0,special:[25,81],bigImage:"RTP510.png",zoneSquare:true,range:2,title:"精英",auraName:"魔怔光环",atkValue:20,defValue:-50,add:true},E796:{name:"虎魔仇杀者",hp:27500000,atk:7100000,def:2800000,money:250,exp:0,point:0,special:[80,84],damage2:500000,n:2,title:"精英",value52:100},E797:{name:"幽闭恐惧症",hp:40000000,atk:5000000,def:3000000,money:240,exp:0,point:0,special:[78,85],value:null,zoneSquare:true,range:3,atkValue:200000,hpValue:null,title:"喽啰"},E798:{name:"狂热近卫",hp:55000000,atk:5750000,def:5250000,money:285,exp:0,point:0,special:[],bigImage:"E798.png",title:"精英"},E799:{name:"清洁打工人",hp:9922,atk:2221,def:1188,money:1,exp:0,point:0,special:[49],value35:2221,description:"\\r[yellow]即使在暴乱中，这些敬业而不知疲倦的机器人也在忠实地履行着自己的职责。\\r"},E801:{name:"洛渔",hp:91670000,atk:1919000,def:5140000,money:810,exp:0,point:0,special:[2,88],bigImage:"CP060AB.png",title:"人造神明"},E802:{name:"秩见",hp:191980000,atk:7100000,def:5140000,money:1009,exp:0,point:0,special:[59,85],title:"第零公民",atkValue:81000,range:7,zoneSquare:true},E803:{name:"禁言者",hp:45140000,atk:8100000,def:2500000,money:290,exp:0,point:0,special:[78,81],title:"领主"},E807:{name:"钢面机兵",hp:112000000,atk:6960000,def:3040000,money:300,exp:0,point:0,special:[],title:"喽啰"},E808:{name:"碉堡",hp:204800000,atk:10240000,def:5120000,money:365,exp:0,point:0,special:[],title:"精英"},E809:{name:"摩宇打工人",hp:40400000,atk:9960000,def:5550000,money:315,exp:0,point:0,special:[],title:"喽啰"},E810:{name:"碧蓝防线",hp:108000000,atk:1440000,def:5760000,money:325,exp:0,point:0,special:[2],title:"喽啰"},E811:{name:"械蛛",hp:70070000,atk:10010000,def:1001000,money:303,exp:0,point:0,special:[1],bigImage:"DMechspider.png",title:"喽啰"},E812:{name:"赛博力士",hp:160000000,atk:8400000,def:5600000,money:335,exp:0,point:0,special:[],title:"喽啰"},E813:{name:"不动矛王",hp:48000000,atk:10800000,def:8000000,money:345,exp:0,point:0,special:[1],title:"喽啰",value28:-4},E814:{name:"火药桶",hp:30000000,atk:15000000,def:1000000,money:1,exp:0,point:0,special:[86],damage2:15000000},E815:{name:"勇敢骑士",hp:105000000,atk:10500000,def:6300000,money:355,exp:0,point:0,special:[69],title:"精英",description:"\\r[yellow]勇敢骑士，不怕困难！\\r"},E816:{name:"狂战巫师",hp:60000000,atk:8800000,def:6500000,money:320,exp:0,point:0,special:[18],value:1500000,title:"喽啰",description:"\\r[yellow]正统的巫师从来不用魔攻。力量拉满！\\r"},E818:{name:"铁焚（弱）",hp:80000000,atk:15800000,def:1900000,money:5000,exp:0,point:0,special:[9],bigImage:"DIronfan.png",title:"高级统领",n:2},E819:{name:"自走炮台",hp:80800000,atk:11200000,def:7200000,money:375,exp:0,point:0,special:[77],bigImage:"Dbot011.png",title:"精英",value:null,snipe_damage:11000000},E820:{name:"摩宇自卫队",hp:50000000,atk:9000000,def:4500000,money:310,exp:0,point:0,special:[39],range:2,zoneSquare:true,title:"喽啰"},E821:{name:"摩宇特战军",hp:65000000,atk:12500000,def:7500000,money:400,exp:0,point:0,special:[39],range:2,zoneSquare:true,title:"精英"},E827:{name:"守护神像",hp:99000000,atk:16000000,def:10500000,money:435,exp:0,point:0,special:[72],bigImage:"Dbotrome.png",title:"精英"},E828:{name:"夕月",hp:400000000,atk:15000000,def:12000000,money:5000,exp:0,point:0,special:[4,29],title:"大魔王",value29:20,value31:null},E829:{name:"暴虐",hp:145000000,atk:14000000,def:9500000,money:425,exp:0,point:0,special:[80],bigImage:"Dbot013.png",title:"精英",value52:50},E833:{name:"毁灭炮台",hp:168000000,atk:18000000,def:12800000,money:1000,exp:0,point:0,special:[15],bigImage:"Dbotturrent.png",range:2,zoneSquare:true,title:"领主",value:50000000},E834:{name:"义体战士",hp:100000000,atk:13100000,def:7200000,money:405,exp:0,point:0,special:[],bigImage:"Dbot008.png",title:"精英"},E835:{name:"恶意",hp:195000000,atk:14950000,def:10950000,money:450,exp:0,point:0,special:[16],bigImage:"Dbot004.png",title:"精英",value60:null,damage2:32000000},E836:{name:"高傲",hp:91000000,atk:16900000,def:13000000,money:445,exp:0,point:0,special:[48],bigImage:"Dbot010.png",title:"精英",add:false,range:1,zoneSquare:true,atkValue:2600000,hpValue:null,defValue:910000},E837:{name:"断钢剑士",hp:95000000,atk:14500000,def:7500000,money:415,exp:0,point:0,special:[1],title:"精英"},E838:{name:"高难法师",hp:80000000,atk:6410000,def:6700000,money:417,exp:0,point:0,special:[2],title:"精英",value29:null},E839:{name:"完美盾卫",hp:200000000,atk:11500000,def:9000000,money:410,exp:0,point:0,special:[],title:"精英"},E840:{name:"金色传说",hp:100000,atk:10000,def:10000,money:500,exp:0,point:0,special:[25,90],zoneSquare:true,range:13,hpValue:50,add:true},E841:{name:"守护力场",hp:10000,atk:10000,def:100000,money:500,exp:0,point:0,special:[25,90],atkValue:null,zoneSquare:true,range:13,add:true,defValue:20},E842:{name:"猛禽",hp:48000000,atk:14400000,def:10800000,money:440,exp:0,point:0,special:[45,82],bigImage:"Dbot002.png",title:"精英",value28:10,n:null,value45:2,value53:50},E843:{name:"铁焚",hp:280000000,atk:15800000,def:5900000,money:5000,exp:0,point:0,special:[9],bigImage:"DIronfan.png",title:"高级统领",n:2},E844:{name:"2 2 2 1",hp:1221000000,atk:26620000,def:22210000,money:2221,exp:0,point:0,special:[87,115],title:"械灵之王",faceIds:{down:"E844",left:"E907",right:"E908",up:"E845"}},E845:{name:"2 2 2 1",hp:1221000000,atk:26620000,def:22210000,money:2221,exp:0,point:0,special:[87,115],displayIdInBook:"E844",faceIds:{down:"E844",left:"E907",right:"E908",up:"E845"},title:"械灵之王"},E846:{name:"怠慢",hp:120000000,atk:4000000,def:12000000,money:455,exp:0,point:0,special:[1,2],bigImage:"Dbot003.png",title:"精英",value28:-5,zoneSquare:false,range:null,value:null},E847:{name:"火狗",hp:120000000,atk:6000000,def:15000000,money:500,exp:0,point:0,special:[2,92],defValue:null,range:1,add:false,zoneSquare:true,damage2:6000000,title:"精英"},E848:{name:"械人-CAS型",hp:144000000,atk:17280000,def:13600000,money:990,exp:0,point:0,special:[48,76],bigImage:"Dbot006.png",title:"领主",atkValue:3000000,hpValue:44000000,range:1,zoneSquare:true,value:null,defValue:1000000},E849:{name:"摩宇警卫",hp:128000000,atk:15520000,def:9360000,money:430,exp:0,point:0,special:[18],bigImage:"DKN_HoK01.png",title:"精英",snipe_damage:null,value:2500000},E850:{name:"铁男",hp:76000000,atk:13600000,def:10400000,money:420,exp:0,point:0,special:[],title:"精英"},E855:{name:"R型械灵-改",hp:8100000,atk:1800000,def:456500,money:0,exp:0,point:0,special:[25,87],title:"精英",range:18,zoneSquare:true,add:true,auraName:"至尊光环",atkValue:-10,defValue:-5},E856:{name:"S型械灵-改",hp:19198100,atk:1919810,def:1145140,money:0,exp:0,point:0,special:[46,87],title:"精英",zoneSquare:true,range:2,add:true,value46:-2500000},E857:{name:"狱贤",hp:810000000,atk:11450000,def:14000000,money:9999,exp:0,point:0,special:[1,7,8,9],title:"第零公民",damage:1,atkValue:50,value:50,n:2},E859:{name:"福博",hp:800000000,atk:25500000,def:22500000,money:25000,exp:0,point:0,special:[29],title:"第零公民",value29:25},E860:{name:"狱贤",hp:810000000,atk:11450000,def:14000000,money:9999,exp:0,point:0,special:[1,7,8,9],displayIdInBook:"E857",value:50,title:"第零公民",atkValue:50,damage:1,n:2},E862:{name:"械灵-Angel",hp:66630000,atk:4442000,def:2221000,money:2221,exp:0,point:0,special:[4,87],title:"领主",faceIds:{down:"E862",up:"E890"}},E873:{name:"活体熔岩",hp:70000000,atk:21000000,def:14000000,money:500,exp:0,point:0,special:[64,81],range:2,zoneSquare:true,value:null,damage:22210000,title:"喽啰"},E874:{name:"沸物",hp:300000000,atk:20000000,def:2500000,money:0,exp:0,point:0,special:[61],hpValue:-25000000,range:13,zoneSquare:true,add:true},E875:{name:"渴血飞蛇",hp:145000000,atk:22500000,def:13500000,money:500,exp:0,point:0,special:[89],title:"精英",value89:50},E876:{name:"长颈恶龙",hp:95000000,atk:24500000,def:14500000,money:500,exp:0,point:0,special:[],title:"精英",damage2:null},E877:{name:"深渊蜉蝣",hp:300000000,atk:19190000,def:11880000,money:500,exp:0,point:0,special:[82],title:"精英",value52:null,value53:30},E878:{name:"被害妄想症",hp:120000000,atk:30000000,def:0,money:500,exp:0,point:0,special:[80,93],damage2:100,range:1,zoneSquare:true,value45:null,title:"喽啰",value52:100},E879:{name:"聚合沸物",hp:48000000,atk:20000000,def:20000000,money:55,exp:0,point:0,special:[116],bigImage:"CP414AB.png",title:"领主"},E880:{name:"狂怒杀手",hp:99990000,atk:24440000,def:15550000,money:533,exp:0,point:0,special:[1],title:"领主",value28:2},E882:{name:"鸠炎",hp:840000000,atk:26500000,def:17500000,money:10000,exp:0,point:0,special:[9,92],title:"灾厄使者",bigImage:"h_ky_thug3.png",zoneSquare:true,range:3,damage2:10000000,n:2},E883:{name:"社交恐惧症",hp:144400000,atk:33330000,def:11110000,money:600,exp:0,point:0,special:[25,94],zoneSquare:true,range:2,defValue:null,title:"领主",bigImage:"CP811AB.png",damage2:100,auraName:"衰退光环",snipe_damage:null,atkValue:-10,add:true},E884:{name:"械人-POL型",hp:204800000,atk:23040000,def:16960000,money:995,exp:0,point:0,special:[80,88],bigImage:"Dbot007.png",title:"领主",value52:16},E885:{name:"碳烤打工人",hp:80800000,atk:19960000,def:14040000,money:500,exp:0,point:0,special:[],title:"喽啰"},E886:{name:"暴食",hp:250000000,atk:28000000,def:14000000,money:650,exp:0,point:0,special:[89],title:"领主",value89:100,bigImage:"CP866AB.png"},E887:{name:"爆炎骸骨",hp:50000000,atk:42000000,def:6000000,money:500,exp:0,point:0,special:[86],title:"喽啰",damage2:42000000},E888:{name:"奥卡斯特大帝",hp:400000000,atk:25500000,def:22500000,money:0,exp:0,point:0,special:[117,119],bigImage:"Ocast.png",title:"第零公民"},E889:{name:"奥波卢克斯大帝",hp:360000000,atk:35000000,def:16000000,money:0,exp:0,point:0,special:[118,120],bigImage:"Opollux.png",title:"第零公民"},E890:{name:"械灵-Angel",hp:66630000,atk:4442000,def:2221000,money:2221,exp:0,point:0,special:[4,87],faceIds:{down:"E862",up:"E890"}},E895:{name:"紫薯布丁",hp:220000000,atk:23000000,def:15000000,money:600,exp:0,point:0,special:[90]},E896:{name:"沙棘软糖",hp:160000000,atk:27500000,def:12500000,money:600,exp:0,point:0,special:[95],zoneSquare:true,range:2,atkValue:4000000,defValue:-4000000},E897:{name:"酱汁饭团",hp:54000000,atk:36000000,def:18000000,money:600,exp:0,point:0,special:[64],zoneSquare:true,range:2,damage:22210000},E898:{name:"嫉妒",hp:349500000,atk:24950000,def:14950000,money:650,exp:0,point:0,special:[16],bigImage:"Dbot004-1.png",title:"领主",value:100},E899:{name:"暴怒",hp:245000000,atk:24000000,def:19500000,money:650,exp:0,point:0,special:[80],bigImage:"Dbot013-1.png",title:"领主",value52:50},E900:{name:"贪婪",hp:160000000,atk:25000000,def:18500000,money:650,exp:0,point:0,special:[81,96],bigImage:"CP873AB.png",title:"领主",zoneSquare:true,range:2},E901:{name:"玉梅抹茶",hp:222000000,atk:23400000,def:21000000,money:600,exp:0,point:0,special:[]},E902:{name:"懒惰",hp:99000000,atk:33000000,def:21000000,money:650,exp:0,point:0,special:[1],title:"领主",value28:-7},E903:{name:"狂躁之魂",hp:100000000,atk:40000000,def:5000000,money:0,exp:0,point:0,special:[86],damage2:40000000},E21Add1:{name:"傲慢之魂",hp:100000000,atk:36000000,def:16000000,money:0,exp:0,point:0,special:[86,121],damage2:50000000},E905:{name:"奥卡斯特大帝",hp:114514,atk:1919,def:810,money:0,exp:0,point:0,special:[20],bigImage:"Ocast_d.png",title:"第零公民"},E906:{name:"奥波卢克斯大帝",hp:114514,atk:1919,def:810,money:0,exp:0,point:0,special:[20],bigImage:"Opollux_d.png",title:"第零公民"},E907:{name:"2 2 2 1",hp:1221000000,atk:26620000,def:22210000,money:2221,exp:0,point:0,special:[87,115],faceIds:{down:"E844",left:"E907",right:"E908",up:"E845"},title:"械灵之王",displayIdInBook:"E844"},E908:{name:"2 2 2 1",hp:1221000000,atk:26620000,def:22210000,money:2221,exp:0,point:0,special:[87,115],faceIds:{down:"E844",left:"E907",right:"E908",up:"E845"},title:"械灵之王",displayIdInBook:"E844"},E909:{name:"孤鸣",hp:191981000,atk:9191000,def:8100000,money:500,exp:0,point:0,special:[],title:"二等公民",faceIds:{down:"E909",up:"E910"}},E910:{name:"孤鸣",hp:0,atk:0,def:0,money:500,exp:0,point:0,special:[],faceIds:{down:"E909",up:"E910"},displayIdInBook:"E909"}};var icons_4665ee12_3a1f_44a4_bea3_0fccba634dc1={hero:{down:{loc:0,stop:0,leftFoot:1,rightFoot:3},left:{loc:1,stop:0,leftFoot:1,rightFoot:3},right:{loc:2,stop:0,leftFoot:1,rightFoot:3},up:{loc:3,stop:0,leftFoot:1,rightFoot:3},width:32,height:48},terrains:{ground:0,grass:1,grass2:2,snowGround:3,ground2:4,ground3:5,ground4:6,sand:7,ground5:8,yellowWall2:9,whiteWall2:10,blueWall2:11,blockWall:12,grayWall:13,white:14,ground6:15,soil:16,ground7:17,ground8:18,ice:19,downFloor:20,upFloor:21,blueShopLeft:22,blueShopRight:23,pinkShopLeft:24,pinkShopRight:25,arrowUp:26,arrowDown:27,arrowLeft:28,arrowRight:29,light:30,darkLight:31,ski:32,flower:33,box:34,boxed:35,T463:36,T506:37,T641:38,T670:39,T754:40,T770:41,T817:42,T916:43},animates:{star:0,lava:1,blueWater:2,water:3,yellowDoor:4,blueDoor:5,redDoor:6,greenDoor:7,specialDoor:8,steelDoor:9,yellowWall:10,whiteWall:11,blueWall:12,crystalUp:13,crystalBottom:14,starPortal:15,fire:16,portal:17,"switch":18,lavaNet:19,poisonNet:20,weakNet:21,curseNet:22,downPortal:23,leftPortal:24,rightPortal:25,upPortal:26,steelDoor2:27,steelDoor3:28,iceDoor:29,iceDoor2:30,magentaWall:31,A492:32,A493:33,A494:34,A495:35,A668:36,A669:37,yellowDoor2:38,blueDoor2:39,A861:42,redDoor2:40,greenDoor2:41},npcs:{man:0,trader:1,thief:2,recluse:5,king:6,youngMan:7,sign:8,expShop:9,moneyShop:10,greenMan:28,blueTrader:29,redMSNpc:30,octopusLeftTop:12,octopusTop:13,octopusRightTop:14,octopusLeft:15,octopusCenter:16,octopusRight:17,octopusLeftBottom:18,octopusRightBottom:19,dragonLeftTop:20,dragonTop:21,dragonRightTop:22,dragonLeft:23,dragonCenter:24,dragonRight:25,dragonLeftBottom:26,dragonRightBottom:27,closedMoneyShop:11,N407:32,frozenman:3,unfrozenman:4,N514:33,N515:34,magician:31,N597:35,N598:36,N605:37,N690:38,N691:39,N755:40,N858:41,Number0:42,Number1:43,Number2:44,Number3:45,Number4:46,Number5:47,Number6:48,Number7:49,Number8:50,Number9:51,N911:52},npc48:{npc0:0,npc1:1,npc2:2,npc3:3,hero2:4,N337:5,N338:6,N339:7,N340:8,N383:9,N384:10,N385:11,N402:12,N403:13,N404:14,N405:15,N406:16,N408:17,N410:18,N412:19,N413:20,N414:21,N415:22,Nmoli:23,Ngule:24,N423:25,Nancang:26,N464:27,N466:28,N469:29,N473:30,N478:31,N484:32,N491:33,N499:34,N508:35,N518:36,N2221_left:38,N2221_right:39,N2221_up:40,N2221_down:37,N358:41,N2221:42,hero3:43,hero3_left:44,hero3_right:45,hero3_up:46,rogue:47,rogue_left:48,rogue_right:49,rogue_up:50,N516:51,N517:52,N520:53,N521:54,N522:55,N523:56,N571:57,N573:59,N574:60,N575:61,Nxl_U:58,N596:62,N600:63,N601:64,N602:65,N603:66,N606:67,N607:68,N608:69,N609:70,N610:71,N611:72,N612:73,N613:74,N614:75,N615:76,N616:77,N617:78,N618:79,N619:80,N620:81,N621:82,N622:83,N623:84,N624:85,N625:86,N749:87,N750:88,N751:89,N752:90,N753:91,N758:92,N759:93,N760:94,N761:95,N762:96,N763:97,N764:98,N765:99,Ndebug009:100,Ndebug008:101,N786:102,N787:103,N788:104,N789:105,N795:106,N917:107,N918:108,N919:109,N920:110},enemys:{greenSlime:0,redSlime:1,blackSlime:2,slimelord:3,bat:4,bigBat:5,skeleton:8,skeletonCaptain:10,rock:14,bluePriest:16,redPriest:17,brownWizard:18,swordsman:23,soldier:24,yellowKnight:25,redKnight:26,darkKnight:27,blueKnight:31,poisonBat:34,goldHornSlime:43,silverSlime:47,whiteHornSlime:49,redSwordsman:53,skeletonWarrior:9,silverSlimelord:60,goldSlimelord:61,whiteSlimeman:54,slimeman:15,yellowGateKeeper:20,blueGateKeeper:21,blueMS:45,skeletonKnight:39,ironRock:35,grayRock:62,yellowPriest:52,blueRock:63,greenKnight:65,bowman:66,liteBowman:67,watcherSlime:70,frostBat:72,greenGateKeeper:75,evilHero:40,blueButterfly:6,sworm:7,bigfly:11,turtle:28,smallish:29,smallPriest:30,smallWarrior:32,bigFairy:33,smallFairy:36,bigFlower:37,Thief:38,thief_20:59,thief_20_2:64,E344:76,E345:77,E346:78,E347:79,E352:80,E353:81,E354:82,E355:83,E360:84,E367:86,E368:87,E369:88,E370:89,E375:90,E376:91,E377:92,E378:93,E379:94,E380:95,E381:96,E382:97,E251:50,blueGateKeeper2:22,redGateKeeper:69,E278:73,iceMS:44,sWarrior:58,ssWarrior:68,mage1:56,mage2:55,machine:46,redMS:71,greenMS:57,redKing:41,blackKing:42,noble1:12,noble2:13,butler:74,housekeeper:19,clown:48,greenMS2:51,goldMS:85,E422:98,E427:99,E430:100,E431:101,E433:102,E436:103,E448:104,E449:105,E450:106,E451:107,E452:108,E453:109,E454:110,E455:111,E456:112,E457:113,E458:114,E459:115,E460:116,E461:117,E462:118,E519:119,E348:120,E363:121,E399:122,E400:123,E429:124,E434:125,E435:126,E443:127,E444:128,E445:129,E465:130,E467:131,E471:132,E472:133,E474:134,E475:135,E476:136,E477:137,E479:138,E480:139,E481:140,E482:141,E483:142,E485:143,E486:144,E487:144,E488:145,E496:147,E497:148,E498:149,E500:150,E501:151,E502:152,E503:153,E504:154,E505:155,E507:156,E509:157,E510:158,E511:159,E512:160,E513:161,Exl_A:146,Exl_B:162,Exl_C:163,Exl_D:164,E527:165,E528:166,E529:167,E530:168,E531:169,E535:173,E536:174,E537:175,E538:176,E539:177,E540:178,E541:179,E542:180,E543:181,E544:182,E545:183,E546:184,E547:185,E548:186,Exl_E:170,Exl_F:171,Exl_G:172,E551:187,E552:188,E553:189,E554:190,E555:191,E556:192,E557:193,E564:194,E576:195,E577:196,E578:197,E579:198,E580:199,E581:200,E582:201,E583:202,E584:203,E585:204,E586:205,E587:206,E588:207,E589:208,E590:209,E593:210,E594:211,E595:212,E599:213,E604:214,E627:215,E628:216,E630:217,E631:218,E632:219,E633:220,E634:221,E635:222,E636:223,E637:224,E642:225,E643:226,E644:227,E645:228,E646:229,E647:230,E648:231,E649:232,E650:233,E651:234,E671:235,E672:236,E673:237,E674:238,E675:239,E676:240,E677:241,E678:242,E679:243,E680:244,E681:245,E682:246,E684:248,E685:249,E686:250,E687:251,E688:252,E689:253,E696:254,Exl_L:247,E697:255,E698:256,E699:257,E700:258,E701:259,E705:260,E707:261,E708:262,E709:263,E715:264,E716:265,E717:266,E9961_2:267,E730:268,E731:269,E732:270,E733:271,E734:272,E735:273,E736:274,E737:275,E739:276,E740:277,E741:278,E742:279,E743:280,E744:281,E745:282,E757:283,E771:284,E772:285,E773:286,E774:287,E775:288,E776:289,E777:290,E778:291,E779:292,E780:293,E782:294,E783:295,E784:296,E790:297,E796:298,E797:299,E799:300,E802:301,E803:302,E807:303,E808:304,E810:305,E812:306,E813:307,E814:308,E815:309,E816:310,E837:311,E838:312,E839:313,E840:314,E841:315,E847:316,E855:317,E856:318,E873:319,E874:320,E875:321,E876:322,E877:323,E887:324,E895:325,E896:326,E897:327,E901:328,E21Add1:329},enemy48:{steelGuard:2,evilBat:3,Emoli1:4,Emoli2:5,Emoli3:6,Egule1:7,Egule2:8,Eancang:9,E428:10,E432:11,E442:12,E446:13,E2221:14,E2221_down:15,E2221_left:16,E2221_right:17,E2221_up:18,E549:19,E558:20,E559:21,E560:22,E561:23,E562:24,E563:25,E570:26,E626:27,E629:28,A11boss_p1:29,A11boss_p2:30,E262:1,E261:0,E695:31,E704:32,E706:33,E711:35,E712:36,E713:37,E714:38,E9961_1:39,E9961_3:40,E9961_4:34,E9961_5:41,E746:42,E747:43,E748:44,E756:45,E766:46,E767:47,E791:48,E792:49,E793:50,E794:51,E798:52,E801:53,E809:54,E811:55,E818:56,E819:57,E820:58,E821:59,E827:60,E828:61,E829:62,E833:63,E834:64,E835:65,E836:66,E842:67,E843:68,E844:69,E845:70,E846:71,E848:72,E849:73,E850:74,E857:75,E859:76,E860:77,E862:78,E878:79,E879:80,E880:81,E882:82,E883:83,E884:84,E885:85,E886:86,E888:87,E889:88,E890:89,E898:90,E899:91,E900:92,E902:93,E903:94,E905:95,E906:96,E907:97,E908:98,E909:99,E910:100},items:{yellowKey:0,blueKey:1,redKey:2,greenKey:3,steelKey:4,bigKey:6,redGem:16,blueGem:17,greenGem:18,yellowGem:19,redPotion:20,bluePotion:21,greenPotion:22,yellowPotion:23,sword0:60,sword1:50,sword2:51,sword3:52,sword4:53,sword5:54,shield1:55,shield2:56,shield3:57,shield4:58,book:9,fly:12,pickaxe:45,bomb:43,centerFly:13,upFly:15,downFly:14,freezeBadge:41,cross:40,superPotion:29,earthquake:8,poisonWine:24,weakWine:25,curseWine:27,superWine:28,silverCoin:46,amulet:47,hammer:48,jumpShoes:49,skill1:30,I_light:10,I319:5,I320:7,I321:26,greenGem2:33,greenGem3:36,greenGem4:39,redGem4:37,redGem3:34,redGem2:31,blueGem2:32,blueGem3:35,blueGem4:38,bigRedPotion:62,bigBluePotion:63,bigYellowPotion:64,bigGreenPotion:65,skill2:67,skill0_buff:69,skill0:68,I343:70,yellowKey3:71,blueKey3:72,redKey3:73,I392:74,I397:76,I401:77,blackGem:75,I409:78,I62:42,I420:79,I425:80,goldCoin:11,I437:81,I438:82,I439:83,I440:84,I441:85,superPotion_s:86,leaf:59,skill0_all:87,I_wait:88,skill3:90,talentTree:91,I_breakDoor:44,skill4:89,sword6:61,sword7:92,hugeGreenPotion:97,hugeRedPotion:94,hugeBluePotion:95,hugeYellowPotion:96,skill5:98,I592:99,DScore:93,skill6:100,redGem5:101,blueGem5:102,blueGem6:106,blueGem7:110,blueGem8:114,redGem6:105,redGem7:109,redGem8:113,greenGem5:103,greenGem6:107,greenGem7:111,greenGem8:115,sword8:104,shield8:108,skill7:112,talentTree2:116,I_noVampire:117,I_zzzl:118,skill8:119,I_Chap4Shop4:120,I_greenKeyCh3:121,I_superGreenKey:122,skill9:123,skill10:124,skill11:125,skill12:126,skill13:127,talentTree3:128,I_config:129,goldCoin2:130,I_cat:131,sword9:132,redGem9:138,blueGem9:139,greenGem9:140,giantRedPotion:141,giantBluePotion:142,giantYellowPotion:143,giantGreenPotion:144,IxlO:133,IxlP:134,IxlQ:135,IxlR:136,IxlS:137,bigManaitem:145,manaItem:66,redRHeart:146,blueRHeart:147,yellowRHeart:148,greenRHeart:149,specialRHeart:150,I_energyOrb:151,greenBomb:152,I_hj:153},autotile:{autotile:0,autotile1:0,autotile2:0,autotile3:0,autotile4:0,autotile5:0,autotile6:0,autotile7:0,autotile8:0,autotile9:0,autotile10:0,autotile11:0,autotile12:0,autotile13:0,autotile14:0,autotile15:0,autotile16:0,autotile17:0,autotile18:0,autotile19:0,autotile20:0,autotile21:0,autotile22:0,autotile23:0,autotile24:0,autotile25:0,autotile26:0,autotile27:0,autotile28:0,autotile29:0,autotile30:0,autotile31:0,autotile32:0,autotile33:0,autotile34:0}};var maps_90f36752_8815_4be8_b32b_d7fad1d0542e={"1":{cls:"animates",id:"yellowWall",canBreak:true,animate:1,doorInfo:{time:160,openSound:"door.mp3",closeSound:"door.mp3",keys:{}}},"2":{cls:"animates",id:"whiteWall",canBreak:true,animate:1,doorInfo:{time:160,openSound:"door.mp3",closeSound:"door.mp3",keys:{}}},"3":{cls:"animates",id:"blueWall",canBreak:true,animate:1,doorInfo:{time:160,openSound:"door.mp3",closeSound:"door.mp3",keys:{}}},"4":{cls:"animates",id:"star",name:"星空"},"5":{cls:"animates",id:"lava",name:"岩浆"},"6":{cls:"terrains",id:"ice"},"7":{cls:"terrains",id:"blueShopLeft"},"8":{cls:"terrains",id:"blueShopRight"},"9":{cls:"terrains",id:"pinkShopLeft"},"10":{cls:"terrains",id:"pinkShopRight"},"11":{cls:"animates",id:"lavaNet",canPass:true,trigger:"null",script:"(function () {\n\t// 血网的伤害效果移动到 checkBlock 中处理\n\n\t// 如果要做一次性血网，可直接注释掉下面这句话：\n\t// 由于这句话的调用时机比较特殊，一次性血网不在这里实现，而是放到其他地方触发\n\t//core.removeBlock(core.getHeroLoc('x'), core.getHeroLoc('y'));\n})();",name:"血网"},"12":{cls:"animates",id:"poisonNet",canPass:true,trigger:"null",script:'(function () {\n\t// 直接插入公共事件进行毒处理\n\tif (!core.hasItem(\'amulet\')) {\n\t\tcore.insertAction({ "type": "insert", "name": "毒衰咒处理", "args": [0] });\n\t}\n\n\t// 如果要做一次性毒网，可直接注释掉下面这句话：\n\t// core.removeBlock(core.getHeroLoc(\'x\'), core.getHeroLoc(\'y\'));\n})()',name:"毒网"},"13":{cls:"animates",id:"weakNet",canPass:true,trigger:"null",script:'(function () {\n\t// 直接插入公共事件进行衰处理\n\tif (!core.hasItem(\'amulet\')) {\n\t\tcore.insertAction({ "type": "insert", "name": "毒衰咒处理", "args": [1] });\n\t}\n\n\t// 如果要做一次性衰网，可直接注释掉下面这句话：\n\t// core.removeBlock(core.getHeroLoc(\'x\'), core.getHeroLoc(\'y\'));\n})()',name:"衰网"},"14":{cls:"animates",id:"curseNet",canPass:true,trigger:"null",script:'(function () {\n\t// 直接插入公共事件进行咒处理\n\tif (!core.hasItem(\'amulet\')) {\n\t\tcore.insertAction({ "type": "insert", "name": "毒衰咒处理", "args": [2] });\n\t}\n\n\t// 如果要做一次性咒网，可直接注释掉下面这句话：\n\t// core.removeBlock(core.getHeroLoc(\'x\'), core.getHeroLoc(\'y\'));\n})()',name:"咒网"},"15":{cls:"animates",id:"blueWater"},"16":{cls:"animates",id:"water"},"20":{cls:"autotile",id:"autotile"},"21":{cls:"items",id:"yellowKey"},"22":{cls:"items",id:"blueKey"},"23":{cls:"items",id:"redKey"},"24":{cls:"items",id:"greenKey"},"25":{cls:"items",id:"steelKey"},"26":{cls:"items",id:"bigKey"},"27":{cls:"items",id:"redGem"},"28":{cls:"items",id:"blueGem"},"29":{cls:"items",id:"greenGem"},"30":{cls:"items",id:"yellowGem"},"31":{cls:"items",id:"redPotion"},"32":{cls:"items",id:"bluePotion"},"33":{cls:"items",id:"greenPotion"},"34":{cls:"items",id:"yellowPotion"},"35":{cls:"items",id:"sword1"},"36":{cls:"items",id:"shield1"},"37":{cls:"items",id:"sword2"},"38":{cls:"items",id:"shield2"},"39":{cls:"items",id:"sword3"},"40":{cls:"items",id:"shield3"},"41":{cls:"items",id:"sword4"},"42":{cls:"items",id:"shield4"},"43":{cls:"items",id:"sword5"},"44":{cls:"items",id:"leaf"},"45":{cls:"items",id:"book"},"46":{cls:"items",id:"fly"},"47":{cls:"items",id:"pickaxe"},"48":{cls:"items",id:"I_breakDoor"},"49":{cls:"items",id:"bomb"},"50":{cls:"items",id:"centerFly"},"51":{cls:"items",id:"upFly"},"52":{cls:"items",id:"downFly"},"53":{cls:"items",id:"goldCoin"},"54":{cls:"items",id:"freezeBadge"},"55":{cls:"items",id:"cross"},"56":{cls:"items",id:"superPotion"},"57":{cls:"items",id:"earthquake"},"58":{cls:"items",id:"poisonWine"},"59":{cls:"items",id:"weakWine"},"60":{cls:"items",id:"curseWine"},"61":{cls:"items",id:"superWine"},"62":{cls:"items",id:"I62"},"63":{cls:"items",id:"silverCoin"},"64":{cls:"items",id:"amulet"},"65":{cls:"items",id:"hammer"},"68":{cls:"items",id:"greenGem2"},"69":{cls:"items",id:"jumpShoes"},"70":{cls:"items",id:"sword0"},"71":{cls:"items",id:"sword6"},"72":{cls:"items",id:"skill1"},"73":{cls:"items",id:"I_light"},"81":{cls:"animates",id:"yellowDoor",trigger:"openDoor",animate:1,doorInfo:{time:160,openSound:"door.mp3",closeSound:"door.mp3",keys:{yellowKey:1}},name:"黄门"},"82":{cls:"animates",id:"blueDoor",trigger:"openDoor",animate:1,doorInfo:{time:160,openSound:"door.mp3",closeSound:"door.mp3",keys:{blueKey:1}},name:"蓝门"},"83":{cls:"animates",id:"redDoor",trigger:"openDoor",animate:1,doorInfo:{time:160,openSound:"door.mp3",closeSound:"door.mp3",keys:{redKey:1}},name:"红门"},"84":{cls:"animates",id:"greenDoor",trigger:"openDoor",animate:1,doorInfo:{time:160,openSound:"door.mp3",closeSound:"door.mp3",keys:{greenKey:1}},name:"绿门"},"85":{cls:"animates",id:"specialDoor",trigger:"openDoor",animate:1,doorInfo:{time:160,openSound:"door.mp3",closeSound:"door.mp3",keys:{specialKey:1}},name:"机关门"},"86":{cls:"animates",id:"steelDoor",trigger:"openDoor",animate:1,doorInfo:{time:160,openSound:"door.mp3",closeSound:"door.mp3",keys:{steelKey:1}},name:"铁门"},"87":{cls:"terrains",id:"upFloor",canPass:true},"88":{cls:"terrains",id:"downFloor",canPass:true},"89":{cls:"animates",id:"portal",canPass:true},"90":{cls:"animates",id:"starPortal",canPass:true},"91":{cls:"animates",id:"upPortal",canPass:true},"92":{cls:"animates",id:"leftPortal",canPass:true},"93":{cls:"animates",id:"downPortal",canPass:true},"94":{cls:"animates",id:"rightPortal",canPass:true},"101":{cls:"animates",id:"crystalUp"},"102":{cls:"animates",id:"crystalBottom"},"103":{cls:"animates",id:"fire"},"104":{cls:"animates",id:"switch"},"105":{cls:"animates",id:"steelDoor2",doorInfo:{time:160,openSound:"door.mp3",closeSound:"door.mp3",keys:{}},animate:1,trigger:"openDoor"},"106":{cls:"animates",id:"steelDoor3",doorInfo:{time:160,openSound:"door.mp3",closeSound:"door.mp3",keys:{}},animate:1,trigger:"openDoor"},"107":{cls:"animates",id:"iceDoor",doorInfo:{time:160,openSound:"door.mp3",closeSound:"door.mp3",keys:{}},animate:1,trigger:"openDoor"},"108":{cls:"animates",id:"iceDoor2",doorInfo:{time:160,openSound:"door.mp3",closeSound:"door.mp3",keys:{}},animate:1,trigger:"openDoor"},"109":{cls:"animates",id:"magentaWall",canBreak:true,animate:1,doorInfo:{time:160,openSound:"door.mp3",closeSound:"door.mp3",keys:{}}},"121":{cls:"npcs",id:"man"},"122":{cls:"npcs",id:"trader"},"123":{cls:"npcs",id:"thief"},"124":{cls:"npcs",id:"frozenman"},"125":{cls:"npcs",id:"unfrozenman"},"126":{cls:"npcs",id:"recluse"},"127":{cls:"npcs",id:"king"},"128":{cls:"npcs",id:"youngMan"},"129":{cls:"npcs",id:"sign"},"130":{cls:"npcs",id:"expShop"},"131":{cls:"npcs",id:"moneyShop"},"132":{cls:"npcs",id:"closedMoneyShop"},"133":{cls:"npc48",id:"npc0",faceIds:{down:"npc0",left:"npc1",right:"npc2",up:"npc3"},animate:1},"134":{cls:"npc48",id:"npc1",faceIds:{down:"npc0",left:"npc1",right:"npc2",up:"npc3"},animate:1},"135":{cls:"npc48",id:"npc2",faceIds:{down:"npc0",left:"npc1",right:"npc2",up:"npc3"},animate:1},"136":{cls:"npc48",id:"npc3",faceIds:{down:"npc0",left:"npc1",right:"npc2",up:"npc3"},animate:1},"137":{cls:"npcs",id:"greenMan"},"138":{cls:"npcs",id:"blueTrader"},"139":{cls:"npcs",id:"redMSNpc"},"140":{cls:"npcs",id:"magician"},"141":{cls:"autotile",id:"autotile4"},"142":{cls:"autotile",id:"autotile5",canBreak:true},"143":{cls:"autotile",id:"autotile6",canBreak:true},"144":{cls:"autotile",id:"autotile7"},"145":{cls:"autotile",id:"autotile8"},"146":{cls:"autotile",id:"autotile9"},"147":{cls:"autotile",id:"autotile10"},"148":{cls:"autotile",id:"autotile11"},"149":{cls:"autotile",id:"autotile12",canBreak:true},"150":{cls:"autotile",id:"autotile13",canPass:false},"151":{cls:"autotile",id:"autotile1"},"152":{cls:"autotile",id:"autotile2"},"153":{cls:"autotile",id:"autotile3"},"154":{cls:"autotile",id:"autotile14"},"155":{cls:"autotile",id:"autotile15"},"156":{cls:"autotile",id:"autotile16"},"157":{cls:"autotile",id:"autotile17",canBreak:true},"158":{cls:"autotile",id:"autotile18"},"159":{cls:"autotile",id:"autotile19"},"160":{cls:"autotile",id:"autotile20"},"161":{cls:"terrains",id:"arrowUp",canPass:true,cannotOut:["left","right","down"],cannotIn:["up"]},"162":{cls:"terrains",id:"arrowDown",canPass:true,cannotOut:["left","right","up"],cannotIn:["down"]},"163":{cls:"terrains",id:"arrowLeft",canPass:true,cannotOut:["up","down","right"],cannotIn:["left"]},"164":{cls:"terrains",id:"arrowRight",canPass:true,cannotOut:["up","down","left"],cannotIn:["right"]},"165":{cls:"terrains",id:"light",trigger:"null",canPass:true,script:"(function () {\n\tcore.setBlock(core.getNumberById('darkLight'), core.getHeroLoc('x'), core.getHeroLoc('y'));\n})();"},"166":{cls:"terrains",id:"darkLight"},"167":{cls:"terrains",id:"ski",trigger:"ski",canPass:true},"168":{cls:"terrains",id:"flower",canPass:true},"169":{cls:"terrains",id:"box",trigger:"pushBox"},"170":{cls:"terrains",id:"boxed",trigger:"pushBox"},"171":{cls:"autotile",id:"autotile21"},"172":{cls:"autotile",id:"autotile22"},"173":{cls:"autotile",id:"autotile23"},"174":{cls:"autotile",id:"autotile24"},"175":{cls:"autotile",id:"autotile25"},"176":{cls:"autotile",id:"autotile26"},"177":{cls:"autotile",id:"autotile27"},"178":{cls:"autotile",id:"autotile28"},"179":{cls:"autotile",id:"autotile29"},"180":{cls:"autotile",id:"autotile30"},"181":{cls:"npcs",id:"octopusLeftTop"},"182":{cls:"npcs",id:"octopusTop"},"183":{cls:"npcs",id:"octopusRightTop"},"184":{cls:"npcs",id:"octopusLeft"},"185":{cls:"npcs",id:"octopusCenter"},"186":{cls:"npcs",id:"octopusRight"},"187":{cls:"npcs",id:"octopusLeftBottom"},"188":{cls:"npcs",id:"octopusRightBottom"},"189":{cls:"npcs",id:"dragonLeftTop"},"190":{cls:"npcs",id:"dragonTop"},"191":{cls:"npcs",id:"dragonRightTop"},"192":{cls:"npcs",id:"dragonLeft"},"193":{cls:"npcs",id:"dragonCenter"},"194":{cls:"npcs",id:"dragonRight"},"195":{cls:"npcs",id:"dragonLeftBottom"},"196":{cls:"npcs",id:"dragonRightBottom"},"197":{cls:"autotile",id:"autotile31"},"198":{cls:"autotile",id:"autotile32"},"199":{cls:"autotile",id:"autotile33"},"200":{cls:"autotile",id:"autotile34"},"201":{cls:"enemys",id:"greenSlime"},"202":{cls:"enemys",id:"redSlime"},"203":{cls:"enemys",id:"blackSlime"},"204":{cls:"enemys",id:"slimelord"},"205":{cls:"enemys",id:"bat"},"206":{cls:"enemys",id:"bigBat"},"207":{cls:"enemys",id:"blueButterfly"},"208":{cls:"enemys",id:"sworm"},"209":{cls:"enemys",id:"skeleton"},"210":{cls:"enemys",id:"skeletonWarrior"},"211":{cls:"enemys",id:"skeletonCaptain"},"212":{cls:"enemys",id:"bigfly"},"213":{cls:"enemys",id:"noble1"},"214":{cls:"enemys",id:"noble2"},"215":{cls:"enemys",id:"rock"},"216":{cls:"enemys",id:"slimeman"},"217":{cls:"enemys",id:"bluePriest"},"218":{cls:"enemys",id:"redPriest"},"219":{cls:"enemys",id:"brownWizard"},"220":{cls:"enemys",id:"housekeeper"},"221":{cls:"enemys",id:"yellowGateKeeper"},"222":{cls:"enemys",id:"blueGateKeeper"},"223":{cls:"enemys",id:"blueGateKeeper2"},"224":{cls:"enemys",id:"swordsman"},"225":{cls:"enemys",id:"soldier"},"226":{cls:"enemys",id:"yellowKnight"},"227":{cls:"enemys",id:"redKnight"},"228":{cls:"enemys",id:"darkKnight"},"229":{cls:"enemys",id:"turtle"},"230":{cls:"enemys",id:"smallish"},"231":{cls:"enemys",id:"smallPriest"},"232":{cls:"enemys",id:"blueKnight"},"233":{cls:"enemys",id:"smallWarrior"},"234":{cls:"enemys",id:"bigFairy"},"235":{cls:"enemys",id:"poisonBat"},"236":{cls:"enemys",id:"ironRock"},"237":{cls:"enemys",id:"smallFairy"},"238":{cls:"enemys",id:"bigFlower"},"239":{cls:"enemys",id:"Thief"},"240":{cls:"enemys",id:"skeletonKnight"},"241":{cls:"enemys",id:"evilHero"},"242":{cls:"enemys",id:"redKing"},"243":{cls:"enemys",id:"blackKing"},"244":{cls:"enemys",id:"goldHornSlime"},"245":{cls:"enemys",id:"iceMS"},"246":{cls:"enemys",id:"blueMS"},"247":{cls:"enemys",id:"machine"},"248":{cls:"enemys",id:"silverSlime"},"249":{cls:"enemys",id:"clown"},"250":{cls:"enemys",id:"whiteHornSlime"},"251":{cls:"enemys",id:"E251"},"252":{cls:"enemys",id:"greenMS2"},"253":{cls:"enemys",id:"yellowPriest"},"254":{cls:"enemys",id:"redSwordsman"},"255":{cls:"enemys",id:"whiteSlimeman"},"256":{cls:"enemys",id:"mage2"},"257":{cls:"enemys",id:"mage1"},"258":{cls:"enemys",id:"greenMS"},"259":{cls:"enemys",id:"sWarrior"},"260":{cls:"enemys",id:"thief_20"},"261":{cls:"enemy48",id:"E261"},"262":{cls:"enemy48",id:"E262"},"263":{cls:"enemy48",id:"steelGuard"},"264":{cls:"enemy48",id:"evilBat"},"265":{cls:"enemys",id:"silverSlimelord"},"266":{cls:"enemys",id:"goldSlimelord"},"267":{cls:"enemys",id:"grayRock"},"268":{cls:"enemys",id:"blueRock"},"269":{cls:"enemys",id:"thief_20_2"},"270":{cls:"enemys",id:"greenKnight"},"271":{cls:"enemys",id:"bowman"},"272":{cls:"enemys",id:"liteBowman"},"273":{cls:"enemys",id:"ssWarrior"},"274":{cls:"enemys",id:"redGateKeeper"},"275":{cls:"enemys",id:"watcherSlime"},"276":{cls:"enemys",id:"redMS"},"277":{cls:"enemys",id:"frostBat"},"278":{cls:"enemys",id:"E278"},"279":{cls:"enemys",id:"butler"},"280":{cls:"enemys",id:"greenGateKeeper"},"300":{cls:"terrains",id:"ground"},"301":{cls:"terrains",id:"grass"},"302":{cls:"terrains",id:"grass2"},"303":{cls:"terrains",id:"snowGround"},"304":{cls:"terrains",id:"ground2"},"305":{cls:"terrains",id:"ground3"},"306":{cls:"terrains",id:"ground4"},"307":{cls:"terrains",id:"sand"},"308":{cls:"terrains",id:"ground5"},"309":{cls:"terrains",id:"yellowWall2"},"310":{cls:"terrains",id:"whiteWall2"},"311":{cls:"terrains",id:"blueWall2"},"312":{cls:"terrains",id:"blockWall"},"313":{cls:"terrains",id:"grayWall"},"314":{cls:"terrains",id:"white"},"315":{cls:"terrains",id:"ground6"},"316":{cls:"terrains",id:"soil"},"317":{cls:"terrains",id:"ground7"},"318":{cls:"terrains",id:"ground8"},"319":{cls:"items",id:"I319"},"320":{cls:"items",id:"I320"},"321":{cls:"items",id:"I321"},"322":{cls:"items",id:"redGem2"},"323":{cls:"items",id:"blueGem2"},"324":{cls:"items",id:"redGem3"},"325":{cls:"items",id:"blueGem3"},"326":{cls:"items",id:"greenGem3"},"327":{cls:"items",id:"redGem4"},"328":{cls:"items",id:"blueGem4"},"329":{cls:"items",id:"greenGem4"},"330":{cls:"items",id:"bigRedPotion"},"331":{cls:"items",id:"bigBluePotion"},"332":{cls:"items",id:"bigYellowPotion"},"333":{cls:"items",id:"bigGreenPotion"},"334":{cls:"items",id:"manaItem"},"335":{cls:"items",id:"skill2"},"336":{cls:"npc48",id:"hero2",faceIds:{down:"hero2",left:"N337",right:"N338",up:"N339"},animate:4},"337":{cls:"npc48",id:"N337",faceIds:{down:"hero2",left:"N337",right:"N338",up:"N339"},animate:4},"338":{cls:"npc48",id:"N338",faceIds:{down:"hero2",left:"N337",right:"N338",up:"N339"},animate:4},"339":{cls:"npc48",id:"N339",faceIds:{down:"hero2",left:"N337",right:"N338",up:"N339"},animate:4},"340":{cls:"npc48",id:"N340",faceIds:{down:"N340",left:"N383",right:"N384",up:"N385"},animate:4},"341":{cls:"items",id:"skill0"},"342":{cls:"items",id:"skill0_buff"},"343":{cls:"items",id:"I343"},"344":{cls:"enemys",id:"E344"},"345":{cls:"enemys",id:"E345"},"346":{cls:"enemys",id:"E346"},"347":{cls:"enemys",id:"E347"},"348":{cls:"enemys",id:"E348"},"349":{cls:"items",id:"superPotion_s"},"350":{cls:"npc48",id:"N2221_down",faceIds:{up:"N2221_up",down:"N2221_down",left:"N2221_left",right:"N2221_right"},animate:4},"351":{cls:"npc48",id:"N2221_left",faceIds:{up:"N2221_up",down:"N2221_down",left:"N2221_left",right:"N2221_right"},animate:4},"352":{cls:"enemys",id:"E352"},"353":{cls:"enemys",id:"E353"},"354":{cls:"enemys",id:"E354"},"355":{cls:"enemys",id:"E355"},"356":{cls:"npc48",id:"N2221_right",faceIds:{up:"N2221_up",down:"N2221_down",left:"N2221_left",right:"N2221_right"},animate:4},"357":{cls:"npc48",id:"N2221_up",faceIds:{up:"N2221_up",down:"N2221_down",left:"N2221_left",right:"N2221_right"},animate:4},"358":{cls:"npc48",id:"N358",faceIds:{up:"N358",down:"N2221"}},"359":{cls:"npc48",id:"N2221",faceIds:{up:"N358",down:"N2221"}},"360":{cls:"enemys",id:"E360"},"361":{cls:"items",id:"skill0_all"},"362":{cls:"enemy48",id:"E2221"},"363":{cls:"enemys",id:"E363"},"364":{cls:"items",id:"I_wait"},"365":{cls:"enemy48",id:"E2221_down"},"366":{cls:"enemys",id:"goldMS"},"367":{cls:"enemys",id:"E367"},"368":{cls:"enemys",id:"E368"},"369":{cls:"enemys",id:"E369"},"370":{cls:"enemys",id:"E370"},"371":{cls:"enemy48",id:"E2221_left"},"372":{cls:"enemy48",id:"E2221_right"},"373":{cls:"enemy48",id:"E2221_up"},"374":{cls:"npc48",id:"hero3",faceIds:{up:"hero3_up",down:"hero3",left:"hero3_left",right:"hero3_right"},animate:4},"375":{cls:"enemys",id:"E375"},"376":{cls:"enemys",id:"E376"},"377":{cls:"enemys",id:"E377"},"378":{cls:"enemys",id:"E378"},"379":{cls:"enemys",id:"E379"},"380":{cls:"enemys",id:"E380"},"381":{cls:"enemys",id:"E381"},"382":{cls:"enemys",id:"E382"},"383":{cls:"npc48",id:"N383",faceIds:{down:"N340",left:"N383",right:"N384",up:"N385"},animate:4},"384":{cls:"npc48",id:"N384",faceIds:{down:"N340",left:"N383",right:"N384",up:"N385"},animate:4},"385":{cls:"npc48",id:"N385",faceIds:{down:"N340",left:"N383",right:"N384",up:"N385"},animate:4},"386":{cls:"items",id:"yellowKey3"},"387":{cls:"npc48",id:"hero3_left",faceIds:{up:"hero3_up",down:"hero3",left:"hero3_left",right:"hero3_right"},animate:4},"388":{cls:"items",id:"blueKey3"},"389":{cls:"npc48",id:"hero3_right",faceIds:{up:"hero3_up",down:"hero3",left:"hero3_left",right:"hero3_right"},animate:4},"390":{cls:"npc48",id:"hero3_up",faceIds:{up:"hero3_up",down:"hero3",left:"hero3_left",right:"hero3_right"},animate:4},"391":{cls:"items",id:"redKey3"},"392":{cls:"items",id:"I392"},"393":{cls:"npc48",id:"rogue",faceIds:{up:"rogue_up",down:"rogue",left:"rogue_left",right:"rogue_right"},animate:4},"394":{cls:"items",id:"blackGem"},"395":{cls:"npc48",id:"rogue_left",faceIds:{up:"rogue_up",down:"rogue",left:"rogue_left",right:"rogue_right"},animate:4},"396":{cls:"npc48",id:"rogue_right",faceIds:{up:"rogue_up",down:"rogue",left:"rogue_left",right:"rogue_right"},animate:4},"397":{cls:"items",id:"I397"},"398":{cls:"npc48",id:"rogue_up",faceIds:{up:"rogue_up",down:"rogue",left:"rogue_left",right:"rogue_right"},animate:4},"399":{cls:"enemys",id:"E399"},"400":{cls:"enemys",id:"E400"},"401":{cls:"items",id:"I401"},"402":{cls:"npc48",id:"N402",faceIds:{down:"N402",left:"N403",right:"N404",up:"N405"}},"403":{cls:"npc48",id:"N403",faceIds:{down:"N402",left:"N403",right:"N404",up:"N405"}},"404":{cls:"npc48",id:"N404",faceIds:{down:"N402",left:"N403",right:"N404",up:"N405"}},"405":{cls:"npc48",id:"N405",faceIds:{down:"N402",left:"N403",right:"N404",up:"N405"}},"406":{cls:"npc48",id:"N406"},"407":{cls:"npcs",id:"N407"},"408":{cls:"npc48",id:"N408",faceIds:null},"409":{cls:"items",id:"I409"},"410":{cls:"npc48",id:"N410",faceIds:null,animate:4},"411":{cls:"enemy48",id:"Emoli1"},"412":{cls:"npc48",id:"N412",faceIds:{up:"N415",down:"N412",left:"N413",right:"N414"},animate:4},"413":{cls:"npc48",id:"N413",faceIds:{up:"N415",down:"N412",left:"N413",right:"N414"},animate:4},"414":{cls:"npc48",id:"N414",faceIds:{up:"N415",down:"N412",left:"N413",right:"N414"},animate:4},"415":{cls:"npc48",id:"N415",faceIds:{up:"N415",down:"N412",left:"N413",right:"N414"},animate:4},"416":{cls:"npc48",id:"Nmoli"},"417":{cls:"enemy48",id:"Emoli2"},"418":{cls:"enemy48",id:"Emoli3"},"419":{cls:"enemy48",id:"Egule1"},"420":{cls:"items",id:"I420"},"421":{cls:"npc48",id:"Ngule",animate:4},"422":{cls:"enemys",id:"E422"},"423":{cls:"npc48",id:"N423",animate:4},"424":{cls:"enemy48",id:"Egule2"},"425":{cls:"items",id:"I425"},"426":{cls:"enemy48",id:"Eancang"},"427":{cls:"enemys",id:"E427"},"428":{cls:"enemy48",id:"E428"},"429":{cls:"enemys",id:"E429"},"430":{cls:"enemys",id:"E430"},"431":{cls:"enemys",id:"E431"},"432":{cls:"enemy48",id:"E432"},"433":{cls:"enemys",id:"E433"},"434":{cls:"enemys",id:"E434"},"435":{cls:"enemys",id:"E435"},"436":{cls:"enemys",id:"E436"},"437":{cls:"items",id:"I437"},"438":{cls:"items",id:"I438"},"439":{cls:"items",id:"I439"},"440":{cls:"items",id:"I440"},"441":{cls:"items",id:"I441"},"442":{cls:"enemy48",id:"E442"},"443":{cls:"enemys",id:"E443"},"444":{cls:"enemys",id:"E444"},"445":{cls:"enemys",id:"E445"},"446":{cls:"enemy48",id:"E446"},"447":{cls:"npc48",id:"Nancang",animate:4},"448":{cls:"enemys",id:"E448"},"449":{cls:"enemys",id:"E449"},"450":{cls:"enemys",id:"E450"},"451":{cls:"enemys",id:"E451"},"452":{cls:"enemys",id:"E452"},"453":{cls:"enemys",id:"E453"},"454":{cls:"enemys",id:"E454"},"455":{cls:"enemys",id:"E455"},"456":{cls:"enemys",id:"E456"},"457":{cls:"enemys",id:"E457"},"458":{cls:"enemys",id:"E458"},"459":{cls:"enemys",id:"E459"},"460":{cls:"enemys",id:"E460"},"461":{cls:"enemys",id:"E461"},"462":{cls:"enemys",id:"E462"},"463":{cls:"terrains",id:"T463"},"464":{cls:"npc48",id:"N464"},"465":{cls:"enemys",id:"E465"},"466":{cls:"npc48",id:"N466"},"467":{cls:"enemys",id:"E467"},"468":{cls:"items",id:"skill4"},"469":{cls:"npc48",id:"N469"},"470":{cls:"items",id:"skill3"},"471":{cls:"enemys",id:"E471"},"472":{cls:"enemys",id:"E472"},"473":{cls:"npc48",id:"N473"},"474":{cls:"enemys",id:"E474"},"475":{cls:"enemys",id:"E475"},"476":{cls:"enemys",id:"E476"},"477":{cls:"enemys",id:"E477"},"478":{cls:"npc48",id:"N478"},"479":{cls:"enemys",id:"E479"},"480":{cls:"enemys",id:"E480"},"481":{cls:"enemys",id:"E481"},"482":{cls:"enemys",id:"E482"},"483":{cls:"enemys",id:"E483"},"484":{cls:"npc48",id:"N484"},"485":{cls:"enemys",id:"E485"},"486":{cls:"enemys",id:"E486"},"487":{cls:"enemys",id:"E487"},"488":{cls:"enemys",id:"E488"},"489":{cls:"items",id:"talentTree"},"490":{cls:"enemys",id:"Exl_A"},"491":{cls:"npc48",id:"N491"},"492":{cls:"animates",id:"A492"},"493":{cls:"animates",id:"A493"},"494":{cls:"animates",id:"A494"},"495":{cls:"animates",id:"A495"},"496":{cls:"enemys",id:"E496"},"497":{cls:"enemys",id:"E497"},"498":{cls:"enemys",id:"E498"},"499":{cls:"npc48",id:"N499"},"500":{cls:"enemys",id:"E500"},"501":{cls:"enemys",id:"E501"},"502":{cls:"enemys",id:"E502"},"503":{cls:"enemys",id:"E503"},"504":{cls:"enemys",id:"E504"},"505":{cls:"enemys",id:"E505"},"506":{cls:"terrains",id:"T506"},"507":{cls:"enemys",id:"E507"},"508":{cls:"npc48",id:"N508"},"509":{cls:"enemys",id:"E509"},"510":{cls:"enemys",id:"E510"},"511":{cls:"enemys",id:"E511"},"512":{cls:"enemys",id:"E512"},"513":{cls:"enemys",id:"E513"},"514":{cls:"npcs",id:"N514"},"515":{cls:"npcs",id:"N515"},"516":{cls:"npc48",id:"N516",faceIds:{down:"N516",left:"N517",right:"N520",up:"N521"},animate:4},"517":{cls:"npc48",id:"N517",faceIds:{down:"N516",left:"N517",right:"N520",up:"N521"},animate:4},"518":{cls:"npc48",id:"N518"},"519":{cls:"enemys",id:"E519"},"520":{cls:"npc48",id:"N520",faceIds:{down:"N516",left:"N517",right:"N520",up:"N521"},animate:4},"521":{cls:"npc48",id:"N521",faceIds:{down:"N516",left:"N517",right:"N520",up:"N521"},animate:4},"522":{cls:"npc48",id:"N522",faceIds:{up:"N523",down:"N522",left:"N517",right:"N520"}},"523":{cls:"npc48",id:"N523",faceIds:{up:"N523",down:"N522",left:"N517",right:"N520"}},"524":{cls:"enemys",id:"Exl_B"},"525":{cls:"enemys",id:"Exl_C"},"526":{cls:"enemys",id:"Exl_D"},"527":{cls:"enemys",id:"E527"},"528":{cls:"enemys",id:"E528"},"529":{cls:"enemys",id:"E529"},"530":{cls:"enemys",id:"E530"},"531":{cls:"enemys",id:"E531"},"532":{cls:"enemys",id:"Exl_E"},"533":{cls:"enemys",id:"Exl_F"},"534":{cls:"enemys",id:"Exl_G"},"535":{cls:"enemys",id:"E535"},"536":{cls:"enemys",id:"E536"},"537":{cls:"enemys",id:"E537"},"538":{cls:"enemys",id:"E538"},"539":{cls:"enemys",id:"E539"},"540":{cls:"enemys",id:"E540"},"541":{cls:"enemys",id:"E541"},"542":{cls:"enemys",id:"E542"},"543":{cls:"enemys",id:"E543"},"544":{cls:"enemys",id:"E544"},"545":{cls:"enemys",id:"E545"},"546":{cls:"enemys",id:"E546"},"547":{cls:"enemys",id:"E547"},"548":{cls:"enemys",id:"E548"},"549":{cls:"enemy48",id:"E549"},"550":{cls:"items",id:"sword7"},"551":{cls:"enemys",id:"E551"},"552":{cls:"enemys",id:"E552"},"553":{cls:"enemys",id:"E553"},"554":{cls:"enemys",id:"E554"},"555":{cls:"enemys",id:"E555"},"556":{cls:"enemys",id:"E556"},"557":{cls:"enemys",id:"E557"},"558":{cls:"enemy48",id:"E558"},"559":{cls:"enemy48",id:"E559"},"560":{cls:"enemy48",id:"E560"},"561":{cls:"enemy48",id:"E561"},"562":{cls:"enemy48",id:"E562"},"563":{cls:"enemy48",id:"E563"},"564":{cls:"enemys",id:"E564"},"565":{cls:"items",id:"DScore"},"566":{cls:"items",id:"hugeRedPotion"},"567":{cls:"items",id:"hugeBluePotion"},"568":{cls:"items",id:"hugeYellowPotion"},"569":{cls:"items",id:"hugeGreenPotion"},"570":{cls:"enemy48",id:"E570"},"571":{cls:"npc48",id:"N571"},"572":{cls:"npc48",id:"Nxl_U",faceIds:{up:"N575",down:"Nxl_U",left:"N573",right:"N574"},animate:4},"573":{cls:"npc48",id:"N573",faceIds:{up:"N575",down:"Nxl_U",left:"N573",right:"N574"},animate:4},"574":{cls:"npc48",id:"N574",faceIds:{up:"N575",down:"Nxl_U",left:"N573",right:"N574"},animate:4},"575":{cls:"npc48",id:"N575",faceIds:{up:"N575",down:"Nxl_U",left:"N573",right:"N574"},animate:4},"576":{cls:"enemys",id:"E576"},"577":{cls:"enemys",id:"E577"},"578":{cls:"enemys",id:"E578"},"579":{cls:"enemys",id:"E579"},"580":{cls:"enemys",id:"E580"},"581":{cls:"enemys",id:"E581"},"582":{cls:"enemys",id:"E582"},"583":{cls:"enemys",id:"E583"},"584":{cls:"enemys",id:"E584"},"585":{cls:"enemys",id:"E585"},"586":{cls:"enemys",id:"E586"},"587":{cls:"enemys",id:"E587"},"588":{cls:"enemys",id:"E588"},"589":{cls:"enemys",id:"E589"},"590":{cls:"enemys",id:"E590"},"591":{cls:"items",id:"skill5"},"592":{cls:"items",id:"I592"},"593":{cls:"enemys",id:"E593"},"594":{cls:"enemys",id:"E594"},"595":{cls:"enemys",id:"E595"},"596":{cls:"npc48",id:"N596"},"597":{cls:"npcs",id:"N597"},"598":{cls:"npcs",id:"N598"},"599":{cls:"enemys",id:"E599"},"600":{cls:"npc48",id:"N600",faceIds:{down:"N600",left:"N601",right:"N602",up:"N603"},animate:4},"601":{cls:"npc48",id:"N601",faceIds:{down:"N600",left:"N601",right:"N602",up:"N603"},animate:4},"602":{cls:"npc48",id:"N602",faceIds:{down:"N600",left:"N601",right:"N602",up:"N603"},animate:4},"603":{cls:"npc48",id:"N603",faceIds:{down:"N600",left:"N601",right:"N602",up:"N603"},animate:4},"604":{cls:"enemys",id:"E604"},"605":{cls:"npcs",id:"N605"},"606":{cls:"npc48",id:"N606",faceIds:{down:"N606",left:"N607",right:"N608",up:"N609"},animate:4},"607":{cls:"npc48",id:"N607",faceIds:{down:"N606",left:"N607",right:"N608",up:"N609"},animate:4},"608":{cls:"npc48",id:"N608",faceIds:{down:"N606",left:"N607",right:"N608",up:"N609"},animate:4},"609":{cls:"npc48",id:"N609",faceIds:{down:"N606",left:"N607",right:"N608",up:"N609"},animate:4},"610":{cls:"npc48",id:"N610",faceIds:{down:"N610",left:"N611",right:"N612",up:"N613"},animate:4},"611":{cls:"npc48",id:"N611",faceIds:{down:"N610",left:"N611",right:"N612",up:"N613"},animate:4},"612":{cls:"npc48",id:"N612",faceIds:{down:"N610",left:"N611",right:"N612",up:"N613"},animate:4},"613":{cls:"npc48",id:"N613",faceIds:{down:"N610",left:"N611",right:"N612",up:"N613"},animate:4},"614":{cls:"npc48",id:"N614",faceIds:{down:"N614",left:"N615",right:"N616",up:"N617"},animate:4},"615":{cls:"npc48",id:"N615",faceIds:{down:"N614",left:"N615",right:"N616",up:"N617"},animate:4},"616":{cls:"npc48",id:"N616",faceIds:{down:"N614",left:"N615",right:"N616",up:"N617"},animate:4},"617":{cls:"npc48",id:"N617",faceIds:{down:"N614",left:"N615",right:"N616",up:"N617"},animate:4},"618":{cls:"npc48",id:"N618",faceIds:{down:"N618",left:"N619",right:"N620",up:"N621"},animate:4},"619":{cls:"npc48",id:"N619",faceIds:{down:"N618",left:"N619",right:"N620",up:"N621"},animate:4},"620":{cls:"npc48",id:"N620",faceIds:{down:"N618",left:"N619",right:"N620",up:"N621"},animate:4},"621":{cls:"npc48",id:"N621",faceIds:{down:"N618",left:"N619",right:"N620",up:"N621"},animate:4},"622":{cls:"npc48",id:"N622",faceIds:{down:"N622",left:"N623",right:"N624",up:"N625"},animate:4},"623":{cls:"npc48",id:"N623",faceIds:{down:"N622",left:"N623",right:"N624",up:"N625"},animate:4},"624":{cls:"npc48",id:"N624",faceIds:{down:"N622",left:"N623",right:"N624",up:"N625"},animate:4},"625":{cls:"npc48",id:"N625",faceIds:{down:"N622",left:"N623",right:"N624",up:"N625"},animate:4},"626":{cls:"enemy48",id:"E626"},"627":{cls:"enemys",id:"E627"},"628":{cls:"enemys",id:"E628"},"629":{cls:"enemy48",id:"E629"},"630":{cls:"enemys",id:"E630"},"631":{cls:"enemys",id:"E631"},"632":{cls:"enemys",id:"E632"},"633":{cls:"enemys",id:"E633"},"634":{cls:"enemys",id:"E634"},"635":{cls:"enemys",id:"E635"},"636":{cls:"enemys",id:"E636"},"637":{cls:"enemys",id:"E637"},"638":{cls:"enemy48",id:"A11boss_p1"},"639":{cls:"enemy48",id:"A11boss_p2"},"640":{cls:"items",id:"skill6"},"641":{cls:"terrains",id:"T641"},"642":{cls:"enemys",id:"E642"},"643":{cls:"enemys",id:"E643"},"644":{cls:"enemys",id:"E644"},"645":{cls:"enemys",id:"E645"},"646":{cls:"enemys",id:"E646"},"647":{cls:"enemys",id:"E647"},"648":{cls:"enemys",id:"E648"},"649":{cls:"enemys",id:"E649"},"650":{cls:"enemys",id:"E650"},"651":{cls:"enemys",id:"E651"},"652":{cls:"items",id:"redGem5"},"653":{cls:"items",id:"blueGem5"},"654":{cls:"items",id:"greenGem5"},"655":{cls:"items",id:"sword8"},"656":{cls:"items",id:"redGem6"},"657":{cls:"items",id:"blueGem6"},"658":{cls:"items",id:"greenGem6"},"659":{cls:"items",id:"shield8"},"660":{cls:"items",id:"redGem7"},"661":{cls:"items",id:"blueGem7"},"662":{cls:"items",id:"greenGem7"},"663":{cls:"items",id:"skill7"},"664":{cls:"items",id:"redGem8"},"665":{cls:"items",id:"blueGem8"},"666":{cls:"items",id:"greenGem8"},"667":{cls:"items",id:"talentTree2"},"668":{cls:"animates",id:"A668"},"669":{cls:"animates",id:"A669"},"670":{cls:"terrains",id:"T670"},"671":{cls:"enemys",id:"E671"},"672":{cls:"enemys",id:"E672"},"673":{cls:"enemys",id:"E673"},"674":{cls:"enemys",id:"E674"},"675":{cls:"enemys",id:"E675"},"676":{cls:"enemys",id:"E676"},"677":{cls:"enemys",id:"E677"},"678":{cls:"enemys",id:"E678"},"679":{cls:"enemys",id:"E679"},"680":{cls:"enemys",id:"E680"},"681":{cls:"enemys",id:"E681"},"682":{cls:"enemys",id:"E682"},"683":{cls:"enemys",id:"Exl_L"},"684":{cls:"enemys",id:"E684"},"685":{cls:"enemys",id:"E685"},"686":{cls:"enemys",id:"E686"},"687":{cls:"enemys",id:"E687"},"688":{cls:"enemys",id:"E688"},"689":{cls:"enemys",id:"E689"},"690":{cls:"npcs",id:"N690"},"691":{cls:"npcs",id:"N691"},"692":{cls:"items",id:"I_noVampire"},"693":{cls:"items",id:"I_zzzl"},"694":{cls:"items",id:"skill8"},"695":{cls:"enemy48",id:"E695"},"696":{cls:"enemys",id:"E696"},"697":{cls:"enemys",id:"E697"},"698":{cls:"enemys",id:"E698"},"699":{cls:"enemys",id:"E699"},"700":{cls:"enemys",id:"E700"},"701":{cls:"enemys",id:"E701"},"702":{cls:"animates",id:"yellowDoor2",doorInfo:{time:160,openSound:"door.mp3",closeSound:"door.mp3",keys:{yellowKey:3}},animate:1,name:"强黄门",trigger:"openDoor"},"703":{cls:"animates",id:"blueDoor2",doorInfo:{time:160,openSound:"door.mp3",closeSound:"door.mp3",keys:{blueKey:3}},trigger:"openDoor",name:"强蓝门",animate:1},"704":{cls:"enemy48",id:"E704"},"705":{cls:"enemys",id:"E705"},"706":{cls:"enemy48",id:"E706"},"707":{cls:"enemys",id:"E707"},"708":{cls:"enemys",id:"E708"},"709":{cls:"enemys",id:"E709"},"710":{cls:"enemy48",id:"E9961_4"},"711":{cls:"enemy48",id:"E711"},"712":{cls:"enemy48",id:"E712"},"713":{cls:"enemy48",id:"E713"},"714":{cls:"enemy48",id:"E714"},"715":{cls:"enemys",id:"E715"},"716":{cls:"enemys",id:"E716"},"717":{cls:"enemys",id:"E717"},"718":{cls:"enemy48",id:"E9961_1"},"719":{cls:"enemy48",id:"E9961_3"},"720":{cls:"enemy48",id:"E9961_5"},"721":{cls:"enemys",id:"E9961_2"},"722":{cls:"items",id:"I_Chap4Shop4"},"723":{cls:"items",id:"I_greenKeyCh3"},"724":{cls:"items",id:"I_superGreenKey"},"725":{cls:"items",id:"skill9"},"726":{cls:"items",id:"skill10"},"727":{cls:"items",id:"skill11"},"728":{cls:"items",id:"skill12"},"729":{cls:"items",id:"skill13"},"730":{cls:"enemys",id:"E730"},"731":{cls:"enemys",id:"E731"},"732":{cls:"enemys",id:"E732"},"733":{cls:"enemys",id:"E733"},"734":{cls:"enemys",id:"E734"},"735":{cls:"enemys",id:"E735"},"736":{cls:"enemys",id:"E736"},"737":{cls:"enemys",id:"E737"},"738":{cls:"items",id:"talentTree3"},"739":{cls:"enemys",id:"E739"},"740":{cls:"enemys",id:"E740"},"741":{cls:"enemys",id:"E741"},"742":{cls:"enemys",id:"E742"},"743":{cls:"enemys",id:"E743"},"744":{cls:"enemys",id:"E744"},"745":{cls:"enemys",id:"E745"},"746":{cls:"enemy48",id:"E746"},"747":{cls:"enemy48",id:"E747"},"748":{cls:"enemy48",id:"E748"},"749":{cls:"npc48",id:"N749",bigImage:"debug_boss.png",animate:4},"750":{cls:"npc48",id:"N750",faceIds:{down:"N750",left:"N751",right:"N752",up:"N753"}},"751":{cls:"npc48",id:"N751",faceIds:{down:"N750",left:"N751",right:"N752",up:"N753"}},"752":{cls:"npc48",id:"N752",faceIds:{down:"N750",left:"N751",right:"N752",up:"N753"}},"753":{cls:"npc48",id:"N753",faceIds:{down:"N750",left:"N751",right:"N752",up:"N753"}},"754":{cls:"terrains",id:"T754"},"755":{cls:"npcs",id:"N755"},"756":{cls:"enemy48",id:"E756"},"757":{cls:"enemys",id:"E757"},"758":{cls:"npc48",id:"N758",faceIds:{down:"N758",left:"N759",right:"N760",up:"N761"}},"759":{cls:"npc48",id:"N759",faceIds:{down:"N758",left:"N759",right:"N760",up:"N761"}},"760":{cls:"npc48",id:"N760",faceIds:{down:"N758",left:"N759",right:"N760",up:"N761"}},"761":{cls:"npc48",id:"N761",faceIds:{down:"N758",left:"N759",right:"N760",up:"N761"},animate:1},"762":{cls:"npc48",id:"N762",faceIds:{down:"N762",left:"N763",right:"N764",up:"N765"}},"763":{cls:"npc48",id:"N763",faceIds:{down:"N762",left:"N763",right:"N764",up:"N765"}},"764":{cls:"npc48",id:"N764",faceIds:{down:"N762",left:"N763",right:"N764",up:"N765"}},"765":{cls:"npc48",id:"N765",faceIds:{down:"N762",left:"N763",right:"N764",up:"N765"}},"766":{cls:"enemy48",id:"E766"},"767":{cls:"enemy48",id:"E767"},"768":{cls:"npc48",id:"Ndebug009",bigImage:"debug009.png"},"769":{cls:"npc48",id:"Ndebug008",bigImage:"debug008.png"},"770":{cls:"terrains",id:"T770"},"771":{cls:"enemys",id:"E771"},"772":{cls:"enemys",id:"E772"},"773":{cls:"enemys",id:"E773"},"774":{cls:"enemys",id:"E774"},"775":{cls:"enemys",id:"E775"},"776":{cls:"enemys",id:"E776"},"777":{cls:"enemys",id:"E777"},"778":{cls:"enemys",id:"E778"},"779":{cls:"enemys",id:"E779"},"780":{cls:"enemys",id:"E780"},"781":{cls:"items",id:"I_config"},"782":{cls:"enemys",id:"E782"},"783":{cls:"enemys",id:"E783"},"784":{cls:"enemys",id:"E784"},"785":{cls:"items",id:"goldCoin2"},"786":{cls:"npc48",id:"N786",faceIds:{down:"N786",left:"N787",right:"N788",up:"N789"},animate:1},"787":{cls:"npc48",id:"N787",faceIds:{down:"N786",left:"N787",right:"N788",up:"N789"}},"788":{cls:"npc48",id:"N788",faceIds:{down:"N786",left:"N787",right:"N788",up:"N789"}},"789":{cls:"npc48",id:"N789",faceIds:{down:"N786",left:"N787",right:"N788",up:"N789"}},"790":{cls:"enemys",id:"E790"},"791":{cls:"enemy48",id:"E791"},"792":{cls:"enemy48",id:"E792"},"793":{cls:"enemy48",id:"E793"},"794":{cls:"enemy48",id:"E794"},"795":{cls:"npc48",id:"N795",animate:1},"796":{cls:"enemys",id:"E796"},"797":{cls:"enemys",id:"E797"},"798":{cls:"enemy48",id:"E798"},"799":{cls:"enemys",id:"E799"},"800":{cls:"items",id:"I_cat"},"801":{cls:"enemy48",id:"E801"},"802":{cls:"enemys",id:"E802"},"803":{cls:"enemys",id:"E803"},"804":{cls:"animates",id:"redDoor2",animate:1,trigger:"openDoor",name:"强红门",doorInfo:{time:160,openSound:"door.mp3",closeSound:"door.mp3",keys:{redKey:3}}},"805":{cls:"animates",id:"greenDoor2",animate:1,name:"强绿门",trigger:"openDoor",doorInfo:{time:160,openSound:"door.mp3",closeSound:"door.mp3",keys:{greenKey:3}}},"806":{cls:"items",id:"sword9"},"807":{cls:"enemys",id:"E807"},"808":{cls:"enemys",id:"E808"},"809":{cls:"enemy48",id:"E809"},"810":{cls:"enemys",id:"E810"},"811":{cls:"enemy48",id:"E811"},"812":{cls:"enemys",id:"E812"},"813":{cls:"enemys",id:"E813"},"814":{cls:"enemys",id:"E814"},"815":{cls:"enemys",id:"E815"},"816":{cls:"enemys",id:"E816"},"817":{cls:"terrains",id:"T817"},"818":{cls:"enemy48",id:"E818"},"819":{cls:"enemy48",id:"E819"},"820":{cls:"enemy48",id:"E820"},"821":{cls:"enemy48",id:"E821"},"822":{cls:"items",id:"IxlO"},"823":{cls:"items",id:"IxlP"},"824":{cls:"items",id:"IxlQ"},"825":{cls:"items",id:"IxlR"},"826":{cls:"items",id:"IxlS"},"827":{cls:"enemy48",id:"E827"},"828":{cls:"enemy48",id:"E828"},"829":{cls:"enemy48",id:"E829"},"830":{cls:"items",id:"redGem9"},"831":{cls:"items",id:"blueGem9"},"832":{cls:"items",id:"greenGem9"},"833":{cls:"enemy48",id:"E833"},"834":{cls:"enemy48",id:"E834"},"835":{cls:"enemy48",id:"E835"},"836":{cls:"enemy48",id:"E836"},"837":{cls:"enemys",id:"E837"},"838":{cls:"enemys",id:"E838"},"839":{cls:"enemys",id:"E839"},"840":{cls:"enemys",id:"E840"},"841":{cls:"enemys",id:"E841"},"842":{cls:"enemy48",id:"E842"},"843":{cls:"enemy48",id:"E843"},"844":{cls:"enemy48",id:"E844"},"845":{cls:"enemy48",id:"E845"},"846":{cls:"enemy48",id:"E846"},"847":{cls:"enemys",id:"E847"},"848":{cls:"enemy48",id:"E848"},"849":{cls:"enemy48",id:"E849"},"850":{cls:"enemy48",id:"E850"},"851":{cls:"items",id:"giantRedPotion"},"852":{cls:"items",id:"giantBluePotion"},"853":{cls:"items",id:"giantYellowPotion"},"854":{cls:"items",id:"giantGreenPotion"},"855":{cls:"enemys",id:"E855"},"856":{cls:"enemys",id:"E856"},"857":{cls:"enemy48",id:"E857"},"858":{cls:"npcs",id:"N858",bigImage:"Dball1.png"},"859":{cls:"enemy48",id:"E859"},"860":{cls:"enemy48",id:"E860"},"861":{cls:"animates",id:"A861"},"862":{cls:"enemy48",id:"E862"},"863":{cls:"npcs",id:"Number0"},"864":{cls:"npcs",id:"Number1"},"865":{cls:"npcs",id:"Number2"},"866":{cls:"npcs",id:"Number3"},"867":{cls:"npcs",id:"Number4"},"868":{cls:"npcs",id:"Number5"},"869":{cls:"npcs",id:"Number6"},"870":{cls:"npcs",id:"Number7"},"871":{cls:"npcs",id:"Number8"},"872":{cls:"npcs",id:"Number9"},"873":{cls:"enemys",id:"E873"},"874":{cls:"enemys",id:"E874"},"875":{cls:"enemys",id:"E875"},"876":{cls:"enemys",id:"E876"},"877":{cls:"enemys",id:"E877"},"878":{cls:"enemy48",id:"E878"},"879":{cls:"enemy48",id:"E879"},"880":{cls:"enemy48",id:"E880"},"881":{cls:"items",id:"bigManaitem"},"882":{cls:"enemy48",id:"E882"},"883":{cls:"enemy48",id:"E883"},"884":{cls:"enemy48",id:"E884"},"885":{cls:"enemy48",id:"E885"},"886":{cls:"enemy48",id:"E886"},"887":{cls:"enemys",id:"E887"},"888":{cls:"enemy48",id:"E888"},"889":{cls:"enemy48",id:"E889"},"890":{cls:"enemy48",id:"E890"},"891":{cls:"items",id:"redRHeart"},"892":{cls:"items",id:"blueRHeart"},"893":{cls:"items",id:"yellowRHeart"},"894":{cls:"items",id:"greenRHeart"},"895":{cls:"enemys",id:"E895"},"896":{cls:"enemys",id:"E896"},"897":{cls:"enemys",id:"E897"},"898":{cls:"enemy48",id:"E898"},"899":{cls:"enemy48",id:"E899"},"900":{cls:"enemy48",id:"E900"},"901":{cls:"enemys",id:"E901"},"902":{cls:"enemy48",id:"E902"},"903":{cls:"enemy48",id:"E903"},"904":{cls:"enemys",id:"E21Add1"},"905":{cls:"enemy48",id:"E905"},"906":{cls:"enemy48",id:"E906"},"907":{cls:"enemy48",id:"E907"},"908":{cls:"enemy48",id:"E908"},"909":{cls:"enemy48",id:"E909"},"910":{cls:"enemy48",id:"E910"},"911":{cls:"npcs",id:"N911"},"912":{cls:"items",id:"specialRHeart"},"913":{cls:"items",id:"I_energyOrb"},"914":{cls:"items",id:"greenBomb"},"915":{cls:"items",id:"I_hj"},"916":{cls:"terrains",id:"T916"},"917":{cls:"npc48",id:"N917",faceIds:{down:"N917",left:"N918",right:"N919",up:"N920"}},"918":{cls:"npc48",id:"N918",faceIds:{down:"N917",left:"N918",right:"N919",up:"N920"}},"919":{cls:"npc48",id:"N919",faceIds:{down:"N917",left:"N918",right:"N919",up:"N920"}},"920":{cls:"npc48",id:"N920",faceIds:{down:"N917",left:"N918",right:"N919",up:"N920"}},"20059":{cls:"tileset",id:"X20059",canPass:true},"20061":{cls:"tileset",id:"X20061",canPass:true},"20067":{cls:"tileset",id:"X20067",canPass:true},"20069":{cls:"tileset",id:"X20069",canPass:true},"60000":{cls:"tileset",id:"X60000",canPass:true},"60037":{cls:"tileset",id:"X60037",canPass:false},"60078":{cls:"tileset",id:"X60078",canPass:true},"60132":{cls:"tileset",id:"X60132",canPass:false},"60135":{cls:"tileset",id:"X60135",canPass:false},"70009":{cls:"tileset",id:"X70009",canBreak:true},"80040":{cls:"tileset",id:"X80040",cannotOut:["up","left"],cannotIn:["up","left"],canPass:false},"80041":{cls:"tileset",id:"X80041",cannotOut:["up"],cannotIn:["up"]},"80042":{cls:"tileset",id:"X80042",cannotOut:["up","right"],cannotIn:["up","right"],canPass:false},"80048":{cls:"tileset",id:"X80048",cannotOut:["left"],cannotIn:["left"]},"80050":{cls:"tileset",id:"X80050",cannotOut:["right"],cannotIn:["right"]},"80056":{cls:"tileset",id:"X80056",cannotOut:["down","left"],cannotIn:["down","left"]},"80057":{cls:"tileset",id:"X80057",cannotOut:["down"],cannotIn:["down"]},"80058":{cls:"tileset",id:"X80058",cannotOut:["down","right"],cannotIn:["down","right"]},"90002":{cls:"tileset",id:"X90002",canBreak:true},"90007":{cls:"tileset",id:"X90007",cannotIn:["up","down","left","right"],cannotOut:[]},"90009":{cls:"tileset",id:"X90009",canBreak:true},"90010":{cls:"tileset",id:"X90010",canBreak:true},"150095":{cls:"tileset",id:"X150095",canPass:true},"150103":{cls:"tileset",id:"X150103",canPass:true}};var items_296f5d02_12fd_4166_a7c1_b5e830c9ee3a={yellowKey:{cls:"tools",name:"黄钥匙",text:"可以打开一扇黄门",hideInToolbox:true,category:"消耗道具"},blueKey:{cls:"tools",name:"蓝钥匙",text:"可以打开一扇蓝门",hideInToolbox:true,category:"消耗道具"},redKey:{cls:"tools",name:"红钥匙",text:"可以打开一扇红门",hideInToolbox:true,category:"消耗道具"},redGem:{cls:"items",name:"红宝石",text:null,itemEffect:"core.status.hero.atk += core.values.redGem * core.status.thisMap.ratio",itemEffectTip:"，攻击+${core.values.redGem * core.status.thisMap.ratio}",useItemEffect:null,canUseItemEffect:null},blueGem:{cls:"items",name:"蓝宝石",text:null,itemEffect:"core.status.hero.def += core.values.blueGem * core.status.thisMap.ratio",itemEffectTip:"，防御+${core.values.blueGem * core.status.thisMap.ratio}",useItemEffect:null,canUseItemEffect:null},greenGem:{cls:"items",name:"绿宝石",text:null,itemEffect:"core.status.hero.mdef += core.values.greenGem * core.status.thisMap.ratio",itemEffectTip:"，护盾+${core.values.greenGem * core.status.thisMap.ratio}",useItemEffect:null,canUseItemEffect:null},yellowGem:{cls:"tools",name:"黄宝石",text:'蕴含极强的力量，但无法被直接吸收。${flag:yellowGem_extra_description||""}',itemEffect:"",itemEffectTip:"",useItemEvent:null,canUseItemEffect:"false",category:"消耗道具"},redPotion:{cls:"items",name:"红血瓶",text:null,itemEffect:"core.status.hero.hp += core.values.redPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1)",itemEffectTip:"，生命+${core.formatBigNumber(core.values.redPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1))}",useItemEffect:null,canUseItemEffect:"true"},bluePotion:{cls:"items",name:"蓝血瓶",text:null,itemEffect:"core.status.hero.hp += core.values.bluePotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1)",itemEffectTip:"，生命+${core.formatBigNumber(core.values.bluePotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1))}",useItemEffect:null,canUseItemEffect:"true"},yellowPotion:{cls:"items",name:"黄血瓶",text:null,itemEffect:"core.status.hero.hp += core.values.yellowPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1)",itemEffectTip:"，生命+${core.formatBigNumber(core.values.yellowPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1))}",useItemEffect:null,canUseItemEffect:"true"},greenPotion:{cls:"items",name:"绿血瓶",text:null,itemEffect:"core.status.hero.hp += core.values.greenPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1)",itemEffectTip:"，生命+${core.formatBigNumber(core.values.greenPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1))}",useItemEffect:null,canUseItemEffect:"true"},sword0:{cls:"equips",name:"破旧的剑",text:"一把异常难用的剑，用它还不如用拳头，攻击-150",equip:{type:0,animate:"hand",value:{atk:-150},percentage:{}},itemEffect:"core.status.hero.atk += 0",itemEffectTip:"，攻击+0"},sword1:{cls:"equips",name:"铁剑",text:"像是从古代穿越过来的武器，攻击+5",equip:{type:0,animate:"sword1",value:{atk:5}},itemEffect:"core.status.hero.atk += 5",itemEffectTip:"，攻击+5"},sword2:{cls:"equips",name:"银剑",text:"华丽耐用的银剑，十分适合作为装饰，攻击+20",equip:{type:0,animate:"sword2",value:{atk:20}},itemEffect:"core.status.hero.atk += 20",itemEffectTip:"，攻击+20"},sword3:{cls:"equips",name:"平世剑",text:"我们不要歧视，要平视！攻击+100",equip:{type:0,animate:"sword3",value:{atk:100},percentage:{}},itemEffect:"core.status.hero.atk += 100",itemEffectTip:"，攻击+100"},sword4:{cls:"equips",name:"激光剑",text:"能轻易地切开任何金属，攻击+1000",equip:{type:0,animate:"sword4",value:{atk:1000},percentage:{}},itemEffect:"core.status.hero.atk += 1000",itemEffectTip:"，攻击+1000"},sword5:{cls:"equips",name:"注魔之刃",text:"轻便快速的剑，被注入了魔法的力量。攻击+70%，防御-30%，护盾+70%，普通攻击额外造成25%伤害。",equip:{type:0,animate:"zhanji",value:{},percentage:{mdef:70,def:-30,atk:70}},itemEffect:"core.status.hero.atk += 100",itemEffectTip:"，攻击+100"},shield1:{cls:"equips",name:"铁盾",text:"像是从古代穿越过来的防具，防御+5",equip:{type:1,value:{def:5}},itemEffect:"core.status.hero.def += 5",itemEffectTip:"，防御+5"},shield2:{cls:"equips",name:"银盾",text:"华丽耐用的银盾，十分适合作为装饰，防御+20",equip:{type:1,value:{def:20}},itemEffect:"core.status.hero.def += 20",itemEffectTip:"，防御+20"},shield3:{cls:"equips",name:"平世盾",text:"传说中的七大名盾之一，防御+100",equip:{type:1,value:{def:100}},itemEffect:"core.status.hero.def += 100",itemEffectTip:"，防御+100"},shield4:{cls:"equips",name:"钛金盾",text:"极其坚硬而光滑，能够轻易弹飞寻常的子弹，防御+1000",equip:{type:1,value:{def:1000},percentage:{}},itemEffect:"core.status.hero.def += 1000",itemEffectTip:"，防御+1000"},superPotion:{cls:"items",name:"圣水",itemEffect:'core.status.hero.hp *= 2;\ncore.drawHeroAnimate("heal");',itemEffectTip:"，生命值翻倍",canUseItemEffect:true,useItemEffect:"core.status.hero.hp *= 2;"},silverCoin:{cls:"items",name:"银币",itemEffect:"core.status.hero.money += 100",itemEffectTip:"，金币+100"},book:{cls:"constants",name:"怪物手册",text:"可以查看当前楼层各怪物属性",hideInToolbox:true,useItemEffect:"core.ui.drawBook(0);",canUseItemEffect:"true"},fly:{cls:"constants",name:"楼层传送器",text:"可以自由往来去过的楼层",hideInReplay:true,hideInToolbox:true,useItemEffect:"core.ui.drawFly(core.floorIds.indexOf(core.status.floorId));",canUseItemEffect:"(function () {\n\tif (core.getFlag(\"spe83_step\", 0) > 0) return false; // 定时炸弹\n\tvar blocks = core.getMapBlocksObj(core.status.floorId);\n\tfor (var loc in blocks) {\n\t\tvar block = blocks[loc],\n\t\t\tid = block.event.id,\n\t\t\tenemy = core.material.enemys[id];\n\t\tif (block.disable) continue;\n\t\tif (enemy && core.hasSpecial(enemy.special, 68)) {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn core.status.maps[core.status.floorId].canFlyFrom && !core.getFlag('disableFly', 0);\n})();"},freezeBadge:{cls:"constants",name:"冰冻徽章",text:"可以将面前的熔岩变成平地",useItemEffect:"(function () {\n\tvar success = false;\n\n\tvar snowFourDirections = false; // 是否四方向雪花；如果是将其改成true\n\tif (snowFourDirections) {\n\t\t// 四方向雪花\n\t\tfor (var direction in core.utils.scan) {\n\t\t\tvar delta = core.utils.scan[direction];\n\t\t\tvar nx = core.getHeroLoc('x') + delta.x,\n\t\t\t\tny = core.getHeroLoc('y') + delta.y;\n\t\t\tif (core.getBlockId(nx, ny) == 'lava') {\n\t\t\t\tcore.removeBlock(nx, ny);\n\t\t\t\tsuccess = true;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (core.getBlockId(core.nextX(), core.nextY()) == 'lava') {\n\t\t\tcore.removeBlock(core.nextX(), core.nextY());\n\t\t\tsuccess = true;\n\t\t}\n\t}\n\n\tif (success) {\n\t\tcore.drawTip(core.material.items[itemId].name + '使用成功');\n\t} else {\n\t\tcore.drawTip(\"当前无法使用\" + core.material.items[itemId].name);\n\t\tcore.addItem(itemId, 1);\n\t\treturn;\n\t}\n})();",canUseItemEffect:"true"},cross:{cls:"constants",name:"十字架",text:"持有后无视怪物的无敌属性"},amulet:{cls:"constants",name:"避战符",text:"不会被拥有追击属性的敌人强制战斗",category:"永久道具",canUseItemEffect:true,useItemEffect:'core.insertAction("神奇的护符，能够让拥有\\r[yellow]追击\\r属性的敌人变得宛如智障。");',hideInReplay:true},bigKey:{cls:"tools",name:"大黄门钥匙",text:"可以开启当前层所有黄门",itemEffect:"core.status.hero.items.keys.yellowKey++;core.status.hero.items.keys.blueKey++;core.status.hero.items.keys.redKey++;",itemEffectTip:"，全钥匙+1",useItemEffect:'(function () {\n\tvar actions = core.searchBlock("yellowDoor").map(function (block) {\n\t\treturn { "type": "openDoor", "loc": [block.x, block.y], "async": true };\n\t});\n\tactions.push({ "type": "waitAsync" });\n\tactions.push({ "type": "tip", "text": core.material.items[itemId].name + "使用成功" });\n\tcore.insertAction(actions);\n})();',canUseItemEffect:"(function () {\n\treturn core.searchBlock('yellowDoor').length > 0;\n})();"},greenKey:{cls:"tools",name:"绿钥匙",text:"这钥匙，绿油油的，看起来好舒服吖",category:"消耗道具",useItemEffect:'core.getItem("greenKey");\ncore.insertAction("也许比绿钥匙本身更重要的，是留住它所需的东西。");',canUseItemEffect:true},steelKey:{cls:"tools",name:"铁门钥匙",text:"可以打开一扇铁门",category:"消耗道具"},pickaxe:{cls:"tools",name:"破墙镐",text:"破坏面前的不可通行地形，快捷键2",useItemEffect:"(function () {\n\tvar canBreak = function (x, y) {\n\t\tvar block = core.getBlock(x, y);\n\t\tif (block == null || block.disable) return false;\n\t\treturn block.event.canBreak;\n\t};\n\n\tvar success = false;\n\tvar pickaxeFourDirections = false; // 是否四方向破；如果是将其改成true\n\tif (pickaxeFourDirections) {\n\t\t// 四方向破\n\t\tfor (var direction in core.utils.scan) {\n\t\t\tvar delta = core.utils.scan[direction];\n\t\t\tvar nx = core.getHeroLoc('x') + delta.x,\n\t\t\t\tny = core.getHeroLoc('y') + delta.y;\n\t\t\tif (canBreak(nx, ny)) {\n\t\t\t\tcore.removeBlock(nx, ny);\n\t\t\t\tsuccess = true;\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// 仅破当前\n\t\tif (canBreak(core.nextX(), core.nextY())) {\n\t\t\tcore.removeBlock(core.nextX(), core.nextY());\n\t\t\tsuccess = true;\n\t\t}\n\t}\n\n\tif (success) {\n\t\tcore.playSound('pickaxe.mp3');\n\t\tcore.drawTip(core.material.items[itemId].name + '使用成功');\n\t} else {\n\t\t// 无法使用\n\t\tcore.drawTip(\"当前无法使用\" + core.material.items[itemId].name);\n\t\tcore.addItem(itemId, 1);\n\t\treturn;\n\t}\n})();",canUseItemEffect:"true",category:"消耗道具",hideInReplay:true},bomb:{cls:"tools",name:"炸弹",text:"可以炸掉勇士面前的怪物",useItemEffect:"(function () {\n\tvar canBomb = function (x, y) {\n\t\tvar block = core.getBlock(x, y);\n\t\tif (block == null || block.block.disable || block.block.event.cls.indexOf('enemy') != 0) return false;\n\t\tvar enemy = core.material.enemys[block.block.event.id];\n\t\treturn enemy && !enemy.notBomb;\n\t};\n\n\tvar bombList = []; // 炸掉的怪物坐标列表\n\tvar bombFourDirections = false; // 是否四方向可炸；如果是将其改成true。\n\tif (bombFourDirections) {\n\t\t// 四方向炸\n\t\tfor (var direction in core.utils.scan) {\n\t\t\tvar delta = core.utils.scan[direction];\n\t\t\tvar nx = core.getHeroLoc('x') + delta.x,\n\t\t\t\tny = core.getHeroLoc('y') + delta.y;\n\t\t\tif (canBomb(nx, ny)) {\n\t\t\t\tbombList.push([nx, ny]);\n\t\t\t\tcore.removeBlock(nx, ny);\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// 仅炸当前\n\t\tif (canBomb(core.nextX(), core.nextY())) {\n\t\t\tbombList.push([core.nextX(), core.nextY()]);\n\t\t\tcore.removeBlock(core.nextX(), core.nextY());\n\t\t}\n\t}\n\n\tif (bombList.length > 0) {\n\t\tcore.playSound('bomb.mp3');\n\t\tcore.drawTip(core.material.items[itemId].name + '使用成功');\n\t} else {\n\t\tcore.drawTip('当前无法使用' + core.material.items[itemId].name);\n\t\tcore.addItem(itemId, 1);\n\t\treturn;\n\t}\n\n\t// 炸弹后事件\n\t// 这是一个使用炸弹也能开门的例子\n\t/*\n\tif (core.status.floorId=='xxx' && core.terrainExists(x0,y0,'specialDoor') // 某个楼层，该机关门存在\n\t\t&& !core.enemyExists(x1,y1) && !core.enemyExists(x2,y2)) // 且守门的怪物都不存在\n\t{\n\t\tcore.insertAction([ // 插入事件\n\t\t\t{\"type\": \"openDoor\", \"loc\": [x0,y0]} // 开门\n\t\t])\n\t}\n\t*/\n})();",canUseItemEffect:"true"},centerFly:{cls:"tools",name:"中心对称飞行器",text:"可以飞向当前楼层中心对称的位置",useItemEffect:"core.playSound('centerFly.mp3');\ncore.clearMap('hero');\ncore.setHeroLoc('x', core.bigmap.width - 1 - core.getHeroLoc('x'));\ncore.setHeroLoc('y', core.bigmap.height - 1 - core.getHeroLoc('y'));\ncore.drawHero();\ncore.drawTip(core.material.items[itemId].name + '使用成功');",canUseItemEffect:"(function () {\n\tvar toX = core.bigmap.width - 1 - core.getHeroLoc('x'),\n\t\ttoY = core.bigmap.height - 1 - core.getHeroLoc('y');\n\tvar id = core.getBlockId(toX, toY);\n\treturn id == null;\n})();"},upFly:{cls:"tools",name:"上楼器",text:"可以飞往楼上的下楼梯口——如果存在的话",useItemEffect:'(function () {\n\tvar floorId = core.floorIds[core.floorIds.indexOf(core.status.floorId) + 1];\n\tif (core.status.event.id == \'action\') {\n\t\tcore.insertAction([\n\t\t\t{ "type": "changeFloor", "stair": "downFloor", "floorId": floorId },\n\t\t\t{ "type": "tip", "text": core.material.items[itemId].name + \'使用成功\' }\n\t\t]);\n\t} else {\n\t\tcore.changeFloor(floorId, "downFloor", null, null, function () {\n\t\t\tcore.drawTip(core.material.items[itemId].name + \'使用成功\');\n\t\t\tcore.replay();\n\t\t});\n\t}\n})();',canUseItemEffect:"(function () {\n\tvar floorId = core.status.floorId,\n\t\tindex = core.floorIds.indexOf(floorId);\n\tif (index > 0) {\n\t\tvar toId = core.floorIds[index + 1],\n\t\t\ttoX = core.getHeroLoc('x'),\n\t\t\ttoY = core.getHeroLoc('y');\n\t\t// 设置了下楼梯才能使用\n\t\tif (!core.status.maps[toId].downFloor) {\n\t\t\tif (!core.isReplaying()) core.playSound(\"057-Wrong01.ogg\");\n\t\t\treturn false;\n\t\t}\n\t\t// 飞到下楼梯，无需检查下一层同位置是否有东西\n\t\t//var mw = core.floors[toId].width,\n\t\t//\tmh = core.floors[toId].height;\n\t\t//if (toX >= 0 && toX < mw && toY >= 0 && toY < mh && core.getBlock(toX, toY, toId) == null) {\n\t\t//\treturn true;\n\t\t//}\n\t\treturn true;\n\t}\n\treturn false;\n})();",category:"消耗道具"},downFly:{cls:"tools",name:"下楼器",text:"可以飞往楼下的上楼梯口——如果存在的话",useItemEffect:'(function () {\n\tvar floorId = core.floorIds[core.floorIds.indexOf(core.status.floorId) - 1];\n\tif (core.status.event.id == \'action\') {\n\t\tcore.insertAction([\n\t\t\t{ "type": "changeFloor", "stair": "upFloor", "floorId": floorId },\n\t\t\t{ "type": "tip", "text": core.material.items[itemId].name + \'使用成功\' }\n\t\t]);\n\t} else {\n\t\tcore.changeFloor(floorId, "upFloor", null, null, function () {\n\t\t\tcore.drawTip(core.material.items[itemId].name + \'使用成功\');\n\t\t\tcore.replay();\n\t\t});\n\t}\n})();',canUseItemEffect:"(function () {\n\tvar floorId = core.status.floorId,\n\t\tindex = core.floorIds.indexOf(floorId);\n\tif (index > 0) {\n\t\tvar toId = core.floorIds[index - 1],\n\t\t\ttoX = core.getHeroLoc('x'),\n\t\t\ttoY = core.getHeroLoc('y');\n\t\t// 设置了上楼梯才能使用\n\t\tif (!core.status.maps[toId].upFloor) {\n\t\t\tif (!core.isReplaying()) core.playSound(\"057-Wrong01.ogg\");\n\t\t\treturn false;\n\t\t}\n\t\t// 飞到上楼梯，无需检查下一层同位置是否有东西\n\t\t//var mw = core.floors[toId].width,\n\t\t//\tmh = core.floors[toId].height;\n\t\t//if (toX >= 0 && toX < mw && toY >= 0 && toY < mh && core.getBlock(toX, toY, toId) == null) {\n\t\t//\treturn true;\n\t\t//}\n\t\treturn true;\n\t}\n\treturn false;\n})();",category:"消耗道具"},earthquake:{cls:"tools",name:"地震卷轴",text:"可以破坏当前层的所有墙",useItemEffect:"(function () {\n\tvar indexes = [];\n\tfor (var index in core.status.thisMap.blocks) {\n\t\tvar block = core.status.thisMap.blocks[index];\n\t\tif (!block.disable && block.event.canBreak) {\n\t\t\tindexes.push(index);\n\t\t}\n\t}\n\tcore.removeBlockByIndexes(indexes);\n\tcore.drawMap(core.status.floorId, function () {\n\t\tcore.drawTip(core.material.items[itemId].name + '使用成功');\n\t});\n})();",canUseItemEffect:"(function () {\n\treturn core.status.thisMap.blocks.filter(function (block) {\n\t\treturn !block.disable && block.event.canBreak;\n\t}).length > 0;\n})();"},poisonWine:{cls:"tools",name:"解毒药水",text:"可以解除中毒状态",useItemEffect:"core.removeFlag('poison');",canUseItemEffect:"core.hasFlag('poison');",category:"消耗道具"},weakWine:{cls:"tools",name:"平静药水",text:"可以解除所有暴戾状态，若没有该状态则回复50能量",useItemEffect:'core.playSound("pickPotion2.wav");\ncore.drawHeroAnimate("dispel");\nif (core.getFlag("rage_stack", 0) > 0) {\n\tcore.setFlag("rage_stack", 0);\n} else {\n\tcore.status.hero.mana += 50;\n}\ncore.updateStatusBar();\ncore.setHeroIcon("hero.png");',canUseItemEffect:true,category:"消耗道具"},curseWine:{cls:"tools",name:"解咒药水",text:"可以解除诅咒状态",useItemEffect:"core.removeFlag('curse');",canUseItemEffect:"core.hasFlag('curse');",category:"消耗道具"},superWine:{cls:"tools",name:"万能药水",text:"可以解除所有不良状态",useItemEffect:"core.removeFlag('poison');\nif (core.hasFlag('weak')) {\n\tcore.removeFlag('weak');\n\tif (core.values.weakValue>=1) { // >=1：直接扣数值\n\t\tcore.status.hero.atk += core.values.weakValue;\n\t\tcore.status.hero.def += core.values.weakValue;\n\t}\n\telse { // <1：扣比例\n\t\tcore.addBuff(\"atk\", core.values.weakValue);\n\t\tcore.addBuff(\"def\", core.values.weakValue);\n\t}\n}\ncore.removeFlag('curse');",canUseItemEffect:"(function() {\n\treturn core.hasFlag('poison') || core.hasFlag('weak') || core.hasFlag('curse');\n})();",category:"消耗道具"},hammer:{cls:"tools",name:"圣锤",text:"该道具尚未被定义"},jumpShoes:{cls:"tools",name:"跳跃靴",text:"能跳跃到前方两格处",useItemEffect:'core.playSound("jump.mp3"); core.insertAction({ "type": "jumpHero", "loc": [core.nextX(2), core.nextY(2)] });',canUseItemEffect:"(function () {\n\tvar nx = core.nextX(2),\n\t\tny = core.nextY(2);\n\treturn nx >= 0 && nx < core.bigmap.width && ny >= 0 && ny < core.bigmap.height && core.getBlockId(nx, ny) == null;\n})();"},skill1:{cls:"constants",name:"【主动】护盾爆发",text:"自身首次攻击前，对全体敌人造成等同于自身${flag:skill1_ratio}倍剩余护盾值的技能伤害${flag:skill1_extra_text}。消耗${flag:skill1_cost}能量。快捷键1。",hideInReplay:true,useItemEffect:"if (core.getFlag('skill', 0) != 1) { // 判断当前是否已经开了此技能\n\tif (core.getStatus('mana') >= core.getFlag('skill1_cost', 10)) { // 这里要写当前能否开技能的条件判断，比如魔力值至少要多少\n\t\tcore.setFlag('skill', 1); // 开技能1\n\t\tcore.setFlag('skillName', '护盾爆发'); // 设置技能名\n\t\tif (!core.isReplaying()) core.playSound(\"002-System02.ogg\");\n\t} else {\n\t\tcore.drawTip(\"魔力不足，无法开启技能\");\n\t\tif (!core.isReplaying()) core.playSound(\"057-Wrong01.ogg\");\n\t}\n} else { // 关闭技能\n\tcore.setFlag('skill', 0); // 关闭技能状态\n\tcore.setFlag('skillName', '无');\n\tif (!core.isReplaying()) core.playSound(\"008-System08.ogg\");\n}",canUseItemEffect:"true",category:"主动技能"},I_light:{cls:"constants",name:"大型探照灯",text:"几乎可以照亮整个楼层，使用切换开关",canUseItemEffect:true,useItemEffect:"if (core.getFlag('lightRadius', 0) < 200) {\n\tcore.setFlag('origin_lightRadius', core.getFlag('lightRadius', 0));\n\tcore.setFlag(\"lightRadius\", 500);\n} else {\n\tcore.setFlag(\"lightRadius\", core.getFlag('origin_lightRadius'));\n}\ncore.playSound('VX_Sword1.ogg');\ncore.drawMap();\ncore.plugin.updateWeather();",category:"永久道具",hideInReplay:true},I319:{cls:"constants",name:"匙之道",text:"每开启一个黄门，机器之心对攻防护盾的提升效果永久增加1%。1蓝门=3黄门，1红门=10黄门。",category:"被动技能",canUseItemEffect:true,useItemEffect:'core.insertAction("消耗钥匙之后，将其一部分力量彻底吸收至自身，是相当强悍的能力。\\n传说道境之上还有源境，但至今无人能窥得其奥妙。");',hideInReplay:true},I320:{cls:"items",name:"纸条",text:"普通的纸条，上面写了什么东西"},I321:{cls:"tools",name:"解冻药水",text:"可以解除所有冻结状态，并回复5000生命和20能量",canUseItemEffect:true,useItemEffect:'core.playSound("pickPotion2.wav");\ncore.drawHeroAnimate("dispel");\nif (core.getFlag("freeze_stack", 0) > 0) {\n\tcore.setFlag("freeze_stack", 0);\n}\ncore.status.hero.hp += 5000;\ncore.status.hero.mana += 20;\ncore.updateStatusBar();',category:"消耗道具"},greenGem2:{cls:"items",name:"二阶绿宝石",text:null,useItemEvent:null,canUseItemEffect:null,itemEffect:"core.status.hero.mdef += 2 * core.values.greenGem * core.status.thisMap.ratio",itemEffectTip:"，护盾+${2*core.values.greenGem * core.status.thisMap.ratio}"},greenGem3:{cls:"items",name:"三阶绿宝石",itemEffect:"core.status.hero.mdef += 4 * core.values.greenGem * core.status.thisMap.ratio",itemEffectTip:"，护盾+${4*core.values.greenGem * core.status.thisMap.ratio}"},greenGem4:{cls:"items",name:"四阶绿宝石",itemEffect:"core.status.hero.mdef += 8 * core.values.greenGem * core.status.thisMap.ratio",itemEffectTip:"，护盾+${8*core.values.greenGem * core.status.thisMap.ratio}"},redGem4:{cls:"items",name:"四阶红宝石",itemEffect:"core.status.hero.atk += 8 * core.values.redGem * core.status.thisMap.ratio",itemEffectTip:"，攻击+${8*core.values.redGem * core.status.thisMap.ratio}"},redGem3:{cls:"items",name:"三阶红宝石",itemEffect:"core.status.hero.atk += 4 * core.values.redGem * core.status.thisMap.ratio",itemEffectTip:"，攻击+${4*core.values.redGem * core.status.thisMap.ratio}"},redGem2:{cls:"items",name:"二阶红宝石",text:null,itemEffect:"core.status.hero.atk += 2 * core.values.redGem * core.status.thisMap.ratio",itemEffectTip:"，攻击+${2*core.values.redGem * core.status.thisMap.ratio}"},blueGem2:{cls:"items",name:"二阶蓝宝石",itemEffect:"core.status.hero.def += 2 * core.values.blueGem * core.status.thisMap.ratio",itemEffectTip:"，防御+${2*core.values.blueGem * core.status.thisMap.ratio}"},blueGem3:{cls:"items",name:"三阶蓝宝石",itemEffect:"core.status.hero.def += 4 * core.values.blueGem * core.status.thisMap.ratio",itemEffectTip:"，防御+${4*core.values.blueGem * core.status.thisMap.ratio}"},blueGem4:{cls:"items",name:"四阶蓝宝石",itemEffect:"core.status.hero.def += 8 * core.values.blueGem * core.status.thisMap.ratio",itemEffectTip:"，防御+${8*core.values.blueGem * core.status.thisMap.ratio}"},bigRedPotion:{cls:"items",name:"大红血瓶",itemEffect:"core.status.hero.hp += 10 * core.values.redPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1)",itemEffectTip:"，生命+${core.formatBigNumber(10*core.values.redPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1))}"},bigBluePotion:{cls:"items",name:"大蓝血瓶",itemEffect:"core.status.hero.hp += 10 * core.values.bluePotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1)",itemEffectTip:"，生命+${core.formatBigNumber(10*core.values.bluePotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1))}"},bigYellowPotion:{cls:"items",name:"大黄血瓶",itemEffect:"core.status.hero.hp += 10 * core.values.yellowPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1)",itemEffectTip:"，生命+${core.formatBigNumber(10*core.values.yellowPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1))}"},bigGreenPotion:{cls:"items",name:"大绿血瓶",itemEffect:"core.status.hero.hp += 10 * core.values.greenPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1)",itemEffectTip:"，生命+${core.formatBigNumber(10*core.values.greenPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1))}"},skill2:{cls:"constants",name:"【主动】集中防御",text:"蓄力${flag:skill2_charge}回合，之后本场战斗中防御提升基础值的${flag:skill2_val}%（${flag:skill2_val*core.getStatus('def')/100}点）。消耗${flag:skill2_cost}能量。快捷键2。",useItemEffect:"if (core.getFlag('skill', 0) != 2) { // 判断当前是否已经开了此技能\n\tif (core.getStatus('mana') >= core.getFlag('skill2_cost', 10)) {\n\t\tcore.setFlag('skill', 2);\n\t\tcore.setFlag('skillName', '集中防御');\n\t\tif (!core.isReplaying()) core.playSound(\"002-System02.ogg\");\n\t} else {\n\t\tcore.drawTip(\"魔力不足，无法开启技能\");\n\t\tif (!core.isReplaying()) core.playSound(\"057-Wrong01.ogg\");\n\t}\n} else { // 关闭技能\n\tcore.setFlag('skill', 0); // 关闭技能状态\n\tcore.setFlag('skillName', '无');\n\tif (!core.isReplaying()) core.playSound(\"008-System08.ogg\");\n}",canUseItemEffect:"true",category:"主动技能",hideInReplay:true},skill0_buff:{cls:"items",name:"强化修复",itemEffect:"core.addFlag('skill0_val', 100);\ncore.addFlag('skill0_buff_used', 1);",itemEffectTip:"，修复效果增强100点",text:"修复效果增强100点"},skill0:{cls:"constants",name:"【主动】修复",text:"消耗${flag:skill0_cost}能量，增加${flag:skill0_val}*${flag:skill0_ratio}%生命（${Math.floor(flag:skill0_val*flag:skill0_ratio/100)}点）。快捷键1。",useItemEffect:"if (core.getStatus('mana') >= core.getFlag('skill0_cost', 10)) {\n\tcore.status.hero.hp += core.getFlag('skill0_val', 200) * core.getFlag(\"skill0_ratio\", 100) / 100;\n\tcore.status.hero.mana -= core.getFlag('skill0_cost', 10);\n\tif (!core.getFlag(\"skill0_no_animate\", 0)) {\n\t\tcore.drawHeroAnimate('heal2');\n\t}\n\tif (core.hasItem(\"I343\")) {\n\t\tcore.addFlag(\"skill0_ratio\", core.getFlag(\"skill0_ratio_increase_pp\", 2));\n\t}\n}",canUseItemEffect:"core.status.hero.mana >= core.getFlag('skill0_cost', 10);",category:"主动技能",hideInReplay:true},I343:{cls:"constants",name:"修复增幅",text:"每使用一次修复，效果倍率提升${flag:skill0_ratio_increase_pp||2}%。",equip:null,category:"被动技能",canUseItemEffect:"true",useItemEffect:'core.insertAction("越咸越强");'},yellowKey3:{cls:"items",name:"黄钥匙串",itemEffect:"core.addItem('yellowKey', 3);",itemEffectTip:"，3把黄钥匙"},blueKey3:{cls:"items",name:"蓝钥匙串",itemEffectTip:"，3把蓝钥匙",itemEffect:"core.addItem('blueKey', 3);"},redKey3:{cls:"items",name:"红钥匙串",itemEffectTip:"，3把红钥匙",itemEffect:"core.addItem('redKey', 3);"},I392:{cls:"constants",name:"机器之心",equip:null,text:"攻击、防御、护盾分别变为基础值的${flag:heart_atk_pp+100}%，${flag:heart_def_pp+100}%，${flag:heart_mdef_pp+100}%。（使用以查看基础能力值）",useItemEffect:"core.insertAction(\"当前基础能力：\\n攻击：\\r[red]\" + core.getStatus('atk') + \"\\r\\n防御：\\r[aqua]\" + core.getStatus('def') + \"\\r\\n护盾：\\r[lime]\" + core.getStatus('mdef'));",canUseItemEffect:"true",category:"永久道具",hideInReplay:true},I397:{cls:"items",name:"活力之核",equip:null,text:"",itemEffect:"core.plugin.addValpp('mdef', 40);",itemEffectTip:"，基础护盾提升40%。"},I401:{cls:"items",name:"热情之核",equip:null,text:"",itemEffect:"core.plugin.addValpp('atk', 20);",itemEffectTip:"，基础攻击提升20%。"},blackGem:{cls:"items",name:"黑宝石",equip:null,text:"",itemEffect:"core.plugin.addValpp('atk', 2);\ncore.plugin.addValpp('def', 2);\ncore.plugin.addValpp('mdef', 2);",itemEffectTip:"，基础攻防护盾各提升2%"},I409:{cls:"items",name:"坚毅之核",itemEffect:"core.plugin.addValpp('def', 20);",itemEffectTip:"，基础防御提升20%。",text:""},I62:{cls:"constants",name:"能量回复",text:'拾取能量块后回复${flag:mana_item||15}点能量。每场战斗后回复${flag:mana_regen}点能量${flag:I62_extra_description || ""}',category:"被动技能",canUseItemEffect:true,useItemEffect:'core.insertAction("刷蓝再也不用控攻击了。");',hideInReplay:true},I420:{cls:"constants",name:"绿姐姐的提示",canUseItemEffect:true,useItemEffect:'core.insertCommonEvent("绿姐姐的提示");',text:"包含一些关于本区域的提示信息",category:"永久道具"},I425:{cls:"tools",name:"急救药水",text:"瓶子看上去十分粗糙，将100能量转换为40000生命",itemEffect:null,useItemEffect:'core.status.hero.mana -= 100;\ncore.status.hero.hp += 40000;\ncore.drawHeroAnimate("heal2");',canUseItemEffect:"core.status.hero.mana >= 100",category:"消耗道具"},goldCoin:{cls:"items",name:"金币",text:null,itemEffect:"core.status.hero.money += 500",itemEffectTip:"，金币+500"},I437:{cls:"constants",name:"强化护盾",category:"永久道具",text:'每点护盾能够抵挡${flag:mdef_ratio}点伤害（总共抵挡${flag:mdef_ratio*10*core.getRealStatus("mdef")/10}点伤害）',canUseItemEffect:true,useItemEffect:'core.insertAction("\\"你害怕净化，是因为你护盾不够高。\\"");',hideInReplay:true},I438:{cls:"tools",name:"红葡萄酒",category:"消耗道具",text:"基础攻击提升300点，持续至下一场战斗结束，不可叠加。",canUseItemEffect:'core.getFlag("used_potion", 0) == 0',useItemEffect:'core.setFlag("used_potion", 1);\nvar val = 300;\ncore.setFlag("potion_atk", val);\ncore.status.hero.atk += val;\ncore.updateStatusBar();\ncore.drawHeroAnimate("rage_buff");'},I439:{cls:"tools",name:"蓝莓果汁",category:"消耗道具",text:"基础防御提升200点，持续至下一场战斗结束，不可叠加。",canUseItemEffect:'core.getFlag("used_potion", 0) == 0',useItemEffect:'core.setFlag("used_potion", 1);\nvar val = 200;\ncore.setFlag("potion_def", val);\ncore.status.hero.def += val;\ncore.updateStatusBar();\ncore.drawHeroAnimate("def_buff");'},I440:{cls:"tools",name:"万能药水",category:"消耗道具",text:"能够解除所有异常状态的神药",canUseItemEffect:'core.getFlag("freeze_stack", 0) > 0 || core.getFlag("rage_stack", 0) != 0',useItemEffect:'core.setFlag("freeze_stack", 0);\ncore.setFlag("rage_stack", 0);\ncore.drawHeroAnimate("dispel");\ncore.updateStatusBar();\ncore.setHeroIcon("hero.png");'},I441:{cls:"tools",name:"茉莉清茶",category:"消耗道具",canUseItemEffect:'core.getFlag("used_potion", 0) == 0',useItemEffect:'core.setFlag("used_potion", 1);\nvar val = 1000;\ncore.setFlag("potion_mdef", val);\ncore.status.hero.mdef += val;\ncore.updateStatusBar();\ncore.drawHeroAnimate("mdef_buff");',text:"基础护盾提升1000点，持续至下一场战斗结束，不可叠加。\n瓶子里的东西似乎被人调换过"},superPotion_s:{cls:"items",name:"灵水",itemEffect:"core.status.hero.hp *= 1.05;",itemEffectTip:"，生命值增加5%（${core.formatBigNumber(Math.floor(core.status.hero.hp*5/105))}点)"},leaf:{cls:"equips",name:"小芊叶",text:"虽然看上去只是一片叶子，但是防御+500，且每场战斗后额外回复1能量",equip:{type:1,value:{def:500},percentage:{}},itemEffect:'console.log("烤猫");',itemEffectTip:"烤猫"},skill0_all:{cls:"constants",name:"【主动】一键修复",category:"主动技能",text:"自动不停地释放修复，直到能量耗尽。",canUseItemEffect:"core.status.hero.mana >= core.getFlag('skill0_cost', 10) && core.hasItem(\"skill0\");",useItemEffect:'core.setFlag("skill0_no_animate", 1);\nwhile (core.status.hero.mana >= core.getFlag(\'skill0_cost\', 10)) {\n\tcore.useItem("skill0", true);\n}\ncore.drawHeroAnimate("heal2");\ncore.setFlag("skill0_no_animate", 0);',hideInReplay:true},I_wait:{cls:"constants",name:"【主动】原地等待",category:"主动技能",canUseItemEffect:true,text:"原地等待一回合。快捷键3。",useItemEffect:'if (core.getFlag("70F_boss_phase", 0) == 1) {\n\tcore.autosave(false);\n}\ncore.drawHeroAnimate("yongchang");\ncore.moveOneStep();',hideInReplay:true},skill3:{cls:"constants",name:"【主动】轻风",category:"主动技能",text:'将面前的敌人向后推动${flag:skill3_range||1}格，消耗${flag:skill3_cost || 50}能量。对拥有特殊头衔的敌人无效。${flag:skill3_extra_description||""}快捷键1。',hideInReplay:true,useItemEffect:'var cost = core.getFlag("skill3_cost", 50);\nif (core.status.hero.mana < cost) {\n\tcore.drawTip("能量不足。");\n\tif (!core.isReplaying()) core.playSound("057-Wrong01.ogg");\n} else {\n\tvar nextX = core.nextX();\n\tvar nextY = core.nextY();\n\tvar cls = core.getBlockCls(nextX, nextY);\n\tvar dir = core.status.hero.loc.direction;\n\tvar arrays = core.maps._generateMovableArray_arrays(core.status.floorId);\n\tif (cls != "enemys" && cls != "enemy48") {\n\t\tif (core.getFlag("skill3_push_self", 0) == 0 || core.getBlockId(core.nextX(), core.nextY()) != null) {\n\t\t\tcore.drawTip("没有可推动的物体。");\n\t\t\tif (!core.isReplaying()) core.playSound("002-System02.ogg");\n\t\t} else { // 推自己\n\t\t\tvar prevX = core.status.hero.loc.x,\n\t\t\t\tprevY = core.status.hero.loc.y;\n\t\t\tvar id = core.getBlockId(core.nextX(), core.nextY());\n\t\t\tvar steps = [];\n\t\t\tvar func1 = function (name) { return arrays[name][prevY][prevX]; };\n\t\t\tvar func2 = function (name) { return arrays[name][nextY][nextX]; };\n\t\t\twhile (id == null && nextX >= 0 && nextY >= 0 && nextX < core.bigmap.width && nextY < core.bigmap.height &&\n\t\t\t\t!core.maps._canMoveHero_checkCannotInOut(Object.keys(arrays).map(func1), "cannotOut", dir) &&\n\t\t\t\t!core.maps._canMoveHero_checkCannotInOut(Object.keys(arrays).map(func2), "cannotIn", dir)) {\n\t\t\t\tsteps.push(dir);\n\t\t\t\tswitch (dir) {\n\t\t\t\tcase "up":\n\t\t\t\t\tprevY = nextY;\n\t\t\t\t\tnextY -= 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase "down":\n\t\t\t\t\tprevY = nextY;\n\t\t\t\t\tnextY += 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase "left":\n\t\t\t\t\tprevX = nextX;\n\t\t\t\t\tnextX -= 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase "right":\n\t\t\t\t\tprevX = nextX;\n\t\t\t\t\tnextX += 1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tid = core.getBlockId(nextX, nextY);\n\t\t\t}\n\t\t\tif (steps.length == 0) {\n\t\t\t\tcore.drawTip("推动距离为0！");\n\t\t\t\tif (!core.isReplaying()) core.playSound("002-System02.ogg");\n\t\t\t} else {\n\t\t\t\tcore.autosave();\n\t\t\t\tcore.status.hero.mana -= cost;\n\t\t\t\tcore.drawHeroAnimate("skill3");\n\t\t\t\tvar push_time = 70;\n\t\t\t\tif (core.isReplaying()) push_time = 10; // 这玩意好像实际上并没有生效，咕了\n\t\t\t\tcore.insertAction({ "type": "moveHero", "time": push_time, "steps": steps });\n\t\t\t}\n\t\t\t// return here\n\t\t}\n\t} else {\n\t\tvar mon_id = core.getBlockId(nextX, nextY);\n\t\tvar enemy = core.material.enemys[mon_id];\n\t\tvar can_push = enemy.title == null || enemy.title == "普通";\n\t\tvar actions = [];\n\t\tvar range_remain = core.getFlag("skill3_range", 1);\n\t\tvar dirs = [];\n\t\tswitch (dir) {\n\t\tcase "up":\n\t\t\tvar id = core.getBlockId(nextX, nextY - 1);\n\t\t\tif (id == null && can_push) {\n\t\t\t\tvar func1 = function (name) { return arrays[name][nextY][nextX]; };\n\t\t\t\tvar func2 = function (name) { return arrays[name][nextY - 1][nextX]; };\n\t\t\t\twhile (range_remain > 0 && id == null && nextY > 0 &&\n\t\t\t\t\t!core.maps._canMoveHero_checkCannotInOut(Object.keys(arrays).map(func1), "cannotOut", dir) &&\n\t\t\t\t\t!core.maps._canMoveHero_checkCannotInOut(Object.keys(arrays).map(func2), "cannotIn", dir)) {\n\t\t\t\t\tdirs.push(dir);\n\t\t\t\t\tnextY -= 1;\n\t\t\t\t\trange_remain -= 1;\n\t\t\t\t\tid = core.getBlockId(nextX, nextY - 1);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\tcase "left":\n\t\t\tvar id = core.getBlockId(nextX - 1, nextY);\n\t\t\tif (id == null && can_push) {\n\t\t\t\tvar func1 = function (name) { return arrays[name][nextY][nextX]; };\n\t\t\t\tvar func2 = function (name) { return arrays[name][nextY][nextX - 1]; };\n\t\t\t\twhile (range_remain > 0 && id == null && nextX > 0 &&\n\t\t\t\t\t!core.maps._canMoveHero_checkCannotInOut(Object.keys(arrays).map(func1), "cannotOut", dir) &&\n\t\t\t\t\t!core.maps._canMoveHero_checkCannotInOut(Object.keys(arrays).map(func2), "cannotIn", dir)) {\n\t\t\t\t\tdirs.push(dir);\n\t\t\t\t\tnextX -= 1;\n\t\t\t\t\trange_remain -= 1;\n\t\t\t\t\tid = core.getBlockId(nextX - 1, nextY);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\tcase "right":\n\t\t\tvar id = core.getBlockId(nextX + 1, nextY);\n\t\t\tif (id == null && can_push) {\n\t\t\t\tvar func1 = function (name) { return arrays[name][nextY][nextX]; };\n\t\t\t\tvar func2 = function (name) { return arrays[name][nextY][nextX + 1]; };\n\t\t\t\twhile (range_remain > 0 && id == null && nextX < core.bigmap.width - 1 &&\n\t\t\t\t\t!core.maps._canMoveHero_checkCannotInOut(Object.keys(arrays).map(func1), "cannotOut", dir) &&\n\t\t\t\t\t!core.maps._canMoveHero_checkCannotInOut(Object.keys(arrays).map(func2), "cannotIn", dir)) {\n\t\t\t\t\tdirs.push(dir);\n\t\t\t\t\tnextX += 1;\n\t\t\t\t\trange_remain -= 1;\n\t\t\t\t\tid = core.getBlockId(nextX + 1, nextY);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\tcase "down":\n\t\t\tvar id = core.getBlockId(nextX, nextY + 1);\n\t\t\tif (id == null && can_push) {\n\t\t\t\tvar func1 = function (name) { return arrays[name][nextY][nextX]; };\n\t\t\t\tvar func2 = function (name) { return arrays[name][nextY + 1][nextX]; };\n\t\t\t\twhile (range_remain > 0 && id == null && nextY < core.bigmap.height - 1 &&\n\t\t\t\t\t!core.maps._canMoveHero_checkCannotInOut(Object.keys(arrays).map(func1), "cannotOut", dir) &&\n\t\t\t\t\t!core.maps._canMoveHero_checkCannotInOut(Object.keys(arrays).map(func2), "cannotIn", dir)) {\n\t\t\t\t\tdirs.push(dir);\n\t\t\t\t\tnextY += 1;\n\t\t\t\t\trange_remain -= 1;\n\t\t\t\t\tid = core.getBlockId(nextX, nextY + 1);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\tif (dirs.length == 0) {\n\t\t\tcore.drawTip("推不动！");\n\t\t\tif (!core.isReplaying()) core.playSound("002-System02.ogg");\n\t\t} else {\n\t\t\tvar push_time = 100;\n\t\t\tif (core.isReplaying()) push_time = 10;\n\t\t\tactions.push({ "type": "move", "loc": [core.nextX(), core.nextY()], "steps": dirs, "time": push_time, "keep": true });\n\t\t\tcore.autosave();\n\t\t\tcore.status.hero.mana -= cost;\n\t\t\tif (core.plugin.getTalentLv(3) == 5) {\n\t\t\t\tcore.addFlag("talent3_up5_spe", 1);\n\t\t\t\tif (core.getFlag("talent3_up5_spe", 0) >= 20) {\n\t\t\t\t\tcore.drawHeroAnimate("yongchang");\n\t\t\t\t\tif (core.getFlag("autoUpgradeTalent", 0) > 0) core.plugin._tryUpgrade(3);\n\t\t\t\t}\n\t\t\t} else if (core.plugin.getTalentLv(3) == 8) {\n\t\t\t\tcore.addFlag("talent3_up8_spe", 1);\n\t\t\t\tvar need = 50;\n\t\t\t\tif (flags.hard == 1) need = 35;\n\t\t\t\tif (core.getFlag("talent3_up8_spe", 0) >= need) {\n\t\t\t\t\tcore.drawHeroAnimate("yongchang");\n\t\t\t\t\tif (core.getFlag("autoUpgradeTalent", 0) > 0) core.plugin._tryUpgrade(3);\n\t\t\t\t}\n\t\t\t}\n\t\t\tcore.drawAnimate("skill3", core.nextX(), core.nextY());\n\t\t\tcore.insertAction(actions);\n\t\t}\n\t}\n}',canUseItemEffect:"(function () {\n\treturn true;\n})();"},talentTree:{cls:"constants",name:"神秘徽章",useItemEffect:"core.plugin.openSkillTree();",category:"永久道具",canUseItemEffect:'core.getFlag("talentTree_unlocked", false) && !core.getFlag("talentTree_isOpen", false)',text:"${flag:talentTree_description}",hideInReplay:true},I_breakDoor:{cls:"constants",name:"砸门",text:"${flag:skill4_description}",useItemEffect:'(function () {\n\tcore.status.hero.mana -= 50;\n\tcore.removeBlock(core.nextX(), core.nextY());\n\tcore.drawAnimate("crossattack", core.nextX(), core.nextY());\n})();',canUseItemEffect:"(function () {\n\treturn core.getBlockId(core.nextX(), core.nextY()) == 'yellowDoor';\n})();",category:"主动技能",hideInToolbox:false,hideInReplay:true},skill4:{cls:"constants",name:"【主动】放置莱姆",category:"主动技能",text:"${flag:skill4_description}",useItemEffect:'var cost = core.getFlag("skill4_cost", 100);\nvar nx = core.nextX(1),\n\tny = core.nextY(1);\nvar enabled = nx >= 0 && nx < core.bigmap.width && ny >= 0 && ny < core.bigmap.height &&\n\tcore.getBlockId(nx, ny, null, true) == null;\nif (core.status.hero.mana < cost) {\n\tcore.drawTip("能量不足。");\n\tif (!core.isReplaying()) core.playSound("057-Wrong01.ogg");\n} else if (!enabled) {\n\tcore.drawTip("面前不是空地，无法使用。");\n\tif (!core.isReplaying()) core.playSound("057-Wrong01.ogg");\n} else {\n\tcore.autosave();\n\tcore.status.hero.mana -= cost;\n\tvar res = core.getFlag("skill4_result", "E527");\n\tcore.insertAction({ "type": "setBlock", "number": res, "loc": [core.nextX(1), core.nextY(1)] });\n\tcore.drawAnimate("yongchang", core.nextX(1), core.nextY(1));\n}',canUseItemEffect:"true",hideInReplay:true},sword6:{cls:"equips",name:"噬魂之锋",text:"据说会逐渐侵蚀使用者的灵魂。攻击+70%，防御+60%，护盾-40%，前10次攻击吸取10%生命。",equip:{type:0,animate:"jianji2",value:{},percentage:{mdef:-40,def:60,atk:70}},itemEffect:"core.status.hero.def += 0",itemEffectTip:"，防御+0"},sword7:{cls:"equips",name:"无锋重剑",equip:{type:0,animate:"skill2",value:{},percentage:{def:70,atk:40}},text:"像盾牌的重剑。攻击+40%，防御+70%，令每点护盾额外抵挡0.35点伤害。"},hugeGreenPotion:{cls:"items",name:"巨绿血瓶",itemEffect:"core.status.hero.hp += 100 * core.values.greenPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1)",itemEffectTip:"，生命+${core.formatBigNumber(100*core.values.greenPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1))}"},hugeRedPotion:{cls:"items",name:"巨红血瓶",itemEffect:"core.status.hero.hp += 100 * core.values.redPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1)",itemEffectTip:"，生命+${core.formatBigNumber(100*core.values.redPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1))}"},hugeBluePotion:{cls:"items",name:"巨蓝血瓶",itemEffect:"core.status.hero.hp += 100 * core.values.bluePotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1)",itemEffectTip:"，生命+${core.formatBigNumber(100*core.values.bluePotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1))}"},hugeYellowPotion:{cls:"items",name:"巨黄血瓶",itemEffect:"core.status.hero.hp += 100 * core.values.yellowPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1)",itemEffectTip:"，生命+${core.formatBigNumber(100*core.values.yellowPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1))}"},skill5:{cls:"constants",name:"鸽化",canUseItemEffect:'!(core.getFlag("skill5_is_on", false)) || (core.getTalentLv(10) > 0) || (core.getTalentLv(12) > 0)',category:"主动技能",text:"${flag:skill5_description}冷却剩余${flag:skill5_cd}次战斗。",useItemEffect:'if (core.getFlag("skill5_cd", 0) > 0) {\n\tcore.drawTip("还需经过" + core.getFlag("skill5_cd", 0) + "次战斗才能使用。");\n\tif (!core.isReplaying()) core.playSound("057-Wrong01.ogg");\n} else {\n\tif (core.getTalentLv(10) > 0) { // 攻防\n\t\tif (core.getFlag("skill5_is_on", false)) { // 手动关闭\n\t\t\tcore.autosave();\n\t\t\tcore.insertCommonEvent("AD不鸽了");\n\t\t} else {\n\t\t\tvar cost = 0;\n\t\t\tif (core.status.hero.mana < cost) {\n\t\t\t\tcore.drawTip("能量不足。");\n\t\t\t\tif (!core.isReplaying()) core.playSound("057-Wrong01.ogg");\n\t\t\t} else {\n\t\t\t\tcore.autosave();\n\t\t\t\tcore.status.hero.mana -= cost;\n\t\t\t\tcore.insertCommonEvent("鸽化AD");\n\t\t\t}\n\t\t}\n\t} else if (core.getTalentLv(11) > 0) { // 攻盾\n\t\tvar cost = 60;\n\t\tif (core.status.hero.mana < cost) {\n\t\t\tcore.drawTip("能量不足。");\n\t\t\tif (!core.isReplaying()) core.playSound("057-Wrong01.ogg");\n\t\t} else {\n\t\t\tcore.autosave();\n\t\t\tcore.status.hero.mana -= cost;\n\t\t\tcore.insertCommonEvent("鸽化AM");\n\t\t}\n\t} else if (core.getTalentLv(12) > 0) { // 防盾\n\t\tif (core.getFlag("skill5_is_on", false)) { // 手动关闭\n\t\t\tcore.autosave();\n\t\t\tcore.insertCommonEvent("DM不鸽了");\n\t\t} else {\n\t\t\tvar cost = 0;\n\t\t\tif (core.status.hero.mana < cost) {\n\t\t\t\tcore.drawTip("能量不足。");\n\t\t\t\tif (!core.isReplaying()) core.playSound("057-Wrong01.ogg");\n\t\t\t} else {\n\t\t\t\tcore.autosave();\n\t\t\t\tcore.status.hero.mana -= cost;\n\t\t\t\tcore.insertCommonEvent("鸽化DM");\n\t\t\t}\n\t\t}\n\t}\n}',hideInReplay:true},I592:{cls:"tools",name:"珍藏版绿钥匙-2",category:"消耗道具",text:"【荣誉物品】前两章剩余的绿钥匙，与之后的绿钥匙相独立。",canUseItemEffect:"false",hideInReplay:true},DScore:{cls:"tools",name:"副本分数",itemEffect:null,itemEffectTip:null,category:"消耗道具",canUseItemEffect:"false",text:"副本挑战模式的分数"},skill6:{cls:"constants",name:"【主动】后抛",text:'将面前的敌人扔到自己身后，消耗${flag:skill6_cost}能量。对拥有特殊头衔的敌人无效。${flag:skill6_extra_description||""}快捷键1。',category:"主动技能",hideInReplay:true,canUseItemEffect:"(function () {\n\treturn true;\n})();",useItemEffect:'var cost = core.getFlag("skill6_cost", 641);\nif (core.status.hero.mana < cost) {\n\tcore.drawTip("能量不足。");\n\tif (!core.isReplaying()) core.playSound("057-Wrong01.ogg");\n} else {\n\tvar nextX = core.nextX();\n\tvar nextY = core.nextY();\n\tvar cls = core.getBlockCls(nextX, nextY);\n\tvar dir = core.status.hero.loc.direction;\n\tvar arrays = core.maps._generateMovableArray_arrays(core.status.floorId);\n\n\tvar time = 500;\n\tif (core.isReplaying()) time = 10;\n\tvar actions = [];\n\tvar dxy, back_id;\n\tif (cls != "enemys" && cls != "enemy48") {\n\t\tvar tmp_id = core.getBlockId(nextX, nextY);\n\t\tvar can_throw_id_list = ["yellowDoor", "yellowKey", "blueKey", "redKey", "redPotion", "bluePotion", "yellowPotion", "greenPotion", "bigRedPotion", "bigBluePotion", "bigYellowPotion", "bigGreenPotion", "manaItem", "hugeRedPotion", "hugeBluePotion", "hugeYellowPotion", "hugeGreenPotion"];\n\t\tif (core.getTalentLv2(6) == 1 && can_throw_id_list.indexOf(tmp_id) >= 0) { // 抛门\n\t\t\tswitch (dir) {\n\t\t\tcase "up":\n\t\t\t\tback_id = core.getBlockId(nextX, nextY + 2);\n\t\t\t\tdxy = [0, 2];\n\t\t\t\tbreak;\n\t\t\tcase "left":\n\t\t\t\tback_id = core.getBlockId(nextX + 2, nextY);\n\t\t\t\tdxy = [2, 0];\n\t\t\t\tbreak;\n\t\t\tcase "right":\n\t\t\t\tback_id = core.getBlockId(nextX - 2, nextY);\n\t\t\t\tdxy = [-2, 0];\n\t\t\t\tbreak;\n\t\t\tcase "down":\n\t\t\t\tback_id = core.getBlockId(nextX, nextY - 2);\n\t\t\t\tdxy = [0, -2];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar targetX = nextX + dxy[0];\n\t\t\tvar targetY = nextY + dxy[1];\n\t\t\tvar should_throw = targetX >= 0 && targetX < core.bigmap.width && targetY >= 0 && targetY < core.bigmap.height && back_id == null;\n\t\t\tif (should_throw) {\n\t\t\t\tcore.autosave();\n\t\t\t\tif (core.status.hero.followers.length > 0) {\n\t\t\t\t\tactions.push({ "type": "unfollow", "name": "hero3.png" }, { "type": "follow", "name": "hero3.png" });\n\t\t\t\t}\n\t\t\t\tactions.push({ "type": "jump", "from": [nextX, nextY], "dxy": dxy, "time": time, "keep": true });\n\t\t\t\tcore.status.hero.mana -= cost;\n\t\t\t\tcore.drawAnimate("skill6", nextX, nextY);\n\t\t\t\tcore.insertAction(actions);\n\t\t\t} else {\n\t\t\t\tcore.drawTip("背后不是空地！");\n\t\t\t\tif (!core.isReplaying()) core.playSound("002-System02.ogg");\n\t\t\t}\n\t\t} else {\n\t\t\tcore.drawTip("没有可抛掷的物体。");\n\t\t\tif (!core.isReplaying()) core.playSound("002-System02.ogg");\n\t\t\t// return here\n\t\t}\n\t} else {\n\t\tvar mon_id = core.getBlockId(nextX, nextY);\n\t\tvar enemy = core.material.enemys[mon_id];\n\t\tvar can_throw = enemy.title == null || enemy.title == "普通";\n\t\tswitch (dir) {\n\t\tcase "up":\n\t\t\tback_id = core.getBlockId(nextX, nextY + 2);\n\t\t\tdxy = [0, 2];\n\t\t\tbreak;\n\t\tcase "left":\n\t\t\tback_id = core.getBlockId(nextX + 2, nextY);\n\t\t\tdxy = [2, 0];\n\t\t\tbreak;\n\t\tcase "right":\n\t\t\tback_id = core.getBlockId(nextX - 2, nextY);\n\t\t\tdxy = [-2, 0];\n\t\t\tbreak;\n\t\tcase "down":\n\t\t\tback_id = core.getBlockId(nextX, nextY - 2);\n\t\t\tdxy = [0, -2];\n\t\t\tbreak;\n\t\t}\n\t\tvar targetX = nextX + dxy[0];\n\t\tvar targetY = nextY + dxy[1];\n\t\tvar should_throw = targetX >= 0 && targetX < core.bigmap.width && targetY >= 0 && targetY < core.bigmap.height && back_id == null;\n\t\tif (!can_throw) {\n\t\t\tcore.drawTip("扔不动！");\n\t\t\tif (!core.isReplaying()) core.playSound("002-System02.ogg");\n\t\t} else if (should_throw) {\n\t\t\tcore.autosave();\n\t\t\tif (core.status.hero.followers.length > 0) {\n\t\t\t\tactions.push({ "type": "unfollow", "name": "hero3.png" }, { "type": "follow", "name": "hero3.png" });\n\t\t\t}\n\t\t\tactions.push({ "type": "jump", "from": [nextX, nextY], "dxy": dxy, "time": time, "keep": true });\n\t\t\tcore.status.hero.mana -= cost;\n\t\t\tcore.drawAnimate("skill6", nextX, nextY);\n\t\t\tcore.insertAction(actions);\n\t\t} else if (core.getTalentLv2(1) > 0) { // 气旋\n\t\t\tcore.autosave();\n\t\t\t// 背后不是空地，强制战斗\n\t\t\tcore.setFlag("skill6_battle", 1);\n\t\t\tactions.push({ "type": "jump", "from": [nextX, nextY], "dxy": [0, 0], "time": time, "keep": true }, { "type": "battle", "loc": [nextX, nextY] });\n\t\t\tcore.status.hero.mana -= cost;\n\t\t\tcore.drawAnimate("skill6", nextX, nextY);\n\t\t\tcore.insertAction(actions);\n\t\t} else {\n\t\t\tcore.drawTip("背后不是空地！");\n\t\t\tif (!core.isReplaying()) core.playSound("002-System02.ogg");\n\t\t}\n\t}\n}'},redGem5:{cls:"items",name:"五阶红宝石",itemEffect:"core.status.hero.atk += 16 * core.values.redGem * core.status.thisMap.ratio",itemEffectTip:"，攻击+${16*core.values.redGem * core.status.thisMap.ratio}"},blueGem5:{cls:"items",name:"五阶蓝宝石",itemEffect:"core.status.hero.def += 16 * core.values.blueGem * core.status.thisMap.ratio",itemEffectTip:"，防御+${16*core.values.blueGem * core.status.thisMap.ratio}"},blueGem6:{cls:"items",name:"六阶蓝宝石",itemEffect:"core.status.hero.def += 32 * core.values.blueGem * core.status.thisMap.ratio",itemEffectTip:"，防御+${32*core.values.blueGem * core.status.thisMap.ratio}"},blueGem7:{cls:"items",name:"七阶蓝宝石",itemEffect:"core.status.hero.def += 64 * core.values.blueGem * core.status.thisMap.ratio",itemEffectTip:"，防御+${64*core.values.blueGem * core.status.thisMap.ratio}"},blueGem8:{cls:"items",name:"八阶蓝宝石",itemEffect:"core.status.hero.def += 128 * core.values.blueGem * core.status.thisMap.ratio",itemEffectTip:"，防御+${128*core.values.blueGem * core.status.thisMap.ratio}"},redGem6:{cls:"items",name:"六阶红宝石",itemEffect:"core.status.hero.atk += 32 * core.values.redGem * core.status.thisMap.ratio",itemEffectTip:"，攻击+${32*core.values.redGem * core.status.thisMap.ratio}"},redGem7:{cls:"items",name:"七阶红宝石",itemEffect:"core.status.hero.atk += 64 * core.values.redGem * core.status.thisMap.ratio",itemEffectTip:"，攻击+${64 * core.values.redGem * core.status.thisMap.ratio}"},redGem8:{cls:"items",name:"八阶红宝石",itemEffect:"core.status.hero.atk += 128 * core.values.redGem * core.status.thisMap.ratio",itemEffectTip:"，攻击+${128*core.values.redGem * core.status.thisMap.ratio}"},greenGem5:{cls:"items",name:"五阶绿宝石",itemEffect:"core.status.hero.mdef += 16 * core.values.greenGem * core.status.thisMap.ratio",itemEffectTip:"，护盾+${16*core.values.greenGem * core.status.thisMap.ratio}"},greenGem6:{cls:"items",name:"六阶绿宝石",itemEffect:"core.status.hero.mdef += 32 * core.values.greenGem * core.status.thisMap.ratio",itemEffectTip:"，护盾+${32*core.values.greenGem * core.status.thisMap.ratio}"},greenGem7:{cls:"items",name:"七阶绿宝石",itemEffect:"core.status.hero.mdef += 64 * core.values.greenGem * core.status.thisMap.ratio",itemEffectTip:"，护盾+${64*core.values.greenGem * core.status.thisMap.ratio}"},greenGem8:{cls:"items",name:"八阶绿宝石",itemEffect:"core.status.hero.mdef += 128 * core.values.greenGem * core.status.thisMap.ratio",itemEffectTip:"，护盾+${128*core.values.greenGem * core.status.thisMap.ratio}"},sword8:{cls:"equips",name:"神圣剑",equip:{type:0,animate:"sword8",value:{atk:6000},percentage:{}},text:"远古时代的传说级装备，攻击+6000"},shield8:{cls:"equips",name:"神圣盾",equip:{type:1,value:{def:6000},percentage:{}},text:"远古时代的传说级装备，防御+6000"},skill7:{cls:"constants",name:"【主动】潜行",category:"主动技能",text:"进入隐身状态，不会触发地图伤害，持续到下次进行战斗前。消耗${flag:skill7_cost}能量。主动取消或完成总伤害不大于0的战斗会返还${flag:skill7_cancel_return_cost}点能量。快捷键2。",hideInReplay:true,canUseItemEffect:"(function () {\n\treturn true;\n})();",useItemEffect:'var cost = core.getFlag("skill7_cost", 100);\nif (core.getFlag("invisible", 0) == 0) {\n\tif (core.status.hero.mana < cost) {\n\t\tcore.drawTip("能量不足。");\n\t\tif (!core.isReplaying()) core.playSound("057-Wrong01.ogg");\n\t} else {\n\t\tcore.status.hero.mana -= cost;\n\t\tcore.insertCommonEvent("进入隐身");\n\t}\n} else {\n\tif (core.getFlag("invisible_moved") == 2221) {\n\t\tcore.status.hero.mana += cost;\n\t\tcore.insertCommonEvent("退出隐身", [0]);\n\t\tcore.insertAction({\n\t\t\t"type": "choices",\n\t\t\t"text": "\\t[系统提示]恭喜获得成就【薅羊毛】！这多出来的25能量就作为奖励送给你了。",\n\t\t\t"choices": [{\n\t\t\t\t"text": "？？？！",\n\t\t\t\t"action": []\n\t\t\t}, ]\n\t\t});\n\t} else if (core.getFlag("invisible_moved") == 0) {\n\t\tcore.status.hero.mana += cost;\n\t\tcore.insertCommonEvent("退出隐身", [0]);\n\t} else {\n\t\tcore.insertCommonEvent("退出隐身", [1]);\n\t}\n}'},talentTree2:{cls:"constants",name:"魔法书",category:"永久道具",useItemEffect:"core.plugin.openSkillTree2();",canUseItemEffect:'!core.getFlag("talentTree_isOpen", false)',hideInReplay:true,text:"神秘的魔法书，开启第四章前篇的天赋树"},I_noVampire:{cls:"constants",name:"仙域甲",category:"永久道具",text:"无视敌人的吸血属性",canUseItemEffect:true,useItemEffect:'core.insertAction("为对付吸血属性专门设计的铠甲，但无法应对许多伪吸血属性，比如 窥 血 为 攻。");'},I_zzzl:{cls:"constants",name:"至尊之录",category:"永久道具",canUseItemEffect:true,useItemEffect:'core.insertCommonEvent("至尊之录");',text:"不知是谁写的",hideInReplay:true},skill8:{cls:"constants",name:"【主动】跳跃",category:"主动技能",useItemEffect:'var nx = core.nextX(2),\n\tny = core.nextY(2);\nvar canjump = nx >= 0 && nx < core.bigmap.width && ny >= 0 && ny < core.bigmap.height && core.getBlockId(nx, ny) == null;\nvar reason = "落脚点不是空地！";\nif (core.plugin.getTalentLv2(3) < 1) {\n\tvar block_class = core.getBlockCls(core.nextX(1), core.nextY(1));\n\tif (core.getBlockId(core.nextX(1), core.nextY(1)) != null && block_class != "enemys" && block_class != "enemy48" && block_class != "items") {\n\t\tcanjump = false;\n\t\treason = "只能跃过敌人或物品上方！";\n\t}\n}\nvar cost = 200;\nif (canjump) {\n\tif (core.status.hero.mana < cost) {\n\t\tcore.drawTip("能量不足。");\n\t\tif (!core.isReplaying()) core.playSound("057-Wrong01.ogg");\n\t} else {\n\t\tcore.autosave();\n\t\tcore.status.hero.mana -= cost;\n\t\tcore.drawHeroAnimate("skill6");\n\t\tvar actions = [{ "type": "jumpHero", "loc": [nx, ny] }];\n\t\tif (core.getFlag("talent2_7_lv", 0) > 0) {\n\t\t\tactions.push({ "type": "insert", "name": "skill8buff" });\n\t\t}\n\t\tcore.insertAction(actions);\n\t}\n} else {\n\tcore.drawTip(reason);\n\tif (!core.isReplaying()) core.playSound("057-Wrong01.ogg");\n}',canUseItemEffect:true,hideInReplay:true,text:'跳跃到前方两格的空地，消耗200能量。${flag:skill8_extra_description||""}快捷键3。'},I_Chap4Shop4:{cls:"items",name:"快捷商店4",text:"打开第四章的商店，快捷键V",canUseItemEffect:"(function () {\n\treturn true;\n})();",useItemEffect:'core.openShop("Chap4Shop4");',category:"永久道具",hideInReplay:true},I_greenKeyCh3:{cls:"tools",name:"珍藏版绿钥匙-3",text:"【荣誉物品】第三章和第四章省下来的绿钥匙，与之后的绿钥匙相独立。",hideInReplay:true,canUseItemEffect:"false",category:"消耗道具",useItemEffect:null},I_superGreenKey:{cls:"constants",name:"万能绿钥匙",canUseItemEffect:true,category:"永久道具",text:"能够无限制地开启绿门",useItemEffect:'core.insertAction("再也不用纠结要不要开绿门了——虽然，有些人从来都没纠结过。");'},skill9:{cls:"constants",name:"至尊飞升",canUseItemEffect:"true",text:"每次战斗后，攻防盾永久提升1%",category:"被动技能",useItemEffect:'core.insertAction("这个技能竟然不是上勾拳？");',hideInReplay:true},skill10:{cls:"constants",name:"【主动】毁灭重拳",canUseItemEffect:"true",category:"主动技能",text:"向前冲刺最多${flag:skill10_range}格，拾取沿途的物品；停止时降低3*3范围内所有敌人${core.formatBigNumber(flag:skill10_ddef)}点防御，不可叠加；${flag:skill10_desc2}，然后临时护盾衰减1步。${flag:skill10_desc3}消耗${flag:skill10_cost+core.getTalentLv3(3)}能量。快捷键1。\\n",hideInReplay:true,useItemEffect:'var cost = core.getFlag("skill10_cost", 0) + core.getTalentLv3(3);\nif (core.status.hero.mana < cost) {\n\tcore.drawTip("能量不足。");\n\tif (!core.isReplaying()) core.playSound("057-Wrong01.ogg");\n} else {\n\tvar actions = [],\n\t\tactions2 = [];\n\tvar nextX = core.nextX();\n\tvar nextY = core.nextY();\n\tvar cls = core.getBlockCls(nextX, nextY);\n\tvar dir = core.status.hero.loc.direction;\n\tvar arrays = core.maps._generateMovableArray_arrays(core.status.floorId);\n\tvar range_remain = core.getFlag("skill10_range", 2221);\n\tvar prevX = core.status.hero.loc.x,\n\t\tprevY = core.status.hero.loc.y;\n\tvar autopickitems = true;\n\tif (cls != "enemys" && cls != "enemy48") { // 推自己\n\t\tvar id = core.getBlockId(nextX, nextY);\n\t\tvar func1 = function (name) { return arrays[name][prevY][prevX]; };\n\t\tvar func2 = function (name) { return arrays[name][nextY][nextX]; };\n\t\twhile (range_remain > 0 && (id == null || (autopickitems && cls == "items")) &&\n\t\t\tnextX >= 0 && nextY >= 0 && nextX < core.bigmap.width && nextY < core.bigmap.height &&\n\t\t\t!core.maps._canMoveHero_checkCannotInOut(Object.keys(arrays).map(func1), "cannotOut", dir) &&\n\t\t\t!core.maps._canMoveHero_checkCannotInOut(Object.keys(arrays).map(func2), "cannotIn", dir)) {\n\t\t\tif (autopickitems && cls == "items") {\n\t\t\t\t//actions2.push({ "type": "function", "function": "function(){core.trigger(" + nextX + "," + nextY + ");}" });\n\t\t\t\tactions2.push({ "type": "function", "function": "function(){core.events.getNextItem(true);}" });\n\t\t\t}\n\t\t\tactions2.push({ "type": "moveHero", "time": 37, "steps": [dir] });\n\t\t\trange_remain -= 1;\n\t\t\tswitch (dir) {\n\t\t\tcase "up":\n\t\t\t\tprevY = nextY;\n\t\t\t\tnextY -= 1;\n\t\t\t\tbreak;\n\t\t\tcase "down":\n\t\t\t\tprevY = nextY;\n\t\t\t\tnextY += 1;\n\t\t\t\tbreak;\n\t\t\tcase "left":\n\t\t\t\tprevX = nextX;\n\t\t\t\tnextX -= 1;\n\t\t\t\tbreak;\n\t\t\tcase "right":\n\t\t\t\tprevX = nextX;\n\t\t\t\tnextX += 1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tid = core.getBlockId(nextX, nextY);\n\t\t\tcls = core.getBlockCls(nextX, nextY);\n\t\t}\n\t\tif (actions2.length > 0) {\n\t\t\t// 这里的另一种实现方式是用 moveAction，不同之处在于 moveAction 默认情况下会触发地图伤害\n\t\t\t//actions.push({ "type": "function", "function": "function(){core.setFlag(\'originalMovespeed\',core.values.moveSpeed); core.values.moveSpeed = 37; }" });\n\t\t\tactions.push({ "type": "setValue", "name": "flag:moveShadow", "value": "1" }, { "type": "setValue", "name": "flag:skill10Moving", "value": "1" }, { "type": "playSound", "name": "skill10pre.mp3" });\n\t\t\tfor (var i in actions2) {\n\t\t\t\tactions.push(actions2[i]);\n\t\t\t}\n\t\t\tactions.push({ "type": "setValue", "name": "flag:moveShadow", "value": "0" }, { "type": "setValue", "name": "flag:skill10Moving", "value": "0" });\n\t\t\t//actions.push({ "type": "function", "function": "function(){core.values.moveSpeed = core.getFlag(\'originalMovespeed\',100);core.removeFlag(\'originalMovespeed\');}" });\n\t\t}\n\t}\n\n\tactions.push({ "type": "vibrate", "direction": "horizontal", "time": 100, "speed": 10, "power": 10, "async": true }, { "type": "animate", "name": "darkexplode", "loc": "hero", "async": true });\n\n\t// deal damage\n\tactions.push({ "type": "function", "function": "function(){\\ncore.plugin.doSkill10();\\n}" });\n\n\t// 这里逻辑与 doSkill10 重复\n\tvar cnt = 0,\n\t\trange = 1;\n\tfor (var i = prevX - range; i <= prevX + range; ++i) {\n\t\tfor (var j = prevY - range; j <= prevY + range; ++j) {\n\t\t\tif (core.plugin.isEnemy(i, j)) {\n\t\t\t\tcnt += 1;\n\t\t\t}\n\t\t}\n\t}\n\tif (cnt == 0) {\n\t\tcost -= core.getFlag("skill10_ret_mana", 0);\n\t}\n\tcore.autosave();\n\tcore.addFlag("skill10_use_time", 1);\n\tcore.addFlag("skill10_hit_enemy", cnt);\n\tcore.status.hero.mana -= cost;\n\t/*\n\tif (core.getTalentLv3(1) == 1 && core.getFlag("skill10_use_time") >= 10) {\n\t\tcore.drawHeroAnimate("yongchang");\n\t\tif (core.getFlag("autoUpgradeTalent", 0) > 0) core.plugin._tryUpgrade3(1);\n\t} else if (core.getTalentLv3(1) == 2 && core.getFlag("skill10_hit_enemy") >= 50) {\n\t\tcore.drawHeroAnimate("yongchang");\n\t\tif (core.getFlag("autoUpgradeTalent", 0) > 0) {\n\t\t\tcore.plugin._tryUpgrade3(1);\n\t\t\tif (core.getTalentLv3(3) >= 25) { core.plugin._tryUpgrade3(1); }\n\t\t\tif (core.getTalentLv3(3) >= 60) { core.plugin._tryUpgrade3(1); }\n\t\t}\n\t}*/\n\tactions.push({ "type": "function", "function": "function(){\\nif (core.getTalentLv3(1) == 1 && core.getFlag(\\"skill10_use_time\\") >= 10) {\\n\\tcore.drawHeroAnimate(\\"yongchang\\");\\n\\tif (core.getFlag(\\"autoUpgradeTalent\\", 0) > 0) core.plugin._tryUpgrade3(1);\\n} else if (core.getTalentLv3(1) == 2 && core.getFlag(\\"skill10_hit_enemy\\") >= 50) {\\n\\tcore.drawHeroAnimate(\\"yongchang\\");\\n\\tif (core.getFlag(\\"autoUpgradeTalent\\", 0) > 0) {\\n\\t\\tcore.plugin._tryUpgrade3(1);\\n\\t\\tif (core.getTalentLv3(3) >= 25) { core.plugin._tryUpgrade3(1); }\\n\\t\\tif (core.getTalentLv3(3) >= 60) { core.plugin._tryUpgrade3(1); }\\n\\t}\\n}\\n}" });\n\tcore.insertAction(actions);\n}'},skill11:{cls:"constants",name:"【被动】最佳防守",canUseItemEffect:"true",text:'每次战斗后获得1层临时护盾，每移动一步失去${flag:skill11_decay_pp / 100}层。每层临时护盾提供${flag:skill11_add}%基础护盾值，最多拥有${flag:skill11_upbound}层。当前拥有${flag:temp_mdef_pp||0}%基础值（${flag:temp_mdef_pp*core.status.hero.mdef/100||0}点）临时护盾。转换地图后层数清零。${flag:skill11_desc || ""}\\n',hideInReplay:true,category:"被动技能",useItemEffect:'core.insertAction("每次战斗后获得\\r[yellow]" + core.getFlag("skill11_add") + "%\\r基础护盾值的临时护盾，每移动一步失去\\r[yellow]" + (core.getFlag("skill11_add") * core.getFlag("skill11_decay_pp") / 100) + "%\\r护盾；最多拥有\\r[yellow]" + (core.getFlag("skill11_add") * core.getFlag("skill11_upbound")) + "%\\r的临时护盾。\\n当前拥有\\r[orange]" + core.getFlag("temp_mdef_pp") + "%\\r基础值（\\r[green]" + core.status.hero.mdef + "\\r），\\n共\\r[lime]" + core.getFlag("temp_mdef_pp") * core.status.hero.mdef / 100 + "\\r点临时护盾。");'},skill12:{cls:"constants",name:"【主动】裂地重拳",canUseItemEffect:"true",category:"主动技能",text:"跳向面前2格，落地后触发面前一排三格的物体，并将面前第二排三格的物体拉向自身；受到此技能作用的敌人降低${core.formatBigNumber(flag:skill12_datk)}点攻击，不可叠加；每击中一个敌人获得${flag:skill12_hit_ret}能量，并回复临时护盾数值${flag:skill12_drain_ratio}%的生命。消耗${flag:skill12_cost + core.getTalentLv3(3)}点能量。快捷键2。\\n",hideInReplay:true,useItemEffect:'core.insertCommonEvent("doSkill12");'},skill13:{cls:"constants",name:"【奥义】毁 天 灭 地",canUseItemEffect:'(function () {\n\tvar toX = core.getFlag("temp_skill13_x"),\n\t\ttoY = core.getFlag("temp_skill13_y");\n\tvar id = core.getBlockId(toX, toY);\n\treturn id == null || core.plugin.isEnemy(toX, toY) || core.getBlockCls(toX, toY) == "items";\n})();',text:"跳到空中，然后落在原地或者中心对称位置的空地/物品/敌人头上。落地后降低附近敌人${core.formatBigNumber(flag:skill13_datk)}点攻防（不与其他技能效果叠加），并造成满额临时护盾爆炸的范围伤害；对落点处敌人造成的伤害加倍，并且强制与其战斗。之后获得3层临时护盾。每次使用本技能后消耗变为2000能量，每次战斗后消耗降低${flag:skill13_cost_reduce}点，当前消耗为${flag:skill13_cost}点。快捷键3。",category:"主动技能",hideInReplay:true,useItemEffect:"core.insertCommonEvent(\"毁天灭地\");\n/*core.playSound('DF_q_1.mp3');\ncore.playSound('DF_q_2.mp3');\ncore.clearMap('hero');\ncore.setHeroLoc('x', core.bigmap.width - 1 - core.getHeroLoc('x'));\ncore.setHeroLoc('y', core.bigmap.height - 1 - core.getHeroLoc('y'));\ncore.drawHero();\ncore.drawTip(core.material.items[itemId].name + '使用成功');*/"},talentTree3:{cls:"constants",name:"毁灭拳套",canUseItemEffect:'!core.getFlag("talentTree_isOpen", false)',category:"永久道具",hideInReplay:true,useItemEffect:"core.plugin.openSkillTree3();",text:"蕴含惊人力量的拳套，开启第四章后篇的天赋树，快捷键V"},I_config:{cls:"constants",name:"系统设置",canUseItemEffect:"true",hideInReplay:true,category:"永久道具",useItemEvent:[{type:"while",condition:"true",data:[{type:"if",condition:"flag:config_page == 0","true":[{type:"choices",text:"\t[系统设置]",choices:[{text:"返回",action:[{type:"exit"}]},{text:"使用作者推荐的设置",color:[255,215,0,1],action:[{type:"function","function":"function(){\ncore.setFlag('autoGetItem', 1);\ncore.setFlag('autoBattle', 1);\ncore.setFlag('itemDetail', 0);\ncore.setFlag('MonHPMode', 0);\ncore.setFlag('autoUpgradeTalent', 1);\ncore.updateDamage();\n}"},"设置完成！"]},{text:'自动拾取: ${core.getFlag("autoGetItem",0)==1?"On":"Off"}',action:[{type:"function","function":"function(){\ncore.getFlag('autoGetItem', 0) == 0 ? core.setFlag('autoGetItem', 1) : core.setFlag('autoGetItem', 0);\n}"}]},{text:'自动清怪: ${core.getFlag("autoBattle",0)==1?"On":"Off"}',action:[{type:"function","function":"function(){\ncore.getFlag(\"autoBattle\", 0) == 0 ? core.setFlag('autoBattle', 1) : core.setFlag('autoBattle', 0);\n}"}]},{text:'物品显伤: ${core.getFlag("itemDetail",0)==0?"Off":"On"}',action:[{type:"function","function":"function(){\nif (core.getFlag('itemDetail', 0) == 0) {\n\tcore.setFlag('itemDetail', 1);\n} else {\n\tcore.setFlag('itemDetail', 0);\n\tcore.removeFlag(\"itemDetailCache\");\n}\ncore.updateDamage();\n}"}]},{text:'怪物显血: ${core.getFlag("MonHPMode",0)==0?"百分比":"数字"}',action:[{type:"function","function":"function(){\ncore.getFlag('MonHPMode', 0) == 0 ? core.setFlag('MonHPMode', 1) : core.setFlag('MonHPMode', 0);\ncore.updateDamage();\n}"}]},{text:'天赋自动升级: ${core.getFlag("autoUpgradeTalent",0)==1?"On":"Off"}',action:[{type:"function","function":"function(){\ncore.getFlag('autoUpgradeTalent', 0) == 0 ? core.setFlag('autoUpgradeTalent', 1) : core.setFlag('autoUpgradeTalent', 0);\n}"}]},{text:"下一页",action:[{type:"setValue",name:"flag:config_page",value:"1"}]}]}]},{type:"if",condition:"flag:config_page == 1","true":[{type:"choices",text:"\t[系统设置,I_config]",choices:[{text:"返回",action:[{type:"setValue",name:"flag:config_page",value:"0"},{type:"exit"}]},{text:'不显示天气: ${core.getFlag("no_weather",0)==0?"Off":"On"}',action:[{type:"function","function":"function(){\ncore.getFlag('no_weather', 0) == 0 ? core.setFlag('no_weather', 1) : core.setFlag('no_weather', 0);\ncore.updateWeather();\n}"}]},{text:'关闭消散特效: ${core.getFlag("no_flashHide",0)==0?"Off":"On"}',action:[{type:"function","function":"function(){\ncore.getFlag('no_flashHide', 0) == 0 ? core.setFlag('no_flashHide', 1) : core.setFlag('no_flashHide', 0);\n}"}]}]}]}]}],text:"可设置自动拾取等功能。部分配置只有在部分章节有用。如果出现卡顿，调整第二页的某些配置可能会有帮助。"},goldCoin2:{cls:"items",name:"紫金币",canUseItemEffect:"true",itemEffect:"core.status.hero.money += 1500",itemEffectTip:"，金币+1500"},I_cat:{cls:"equips",name:"玩偶猫",canUseItemEffect:"true",text:"猫猫能有什么坏心思呢~\\n获取后免疫“誓仇”，装备时再提升30000点基础防御",category:"永久道具",useItemEvent:null,equip:{type:1,value:{def:30000},percentage:{}}},sword9:{cls:"equips",name:"斩魔刀",canUseItemEffect:"true",text:"似乎是世外的观察者都被虎魔帮恶心到了，降下惩戒之力凝聚成这把武器\\n提升16000点基础攻击",equip:{type:0,value:{atk:16000},percentage:{}},category:"永久道具"},redGem9:{cls:"items",name:"九阶红宝石",canUseItemEffect:"true",itemEffect:"core.status.hero.atk += 256 * core.values.redGem * core.status.thisMap.ratio",itemEffectTip:"，攻击+${256*core.values.redGem * core.status.thisMap.ratio}"},blueGem9:{cls:"items",name:"九阶蓝宝石",canUseItemEffect:"true",itemEffect:"core.status.hero.def += 256 * core.values.blueGem * core.status.thisMap.ratio",itemEffectTip:"，防御+${256*core.values.blueGem * core.status.thisMap.ratio}"},greenGem9:{cls:"items",name:"九阶绿宝石",canUseItemEffect:"true",itemEffect:"core.status.hero.mdef += 256 * core.values.greenGem * core.status.thisMap.ratio",itemEffectTip:"，护盾+${256*core.values.greenGem * core.status.thisMap.ratio}"},giantRedPotion:{cls:"items",name:"巨大红血瓶",canUseItemEffect:"true",itemEffect:"core.status.hero.hp += 1000 * core.values.redPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1)",itemEffectTip:"，生命+${core.formatBigNumber(1000*core.values.redPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1))}"},giantBluePotion:{cls:"items",name:"巨大蓝血瓶",canUseItemEffect:"true",itemEffect:"core.status.hero.hp += 1000 * core.values.bluePotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1)",itemEffectTip:"，生命+${core.formatBigNumber(1000*core.values.bluePotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1))}"},giantYellowPotion:{cls:"items",name:"巨大黄血瓶",canUseItemEffect:"true",itemEffect:"core.status.hero.hp += 1000 * core.values.yellowPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1)",itemEffectTip:"，生命+${core.formatBigNumber(1000*core.values.yellowPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1))}"},giantGreenPotion:{cls:"items",name:"巨大绿血瓶",canUseItemEffect:"true",itemEffectTip:"，生命+${core.formatBigNumber(1000*core.values.greenPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1))}",itemEffect:"core.status.hero.hp += 1000 * core.values.greenPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1)"},IxlO:{cls:"tools",name:"O型械灵精华",canUseItemEffect:"true",text:"BOOM！使用后摧毁自身为中心3*3范围内的补给品和非绿色门",category:"消耗道具",useItemEffect:'core.autosave();\nvar can_break_list = core.plugin.canBreakList;\nvar x = core.status.hero.loc.x,\n\ty = core.status.hero.loc.y;\ncore.drawAnimate("fire2", x, y);\nvar range = 1;\nfor (var i = x - range; i <= x + range; ++i) {\n\tfor (var j = y - range; j <= y + range; ++j) {\n\t\tvar id = core.getBlockId(i, j);\n\t\tif (can_break_list.includes(id)) {\n\t\t\t//core.plugin.flashHide(i, j);\n\t\t\tcore.removeBlock(i, j);\n\t\t}\n\t}\n}'},IxlP:{cls:"tools",name:"P型械灵精华",canUseItemEffect:"true",text:"PONG！使用后摧毁同行列的补给品和非绿色门",category:"消耗道具",useItemEffect:'core.autosave();\nvar can_break_list = core.plugin.canBreakList;\nvar x = core.status.hero.loc.x,\n\ty = core.status.hero.loc.y;\n\nvar floorId = core.status.floorId;\nvar width = core.floors[floorId].width,\n\theight = core.floors[floorId].height;\ncore.drawAnimate("darkexplode", x, y);\nfor (var i = 0; i < width; ++i) {\n\tif (i == x) continue;\n\tcore.drawAnimate("darkexplode_mute", i, y);\n\tvar id = core.getBlockId(i, y);\n\tif (can_break_list.includes(id)) {\n\t\t//core.plugin.flashHide(i, y);\n\t\tcore.removeBlock(i, y);\n\t}\n\tfor (var j = 0; j < height; ++j) {\n\t\tif (j == y) continue;\n\t\tcore.drawAnimate("darkexplode_mute", x, j);\n\t\tvar id = core.getBlockId(x, j);\n\t\tif (can_break_list.includes(id)) {\n\t\t\t//core.plugin.flashHide(x, j);\n\t\t\tcore.removeBlock(x, j);\n\t\t}\n\t}\n}'},IxlQ:{cls:"tools",name:"Q型械灵精华",canUseItemEffect:'(function () {\n\tvar can_break_list = core.plugin.canBreakList;\n\tvar toX = core.nextX(1),\n\t\ttoY = core.nextY(1);\n\tvar set = false;\n\tvar add_money = 0;\n\tif (toX >= 0 && toY >= 0 && toX < core.bigmap.width && toY < core.bigmap.height) {\n\t\tvar target_id = core.getBlockId(toX, toY);\n\t\tif (target_id == null) set = true;\n\t\telse if (core.plugin.isEnemy(toX, toY)) {\n\t\t\tvar enemy = core.material.enemys[target_id];\n\t\t\tset = enemy.title == null || enemy.title == "普通" || enemy.title == "喽啰" || enemy.title == "精英";\n\t\t\tif (!set) {\n\t\t\t\tcore.drawTip("面前的敌人过于强大。");\n\t\t\t\tif (!core.isReplaying()) core.playSound("操作失败");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tadd_money = enemy.money;\n\t\t} else if (can_break_list.includes(target_id)) {\n\t\t\tset = true;\n\t\t} else {\n\t\t\tcore.drawTip("无法摧毁面前的物体。");\n\t\t\tif (!core.isReplaying()) core.playSound("操作失败");\n\t\t}\n\t}\n\treturn set;\n})();',text:"尝试在面前关上一扇黄门。如果面前是补给品、非绿色门或不超过精英阶的敌人，会先将其摧毁。",category:"消耗道具",useItemEffect:'core.autosave();\nvar can_break_list = core.plugin.canBreakList;\nvar toX = core.nextX(1),\n\ttoY = core.nextY(1);\nvar set = false;\nvar add_money = 0;\nif (toX >= 0 && toY >= 0 && toX < core.bigmap.width && toY < core.bigmap.height) {\n\tvar target_id = core.getBlockId(toX, toY);\n\tif (target_id == null) set = true;\n\telse if (core.plugin.isEnemy(toX, toY)) {\n\t\tvar enemy = core.material.enemys[target_id];\n\t\tset = enemy.title == null || enemy.title == "普通" || enemy.title == "喽啰" || enemy.title == "精英";\n\t\tadd_money = enemy.money;\n\t} else if (can_break_list.includes(target_id)) {\n\t\tset = true;\n\t}\n}\nif (set) {\n\tcore.removeBlock(toX, toY);\n\tcore.drawAnimate("fire2", toX, toY);\n\tif (add_money > 0) {\n\t\tcore.status.hero.money += add_money;\n\t\tcore.drawTip("从被门夹死的敌人身上获得" + add_money + "金币");\n\t\tif (core.hasItem("talentTree3")) {\n\t\t\tcore.addFlag("talentT3_3_upX", 1);\n\t\t\tcore.plugin._tryUpgrade3(3, true); // 也包含依赖至尊飞升的其他升级\n\t\t}\n\t\tcore.updateStatusBar();\n\t}\n\tcore.insertAction({ "type": "closeDoor", "id": "yellowDoor", "loc": [toX, toY] });\n}'},IxlR:{cls:"tools",name:"R型械灵精华",canUseItemEffect:'(function () {\n\tvar nx = core.nextX(1),\n\t\tny = core.nextY(1);\n\tvar enabled = nx >= 0 && nx < core.bigmap.width && ny >= 0 && ny < core.bigmap.height &&\n\t\tcore.getBlockId(nx, ny, null, true) == null;\n\tif (!enabled) {\n\t\tcore.drawTip("面对空地才能使用。");\n\t\tif (!core.isReplaying()) core.playSound("操作失败");\n\t}\n\treturn enabled;\n})();',text:"在面前放置R型械灵的影像，放出光环降低同楼层所有敌人10%攻击和5%防御。可能发挥巨大的作用！",category:"消耗道具",useItemEffect:'var nx = core.nextX(1),\n\tny = core.nextY(1);\nvar enabled = nx >= 0 && nx < core.bigmap.width && ny >= 0 && ny < core.bigmap.height &&\n\tcore.getBlockId(nx, ny, null, true) == null;\nif (!enabled) {\n\tcore.drawTip("面前不是空地，无法使用。");\n\tcore.getItem("I825");\n\tif (!core.isReplaying()) core.playSound("057-Wrong01.ogg");\n} else {\n\tcore.autosave();\n\tcore.insertAction({ "type": "setBlock", "number": "E855", "loc": [core.nextX(1), core.nextY(1)] });\n\tcore.drawAnimate("yongchang", core.nextX(1), core.nextY(1));\n}'},IxlS:{cls:"tools",name:"S型械灵精华",canUseItemEffect:'(function () {\n\tvar nx = core.nextX(1),\n\t\tny = core.nextY(1);\n\tvar enabled = nx >= 0 && nx < core.bigmap.width && ny >= 0 && ny < core.bigmap.height &&\n\t\tcore.getBlockId(nx, ny, null, true) == null;\n\tif (!enabled) {\n\t\tcore.drawTip("面对空地才能使用。");\n\t\tif (!core.isReplaying()) core.playSound("操作失败");\n\t}\n\treturn enabled;\n})();',text:"在面前放置S型械灵的影像，放出光环削弱自身为中心5*5范围内的敌人，使敌人每次被攻击时失去250万生命值。战胜强敌的关键！",category:"消耗道具",useItemEffect:'var nx = core.nextX(1),\n\tny = core.nextY(1);\nvar enabled = nx >= 0 && nx < core.bigmap.width && ny >= 0 && ny < core.bigmap.height &&\n\tcore.getBlockId(nx, ny, null, true) == null;\nif (!enabled) {\n\tcore.drawTip("面前不是空地，无法使用。");\n\tcore.getItem("I826");\n\tif (!core.isReplaying()) core.playSound("057-Wrong01.ogg");\n} else {\n\tcore.autosave();\n\tcore.insertAction({ "type": "setBlock", "number": "E856", "loc": [core.nextX(1), core.nextY(1)] });\n\tcore.drawAnimate("yongchang", core.nextX(1), core.nextY(1));\n}'},bigManaitem:{cls:"items",name:"大能量块",canUseItemEffect:null,itemEffect:'core.status.hero.mana += core.getFlag("mana_item", 15) * 3;',itemEffectTip:"，能量+${flag:mana_item * 3}"},manaItem:{cls:"items",name:"能量块",itemEffect:'core.status.hero.mana += core.getFlag("mana_item", 15)',itemEffectTip:"，能量+${flag:mana_item||15}"},redRHeart:{cls:"items",name:"红色可爱元素",canUseItemEffect:"true",itemEffect:'var dmg = 500 * core.values.redPotion * core.status.thisMap.ratio * core.getFlag(\'potion_extra_ratio\', 1);\ndmg -= core.getFlag("temp_mdef_pp") * core.status.hero.mdef / 100 * core.getFlag("mdef_ratio", 1);\ndmg = Math.max(dmg, 0);\ncore.plugin.popSkillDamage(dmg, core.status.hero.loc.x, core.status.hero.loc.y);\ncore.status.hero.hp -= dmg;\ncore.plugin.addTempMdefpp(-core.getFlag("skill11_add"));\nif (!core.getFlag("__statistics__") && core.status.hero.hp <= 0) core.lose();',itemEffectTip:"，受到${core.formatBigNumber(Math.max(0, 500*core.values.redPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1)))}点伤害"},blueRHeart:{cls:"items",name:"蓝色可爱元素",canUseItemEffect:"true",itemEffect:'var dmg = 500 * core.values.bluePotion * core.status.thisMap.ratio * core.getFlag(\'potion_extra_ratio\', 1);\ndmg -= core.getFlag("temp_mdef_pp") * core.status.hero.mdef / 100 * core.getFlag("mdef_ratio", 1);\ndmg = Math.max(dmg, 0);\ncore.plugin.popSkillDamage(dmg, core.status.hero.loc.x, core.status.hero.loc.y);\ncore.status.hero.hp -= dmg;\ncore.plugin.addTempMdefpp(-core.getFlag("skill11_add"));\nif (!core.getFlag("__statistics__") && core.status.hero.hp <= 0) core.lose();',itemEffectTip:"，受到${core.formatBigNumber(Math.max(0, 500*core.values.bluePotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1)))}点伤害"},yellowRHeart:{cls:"items",name:"黄色可爱元素",canUseItemEffect:"true",itemEffect:'var dmg = 500 * core.values.yellowPotion * core.status.thisMap.ratio * core.getFlag(\'potion_extra_ratio\', 1);\ndmg -= core.getFlag("temp_mdef_pp") * core.status.hero.mdef / 100 * core.getFlag("mdef_ratio", 1);\ndmg = Math.max(dmg, 0);\ncore.plugin.popSkillDamage(dmg, core.status.hero.loc.x, core.status.hero.loc.y);\ncore.status.hero.hp -= dmg;\ncore.plugin.addTempMdefpp(-core.getFlag("skill11_add"));\nif (!core.getFlag("__statistics__") && core.status.hero.hp <= 0) core.lose();',itemEffectTip:"，受到${core.formatBigNumber(Math.max(0, 500*core.values.yellowPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1)))}点伤害"},greenRHeart:{cls:"items",name:"绿色可爱元素",canUseItemEffect:"true",itemEffect:'var dmg = 500 * core.values.greenPotion * core.status.thisMap.ratio * core.getFlag(\'potion_extra_ratio\', 1);\ndmg -= core.getFlag("temp_mdef_pp") * core.status.hero.mdef / 100 * core.getFlag("mdef_ratio", 1);\ndmg = Math.max(dmg, 0);\ncore.plugin.popSkillDamage(dmg, core.status.hero.loc.x, core.status.hero.loc.y);\ncore.status.hero.hp -= dmg;\ncore.plugin.addTempMdefpp(-core.getFlag("skill11_add"));\nif (!core.getFlag("__statistics__") && core.status.hero.hp <= 0) core.lose();',itemEffectTip:"，受到${core.formatBigNumber(Math.max(0, 500*core.values.greenPotion * core.status.thisMap.ratio * core.getFlag('potion_extra_ratio', 1)))}点伤害"},specialRHeart:{cls:"items",name:"大可爱元素",canUseItemEffect:"true",itemEffect:'var dmg = core.getFlag(\'specialRHeart_val\', 0);\ndmg -= core.getFlag("temp_mdef_pp") * core.status.hero.mdef / 100 * core.getFlag("mdef_ratio", 1);\ndmg = Math.max(dmg, 0);\ncore.plugin.popSkillDamage(dmg, core.status.hero.loc.x, core.status.hero.loc.y);\ncore.status.hero.hp -= dmg;\ncore.plugin.addTempMdefpp(-core.getFlag("skill11_add"));\nif (!core.getFlag("__statistics__") && core.status.hero.hp <= 0) core.lose();',itemEffectTip:"，受到${core.formatBigNumber(Math.max(0, core.getFlag('specialRHeart_val', 0)))}点伤害"},I_energyOrb:{cls:"constants",name:"能量宝珠",canUseItemEffect:'(function () {\n\tif (core.status.hero.hp <= 125000000) {\n\t\tcore.drawTip("生命不足。");\n\t\tif (!core.isReplaying()) core.playSound("操作失败");\n\t\treturn false;\n\t}\n\treturn true;\n})();',text:"注入12500w点生命，换取500能量值，不限次数。快捷键4。",useItemEffect:'core.status.hero.hp -= 125000000;\ncore.status.hero.mana += 500;\ncore.drawHeroAnimate("electronic");',hideInReplay:true,category:"永久道具"},greenBomb:{cls:"constants",name:"至宝炸弹",canUseItemEffect:'(function () {\n\tif (core.status.hero.mana < 2000) {\n\t\tcore.drawTip("能量不足。");\n\t\tif (!core.isReplaying()) core.playSound("操作失败");\n\t\treturn false;\n\t}\n\tvar toX = core.nextX(1),\n\t\ttoY = core.nextY(1);\n\tvar set = false;\n\tif (toX >= 0 && toY >= 0 && toX < core.bigmap.width && toY < core.bigmap.height) {\n\t\tvar target_id = core.getBlockId(toX, toY);\n\t\tif (core.plugin.isEnemy(toX, toY)) {\n\t\t\tvar enemy = core.material.enemys[target_id];\n\t\t\tset = enemy.title == null || enemy.title == "普通" || enemy.title == "喽啰" || enemy.title == "精英";\n\t\t\tif (!set) {\n\t\t\t\tcore.drawTip("面前的敌人过于强大。");\n\t\t\t\tif (!core.isReplaying()) core.playSound("操作失败");\n\t\t\t}\n\t\t} else {\n\t\t\tcore.drawTip("必须面对一个敌人才能使用。");\n\t\t\tif (!core.isReplaying()) core.playSound("操作失败");\n\t\t}\n\t}\n\treturn set;\n})();',text:"封存了残缺血海奥义的神奇道具。\\n消耗2000点能量，将面前敌人的生命值降为1。使用次数不限，但对阶位超过精英的敌人无效。快捷键4。\\n",hideInReplay:true,category:"永久道具",useItemEffect:'core.autosave();\n\nvar toX = core.nextX(1),\n\ttoY = core.nextY(1);\nif (toX >= 0 && toY >= 0 && toX < core.bigmap.width && toY < core.bigmap.height) {\n\tif (core.plugin.isEnemy(toX, toY)) {\n\t\tcore.status.hero.mana -= 2000;\n\t\tcore.setEnemyOnPoint(toX, toY, null, "hp", 1, "=");\n\t\tcore.drawAnimate("explosion", toX, toY);\n\t}\n}'},I_hj:{cls:"tools",name:"黄极石",canUseItemEffect:"false",text:"记录你完成0伤战斗的次数",category:"消耗道具"}};var functions_d6ad677b_427a_4623_b50f_a445a3b0ef8a={events:{resetGame:function(d,c,a,f,g){core.clearStatus();core.setOpacity("hero",1);core.status=core.clone(core.initStatus,function(h){return h!="hero"&&h!="maps"});core.control._bindRoutePush();core.status.played=true;core.status.hero=core.clone(d);window.hero=core.status.hero;window.flags=core.status.hero.flags;core.events.setHeroIcon(core.status.hero.image,true);core.control._initStatistics(core.animateFrame.totalTime);core.status.hero.statistics.totalTime=core.animateFrame.totalTime=Math.max(core.status.hero.statistics.totalTime,core.animateFrame.totalTime);core.status.hero.statistics.start=null;core.status.hard=c||"";core.status.floorId=a;core.status.maps=f;core.maps._resetFloorImages();core.material.enemys=core.enemys.getEnemys();core.material.items=core.items.getItems();core.values=core.clone(core.data.values);for(var e in g||{}){core.values[e]=g[e]}core.flags=core.clone(core.data.flags);var b=core.getFlag("globalFlags",{});for(var e in b){core.flags[e]=b[e]}core._init_sys_flags();core.resize();if(core.hasFlag("hideStatusBar")){core.hideStatusBar(core.hasFlag("showToolbox"))}else{core.showStatusBar()}core.dom.musicBtn.style.display="none";core.dom.enlargeBtn.style.display="none"},win:function(c,b,a){var e="正在统计分数……\n";if(c=="Chap.1-10层小水塔"){e+="计分方式：生命 + 500*黄钥匙数";core.status.hero.hp+=500*core.itemCount("yellowKey")}else{if(c=="Chap.1-通过第20层"){e+="计分方式：生命 + 100*金币 + 100w*绿钥匙";core.status.hero.hp+=100*core.status.hero.money;core.status.hero.hp+=1000000*core.itemCount("greenKey")}else{if(c=="Chap.2-迈向未来"){e+="检测到收集了所有绿钥匙。\n计分方式：生命值"}else{if(c=="Chap.2-奋起直追"){e+="检测到收集了一部分绿钥匙。\n计分方式：生命值的开方 + 100w*绿钥匙";core.status.hero.hp=Math.sqrt(core.status.hero.hp);core.status.hero.hp+=1000000*core.itemCount("greenKey")}else{if(c=="Chap.3-旅行"||c=="Chap.3-探险"||c=="Chap.3-开拓"){e+="检测到没有咸过绿钥匙。计分方式：生命值"}else{if(c=="Chap.3-咸鱼"){e+="检测到你咸过绿钥匙。计分方式：剩余的绿钥匙";core.status.hero.hp=core.itemCount("greenKey")}else{if(c=="试炼挑战-2"){e+="计分方式：每层通过时的血量和";core.status.hero.hp=core.itemCount("DScore")}else{if(c=="Chap.4.1-格沃之行"){e+="计分方式：生命值 + 500w*黄钥匙 + 1500w*蓝钥匙";core.status.hero.hp+=5000000*core.itemCount("yellowKey");core.status.hero.hp+=15000000*core.itemCount("blueKey")}else{if(c=="Chap.4.1-格沃之王"){e+="计分方式：生命值 + 500w*黄钥匙 + 1500w*蓝钥匙 + 1e*绿钥匙";core.status.hero.hp+=5000000*core.itemCount("yellowKey");core.status.hero.hp+=15000000*core.itemCount("blueKey");core.status.hero.hp+=100000000*core.itemCount("greenKey")}else{if(c=="Chap.4.2-千虹之谜"){e+="计分方式：1w*红钥匙 + 黄极石数量（与千虹广场的神像对话时）";core.status.hero.hp=core.getFlag("hard1_score",-1)}else{if(c=="Chap.4.2-摩宇城的曙光"){e+="计分方式：生命值 + 25w * 能量值";core.status.hero.hp+=250000*core.status.hero.mana;core.status.hero.mana=0}else{if(c=="Chap.4.2-摩宇城的救赎"){e+="计分方式：100e * 绿钥匙 + 生命值 + 25w * 能量值";core.status.hero.hp+=10000000000*core.itemCount("greenKey");core.status.hero.hp+=250000*core.status.hero.mana;core.status.hero.mana=0}else{c="LHJNB!";core.status.hero.hp=1188}}}}}}}}}}}}if(a){core.status.extraEvent=core.clone(core.status.event)}core.ui.closePanel();var d=core.isReplaying();if(d){core.stopReplay()}core.waitHeroToStop(function(){if(!a){core.clearMap("all");core.deleteAllCanvas();core.dom.gif2.innerHTML=""}c=core.replaceText(c);core.drawText([e,"\t["+(c||"恭喜通关")+"]你的分数是${status:hp}。"],function(){core.events.gameOver(c||"",d,b)})})},lose:function(a){core.ui.closePanel();var b=core.isReplaying();core.stopReplay();core.waitHeroToStop(function(){var c="\t["+(a||"结局1：暴毙")+"]你暴毙了。\n如题。";if(a=="疯狂"){c="\t[结局2：疯狂]主角积攒的暴戾层数过高，彻底疯了。"}else{if(a=="迷失"){c="\t[结局3：迷失]主角积攒的沉醉层数过高，彻底迷失了自我。"}else{if(a=="飞行"){c="\t[结局4：飞行]主角尝试飞行。";core.playSound("011-System11.ogg")}else{core.drawHeroAnimate("fire2");core.clearMap("hero")}}}core.drawText([c],function(){core.events.gameOver(null,b)})})},changingFloor:function(d,f){core.plugin.setBgLight([]);var c=core.status.floorId||null;var e=core.hasFlag("__fromLoad__");var g=core.hasFlag("__isFlying__");if(core.flags.flyRecordPosition){if(!e&&!(g&&c==d)){if(!core.hasFlag("__leaveLoc__")){core.setFlag("__leaveLoc__",{})}if(c!=null){core.getFlag("__leaveLoc__")[c]=core.clone(core.status.hero.loc)}}}if(core.floors[c]&&core.floors[d]&&core.floors[c].ratio!=core.floors[d].ratio){core.plugin.clearItemDetailCacheAll()}if(core.autoRemoveMaps){core.autoRemoveMaps(d)}core.maps.resizeMap(d);f.direction=core.turnDirection(f.direction);core.status.hero.loc=f;if(!e){core.extractBlocks(d);core.status.maps[d].blocks.forEach(function(i){if(i.disable&&core.enemys.hasSpecial(i.event.id,23)){i.disable=false;core.setMapBlockDisabled(d,i.x,i.y,false);core.maps._updateMapArray(d,i.x,i.y)}});core.control.gatherFollowers()}core.drawMap(d);if(core.status.maps[d].bgm){var a=core.status.maps[d].bgm;if(a instanceof Array){a=a[Math.floor(Math.random()*a.length)]}if(!core.hasFlag("__bgm__")){core.playBgm(a)}}else{if(d=="Ch4_92_2"){if(core.getFlag("Ch4_92_2_entered",0)==1){core.playBgm("area19_2.mp3")}}else{if(!core.hasFlag("__bgm__")){core.pauseBgm()}}}var b=core.getFlag("__color__",null);if(!b&&core.status.maps[d].color){b=core.status.maps[d].color}core.clearMap("curtain");core.clearMap("event_big");core.status.curtainColor=b;if(b){core.fillRect("curtain",0,0,core.__PIXELS__,core.__PIXELS__,core.arrayToRGBA(b))}core.drawMap();var h=core.getFlag("__weather__",null);if(!h&&core.status.maps[d].weather){h=core.status.maps[d].weather}if(h){core.setWeather(h[0],h[1])}else{core.setWeather()}},afterChangeFloor:function(a){if(core.hasFlag("__fromLoad__")){core.setFlag("__curtain__",null);core.insertAction(core.floors[a].eachArrive);core.events.recoverEvents(core.getFlag("__events__"));core.removeFlag("__events__");if(core.getFlag("70F_boss_phase",0)==1){core.insertAction([{type:"strokeRect",x:34,y:28,width:344,height:32,radius:4,style:[255,255,255,1],lineWidth:4},{type:"fillBoldText",x:32,y:20,style:[255,127,127,1],font:"20px Verdana",text:"BOSS： ？？？！"}])}}else{if(!core.hasVisitedFloor(a)){core.insertAction(core.floors[a].firstArrive);core.visitFloor(a)}core.setFlag("__curtain__",null);core.insertAction(core.floors[a].eachArrive);if(core.getFlag("temp_mdef_pp",0)>0){core.plugin.addTempMdefpp(-core.getFlag("temp_mdef_pp",0))}core.plugin.autoGetItem();core.plugin.autoBattle()}for(var b in core.status.animateObjs){var c=core.status.animateObjs[b];if(c){core.maps.stopAnimate(c.id,true)}}core.plugin.stopAttractAnimate();core.plugin.clearSpriteFlasher()},flyTo:function(f,a){var b=core.status.floorId;if(!core.status.maps[b].canFlyFrom||!core.status.maps[f].canFlyTo||!core.hasVisitedFloor(f)){core.playSound("操作失败");core.drawTip("无法飞往"+core.status.maps[f].title+"！");return false}var e=null,d=null;if(core.flags.flyRecordPosition){d=core.getFlag("__leaveLoc__",{})[f]||null}if(core.status.maps[f].flyPoint!=null&&core.status.maps[f].flyPoint.length==2){d={x:core.status.maps[f].flyPoint[0],y:core.status.maps[f].flyPoint[1]}}if(d==null){var c=core.floorIds.indexOf(b),g=core.floorIds.indexOf(f);var e=c<=g?"downFloor":"upFloor";if(c==g&&core.status.maps[b].underGround){e="upFloor"}}core.status.route.push("fly:"+f);core.ui.closePanel();core.setFlag("__isFlying__",true);core.changeFloor(f,e,d,null,function(){core.removeFlag("__isFlying__");if(a){a()}});return true},beforeBattle:function(d,j,k){var c=core.material.enemys[d];var i=c.special;if(core.enemys.hasSpecial(i,71)&&core.getFlag("invisible",false)&&core.getFlag("skill6_battle",0)==0){return false}if(core.enemys.hasSpecial(i,87)){core.drawAnimate("yongchang",j,k);core.hideBlock(j,k);return false}if(j!=null&&k!=null){var f=j+","+k,b=core.status.checkBlock.cache[f]||{},e=b.guards||[],h=b.spe32_buff||0;if(h>0){core.setFlag("animate_spe32",1)}if(e.length>0){core.setFlag("__guards__"+j+"_"+k,e);var a=[{type:"playSound",name:"jump.mp3"}];e.forEach(function(m){core.push(a,{type:"jump",from:[m[0],m[1]],to:[j,k],time:300,keep:false,async:true});var l=core.material.enemys[m[2]];if(core.enemys.hasSpecial(l.special,25)){core.addFlag("guard_buff_cache_atk",l.atkValue||0);core.addFlag("guard_buff_cache_def",l.defValue||0)}});core.push(a,[{type:"waitAsync"},{type:"trigger",loc:[j,k]}]);core.insertAction(a);return false}}var g=core.getFlag("skill",0);if(g==1&&core.status.hero.mana<core.getFlag("skill1_cost",10)){core.setFlag("skill",0)}else{if(g==2&&core.status.hero.mana<core.getFlag("skill2_cost",10)){core.setFlag("skill",0)}}if(core.enemys.hasSpecial(i,56)){if(core.getFlag("used_potion",0)>0){core.setFlag("used_potion",0);core.status.hero.atk-=core.getFlag("potion_atk",0);core.status.hero.def-=core.getFlag("potion_def",0);core.status.hero.mdef-=core.getFlag("potion_mdef",0);core.setFlag("potion_atk",0);core.setFlag("potion_def",0);core.setFlag("potion_mdef",0)}}return true},afterBattle:function(s,ar,at){core.setFlag("last_battle_enemyId",s);var p=core.material.enemys[s];var ag=p.special;function o(i,j,r,au){var x=j!=null?j:core.getHeroLoc("x");var y=r!=null?r:core.getHeroLoc("y");core.drawAnimate(au,x,y);if(i!=null){core.drawHeroAnimate(i)}}var q=null;if(core.enemys.hasSpecial(ag,35)){q="ice"}if(core.enemys.hasSpecial(ag,40)){q="rage_buff"}if(core.enemys.hasSpecial(ag,44)){q="rage_disp"}if(core.enemys.hasSpecial(ag,47)){q="anti_rage"}if(core.enemys.hasSpecial(ag,49)){q="dispel"}if(core.enemys.hasSpecial(ag,50)){q="spe50"}if(s=="Emoli2"){q="fire"}if(core.enemys.hasSpecial(ag,36)&&(core.hasItem("yellowKey")||core.hasItem("blueKey")||core.hasItem("redKey"))){q="explosion"}if(core.enemys.hasSpecial(ag,22)||core.getFlag("animate_spe32",0)==1){q="explosion_small";core.setFlag("animate_spe32",0)}if(core.enemys.hasSpecial(ag,52)){q="rage_buff"}if(core.enemys.hasSpecial(ag,53)){q="def_buff"}if(core.enemys.hasSpecial(ag,54)){q="mdef_buff"}if(core.enemys.hasSpecial(ag,55)){q="thunder3"}if(core.enemys.hasSpecial(ag,56)){q="dispel"}if(core.enemys.hasSpecial(ag,38)){q="electronic"}if(core.enemys.hasSpecial(ag,62)){q="seal"}if(core.enemys.hasSpecial(ag,63)){q="slash"}if(core.enemys.hasSpecial(ag,84)){q="fire3"}if(core.enemys.hasSpecial(ag,88)){q="electronic"}if(s=="E2221"){q="crossattack"}var F;var ad=core.getFlag("skill",0);if(ad==1){F="skill1"}else{if(ad==2){F="skill2"}else{if(core.hasItem("talentTree3")){F="skill10"}else{var t="hand",u=(core.status.hero.equipment||[])[0];if(u&&(core.material.items[u].equip||{}).animate){t=core.material.items[u].equip.animate}if(!(core.material.animates[t]||{}).se){core.playSound("attack.mp3")}F=t}}}o(q,ar,at,F);var l=core.enemys.getDamage(s,ar,at);if(l==null){l=core.status.hero.hp+1}var L=l;var M=core.enemys.getDamageInfo(p,null,ar,at)?core.enemys.getDamageInfo(p,null,ar,at).turn:1;core.status.hero.hp-=l;core.status.hero.statistics.battleDamage+=l;core.status.hero.statistics.battle++;if(core.status.hero.hp<=0){core.status.hero.hp=0;core.updateStatusBar();core.events.lose("战斗失败");return}var D=[];if(ar!=null&&at!=null){D=core.getFlag("__guards__"+ar+"_"+at,[]);core.removeFlag("__guards__"+ar+"_"+at)}if(core.getFlag("enable_enemy_fly",0)==1){var ak=core.events.getEnemyOnPoint(ar,at);if(!core.isReplaying()&&!core.plugin.hasTitle(ar,at)&&Object.keys(ak).length>0){var S=0,T=0,Y=8;if(ar>core.status.hero.loc.x){S=1}else{if(ar<core.status.hero.loc.x){S=-1}}if(at>core.status.hero.loc.y){T=1}else{if(at<core.status.hero.loc.y){T=-1}}core.jumpBlock(ar,at,ar+(Math.random()-0.5+S)*Y,at+(Math.random()-0.5+T)*Y,500,false)}}core.events.resetEnemyOnPoint(ar,at);var P=D.reduce(function(i,j){return i+core.material.enemys[j[2]].money},p.money);if(core.hasItem("coin")){P*=2}if(core.hasFlag("curse")){P=0}core.status.hero.money+=P;core.status.hero.statistics.money+=P;var v=D.reduce(function(i,j){return i+core.material.enemys[j[2]].exp},p.exp);if(core.hasFlag("curse")){v=0}core.status.hero.exp+=v;core.status.hero.statistics.exp+=v;var G="打败 "+p.name;if(core.flags.statusBarItems.indexOf("enableMoney")>=0){G+="，金币+"+P}if(core.flags.statusBarItems.indexOf("enableExp")>=0){G+="，经验+"+v}core.drawTip(G,p.id);var an=[];if(core.enemys.hasSpecial(ag,50)&&core.getFlag("rage_stack",0)<0){core.addFlag("rage_stack",core.getFlag("rage_stack",0))}if(core.enemys.hasSpecial(ag,12)){core.triggerDebuff("get","poison")}if(core.enemys.hasSpecial(ag,13)){core.triggerDebuff("get","weak")}if(core.enemys.hasSpecial(ag,14)){core.triggerDebuff("get","curse")}if(core.getFlag("freeze_stack",0)){core.addFlag("freeze_stack",-1)}if(core.enemys.hasSpecial(ag,35)){core.addFlag("freeze_stack",p.value35)}if(core.enemys.hasSpecial(ag,44)){core.setFlag("rage_stack",Math.ceil(core.getFlag("rage_stack",0)/2))}if(core.getFlag("rage_stack",0)>0){core.addFlag("rage_stack",-1);if(core.getFlag("hard")==1&&core.getFlag("rage_stack",0)>0){core.addFlag("rage_stack",-1)}}if(core.enemys.hasSpecial(ag,40)){core.addFlag("rage_stack",p.value40)}if(core.getFlag("rage_stack",0)>99){core.lose("疯狂")}else{if(core.getFlag("rage_stack",0)>=80){var X=core.rand(4);switch(X){case 0:core.insertAction("\t[hero]（杀戮，杀戮！）");break;case 1:core.insertAction("\t[hero]（来狠狠地伤害我，然后我也会狠狠地伤害你！来互相伤害吧！）");break;case 2:core.insertAction("\t[hero]（全都去死吧！）");break;case 3:core.insertAction("\t[hero]（不堪一击的废物！）");break}}}if(core.getFlag("rage_stack",0)<0){core.addFlag("rage_stack",1)}if(core.enemys.hasSpecial(ag,47)){core.addFlag("rage_stack",-p.value40)}if(core.getFlag("rage_stack",0)<-99){core.insertAction(["\t[芳芷,hero2]呀，你身上的沉醉层数太多了！这下你“无敌”了。","\t[hero]（好像，陷入了绝境……等等，我记得杂货商人那里有解药。）"])}if(core.getFlag("spe84_n",0)>0){core.addFlag("spe84_n",-1)}if(core.enemys.hasSpecial(ag,84)&&!(core.hasItem("I_cat")||core.hasEquip("I_cat"))){core.addFlag("spe84_n",p.n);core.setFlag("spe84_dmg",p.damage2)}if(core.enemys.hasSpecial(ag,49)){if(core.getFlag("rage_stack",0)!=0||core.getFlag("freeze_stack",0)>0){core.setFlag("rage_stack",0);core.setFlag("freeze_stack",0)}else{if(core.getFlag("spe84_n",0)>0){core.setFlag("spe84_n",0)}else{core.status.hero.hp+=p.value35}}}if(!core.getFlag("skill5_is_on",false)&&!core.getFlag("skill8_buff",false)){if(core.getFlag("rage_stack",0)<-20){core.setHeroIcon("hero_rage2.png")}else{if(core.getFlag("rage_stack",0)>20){core.setHeroIcon("hero_rage.png")}else{core.setHeroIcon("hero.png")}}}if(core.enemys.hasSpecial(ag,17)){core.setFlag("hatred",Math.floor(core.getFlag("hatred",0)/2))}if(core.enemys.hasSpecial(ag,19)){core.status.hero.statistics.battleDamage+=core.status.hero.hp-1;core.status.hero.hp=1}if(core.enemys.hasSpecial(ag,21)){core.status.hero.atk-=(p.atkValue||0);core.status.hero.def-=(p.defValue||0);if(core.status.hero.atk<0){core.status.hero.atk=0}if(core.status.hero.def<0){core.status.hero.def=0}}if(core.hasSpecial(ag,114)){core.status.hero.hp+=core.status.hero.mana*30000;core.status.hero.mana=0}var e=core.plugin.canBreakList;if(core.enemys.hasSpecial(ag,64)){core.drawAnimate("fire2",ar,at);var Y=p.range;for(var H=ar-Y;H<=ar+Y;++H){for(var K=at-Y;K<=at+Y;++K){var I=core.getBlockId(H,K);if(e.includes(I)){core.drawAnimate("fire4_mute",H,K);core.removeBlock(H,K)}}}core.plugin.popSkillDamage(p.damage,core.status.hero.loc.x,core.status.hero.loc.y);core.status.hero.hp-=p.damage}if(core.enemys.hasSpecial(ag,74)){core.drawAnimate("fire2",ar,at);var Y=p.range;var g=1;for(var H=ar-Y;H<=ar+Y;++H){for(var K=at-Y;K<=at+Y;++K){var I=core.getBlockId(H,K);if(e.includes(I)){core.drawAnimate("fire4_mute",H,K);core.removeBlock(H,K);g+=1}}}var ae=Math.floor(p.damage/g);core.plugin.popSkillDamage(ae,core.status.hero.loc.x,core.status.hero.loc.y);core.status.hero.hp-=ae}var C=core.status.floorId;var aq=core.floors[C].width,E=core.floors[C].height;if(core.enemys.hasSpecial(ag,75)){core.drawAnimate("darkexplode",ar,at);var g=1;for(var H=0;H<aq;++H){if(H==ar){continue}core.drawAnimate("darkexplode_mute",H,at);var I=core.getBlockId(H,at);if(e.includes(I)){core.removeBlock(H,at);g+=1}}for(var K=0;K<E;++K){if(K==at){continue}core.drawAnimate("darkexplode_mute",ar,K);var I=core.getBlockId(ar,K);if(e.includes(I)){core.removeBlock(ar,K);g+=1}}core.plugin.popSkillDamage(p.damage,core.status.hero.loc.x,core.status.hero.loc.y);core.status.hero.hp-=p.damage}if(core.hasSpecial(ag,116)){for(var n in core.utils.scan){var Q=ar+core.utils.scan[n].x,R=at+core.utils.scan[n].y,k=Q+","+R;if(Q<0||Q>=aq||R<0||R>=E){continue}if(Q==core.getHeroLoc("x")&&R==core.getHeroLoc("y")){continue}if(core.getBlock(Q,R,C)==null){core.drawAnimate("fire3",Q,R);core.setBlock("E874",Q,R)}}}if(core.status.hero.hp<=0){core.events.lose("战斗失败");return}if(core.getFlag("spe62_seal_hp",0)>0&&core.status.hero.hp>0){core.status.hero.hp+=core.getFlag("spe62_seal_hp",0);core.drawHeroAnimate("spe62");core.setFlag("spe62_seal_hp",0)}if(core.enemys.hasSpecial(ag,62)){core.setFlag("spe62_seal_hp",core.status.hero.hp-1);core.status.hero.hp=1}if(core.enemys.hasSpecial(ag,73)){var ah=[];for(var H=-1;H>-641;--H){if(core.nextX(H)>=0&&core.nextY(H)>=0&&core.nextX(H)<core.bigmap.width&&core.nextY(H)<core.bigmap.height&&core.getBlock(core.nextX(H),core.nextY(H))==null){ah.push("backward")}else{break}}var a=[{type:"animate",name:"skill3",loc:"hero",async:true}];if(ah.length){a.push({type:"moveHero",steps:ah})}core.insertAction(a)}var af=0;if(core.enemys.hasSpecial(ag,78)){var ao=2*core.getHeroLoc("x")-ar,ap=2*core.getHeroLoc("y")-at;var ab=false;var b=0;if(ao>=0&&ap>=0&&ao<core.bigmap.width&&ap<core.bigmap.height){var aj=core.getBlockId(ao,ap);if(aj==null){ab=true}else{if(core.getBlockCls(ao,ap)=="enemys"||core.getBlockCls(ao,ap)=="enemy48"){var p=core.material.enemys[aj];ab=p.title==null||p.title=="普通"||p.title=="喽啰"||p.title=="精英";b=p.money}else{if(e.includes(aj)){ab=true}}}}if(ab){core.removeBlock(ao,ap);core.drawAnimate("fire2",ao,ap);if(b>0){core.status.hero.money+=b;core.drawTip("从被门夹死的敌人身上获得"+b+"金币");if(core.hasItem("talentTree3")){af=1}core.updateStatusBar()}core.insertAction({type:"closeDoor",id:"yellowDoor",loc:[ao,ap]})}}if(core.enemys.hasSpecial(ag,83)){core.setFlag("spe83_step",1);core.setFlag("spe83_range",p.range);core.setFlag("spe83_dmg",p.damage);core.setFlag("cannotMoveDirectly",1)}if(core.enemys.hasSpecial(ag,95)){var Y=p.range;for(var H=ar-Y;H<=ar+Y;++H){for(var K=at-Y;K<=at+Y;++K){if(core.plugin.isEnemy(H,K)){if(p.atkValue){if(p.atkValue>=0){core.setEnemyOnPoint(H,K,null,"atk",p.atkValue,"+=")}else{core.setEnemyOnPoint(H,K,null,"atk",-p.atkValue,"-=")}}if(p.defValue){if(p.defValue>=0){core.setEnemyOnPoint(H,K,null,"def",p.defValue,"+=")}else{core.setEnemyOnPoint(H,K,null,"def",-p.defValue,"-=")}}if(p.hpValue){if(p.hpValue>=0){core.events.setEnemyOnPointAdd(H,K,null,"hp",p.hpValue,"+=")}else{core.events.setEnemyOnPointAdd(H,K,null,"hp",-p.hpValue,"-=")}}core.drawAnimate("rage_buff",H,K)}}}}if(core.enemys.hasSpecial(ag,96)){var Y=p.range;for(var H=ar-Y;H<=ar+Y;++H){for(var K=at-Y;K<=at+Y;++K){if(core.getBlockCls(H,K)=="items"){var I=core.getBlockId(H,K);core.plugin.addAutoGetItemAnimate(I,H,K);core.getItem(I,1,H,K)}}}core.plugin.startAutoGetItemAnimate()}core.setFlag("hatred",core.getFlag("hatred",0)+core.values.hatred);if(core.getFlag("skill5_cd",0)>0){core.addFlag("skill5_cd",-1)}if(core.getFlag("skill5_dm",0)==1){core.status.hero.mana-=core.getFlag("skill5_dm_cost",0);core.plugin.popSkillDamage(core.getFlag("skill5_dm_cost",0),core.status.hero.loc.x,core.status.hero.loc.y,"#FFFFFF");core.addFlag("skill5_dm_cost",20);if(core.status.hero.mana<=0){core.insertCommonEvent("DM不鸽了")}}core.setFlag("guard_buff_cache_atk",0);core.setFlag("guard_buff_cache_def",0);if(core.flags.statusBarItems.indexOf("enableSkill")>=0){var ad=core.getFlag("skill",0);var h=0;if(ad==1){h=core.getFlag("skill1_cost",10)}else{if(ad==2){h=core.getFlag("skill2_cost",10)}}core.status.hero.mana-=h;core.setFlag("skill",0);core.setFlag("skillName","无")}function f(){core.setFlag("used_potion",0);core.status.hero.atk-=core.getFlag("potion_atk",0);core.status.hero.def-=core.getFlag("potion_def",0);core.status.hero.mdef-=core.getFlag("potion_mdef",0);core.setFlag("potion_atk",0);core.setFlag("potion_def",0);core.setFlag("potion_mdef",0)}if(core.getFlag("used_potion",0)>0){core.addFlag("used_potion",-1);if(core.getFlag("used_potion",0)==0){f()}}if(core.enemys.hasSpecial(ag,52)){f();core.setFlag("used_potion",3);core.addFlag("potion_atk",p.value52);core.status.hero.atk+=p.value52}else{if(core.enemys.hasSpecial(ag,53)){f();core.setFlag("used_potion",3);core.addFlag("potion_def",p.value53);core.status.hero.def+=p.value53}else{if(core.enemys.hasSpecial(ag,54)){f();core.setFlag("used_potion",3);core.addFlag("potion_mdef",p.value54);core.status.hero.mdef+=p.value54}}}var U=D.reduce(function(i,j){return i+core.material.enemys[j[2]].point},p.point)||0;if(core.flags.enableAddPoint&&U>0){core.push(an,[{type:"insert",name:"加点事件",args:[U]}])}if(core.status.floorId!=null){core.push(an,core.floors[core.status.floorId].afterBattle[ar+","+at])}if(core.enemys.hasSpecial(ag,36)){core.setItem("yellowKey",0);core.setItem("blueKey",0);core.setItem("redKey",0)}if(core.hasSpecial(ag,38)){core.status.hero.mana=Math.max(0,core.status.hero.mana-p.value38_1)}core.status.hero.mana+=core.getFlag("mana_regen",0);if(core.hasEquip("leaf")){core.status.hero.mana+=1}var z=core.getFlag("I62_extra_mana_regen",0);var w=false;if(L<=0&&z>0){core.status.hero.mana+=z;w=true}if(w){core.drawHeroAnimate("heal")}if(core.getFlag("current_chapter",3)==3){core.status.hero.hp+=core.getRealStatus("mdef")*0.01*core.itemCount("yellowGem")}if(core.hasItem("talentTree3")){if(flags.hard==1&&L<=0&&core.getFlag("A21boss",0)==0){core.getItem("I_hj");if(s=="E802"){core.getItem("I_hj",10)}}if(core.getTalentLv3(3)>=70){core.setFlag("skill11_feat1",true)}if(core.hasItem("skill13")&&core.getFlag("skill13_cost")>0){core.addFlag("skill13_cost",-core.getFlag("skill13_cost_reduce",50));if(core.getFlag("skill13_cost")<0){core.setFlag("skill13_cost",0)}}var ac=false;if(core.getTalentLv3(3)<100){core.addFlag("talentT3_3_upX",1+af);core.plugin._tryUpgrade3(3,true)}if(core.getTalentLv3(0)==1&&core.getTalentLv3(3)>=5){ac=true}if(core.getTalentLv3(0)==2&&core.getTalentLv3(3)>=15){ac=true}if(core.getTalentLv3(0)==3&&core.getTalentLv3(3)>=30){ac=true}if(core.getTalentLv3(1)==4&&core.getTalentLv3(3)>=60&&core.getTalentLv3(5)==3){ac=true}if(core.getTalentLv3(2)==4&&core.getTalentLv3(3)>=90){ac=true}if(ac){core.drawHeroAnimate("yongchang")}}if(core.hasItem("skill11")){core.plugin.addTempMdefpp(core.getFlag("skill11_add"));if(core.enemys.hasSpecial(ag,88)){core.plugin.addTempMdefpp(-9922)}if(core.enemys.hasSpecial(ag,90)){core.plugin.addTempMdefpp(2*core.getFlag("skill11_add"))}}if(core.hasItem("talentTree")&&core.getFlag("talentTree_unlocked",false)){var ac=false;var Z=[[-1,-1,50],[-1,-1,50],[-1,-1,50],[-1,5],[-1,50],[-1,50],[-1,50],[-1,50],[-1,50],[-1,50],];for(var H=0;H<14;++H){var N=core.plugin.getTalentLv(H);var B="talent"+H+"_up"+N;core.addFlag(B,1);if(Z[H]&&Z[H][N]>0&&core.getFlag(B,0)>=Z[H][N]){ac=true;if(core.getFlag("autoUpgradeTalent",0)>0){core.plugin._tryUpgrade(H)}}}if(L<=0){if(core.plugin.getTalentLv(3)==2){core.addFlag("talent3_up2_spe",1);if(core.getFlag("talent3_up2_spe",0)>=10){ac=true;if(core.getFlag("autoUpgradeTalent",0)>0){core.plugin._tryUpgrade(3)}}}if(core.plugin.getTalentLv(3)==6){core.addFlag("talent3_up6_spe",1);if(core.getFlag("talent3_up6_spe",0)>=50){ac=true;if(core.getFlag("autoUpgradeTalent",0)>0){core.plugin._tryUpgrade(3)}}}}if(ac){core.drawHeroAnimate("yongchang")}}if(core.getFlag("skill6_battle",0)==1){core.setFlag("skill6_battle",0)}if(core.getFlag("invisible",0)==1){if(L<=0&&core.getTalentLv2(5)>=2){core.status.hero.mana+=50;core.drawHeroAnimate("heal2")}core.plugin.exit_invisible()}if(core.status.floorId=="Ch4_32"&&s=="E699"&&ar==10){core.insertAction({type:"choices",text:"\t[系统提示]获得成就【阴间大师】！\n竟然能想到把游猎拉到这里引爆，想必你早已精通各种屑塔的阴间套路了。\n口头奖励一下，你很强。",choices:[{text:"？？？",action:[]},]})}if(an.length>0){core.insertAction(an,ar,at)}core.plugin.flashHide(ar,at);if(core.getBlock(ar,at)!=null){if(core.hasSpecial(p.special,23)){core.hideBlock(ar,at)}else{core.removeBlock(ar,at)}}else{core.updateStatusBar()}if(core.enemys.hasSpecial(ag,86)){var C=core.status.floorId;var aq=core.floors[C].width,E=core.floors[C].height;var c="fire";for(var H=-1;true;--H){var al=core.nextX(H),am=core.nextY(H);if(al<0||am<0||al>=aq||am>=E){break}var I=core.getBlockId(al,am);core.drawAnimate(c,al,am);c="fire_mute";if(e.includes(I)){core.removeBlock(al,am)}if(core.getFlag("A21boss",0)>0&&I&&I.indexOf("RHeart")!=-1){core.plugin.updateBoss21Info(4)}if(!core.plugin.isEnemy(al,am)){if(!core.canMoveHero(al,am,core.plugin.getReverseDirection(core.status.hero.loc.direction))||core.noPass(al,am)){break}}else{var ai=core.material.enemys[core.getBlockId(al,am)];if(core.enemys.hasSpecial(ai.special,121)){}else{core.events.setEnemyOnPointAdd(al,am,null,"hp",p.damage2,"-=")}}}}if(core.enemys.hasSpecial(ag,57)){core.plugin.BombExplode(ar,at,p.damage)}if(core.enemys.hasSpecial(ag,110)){var aa={up:{x:0,y:-1},left:{x:-1,y:0},down:{x:0,y:1},right:{x:1,y:0}};var ao=core.getHeroLoc("x")-aa[core.getHeroLoc("direction")].x;var ap=core.getHeroLoc("y")-aa[core.getHeroLoc("direction")].y;var ab=false;if(ao>=0&&ap>=0&&ao<core.bigmap.width&&ap<core.bigmap.height){if(core.getBlockId(ao,ap)==null){ab=true}else{if(core.getBlockCls(ao,ap)=="enemys"||core.getBlockCls(ao,ap)=="enemy48"){var O=core.getBlockId(ao,ap);var p=core.material.enemys[O];ab=p.title==null||p.title=="普通"}}}if(ab){core.setBlock("E628",ao,ap)}}if(core.getFlag("A21boss",0)==1){core.addFlag("A21boss_battle",1);if(s=="E888"&&core.getFlag("A21boss_1p",0)>=2&&core.getFlag("A21boss_1p",0)<4){core.insertCommonEvent("衰 爆",null,null,null,null,true)}var A=false;var m=false;var V=function(r,y,ay){var aw=core.getHeroLoc("x")+r;var ax=core.getHeroLoc("y")+y;var av=false;if(aw>=0&&aw<=12&&ax>=0&&ax<=12){if(core.getBlockId(aw,ax)==null){av=true}else{if(core.getBlockCls(aw,ax)=="items"&&ay==2){av=true}}}if(av){if(ay==1){core.setBlock("E21Add1",aw,ax);core.drawAnimate("fire3_mute",aw,ax);A=true}else{var au=core.getBlockId(aw,ax);if(!au){au="empty"}var x=["empty","redRHeart","blueRHeart","yellowRHeart","greenRHeart"];var r=x.indexOf(au);if(r==0||core.getFlag("A21boss_2p",0)>=2){if(r<=3){core.setBlock(x[r+1],aw,ax);core.drawAnimate("dark_mute",aw,ax);m=true}}}}};if(s=="E21Add1"&&core.getFlag("A21boss_1p",0)<5){core.plugin.updateBoss21Info(2)}if(s=="E888"&&core.getFlag("A21boss_1p",0)<4){var W=0;while(W<11){W+=1;V(-W,-W,1);V(-W,W,1);V(W,-W,1);V(W,W,1)}}if(s=="E889"&&core.getFlag("A21boss_2p",0)<4){var W=0;while(W<11){W+=2;V(-W,0,2);V(W,0,2);V(0,-W,2);V(0,W,2)}}if(core.getFlag("A21boss_battle")==3&&core.getFlag("A21boss_2p",0)<5){core.setFlag("A21boss_battle",0);V(-1,-1,2);V(-1,1,2);V(1,-1,2);V(1,1,2)}if(!core.isReplaying()){if(A){core.playSound("118-Fire02.ogg")}if(m){core.playSound("139-Darkness02.ogg")}}}if(core.getFlag("Ch4_boss_phase",0)>0){core.insertCommonEvent("Ch4Boss",[ar,at])}if(core.getFlag("Chap3_boss",0)==1){if(core.getFlag("Chap3_boss_phase",0)==0){core.addFlag("make_E627_cd",1);if(core.getFlag("make_E627_cd",0)==3){core.setFlag("make_E627_cd",0);for(var H=-1;H<=1;H+=2){for(var K=-1;K<=1;K+=2){var ao=core.getHeroLoc("x")+H;var ap=core.getHeroLoc("y")+K;var ab=false;if(ao>=0&&ao<=12&&ap>=0&&ap<=12){if(core.getBlockId(ao,ap)==null){ab=true}else{if(core.getBlockCls(ao,ap)=="enemys"||core.getBlockCls(ao,ap)=="enemy48"){var O=core.getBlockId(ao,ap);var p=core.material.enemys[O];ab=p.title==null||p.title=="普通"}}}if(ab){core.setBlock("E627",ao,ap);core.drawAnimate("yongchang",ao,ap)}}}}}else{var J=true;for(var H=0;H<13;++H){for(var K=0;K<13;++K){if(core.getBlockId(H,K)=="E627"){if(J){core.drawAnimate("fire",H,K);J=false}else{core.drawAnimate("fire_mute",H,K)}if(Math.abs(core.getHeroLoc("x")-H)<=1&&Math.abs(core.getHeroLoc("y")-K)<=1){core.status.hero.hp-=2221222;core.plugin.popSkillDamage(2221222,H,K);if(core.status.hero.hp<=0){core.lose()}}}}}}var d=0;for(var H=0;H<13;++H){for(var K=0;K<13;++K){if(core.getBlockId(H,K)=="E627"||core.getBlockId(H,K)=="E628"){d+=1}}}core.setFlag("Chap3_boss_bomb_count",d);if(d>=21&&core.getFlag("Chap3_boss_phase",0)==0){core.setFlag("Chap3_boss_phase",1);core.playSound("se_power0.wav");core.drawAnimate("yongchang",6,6);core.lockControl();core.vibrate("horizontal",2000,10,10,function(){var r=0;for(var x=0;x<13;++x){for(var y=0;y<13;++y){if(core.getBlockId(x,y)=="E627"){r+=999891;core.drawAnimate("fire_mute",x,y)}else{if(core.getBlockId(x,y)=="E628"){core.drawAnimate("fire_mute",x,y);core.setBlock("E627",x,y)}}}}core.status.hero.hp-=r;core.updateStatusBar();core.plugin.popSkillDamage(r,core.getHeroLoc("x"),core.getHeroLoc("y"));core.drawAnimate("thunder3",core.getHeroLoc("x"),core.getHeroLoc("y"));core.unlockControl()})}}core.updateStatusBar();if(core.status.event.id==null){core.continueAutomaticRoute()}else{core.clearContinueAutomaticRoute()}},afterOpenDoor:function(c,e,f){if(core.hasItem("I319")){var a=0;if(c=="yellowDoor"){a=1}else{if(c=="blueDoor"){a=3}else{if(c=="redDoor"){a=10}}}if(a>0){core.addValpp("atk",a);core.addValpp("def",a);core.addValpp("mdef",a)}core.updateStatusBar()}if(core.plugin.getTalentLv(3)==3&&c=="yellowDoor"){core.addFlag("talent3_up3_spe",1);if(core.getFlag("talent3_up3_spe",0)>=20){core.drawHeroAnimate("yongchang");if(core.getFlag("autoUpgradeTalent",0)>0){core.plugin._tryUpgrade(3)}}}var d=[];if(core.status.floorId){core.push(d,core.floors[core.status.floorId].afterOpenDoor[e+","+f])}var b=core.getBlockById(c);if(b&&b.event.doorInfo){core.push(d,b.event.doorInfo.afterOpenDoor)}if(d.length>0){core.insertAction(d,e,f)}if(core.status.event.id==null){core.continueAutomaticRoute()}else{core.clearContinueAutomaticRoute()}core.plugin.autoGetItem();core.plugin.autoBattle()},afterGetItem:function(e,h,i,d){if(e=="redGem"||e=="blueGem"||e=="greenGem"||e=="yellowGem"||e=="redGem2"||e=="blueGem2"||e=="greenGem2"||e=="yellowGem2"||e=="redGem3"||e=="blueGem3"||e=="greenGem3"||e=="yellowGem3"||e=="redGem4"||e=="blueGem4"||e=="greenGem4"||e=="yellowGem4"||e=="redGem5"||e=="blueGem5"||e=="greenGem5"||e=="yellowGem5"||e=="redGem6"||e=="blueGem6"||e=="greenGem6"||e=="yellowGem6"||e=="redGem7"||e=="blueGem7"||e=="greenGem7"||e=="yellowGem7"||e=="redGem8"||e=="blueGem8"||e=="greenGem8"||e=="yellowGem8"||e=="redGem9"||e=="blueGem9"||e=="greenGem9"||e=="yellowGem9"||e=="blackGem"){core.playSound("pickGem.wav")}else{if(e=="yellowKey"||e=="blueKey"||e=="redKey"||e=="greenKey"||e=="yellowKey3"||e=="blueKey3"||e=="redKey3"){core.playSound("pickKey.wav")}else{if(e=="redPotion"||e=="bluePotion"||e=="yellowPotion"||e=="greenPotion"||e=="manaItem"||e=="bigManaitem"||e=="bigRedPotion"||e=="bigBluePotion"||e=="bigYellowPotion"||e=="bigGreenPotion"||e=="hugeRedPotion"||e=="hugeBluePotion"||e=="hugeYellowPotion"||e=="hugeGreenPotion"||e=="giantRedPotion"||e=="giantBluePotion"||e=="giantYellowPotion"||e=="giantGreenPotion"){core.playSound("pickPotion.wav");if(core.getTalentLv(10)==1){core.addFlag("talent10_up2_spe",1)}}else{if(e=="superPotion"||e=="superPotion_s"){core.playSound("pickPotion2.wav")}else{if(["redRHeart","blueRHeart","yellowRHeart","greenRHeart"].indexOf(e)!=-1){core.drawHeroAnimate("dark2")}else{core.playSound("item.mp3")}}}}}if(core.getFlag("A21boss",0)==1){var c=false;if(core.getFlag("A21boss_1p",0)<5){core.addFlag("A21boss_pick",1);var f=function(k,l){var n=core.getHeroLoc("x")+k;var o=core.getHeroLoc("y")+l;var m=false;if(n>=0&&n<=12&&o>=0&&o<=12){if(core.getBlockId(n,o)==null){m=true}}if(m){core.setBlock("E21Add1",n,o);core.drawAnimate("fire3_mute",n,o);c=true}};if(core.getFlag("A21boss_pick")==2){core.setFlag("A21boss_pick",0);f(-1,-1);f(-1,1);f(1,-1);f(1,1);if(core.getFlag("A21boss_1p",0)>=2){f(-2,-2);f(-2,2);f(2,-2);f(2,2);f(-2,0);f(2,0);f(0,-2);f(0,2)}}}if(!core.isReplaying()&&c){core.playSound("118-Fire02.ogg")}var a=core.getFlag("A21boss_2p",0);if(a<5){core.plugin.updateBoss21Info(4)}core.insertCommonEvent("Ch4_2BossDraw")}if(e=="skill1"||e=="skill2"){if(core.hasItem("skill1")&&core.hasItem("skill2")){core.setShopVisited("12FShop",false);core.setFlag("12FShopClose",true);core.setBlock(132,10,4,"MT12")}}if((e=="I343"&&core.getFlag("skill0_buff_used",0)==3)||(core.getFlag("skill0_buff_used",0)==3&&core.hasItem("I343"))){core.setShopVisited("12FShop_easy",false);core.setFlag("12FShopClose",true);core.setBlock(132,10,4,"MT12")}if(e=="manaItem"&&core.getFlag("getManaHint",0)==1){core.setFlag("getManaHint",0);if(core.getFlag("hard")==1){core.insertAction("\t[芳芷,hero2]是能量块，应该有什么办法能利用它。")}else{core.insertAction("\t[芳芷,hero2]是能量块，应该有什么办法把它释放出去作为你的战斗手段。")}}if(core.getFlag("current_chapter",0)==1&&e=="blackGem"&&!core.getFlag("getBlackGem",0)){core.setFlag("getBlackGem",1);core.insertAction("\t[芳芷,hero2]黑宝石，似乎和机器之心的材料很相似，能够让它给你带来更大的增幅。")}var g=[];if(core.status.floorId==null){return}var b=core.floors[core.status.floorId].afterGetItem[h+","+i];if(b&&(b instanceof Array||!d||!b.disableOnGentleClick)){core.unshift(g,b)}if(g.length>0){core.insertAction(g,h,i)}},afterPushBox:function(){if(core.searchBlock("box").length==0){}}},enemys:{getSpecials:function(){return[[1,function(a){if(!a.value28||a.value28==1){return"先攻"}if(a.value28<0){return"迟钝"}return"抢攻"},function(a){if(a.value28<0){return"战斗前被额外攻击\r[yellow]"+-a.value28+"\r回合"}return"战斗前额外攻击\r[yellow]"+(a.value28||1)+"\r回合"},"#ffcc33"],[2,"魔攻","战斗中，无视角色防御","#bbb0ff"],[3,"坚固","防御不小于对方攻击-1，并免疫技能伤害","#c0b088"],[4,"2连击","每回合攻击\r[yellow]2\r次","#ffee77"],[5,"3连击","每回合攻击\r[yellow]3\r次","#ffee77"],[6,function(a){return(a.n||"")+"连击"},function(a){return"每回合攻击\r[yellow]"+(a.n||4)+"\r次"},"#ffee77"],[7,"破甲",function(a){return"强力的攻击粉碎敌人的护甲\n首次攻击时，附加对方防御的\r[yellow]"+Math.floor(100*(a.defValue||core.values.breakArmor||0))+"%\r作为伤害"},"#b30000"],[8,"反伤",function(a){return"来犯之敌，自讨苦吃。\n角色攻击时，攻击力的\r[yellow]"+Math.floor(a.atkValue||core.values.counterAttack||0)+"%\r也会伤害自身。此伤害无视防御。"},"#ffaa44"],[9,"净化",function(a){return"\r[#e525ff]【红海技能】\r战斗前，附加对方护盾的\r[yellow]"+(a.n||core.values.purify)+"\r倍作为伤害"},"#80eed6"],[10,"模仿","攻防与角色攻防相等","#b0c0dd"],[11,"吸血",function(a){var b="\r[#e525ff]【红海技能】\r战斗前，首先吸取对方的"+Math.floor(100*a.value||0)+"%生命（约"+Math.floor((a.value||0)*core.getStatus("hp"))+"点）作为伤害"+(a.add?"，并把伤害数值加到自身生命上":"");if(core.hasItem("I_noVampire")){b+="\r[yellow]（对你无效）\r"}return b},"#ff00d2"],[12,"中毒","战斗后，角色陷入中毒状态，每一步损失生命"+core.values.poisonDamage+"点","#99ee88"],[13,"衰弱","战斗后，角色陷入衰弱状态，攻防暂时下降"+(core.values.weakValue>=1?core.values.weakValue+"点":parseInt(core.values.weakValue*100)+"%"),"#f0bbcc"],[14,"诅咒","战斗后，角色陷入诅咒状态，战斗无法获得金币和经验","#bbeef0"],[15,"领域",function(a){return"角色经过周围\r[yellow]"+(a.zoneSquare?"方形":"十字")+"\r范围内\r[yellow]"+(a.range||1)+"\r格时受到\r[yellow]"+core.formatBigNumber(a.value||0)+"\r点伤害"},"#c677dd"],[16,function(a){if(a.damage2>0){return"夹伤"}if(a.value>=100){return"夹 毙"}if(a.value>99){return"夹爆"}return"夹击"},function(a){if(a.damage2>0){return"经过两个相同的怪物中间，角色受到\r[yellow]"+core.formatBigNumber(a.damage2)+"\r点伤害"}if(a.value>99){return"\r[#e525ff]【血海奥义】\r经过两个相同的怪物中间，角色受到当前生命值\r[yellow]"+a.value+"%\r的伤害"}return"\r[#e525ff]【红海技能】\r经过两个相同的怪物中间，角色受到当前生命值\r[yellow]"+a.value+"%\r的伤害"},"#bb99ee"],[17,"仇恨","战斗前，附加之前积累的仇恨值作为伤害；战斗后，释放一半的仇恨值。（每杀死一个怪物获得"+(core.values.hatred||0)+"点仇恨值）","#b0b666"],[18,function(a){if(!a.value||a.value==0){return"后退"}return"阻击"},function(a){if(!a.value||a.value==0){return"角色经过身边时，后退一格"}return"角色经过身边时造成\r[yellow]"+core.formatBigNumber(a.value||0)+"\r点伤害，并后退一格"},"#8888e6"],[19,"自爆","战斗后角色的生命值变成1","#ff6666"],[20,"无敌",function(a){if(a.id=="E905"||a.id=="E906"){return"\r[#ffee28]【超凡法则】\r已经完全失去战斗力，但由于另一位大帝的存在，免疫所有伤害。"}return"\r[#ffee28]【至尊法则】超越常人认知的守御之力\r\n免疫所有伤害"},"#aaaaaa"],[21,"退化",function(a){return"战斗后角色永久下降"+(a.atkValue||0)+"点攻击和"+(a.defValue||0)+"点防御"},"#ff0000"],[22,"亡命",function(a){return"以拼命态势死战到底。\n战斗前，造成\r[yellow]"+(a.damage||0)+"\r点固定伤害。"},"#ff9977"],[23,"重生","被击败后，角色转换楼层则怪物将再次出现","#a0e0ff"],[24,"射击",function(a){return"角色经过同行或同列可见范围时，造成\r[yellow]"+core.formatBigNumber(a.snipe_damage)+"\r点伤害，可被防御减免。"},"#dda0dd"],[25,function(a){if(a.auraName){return a.auraName}if(a.hpValue&&a.atkValue&&a.defValue){return"魔力光环"}if(a.hpValue){if(a.hpValue>0){return"活力光环"}return"懒散光环"}if(a.atkValue){if(a.atkValue>0){return"狂暴光环"}return"静谧光环"}if(a.defValue){if(a.defValue>0){return"坚毅光环"}return"软弱光环"}return"光环"},function(a){var b;if(!a.range){b="同楼层所有敌人"}else{b="周围"+(a.zoneSquare?"方形":"十字")+"范围内\r[yellow]"+(a.range||1)+"\r格的敌人"}if(a.hpValue){if(a.hpValue>0){b+="生命提升\r[yellow]"+a.hpValue+"%\r，"}else{b+="生命降低\r[yellow]"+(-a.hpValue)+"%\r，"}}if(a.atkValue){if(a.atkValue>0){b+="攻击提升\r[yellow]"+a.atkValue+"%\r，"}else{b+="攻击降低\r[yellow]"+(-a.atkValue)+"%\r，"}}if(a.defValue){if(a.defValue>0){b+="防御提升\r[yellow]"+a.defValue+"%\r，"}else{b+="防御降低\r[yellow]"+(-a.defValue)+"%\r，"}}b+=(a.add?"线性叠加":"不可叠加");return b},"#e6e099",1],[26,"支援","同行或同列可到达范围内敌人受到攻击时将上前支援，跟随敌人战斗。","#77c0b6",1],[27,"捕捉","角色走到周围十字时会强制进行战斗。","#c0ddbb"],[28,function(a){if(a.value28>0){return"迅捷光环"}return"怠惰光环"},function(a){var b;if(!a.range){b="同楼层所有敌人"}else{b="周围"+(a.zoneSquare?"方形":"十字")+"范围内\r[yellow]"+(a.range||1)+"\r格的敌人"}if(a.value28>0){b+="获得额外\r[yellow]"+(a.value28||0)+"\r回合先攻，"}else{b+="被额外先攻\r[yellow]"+(-a.value28||0)+"\r回合，"}b+=(a.add?"可叠加":"不可叠加");return b},"#00dd00",1],[29,"闪避",function(a){return"受到的普通攻击伤害降低\r[yellow]"+(a.value29||0)+"%\r。"},"#c3c3c3"],[30,"匙之力",function(a){var b="\r[#e525ff]【圣匙战技】从附近散落的钥匙上汲取力量，强化自身\r\n";if(a.range){b+="周围"+(a.zoneSquare?"方形":"十字")+"范围内\r[yellow]"+a.range+"\r格，每存在一把黄钥匙，"}else{b+="同楼层每存在一把黄钥匙，"}if(a.value){b+="生命增加\r[yellow]"+a.value+"\r点，"}if(a.atkValue){b+="攻击增加\r[yellow]"+a.atkValue+"\r点，"}if(a.defValue){b+="防御增加\r[yellow]"+a.defValue+"\r点，"}b+="线性叠加。1把蓝钥匙=3把黄钥匙，1把红钥匙=10把黄钥匙。";if(!a.range){b+="（加成已显示在手册中）"}return b},"#A0A000",1],[31,"穿刺",function(a){return"自身的攻击无视角色\r[yellow]"+(a.value31||0)+"%\r的防御力。"}],[32,"亡命光环",function(a){var b="血战到底！\n";if(!a.range){b+="同楼层所有敌人"}else{b+="周围"+(a.zoneSquare?"方形":"十字")+"范围内\r[yellow]"+(a.range||1)+"\r格的敌人"}b+="阵亡时造成额外\r[yellow]"+(a.value32||0)+"\r点伤害，可叠加";return b},"#fff900",1],[33,"绝缘",function(a){if(core.getFlag("hard")==1&&core.getFlag("current_chapter",0)<3){return"此技能在简化难度下无效！"}return"免疫技能伤害。"},"#ddd900"],[34,"追击",function(a){var b="站住别动！\n角色经过怪物同行或同列时，会尝试朝角色移动一格。";if(core.getFlag("chase_no_force",0)==1){return b}return b+"\r[orange]若移动前与角色相邻，则强制战斗。\r"}],[35,"冰冻",function(a){return"战斗结束后，角色获得\r[yellow]"+(a.value35||0)+"\r层冰冻状态，每层使得角色战斗开始时被先攻1回合。每次战斗结束时减少1层该状态。"},"#747dff"],[36,"爆匙","\r[#e525ff]【圣匙战技】引动钥匙之力，毁灭敌人\r\n战斗开始时，令角色身上所有钥匙爆炸，每把爆炸的黄钥匙使角色被先攻1回合，蓝钥匙3回合，红钥匙10回合，可叠加。","#ff0000"],[37,"匙之意",function(a){var b="\r[#e525ff]【圣匙战技】十分精通钥匙之道，能从对方身上的钥匙获取力量\r\n角色身上每存在一把黄钥匙，";if(a.value){b+="生命增加\r[yellow]"+a.value+"\r点，"}if(a.atkValue){b+="攻击增加\r[yellow]"+a.atkValue+"\r点，"}if(a.defValue){b+="防御增加\r[yellow]"+a.defValue+"\r点，"}b+="可叠加。1把蓝钥匙=3把黄钥匙，1把红钥匙=10把黄钥匙。（加成已显示在手册中）";return b},"#CCCC00",1],[38,"法力燃烧",function(a){var b="燃烧对方\r[yellow]"+(a.value38_1||0)+"\r点能量，并造成不足部分\r[yellow]"+core.formatBigNumber(a.value38_2||0)+"\r倍的伤害。";if(core.getFlag("current_chapter",0)<3){b+="晚于角色技能发动。"}return b},"#c677dd"],[39,"远程支援",function(a){var b;if(!a.range){b="同楼层所有其他敌人"}else{b="周围"+(a.zoneSquare?"方形":"十字")+"范围内\r[yellow]"+(a.range||1)+"\r格的其他敌人"}return b+"与角色战斗时，每回合附加一次攻击。"},"#409056",1],[40,"暴戾",function(a){var b="逐渐疯狂的心。\n战斗结束后，角色获得\r[yellow]"+a.value40+"\r层暴戾状态，每层使得造成和受到的伤害均提升1%，线性叠加。每次战斗结束时减少";if(core.getFlag("hard")==2){return b+"\r[orange]一\r层。"}else{return b+"\r[orange]两\r层。"}},"#ff00a5"],[41,"反击","睚眦之怨，无不报复\n每次即将受到攻击时都会立刻攻击敌人1次","#a04056"],[42,"仿攻","攻击力若低于角色，则变为与角色相同","#ff00d2"],[43,"刚毅护盾","每次受到的伤害不大于最大生命值的10%。","#fff900"],[44,"疯狂",function(a){if(core.getFlag("hard",0)==1){return"杀戮，杀戮！\n战斗开始时，角色每有1层暴戾就\r[yellow]攻击空气\r1回合，战斗结束时暴戾层数减半。"}return"杀戮，杀戮！\n战斗开始时，角色每有1层暴戾就\r[orange]自残\r1回合，战斗结束时暴戾层数减半。"},"#ff00a5"],[45,"强击",function(a){return"拥有惊人爆发力的一击\n在进行首次攻击的回合，攻击力提升\r[yellow]"+(a.value45||0)+"\r倍。"},"#b30000"],[46,function(a){if(a.value46<0){return"枯萎之源"}return"生生不息"},function(a){var b;if(!a.range){b="同楼层所有敌人"}else{b="周围"+(a.zoneSquare?"方形":"十字")+"范围内\r[yellow]"+(a.range||1)+"\r格的敌人"}if(a.value46>0){b+="每次受到攻击时回复\r[yellow]"+core.formatBigNumber(a.value46||0)+"\r点生命，"}else{b+="每次受到攻击时失去\r[yellow]"+core.formatBigNumber(-a.value46||0)+"\r点生命，"}b+=(a.add?"可叠加":"不可叠加");return b},"#00dd00",1],[47,"沉醉",function(a){return"感官在奢华的生活中逐渐钝化\n战斗结束后，角色获得\r[yellow]"+a.value40+"\r层沉醉状态，每层使得造成和受到的伤害均减少1%，线性叠加。每次战斗结束时减少一层。"},"#b400ff"],[48,function(a){if(a.atkValue>0){if(a.add){return"颐指气使"}return"傲慢之心"}return"协同之力"},function(a){var b;if(a.atkValue>0){b="傲慢者不屑于与任何人为伍。\n";if(a.range){b+="周围\r[yellow]"+(a.zoneSquare?"方形":"十字")+"\r范围内\r[yellow]"+a.range+"\r格，"}else{b+="同楼层"}if(a.add){b+="每存在一个自身之外的友方单位，自身"}else{b+="如果存在友方单位，自身"}if(a.atkValue>0){b+="攻击下降\r[yellow]"+core.formatBigNumber(a.atkValue||0)+"\r点，"}if(a.defValue>0){b+="防御下降\r[yellow]"+core.formatBigNumber(a.defValue||0)+"\r点，"}if(a.hpValue>0){b+="生命下降\r[yellow]"+core.formatBigNumber(a.hpValue||0)+"\r点，"}if(a.add){b+="可叠加。"}else{b+="不可叠加。"}return b}b="从附近的友方单位获取力量和勇气\n";if(a.range){b+="周围\r[yellow]"+(a.zoneSquare?"方形":"十字")+"\r范围内\r[yellow]"+a.range+"\r格，"}else{b+="同楼层"}if(a.add){b+="每存在一个自身之外的友方单位，自身"}else{b+="如果存在友方单位，自身"}if(a.atkValue<0){b+="攻击提升\r[yellow]"+core.formatBigNumber(-a.atkValue||0)+"\r点，"}if(a.defValue<0){b+="防御提升\r[yellow]"+core.formatBigNumber(-a.defValue||0)+"\r点，"}if(a.hpValue<0){b+="生命提升\r[yellow]"+core.formatBigNumber(-a.hpValue||0)+"\r点，"}if(a.add){b+="可叠加。"}else{b+="不可叠加。"}return b},"#ffb040",1],[49,"清洁",function(a){return"使人焕然一新的治愈之力\n战斗后，角色清除所有负面状态。若清除前无负面状态，则恢复\r[yellow]"+core.formatBigNumber(a.value35||0)+"\r点生命值。"},"#00ff00"],[50,"极奢","令人不能自拔的泡沫……\n战斗后，沉醉状态层数加倍。","#ffff00"],[51,"凋零之歌",function(a){return"挽留不住的美好年华……\n战斗中，角色每回合失去\r[yellow]"+core.formatBigNumber(a.value46||0)+"\r点护盾，若无护盾则失去生命。"},"#bd26ce"],[52,"狂暴之力",function(a){return"战斗后，角色基础攻击暂时提升\r[yellow]"+core.formatBigNumber(a.value52||0)+"\r点，持续3场战斗。不可叠加，不可与其他提升共存。"},"#dd0000"],[53,"坚韧之力",function(a){return"战斗后，角色基础防御暂时提升\r[yellow]"+core.formatBigNumber(a.value53||0)+"\r点，持续3场战斗。不可叠加，不可与其他提升共存。"},"#0088ff"],[54,"护盾之力",function(a){return"战斗后，角色基础护盾暂时提升\r[yellow]"+core.formatBigNumber(a.value54||0)+"\r点，持续3场战斗。不可叠加，不可与其他提升共存。"},"#00dd00"],[55,"中子束","\r[#e525ff]【星际战技】\r每回合普攻2次，魔攻1次。","#ff0000"],[56,"驱散","战斗前，清除角色身上的有益状态。","#00d2d4"],[57,"大爆炸",function(a){return"碰到任何物体时爆炸，对周围一圈的所有单位造成\r[yellow]"+a.damage+"\r点不可被抵挡的伤害，并留下一滩熔岩。"},"#ff0000"],[58,"追踪","角色每移动一步，就会尝试朝角色移动一步。若移动前相邻则强制战斗。","#dd4444"],[59,"穿透","战斗中，无视角色护盾","#00d2d4"],[60,"挫锐",function(a){return"战斗中，角色攻击力减少\r[yellow]"+(a.value60||0)+"%\r。"},"#c0b088"],[61,function(a){if(a.atkValue>0||a.defValue>0||a.hpValue>0){return"协同作战"}else{return"反向协同"}},function(a){var b;if(a.atkValue>0||a.defValue>0||a.hpValue>0){b="United, we are strong!\n周围\r[yellow]"+(a.zoneSquare?"方形":"十字")+"\r范围内\r[yellow]"+(a.range||1)+"\r格，每存在一个自身之外的拥有本属性的友方单位，自身"}else{b="Together, we are five!\n周围\r[yellow]"+(a.zoneSquare?"方形":"十字")+"\r范围内\r[yellow]"+(a.range||1)+"\r格，每存在一个自身之外的拥有本属性的友方单位，自身"}if(a.atkValue>0){b+="攻击提升\r[yellow]"+core.formatBigNumber(a.atkValue||0)+"\r点，"}if(a.defValue>0){b+="防御提升\r[yellow]"+core.formatBigNumber(a.defValue||0)+"\r点，"}if(a.hpValue>0){b+="生命提升\r[yellow]"+core.formatBigNumber(a.hpValue||0)+"\r点，"}if(a.atkValue<0){b+="攻击降低\r[yellow]"+core.formatBigNumber(-a.atkValue)+"\r点，"}if(a.defValue<0){b+="防御降低\r[yellow]"+core.formatBigNumber(-a.defValue)+"\r点，"}if(a.hpValue<0){b+="生命降低\r[yellow]"+core.formatBigNumber(-a.hpValue)+"\r点，"}b+="可叠加。";return b},"#ffb040",1],[62,"命源封印","\r[#e525ff]【残缺奥义】似乎是某个血海奥义的劣化版\r\n战斗后主角生命值降为1，下次战斗后返还因此减少的生命值。","#ff8860"],[63,"残暴斩杀","\r[#e525ff]【魔方战技】来自魔方世界的强悍技能\r\n战斗开始时，若角色生命值不大于怪物生命，则直接\r[orange]暴毙\r","#ff0000"],[64,"完全毁灭",function(a){return"\r[#e525ff]【重要】\r战斗结束时产生大爆炸，摧毁周围方形范围内\r[yellow]"+(a.range||1)+"\r格的补给品、非绿色的门和钥匙，并对角色造成\r[yellow]"+core.formatBigNumber(a.damage||0)+"\r点伤害"},"#ff60dd"],[65,"腐蚀光环",function(a){var b;if(!a.range){b="同楼层发生战斗时"}else{b="周围"+(a.zoneSquare?"方形":"十字")+"范围内\r[yellow]"+(a.range||1)+"\r格发生战斗时"}b+="角色每点护盾抵挡伤害量降低\r[yellow]"+(a.value65||0)+"\r点，可叠加。";return b},"#12a012",1],[66,"破军",function(a){return"\r[#e525ff]【阴间刀法】若敢来犯，必叫你大败而归！\r\n角色经过周围\r[yellow]"+(a.zoneSquare?"方形":"十字")+"\r范围内\r[yellow]"+(a.range||1)+"\r格时生命降为1，被扣除的生命在下次战斗后返还。"},"#ff8860",1],[67,"真视",function(a){return"角色经过周围\r[yellow]"+(a.zoneSquare?"方形":"十字")+"\r范围内\r[yellow]"+(a.range||1)+"\r格时，立即退出隐身状态。"},"#80eed6",1],[68,"空间力场","角色在本层不能使用\\i[fly]楼层传送器。","#ff00d2"],[69,"援护","\r[#e525ff]【盾神战技】当角色靠近友军时挺身而出\r\n角色与该敌人的友军相距2格时，如果该敌人、友军和角色依次位于同一条线，且中间没有障碍物，\r[yellow]跳到角色和友军中间\r。","#77c0b6",1],[70,"窥血为攻","\r[#e525ff]【魔方战技】汝之生命，吾之利刃\r\n战斗开始时，自身攻击力变为角色当前生命值的10%，向下取整。","#ff0000"],[71,"虚化","角色处于隐身状态时可以穿过此敌人，未处于隐身状态下靠近时强制战斗。","#c3c3c3"],[72,"移形换位","\r[#e525ff]【传奇奥义】为复仇而生的技能，却往往被用来保护队友\r\n同行列的友军被角色接近后，若自身与友军中间没有门，与友军互换位置。","#30dddd"],[73,"轻风","战斗后，角色被推开，期间无视地图事件。","#bbeef0"],[74,"阳炎冲击",function(a){return"\r[#e525ff]【传奇奥义】哈雷克之火葬魔咒\r\n战斗结束时以自身为中心产生烈焰，使周围方形范围内\r[yellow]"+(a.range||1)+"\r格的补给品、门、钥匙、以及角色，共同分摊\r[yellow]"+core.formatBigNumber(a.damage||0)+"\r点伤害。"},"#ff60dd"],[75,"激爆",function(a){return"\r[#e525ff]【血海奥义】\r战斗后，摧毁同行列的补给品和非绿色的门，并对角色造成\r[yellow]"+core.formatBigNumber(a.damage||0)+"\r点伤害"},"#ff0000"],[76,"命令光环",function(a){var b;if(!a.range){b="同楼层所有敌人"}else{b="周围"+(a.zoneSquare?"方形":"十字")+"范围内\r[yellow]"+(a.range||1)+"\r格的敌人"}b+="在被角色靠近时主动发起战斗。";return b},"#ffee28",1],[77,"游猎",function(a){return"\r[#00a0ff]【蓝海战技】源自一座永不崩陨的圣城\r\n角色经过同行列可见范围时发起射击，造成\r[yellow]"+core.formatBigNumber(a.snipe_damage)+"\r点伤害，可被防御抵挡。如果角色经过相邻行列可见范围，则尝试移动一格后进行射击。"},"#6006c3",1],[78,"闭门","\r[#00a0ff]【蓝海技能】似乎是某种法则的劣化版\r\n战斗后，在以角色为中心的对称位置关上一扇\\i[yellowDoor]黄门。如果此位置是物品、非绿色门或不超过精英阶的敌人，会先将其摧毁。","#aabb20"],[79,"游击",function(a){return"\r[#00a0ff]【游击战法】敌进我退，敌驻我扰，敌退我追\r\n角色移动到同行列3格以内时，造成\r[yellow]"+core.formatBigNumber(a.value||0)+"\r点伤害，并尝试与角色保持2格距离。"},"#8888e6"],[80,"残虐",function(a){return"战斗中对手没有护盾时，受到额外\r[yellow]"+(a.value52||0)+"%\r伤害。"},"#ff9b9b"],[81,"追猎","角色经过此敌人同行或同列时，它会尝试向角色移动一格（不会被物品阻挡，但会被其他敌人或障碍物阻挡）。\r[orange]若移动前或移动后与角色相邻，则强制战斗。\r","#ff00d2"],[82,"刮骨",function(a){return"\r[#ccaa22]【黄海战技】\r战斗开始时，若角色没有临时护盾，该怪物本场战斗普通攻击造成的伤害提升\r[yellow]"+(a.value53||0)+"%\r。"},"#ccaa22"],[83,"定时炸弹",function(a){return"\r[#e525ff]【重要】\r战斗结束时在角色身上留下定时炸弹，角色移动\r[yellow]1\r步后爆炸，摧毁周围方形范围内\r[yellow]"+(a.range||1)+"\r格的补给品、非绿色的门和钥匙，并对角色造成\r[yellow]"+core.formatBigNumber(a.damage||0)+"\r点伤害。身上有炸弹时无法使用\\i[fly]传送器。"},"#ff60dd"],[84,"誓仇",function(a){return"\r[#e525ff]【虎魔战技】赐强者以勇气，予弱者以愚蠢\r\n战斗后给角色附加\r[yellow]"+a.n+"\r层标记，拥有标记时靠近敌人会\r[orange]强制战斗\r，并且角色每回合受攻击时额外承受\r[yellow]"+core.formatBigNumber(a.damage2)+"\r点伤害。每次战斗后减少一层标记。"},"#aabb20"],[85,"门之力",function(a){var b="\r[#e525ff]【黑屋战神】从附近的门中汲取力量，强化自身\r\n";if(a.range){b+="周围"+(a.zoneSquare?"方形":"十字")+"范围内\r[yellow]"+a.range+"\r格，每存在一个黄门，"}else{b+="同楼层每存在一个黄门，"}if(a.hpValue){b+="生命增加\r[yellow]"+core.formatBigNumber(a.hpValue)+"\r点，"}if(a.atkValue){b+="攻击增加\r[yellow]"+core.formatBigNumber(a.atkValue)+"\r点，"}if(a.defValue){b+="防御增加\r[yellow]"+core.formatBigNumber(a.defValue)+"\r点，"}b+="线性叠加。1蓝门=3黄门，1红门=10黄门。";if(!a.range){b+="（加成已显示在手册中）"}return b},"#a0a000",1],[86,"火焰喷射",function(a){return"\r[#e525ff]【重要】\r战斗后，角色向身后发射一道火焰，火焰碰到障碍后停止，摧毁路径上的所有非绿色门和补给品，并对途经的敌人造成\r[yellow]"+core.formatBigNumber(a.damage2)+"\r点伤害。"},"#dd4444"],[87,"友军","这是你的友军。可与其交互以令其撤退。","#00ff00"],[88,"电磁脉冲","战斗结束后，清空角色的临时护盾。","#c677dd"],[89,"吸噬",function(a){return"战斗中，当角色没有护盾时，敌人造成伤害的\r[yellow]"+a.value89+"%\r会回复其生命。"},"#ff6666"],[90,"能量之源","战斗结束后，角色额外获得\r[yellow]2\r层临时护盾。","#1b00ff"],[91,"避战",function(a){return"角色经过身边时造成\r[yellow]"+core.formatBigNumber(a.damage2||0)+"\r点伤害，并向另外三个方向中可移动距离最远的方向移动一格。距离相同时，优先后退，然后是顺时针的下一个方向。"},"#fbff00"],[92,"熔火",function(a){return"角色经过周围\r[yellow]"+(a.zoneSquare?"方形":"十字")+"\r范围内\r[yellow]"+(a.range||1)+"\r格时受到\r[yellow]"+(a.damage2||0)+"\r点伤害，并且使下次熔火伤害增加\r[orange]50%\r，乘法叠加；离开熔火范围后清除伤害加成。"},"#dd4444"],[93,function(a){if(a.damage2<100){return"吸域"}return"域 毙"},function(a){return"\r[#e525ff]【血海奥义】\r角色经过周围\r[yellow]"+(a.zoneSquare?"方形":"十字")+"\r范围内\r[yellow]"+(a.range||1)+"\r格时受到当前生命值\r[yellow]"+(a.damage2||0)+"%\r伤害"},"#ff00d2"],[94,function(a){if(a.damage2<100){return"吸阻"}return"阻 毙"},function(a){return"\r[#e525ff]【血海奥义】\r角色经过身边时造成当前生命值\r[yellow]"+(a.damage2||0)+"%\r伤害，并后退一格"},"#ff00d2"],[95,"激励",function(a){var b="战斗后，使\r[yellow]"+(a.zoneSquare?"方形":"十字")+"\r范围内\r[yellow]"+(a.range||1)+"\r格的其他敌人";if(a.hpValue){b+="生命增加\r[yellow]"+a.hpValue+"\r点，"}if(a.atkValue){if(a.atkValue>=0){b+="攻击增加\r[yellow]"+core.formatBigNumber(a.atkValue)+"\r点，"}else{b+="攻击减少\r[yellow]"+core.formatBigNumber(-a.atkValue)+"\r点，"}}if(a.defValue){if(a.defValue>=0){b+="防御增加\r[yellow]"+core.formatBigNumber(a.defValue)+"\r点，"}else{b+="防御减少\r[yellow]"+core.formatBigNumber(-a.defValue)+"\r点，"}}b+="不与同类效果叠加。";return b},"#ffee28"],[96,"强夺",function(a){return"战斗后，角色立即拾取敌人\r[yellow]"+(a.zoneSquare?"方形":"十字")+"\r范围内\r[yellow]"+(a.range||1)+"\r格的所有物品"},"#b400ff"],[101,"夹匙","经过两个相同的怪物中间，角色失去1把黄钥匙，若没有钥匙可失去则直接\r[orange]暴毙\r","#ff00d2"],[102,"域匙",function(a){return"经过周围\r[yellow]"+(a.zoneSquare?"方形":"十字")+"\r范围内\r[yellow]"+(a.range||1)+"\r格时角色失去1把黄钥匙，若没有钥匙可失去则直接\r[orange]暴毙\r"},"#ff00d2"],[103,"阻匙",function(a){return"角色经过身边时失去1把黄钥匙，同时怪物后退一格。若没有钥匙可失去则直接\r[orange]暴毙\r"},"#ff00d2"],[104,"无敌","\r[#ffee28]【至尊法则】\r免疫除\\i[E363]\r[orange]至尊爆弹\r之外的所有伤害。若角色主动触碰，会被击退3格，受到\r[yellow]300万\r伤害，并眩晕1回合。","#fbff00"],[105,"投掷爆弹","\r[#e525ff]【重要】\r向角色投掷\\i[E363]\r[orange]至尊爆弹\r，将角色向前击飞2格并造成\r[yellow]222221\r伤害。","#e525ff"],[106,"地烈炎斩","锁定角色当前位置，在接下来的2回合分别打击其所在行/列，造成\r[yellow]当前生命值10%+200万\r伤害，并留下熔岩。","#dd4444"],[107,"寒冰导弹","锁定角色当前位置，3回合后造成5*5的范围打击，造成\r[yellow]当前生命值5%+100万\r伤害、清除范围内的熔岩。","#747dff"],[108,"至尊之怒","\r[#ff0000]【危】\r在自身为中心7*7范围内实行毁灭性打击，造成\r[yellow]当前生命值50%+2221万\r伤害。","#ff0000"],[109,"禁魔力场","在本区域禁用\\i[fly]传送器","#1b00ff"],[110,"重生","\r[#ffee28]【至尊法则】重生之塔，流传千古\r\n战斗后，在角色身后生成\\i[E628]休眠态的爆弹。若角色背后是难以被破坏的物体，则不会生成。","#ffee28"],[111,"至尊之力","\r[#ffee28]【至尊法则】至尊之影，永世不灭\r\n战斗后，激活场上所有的\\i[E628]休眠态爆弹；若场上存在爆弹或技能\r[#e585ea]爆弹囚牢\r未失效，则自身立即重生。","#ffee28"],[112,"爆弹囚牢",function(a){if(core.getFlag("Chap3_boss_phase",0)==0){return"角色每进行3次战斗，便在角色斜向1格的4个位置生成\\i[E627]激活态爆弹。当场上爆弹总数达到\r[yellow]21\r个时，令每个\\i[E627]激活态爆弹对角色造成\r[yellow]999891\r伤害，激活所有\\i[E628]休眠态爆弹，失去此技能并开启技能\r[red][烈焰审判]\r。"}return"此技能已失效。"},"#e585ea"],[113,"烈焰审判",function(a){if(core.getFlag("Chap3_boss_phase",0)>0){return"角色每次战斗后，所有\\i[E627]激活态爆弹都会立即向周围方形1格喷射火焰，造成\r[yellow]2221222\r伤害。"}return"\r[yellow]此技能未开启\r。开启后效果：角色每次战斗后，所有\\i[E627]激活态爆弹都会立即向周围方形1格喷射火焰，造成\r[yellow]2221222\r伤害。"},"#dd4444"],[114,"命源干涉","\r[#ffee28]【超凡法则】以神秘的法则之力直接篡改对方的命源\r\n战斗结束前，将对方的能量值清空，并令其回复损失能量值\r[yellow]30000\r倍的生命。","#ffee28"],[115,"无法侦测","暂时还无法看穿对方的底细……","#aaaaaa"],[116,"分裂","死亡后在周围的空地生成\\i[E874]沸物。","#b0b666"],[117,"傲世之主","\r[#FF7800]【扭曲现实】\r角色每拾取2个物品，便在角色斜向1格的4个位置进行一次\r[yellow]召唤\r：如果是空地，生成\\i[E21Add1]傲慢之魂。傲慢之魂被摧毁时自身失去\r[yellow]250000\r点攻和\r[yellow]500000\r防。","#dd0000"],[118,"狂妄之主","\r[#FF7800]【污染现实】\r角色每进行3次战斗，便在角色斜向1格的4个位置进行一次\r[yellow]召唤\r：如果是空地，生成\\i[redRHeart]红色可爱元素。可爱元素被拾取或摧毁时自身失去\r[yellow]500000\r攻和\r[yellow]250000\r防。","#b030ff"],[119,"永恒蔑视",function(a){var d="\r[#FF7800]【大帝之力】\r每次被击败后立即重生，攻防复原并获得额外的能力。最多重生\r[yellow]4\r次。";var c=["重生后在角色斜向的所有位置发动召唤","每拾取2个物品，也会对斜向2格、同行列2格的位置发动召唤","重生后发动\r[#e525ff]【奥义】傲慢之踵\r：对角色施加恶毒的诅咒，使其攻防降低至\r[orange]1\r；强制与身边的敌人战斗；移动后炸毁方形\r[yellow]1\r格范围内的物品，如果没有炸毁任何物品则承受\r[yellow]2.5e\r点伤害；持续\r[orange]5\r步。","获得被动\r[#ffee28]【法则】狂傲护体\r：免疫非战斗伤害"];for(var b=0;b<4;++b){d+="\n";if(b<core.getFlag("A21boss_1p")){d+="\r[lime]?\r"}else{d+="?"}d+=c[b]}return d},"#ff6666"],[120,"无尽恶意",function(a){var d="\r[#FF7800]【大帝之力】\r每次被击败后立即重生，攻防复原并获得额外的能力。最多重生\r[yellow]4\r次。";var c=["重生后在角色同行列、距离为偶数的位置发动召唤","召唤对可爱元素存在的位置生效，使其升级","获得\r[#e525ff]【奥义】合成大可爱\r：角色与自身进行战斗前，如果自身生命值大于0，将场上的所有可爱元素合成为\\i[specialRHeart]大可爱元素，效果累加，然后强制令角色将其拾取。","获得被动\r[#ffee28]【法则】暗隐邪护\r：免疫战斗伤害"];for(var b=0;b<4;++b){d+="\n";if(b<core.getFlag("A21boss_2p")){d+="\r[lime]?\r"}else{d+="?"}d+=c[b]}return d},"#c677dd"],[121,"防火护盾","免疫\r[orange]火焰喷射\r的伤害。","#99aa44"],]},getEnemyInfo:function(h,r,Y,Z,p){p=p||core.status.floorId;var u=core.getRealStatusOrDefault(r,"hp"),s=core.getRealStatusOrDefault(r,"atk"),t=core.getRealStatusOrDefault(r,"def"),v=core.getRealStatusOrDefault(r,"mdef");var I=core.getEnemyValue(h,"hp",Y,Z,p),F=core.getEnemyValue(h,"atk",Y,Z,p),G=core.getEnemyValue(h,"def",Y,Z,p),L=core.getEnemyValue(h,"special",Y,Z,p);var J=core.getEnemyValue(h,"money",Y,Z,p),H=core.getEnemyValue(h,"exp",Y,Z,p),K=core.getEnemyValue(h,"point",Y,Z,p);var E=core.hasSpecial(L,87);if(!E){if(core.getFlag("previewSkill12",0)==1){var M=core.events.getEnemyOnPoint(Y,Z).atk;var C=core.material.enemys[h.id].atk;if(Math.abs(M-C)>core.getFlag("skill12_datk")){F=M}else{F=core.material.enemys[h.id].atk-core.getFlag("skill12_datk",0)}}if(core.getFlag("previewSkill13",0)==1){var n=Math.abs(Y-core.getFlag("temp_skill13_x")),o=Math.abs(Z-core.getFlag("temp_skill13_y"));var A=n<=2&&o<=2;if(n==2&&o==2){A=false}if(A){var M=core.events.getEnemyOnPoint(Y,Z).atk;var C=core.material.enemys[h.id].atk;if(Math.abs(M-C)>core.getFlag("skill13_datk")){F=M}else{F=core.material.enemys[h.id].atk-core.getFlag("skill13_datk",0)}var N=core.events.getEnemyOnPoint(Y,Z).def;var D=core.material.enemys[h.id].def;if(Math.abs(N-D)>core.getFlag("skill13_ddef")){G=N}else{G=core.material.enemys[h.id].def-core.getFlag("skill13_ddef",0)}var U=900*core.status.hero.mdef/100;var i=core.getFlag("skill10_basedmg")+core.getFlag("skill10_mdefdmgratio",0)*U;if(core.getFlag("A21boss",0)>0&&(h.id=="E888"||h.id=="E905")&&core.getFlag("A21boss_1p",0)>=4){i=0}if(core.getFlag("A21boss",0)>0&&h.id=="E906"&&core.getFlag("A21boss_2p",0)>=5){i=0}I-=i;if(n==0&&o==0){I-=i}}}}if(core.getFlag("hard",0)==1&&!E&&!core.hasSpecial(h.id,115)){F=F*(core.floors[p].hard1_enemy_ratio||100)/100;G=G*(core.floors[p].hard1_enemy_ratio||100)/100;if(core.getFlag("current_chapter",0)==3){I=I*(core.floors[p].hard1_enemy_ratio||100)/100}}if(core.hasSpecial(L,37)){var g=core.itemCount("yellowKey")+core.itemCount("blueKey")*3+core.itemCount("redKey")*10;I+=(h.value||0)*g;F+=(h.atkValue||0)*g;G+=(h.defValue||0)*g}if(core.hasSpecial(L,10)){F=s;G=t}if(core.hasSpecial(L,42)&&F<s){F=s}var q=[];var O=0,P=0,Q=0,R=0,S=0,T=0;if(!core.status.checkBlock){core.status.checkBlock={}}var a=core.getFlag("guard_buff_cache_atk",0),k=core.getFlag("guard_buff_cache_def",0),w=0;var m=-22222221;var X=m,V=m,W=m;if(core.status.checkBlock.needCache){var d=0,e=0,f=0,z=0,b=0,l=0;var B=Y!=null&&Z!=null?(Y+","+Z):"floor";if(!core.status.checkBlock.cache){core.status.checkBlock.cache={}}var c=core.status.checkBlock.cache[B];if(!c||B=="floor"){core.extractBlocks(p);core.status.maps[p].blocks.forEach(function(x){if(!x.disable){var ae=x.event.id,ag=core.material.items[ae],ab=core.material.enemys[ae];if(!E&&ab&&core.hasSpecial(ab.special,25)){var af=ab.range==null;if(ab.range!=null&&Y!=null&&Z!=null){var y=Math.abs(x.x-Y),aa=Math.abs(x.y-Z);if(y+aa<=ab.range){af=true}if(ab.zoneSquare&&y<=ab.range&&aa<=ab.range){af=true}}if(af){if(ab.add){w+=ab.hpValue||0;a+=ab.atkValue||0;k+=ab.defValue||0;d++}else{X=Math.max(X,ab.hpValue||0);V=Math.max(V,ab.atkValue||0);W=Math.max(W,ab.defValue||0)}}}if(!E&&ab&&core.hasSpecial(ab.special,26)&&Y!=null&&Z!=null&&((Y==x.x)||(Z==x.y))&&!(Y==x.x&&Z==x.y)){var ac=true;if(Y==x.x){var ak=Math.min(Z,x.y);var ai=Math.max(Z,x.y);for(var ad=ak+1;ad<ai;++ad){if(core.getBlock(Y,ad,p)!=null&&core.getBlock(Y,ad,p).event.noPass){if(core.getBlock(Y,ad,p).event.cls!="enemys"){if(core.getBlock(Y,ad,p).event.id=="airwall"){continue}ac=false;break}var al=core.enemys.enemys[core.getBlock(Y,ad,p).event.id].special;if(al&&core.hasSpecial(al,26)){}else{ac=false;break}}}}else{var aj=Math.min(Y,x.x);var ah=Math.max(Y,x.x);for(var ad=aj+1;ad<ah;++ad){if(core.getBlock(ad,Z,p)!=null&&core.getBlock(ad,Z,p).event.noPass){if(core.getBlock(ad,Z,p).event.cls!="enemys"){if(core.getBlock(ad,Z,p).event.id=="airwall"){continue}ac=false;break}var al=core.enemys.enemys[core.getBlock(ad,Z,p).event.id].special;if(al&&core.hasSpecial(al,26)){}else{ac=false;break}}}}if(ac){q.push([x.x,x.y,ae])}}if(!E&&ab&&core.hasSpecial(ab.special,28)){var af=ab.range==null;if(ab.range!=null&&Y!=null&&Z!=null){var y=Math.abs(x.x-Y),aa=Math.abs(x.y-Z);if(y+aa<=ab.range){af=true}if(ab.zoneSquare&&y<=ab.range&&aa<=ab.range){af=true}}if(af&&(ab.add||e==0)){O+=ab.value28;e++}}if(!E&&ab&&core.hasSpecial(ab.special,32)){var af=ab.range==null;if(ab.range!=null&&Y!=null&&Z!=null){var y=Math.abs(x.x-Y),aa=Math.abs(x.y-Z);if(y+aa<=ab.range){af=true}if(ab.zoneSquare&&y<=ab.range&&aa<=ab.range){af=true}}if(af){P+=ab.value32||0}}if(!E&&core.hasSpecial(h.special,30)&&ag&&(ae=="yellowKey"||ae=="blueKey"||ae=="redKey"||ae=="yellowKey3"||ae=="blueKey3"||ae=="redKey3")){var af=h.range==null;if(h.range!=null&&Y!=null&&Z!=null){var y=Math.abs(x.x-Y),aa=Math.abs(x.y-Z);if(y+aa<=h.range){af=true}if(h.zoneSquare&&y<=h.range&&aa<=h.range){af=true}}var am=1;if(ae=="blueKey"){am=3}if(ae=="redKey"){am=10}if(ae=="yellowKey3"){am=3}if(ae=="blueKey3"){am=9}if(ae=="redKey3"){am=30}if(af){z+=am*(h.value||0);b+=am*(h.atkValue||0);l+=am*(h.defValue||0)}}if(!E&&core.hasSpecial(h.special,85)&&(ae=="yellowDoor"||ae=="blueDoor"||ae=="redDoor")){var af=h.range==null;if(h.range!=null&&Y!=null&&Z!=null){var y=Math.abs(x.x-Y),aa=Math.abs(x.y-Z);if(y+aa<=h.range){af=true}if(h.zoneSquare&&y<=h.range&&aa<=h.range){af=true}}var am=1;if(ae=="blueDoor"){am=3}if(ae=="redDoor"){am=10}if(af){z+=am*(h.hpValue||0);b+=am*(h.atkValue||0);l+=am*(h.defValue||0)}}if(!E&&ab&&core.hasSpecial(ab.special,46)){var af=ab.range==null;if(ab.range!=null&&Y!=null&&Z!=null){var y=Math.abs(x.x-Y),aa=Math.abs(x.y-Z);if(y+aa<=ab.range){af=true}if(ab.zoneSquare&&y<=ab.range&&aa<=ab.range){af=true}}if(af){S+=ab.value46||0}}if(!E&&core.hasSpecial(h.special,48)&&ab){var af=h.range==null;var y=Math.abs(x.x-Y),aa=Math.abs(x.y-Z);if(h.range!=null&&Y!=null&&Z!=null){if(y+aa<=h.range){af=true}if(h.zoneSquare&&y<=h.range&&aa<=h.range){af=true}}if(y==0&&aa==0){af=false}if(af&&(h.add||f==0)){b-=(h.atkValue||0);l-=(h.defValue||0);z-=(h.hpValue||0);f++}}if(!E&&core.hasSpecial(h.special,61)&&ab){var af=h.range==null;var y=Math.abs(x.x-Y),aa=Math.abs(x.y-Z);if(h.range!=null&&Y!=null&&Z!=null){if(y+aa<=h.range){af=true}if(h.zoneSquare&&y<=h.range&&aa<=h.range){af=true}}if(y==0&&aa==0){af=false}if(!core.hasSpecial(ab.special,61)){af=false}if(af){b+=(h.atkValue||0);l+=(h.defValue||0);z+=(h.hpValue||0)}}if(!E&&ab&&core.hasSpecial(ab.special,65)){var af=ab.range==null;if(ab.range!=null&&Y!=null&&Z!=null){var y=Math.abs(x.x-Y),aa=Math.abs(x.y-Z);if(y+aa<=ab.range){af=true}if(ab.zoneSquare&&y<=ab.range&&aa<=ab.range){af=true}}if(af){T+=(ab.value65||0)}}}});core.status.maps[p].blocks.forEach(function(x){if(!x.disable){var ae=x.event.id,ag=core.material.items[ae],ac=core.material.enemys[ae];if(!E&&ac&&core.hasSpecial(ac.special,39)&&!(Y==x.x&&Z==x.y)){var af=ac.range==null;if(ac.range!=null&&Y!=null&&Z!=null){var aa=Math.abs(x.x-Y),ab=Math.abs(x.y-Z);if(aa+ab<=ac.range){af=true}if(ac.zoneSquare&&aa<=ac.range&&ab<=ac.range){af=true}}if(af){var ad=1;if(flags.hard==1){ad=(core.floors[p].hard1_enemy_ratio||100)/100}Q+=(ac.atk*ad*(1+a/100))||0;var y=1;if(core.hasSpecial(ac.special,31)){y=(y*100-ac.value31)/100}if(core.hasSpecial(ac.special,2)){y=0}R+=y}}}});if(X==m){X=0}if(V==m){V=0}if(W==m){W=0}w=w==0?X:w;a=a==0?V:a;k=k==0?W:k;core.status.checkBlock.cache[B]={hp_buff:w,atk_buff:a,def_buff:k,guards:q,spe28_buff:O,spe32_buff:P,spe39_buff:Q,spe39_count:R,spe46_buff:S,spe65_buff:T,hp_extra:z,atk_extra:b,def_extra:l}}else{w=c.hp_buff;a=c.atk_buff;k=c.def_buff;q=c.guards;O=c.spe28_buff;P=c.spe32_buff;Q=c.spe39_buff;R=c.spe39_count;S=c.spe46_buff;T=c.spe65_buff;z=c.hp_extra;b=c.atk_extra;l=c.def_extra}I+=z;F+=b;G+=l;I*=(100+w)/100}F*=(100+a)/100;G*=(100+k)/100;if(core.hasSpecial(L,70)){F=u*0.1}if(core.hasSpecial(L,3)&&G<s-1){G=s-1}if(core.getTalentLv2(5)>0&&core.getFlag("invisible",0)==1){var j=[0,100000,200000];G-=j[core.getTalentLv2(5)]}return{hp:Math.floor(I),atk:Math.floor(F),def:Math.floor(G),money:Math.floor(J),exp:Math.floor(H),point:Math.floor(K),special:L,guards:q,spe28_buff:O,spe32_buff:P,spe39_buff:Q,spe39_count:R,spe46_buff:S,spe65_buff:T,hp_buff:w}},getDamageInfo:function(j,t,ao,ap,n){n=n||core.status.floorId;var B=core.getRealStatusOrDefault(t,"hp"),u=core.getRealStatusOrDefault(t,"atk"),A=core.getRealStatusOrDefault(t,"def"),C=core.getRealStatusOrDefault(t,"mdef"),w=core.getStatus("atk"),z=core.getStatus("def"),a=A;B=Math.max(0,B);u=Math.max(0,u);A=Math.max(0,A);C=Math.max(0,C);var k=core.enemys.getEnemyInfo(j,t,ao,ap,n);var P=k.hp,M=k.atk,O=k.def,W=k.special,R=k.spe28_buff,S=k.spe39_buff,T=k.spe39_count,U=k.spe46_buff,V=k.spe65_buff;if(core.getFlag("A21boss",0)==1){if(core.getFlag("A21boss_1p",0)>=5&&j.id=="E888"){return null}if(core.getFlag("A21boss_2p",0)>=5&&j.id=="E889"){return null}}if(core.hasSpecial(W,20)&&!core.hasItem("cross")){return null}if(P<=0){var e=0;return{mon_hp:0,mon_atk:Math.floor(M),mon_def:Math.floor(O),init_damage:0,per_damage:0,hero_per_damage:9922,turn:1,damage:e,spe46_buff:0}}if(core.getFlag("A21boss",0)==1){if(core.getFlag("A21boss_1p",0)>=5&&j.id=="E888"){return null}if(core.getFlag("A21boss_2p",0)>=4&&j.id=="E889"){return null}}if(core.hasSpecial(W,63)&&B<=P){return null}var l=0;var ah=0;var ai=0;if(core.getFlag("skill",0)==1){ah=core.getFlag("skill1_stun",0)}if(core.getFlag("skill",0)==2){ai=(z*core.getFlag("skill2_val")/100);a+=ai}var af=1+core.getFlag("rage_stack",0)*0.01;if(core.hasSpecial(W,31)){a=a*(100-j.value31)/100}if(core.hasSpecial(W,60)){u=u*(100-j.value60)/100}var ac=M-a;if(core.hasSpecial(W,2)){ac=M}if(ac<0){ac=0}var N=1;if(core.hasSpecial(W,4)){N=2}if(core.hasSpecial(W,5)){N=3}if(core.hasSpecial(W,6)){N=(j.n||4)}if(core.hasSpecial(W,82)&&core.getFlag("temp_mdef_pp",0)==0){N=(100+j.value53)/100}if(core.hasSpecial(W,55)){N=2}ac*=N;if(core.hasSpecial(W,55)){ac+=M}var ae=Math.max(0,S-a*T);ac+=ae;ac*=af;if(core.hasSpecial(W,51)){ac+=j.value46}if(core.getFlag("spe84_n",0)>0){ac+=core.getFlag("spe84_dmg")}var c=0;if(core.hasSpecial(W,8)){c+=Math.floor((j.atkValue||core.values.counterAttack)*u/100)}if(core.hasSpecial(W,41)){c+=M-a}c*=af;O*=(1-0.1*core.plugin.getTalentLv(5));var D=Math.max(u-O,0);if(core.hasSpecial(W,29)){D*=((100-j.value29)/100)}D*=af;if(core.hasEquip("sword5")){D*=1.25}if(core.hasSpecial(W,43)){D=Math.min(P*0.1,D)}D-=(U||0);var I=0;if(core.hasSpecial(W,11)){var an=B*j.value;if(core.hasItem("I_noVampire")){an=0}an=Math.floor(an)||0;if(j.add){P+=an}I+=an}var aj=0;if(core.hasSpecial(W,1)){aj+=(j.value28||1)}if(R!=0){aj+=R}if(core.getFlag("freeze_stack",0)>0){aj+=core.getFlag("freeze_stack",0)}if(core.getFlag("skill6_battle",0)>0){if(aj>0){aj=0}aj-=core.getFlag("skill6_battle_round",0)}if(core.hasSpecial(W,36)){aj+=core.itemCount("yellowKey");aj+=core.itemCount("blueKey")*3;aj+=core.itemCount("redKey")*10}var J=0;if(core.hasSpecial(W,44)&&core.getFlag("rage_stack",0)>0){J=core.getFlag("rage_stack",0);aj+=J;if(core.getFlag("hard")==2){I+=J*(Math.max(0,(u-A)))}}if(t&&t.hasOwnProperty("mad_turn")&&t.mad_turn>0){I+=t.mad_turn*Math.max(0,M-A)}if(aj>=0){I+=aj*ac}if(core.hasSpecial(W,9)){I+=Math.floor((j.n||core.values.purify)*C)}I*=af;if(core.plugin.getTalentLv(9)>0){I*=(0.8-0.1*core.plugin.getTalentLv(9))}var L=core.getFlag("mdef_ratio",1);L-=V;if(core.getFlag("skill5_dm",0)>0&&core.getFlag("skill5_is_on",false)){L+=0.4}if(core.hasEquip("sword7")){L+=0.35}var ag=0;if(core.getFlag("skill",0)==1){ag=Math.max((C*L-I)/L,0)*core.getFlag("skill1_ratio",1)}if(core.plugin.getTalentLv(11)>0){ag+=(u+C)*0.5*core.plugin.getTalentLv(11)}ag*=af;if(t&&t.hasOwnProperty("skill1_damage")&&t.skill1_damage>0){ag=t.skill1_damage}if(core.hasSpecial(W,43)){P-=Math.min(P*0.1,ag)}else{if(!core.hasSpecial(W,3)&&!core.hasSpecial(W,33)){P-=ag}}var Q=P;var v=0;if(aj<0){v+=-aj}v+=core.plugin.getTalentLv(4);P-=v*D;if(D<=0&&P>0){return null}var am=Math.max(Math.ceil(P/D),1);if(P<=0){am=1;ac=0}if(core.hasSpecial(W,89)&&ac>0){var Y=Math.ceil(C*L/ac);if(Y<am-1){var aa=P-Y*D;var Z=D-Math.max(ac*0.01*j.value89,0);if(Z<=0){return null}var ab=Math.ceil(aa/Z);am=Y+ab}}var q=core.getFlag("__guards__"+ao+"_"+ap,k.guards);var p=false;if(P>=0){am+=core.getFlag("__extraTurn__",0)}if(q.length>0){if(!p){core.setFlag("__extraTurn__",am)}for(var E=0;E<q.length;E++){var r=q[E][0],s=q[E][1],o=q[E][2];var H=core.enemys.getDamageInfo(core.material.enemys[o],{hp:B,atk:w,def:z,mdef:0,skill1_damage:ag,mad_turn:J});if(H==null){return null}core.setFlag("__extraTurn__",H.turn);I+=H.damage}if(p){am+=core.getFlag("__extraTurn__",0)}}core.removeFlag("__extraTurn__");var X=(am-1-ah)*ac+am*c+ah*ae;if(core.getTalentLv(6)>0){var G=[0,29,19,15];var F=G[core.getTalentLv(6)];var ak=1;if(aj<0){F+=aj;ak=-aj}var b=0.01*core.getTalentLv(6)*(ak+ak+F-1)/2;if(F<=0){X*=(0.8-0.1*core.getTalentLv(6))}else{if(am-1<=F){b=0.01*core.getTalentLv(6)*(ak+am-1)/2;X*=(1-b)}else{var g=X*F/(am-1);var h=X-g;X=g*(1-b)+h*(0.8-0.1*core.getTalentLv(6))}}}var e=I+X;if(core.hasSpecial(W,7)&&(am-ah>1||aj>0)){e+=Math.floor((j.defValue||core.values.breakArmor)*A)*af}if(core.hasSpecial(W,45)&&(am-ah>1||aj>0)){e+=(M*(1+j.value45)-a-Math.max(0,M-a))*af*N}if(core.getFlag("skill",0)==2){var ad=ai-Math.max(0,a-M);ad=Math.max(0,ad);e+=(ac+ad*N*af)*core.getFlag("skill2_charge",3);e+=aj*ad*N*af}var m=0;if(core.hasSpecial(W,38)){var d=core.status.hero.mana;if(core.getFlag("skill",0)==1){d-=core.getFlag("skill1_cost",10)}else{if(core.getFlag("skill",0)==2){d-=core.getFlag("skill2_cost",10)}}m+=Math.max(0,j.value38_1-d)*j.value38_2}if(core.hasSpecial(W,22)){m+=j.damage||0}m+=k.spe32_buff||0;if(core.hasSpecial(W,17)){m+=core.getFlag("hatred",0)}m*=af;if(core.plugin.getTalentLv(9)>0){m*=(0.8-0.1*core.plugin.getTalentLv(9))}e+=m;C+=(am-1)*A*0.02*core.plugin.getTalentLv(7);if(!core.hasSpecial(W,59)){e-=C*L}if(core.hasSpecial(W,80)){e*=(100+j.value52)/100}var f=core.getFlag("skill5_dm",0)>0&&core.getFlag("skill5_is_on",false);if(!f){e=Math.max(0,e)}if(core.hasEquip("sword6")){if(v+am>10){e-=0.1*10*D}else{e-=0.1*Q}}if(core.getFlag("skill5_am",0)==1){e-=0.1*k.hp}if(core.plugin.getTalentLv(12)>0){var al=Math.floor(am/5);var K=10+10*core.plugin.getTalentLv(12);if(al>K){al=K}e-=al*A*0.1}if(f){e=Math.max(-3*core.getRealStatusOrDefault(null,"mdef"),e)}if(core.getFlag("skill8_buff",0)>0){e/=4}return{mon_hp:Math.floor(P),mon_atk:Math.floor(M),mon_def:Math.floor(O),init_damage:Math.floor(I),per_damage:Math.floor(ac),hero_per_damage:Math.floor(D),turn:Math.floor(am),damage:Math.floor(e),spe46_buff:Math.floor(U)}}},actions:{onKeyUp:function(d,a){if(core.isMoving()){return}if(a&&d>=48&&d<=57){core.items.quickLoadEquip(d-48);return}switch(d){case 27:core.openSettings(true);break;case 88:core.openBook(true);break;case 71:core.useFly(true);break;case 65:core.doSL("autoSave","load");break;case 87:core.doSL("autoSave","reload");break;case 83:core.save(true);break;case 68:core.load(true);break;case 69:core.ui.drawCursor();break;case 84:core.openToolbox(true);break;case 81:core.openEquipbox(true);break;case 90:core.turnHero();break;case 86:core.openQuickShop(true);break;case 32:core.getNextItem();break;case 82:core.actions._clickSyncSave_replay();break;case 33:case 34:core.ui._drawViewMaps();break;case 66:core.ui._drawStatistics();break;case 72:core.ui.drawHelp();break;case 77:core.actions._clickNotes_show();break;case 78:core.confirmRestart();break;case 79:core.actions._clickGameInfo_openProject();break;case 80:core.actions._clickGameInfo_openComments();break;case 49:if(core.canUseItem("skill1")){core.useItem("skill1")}else{if(core.canUseItem("skill0")){core.useItem("skill0")}else{if(core.canUseItem("skill3")){core.useItem("skill3")}else{if(core.canUseItem("skill6")){core.useItem("skill6")}else{if(core.canUseItem("skill10")){core.useItem("skill10")}}}}}break;case 50:if(core.canUseItem("skill2")){core.useItem("skill2")}else{if(core.canUseItem("pickaxe")){core.useItem("pickaxe")}else{if(core.canUseItem("skill4")){core.useItem("skill4")}else{if(core.canUseItem("skill7")){core.useItem("skill7")}else{if(core.canUseItem("skill12")){core.events.tryUseItem("skill12")}}}}}break;case 51:if(core.canUseItem("I_wait")){core.useItem("I_wait")}else{if(core.canUseItem("skill5")){core.useItem("skill5")}else{if(core.canUseItem("skill8")){core.useItem("skill8")}else{if(core.hasItem("skill13")){core.events.tryUseItem("skill13")}}}}break;case 52:if(core.canUseItem("I_energyOrb")){core.useItem("I_energyOrb");break}if(core.canUseItem("greenBomb")){core.useItem("greenBomb");break}var e=["icePickaxe","freezeBadge","earthquake","upFly","downFly","jumpShoes","lifeWand","poisonWine","weakWine","curseWine","superWine"];for(var b=0;b<e.length;b++){var c=e[b];if(core.canUseItem(c)){core.status.route.push("key:52");core.useItem(c,true);break}}break;case 53:core.doSL("autoSave","load");break;case 54:core.doSL("autoSave","reload");break;case 55:core.getNextItem();break;case 118:core.debug();break}},onStatusBarClick:function(a,b){if(core.status.lockControl){return}if(core.isMoving()){return}console.log("onStatusBarClick:",a,b);if(core.domStyle.isVertical){if(a>=6&&a<=38&&b>=72&&b<=104){if(core.hasItem("skill1")){core.useItem("skill1")}else{if(core.hasItem("skill0")){core.useItem("skill0")}else{if(core.hasItem("skill3")){core.useItem("skill3")}else{if(core.hasItem("skill6")){core.useItem("skill6")}else{if(core.hasItem("skill10")){core.useItem("skill10")}}}}}}if(a>=46&&a<=78&&b>=72&&b<=104){if(core.hasItem("skill2")){core.useItem("skill2")}else{if(core.hasItem("skill4")){core.useItem("skill4")}else{if(core.hasItem("skill7")){core.useItem("skill7")}else{if(core.hasItem("skill12")){core.ui._drawSkill12()}}}}}if(a>=86&&a<=118&&b>=72&&b<=104){if(core.hasItem("I_wait")){core.useItem("I_wait")}else{if(core.hasItem("skill5")){core.useItem("skill5")}else{if(core.hasItem("skill8")){core.useItem("skill8")}else{if(core.hasItem("skill13")){core.ui._drawSkill13()}}}}}if(a>=126&&a<=158&&b>=72&&b<=104){if(core.hasItem("pickaxe")){core.useItem("pickaxe")}}if(a>=146&&a<=178&&b>=72&&b<=104){if(core.hasItem("I_energyOrb")){core.useItem("I_energyOrb")}else{if(core.hasItem("greenBomb")){core.useItem("greenBomb")}}}}else{if(a>=6&&a<=38&&b>=210&&b<=242){if(core.hasItem("skill1")){core.useItem("skill1")}else{if(core.hasItem("skill0")){core.useItem("skill0")}else{if(core.hasItem("skill3")){core.useItem("skill3")}else{if(core.hasItem("skill6")){core.useItem("skill6")}else{if(core.hasItem("skill10")){core.useItem("skill10")}}}}}}if(a>=46&&a<=78&&b>=210&&b<=242){if(core.hasItem("skill2")){core.useItem("skill2")}else{if(core.hasItem("skill4")){core.useItem("skill4")}else{if(core.hasItem("skill7")){core.useItem("skill7")}else{if(core.hasItem("skill12")){core.ui._drawSkill12()}}}}}if(a>=86&&a<=118&&b>=210&&b<=242){if(core.hasItem("I_wait")){core.useItem("I_wait")}else{if(core.hasItem("skill5")){core.useItem("skill5")}else{if(core.hasItem("skill8")){core.useItem("skill8")}else{if(core.hasItem("skill13")){core.ui._drawSkill13()}}}}}if(a>=6&&a<=38&&b>=250&&b<=282){if(core.hasItem("pickaxe")){core.useItem("pickaxe")}else{if(core.hasItem("I_energyOrb")){core.useItem("I_energyOrb")}}}if(a>=86&&a<=118&&b>=250&&b<=282){if(core.hasItem("greenBomb")){core.useItem("greenBomb")}}}}},control:{saveData:function(){var d={};for(var c in core.values){if(!core.same(core.values[c],core.data.values[c])){d[c]=core.clone(core.values[c])}}var b=["skill1_extra_text","I62_extra_description","skill12_desc1"];var a={floorId:core.status.floorId,hero:core.clone(core.status.hero),hard:core.status.hard,maps:core.maps.saveMap(),route:core.encodeRoute(core.status.route),values:d,version:core.firstData.version,guid:core.getGuid(),time:new Date().getTime(),bgmSpeed:core.musicStatus.bgmSpeed};return a},getStatusLabel:function(a){return{name:"名称",lv:"等级",hpmax:"生命上限",hp:"生命",manamax:"魔力上限",mana:"魔力",atk:"攻击",def:"防御",mdef:"护盾",money:"金币",exp:"经验",point:"加点",steps:"步数",}[a]||a},loadData:function(b,a){core.resetGame(b.hero,b.hard,b.floorId,core.maps.loadMap(b.maps,null,b.hero.flags),b.values);core.status.route=core.decodeRoute(b.route);core.control._bindRoutePush();core.status.textAttribute=core.getFlag("textAttribute",core.status.textAttribute);var d=core.getFlag("globalAttribute",core.status.globalAttribute);if(!core.same(d,core.status.globalAttribute)){core.status.globalAttribute=d;core.resize()}core.events.setVolume(core.getFlag("__volume__",1),0);var c=core.status.hero.image;c=core.getMappedName(c);if(core.material.images.images[c]){core.material.images.hero=core.material.images.images[c];core.material.icons.hero.width=core.material.images.images[c].width/4;core.material.icons.hero.height=core.material.images.images[c].height/4}core.setFlag("__fromLoad__",true);core.setFlag("lastWeatherTime",0);core.setFlag("lastTime",0);core.events.stopAsync();if(core.getFlag("invisible",0)==1){core.setOpacity("hero",0.5)}else{core.setOpacity("hero",0.99)}core.changeFloor(b.floorId,null,b.hero.loc,0,function(){if(core.hasFlag("__bgm__")){core.playBgm(core.getFlag("__bgm__"))}core.setBgmSpeed(b.bgmSpeed||100,true);core.removeFlag("__fromLoad__");if(core.getFlag("B20F_boss_activated",0)==1){core.insertCommonEvent("Ch1BossDraw")}if(core.getFlag("Ch4_boss_activated",0)==1){core.insertCommonEvent("Ch4BossDraw")}if(core.getFlag("A21boss",0)==1){core.insertCommonEvent("Ch4_2BossDraw")}if(core.getFlag("70F_boss_phase",0)==1){core.trigger(0,12);if(core.getFlag("70Fboss_skill2_ready",0)>0){if(core.getFlag("70Fboss_skill2_dir",0)%2!=0){core.insertAction({type:"showImage",code:1,image:"downArrow.png",loc:["flag:70Fboss_skill2_loc_x*32","flag:70Fboss_skill2_loc_y*32"],opacity:1,time:0})}else{core.insertAction({type:"showImage",code:1,image:"rightArrow.png",loc:["flag:70Fboss_skill2_loc_x*32","flag:70Fboss_skill2_loc_y*32"],opacity:1,time:0})}}if(core.getFlag("70Fboss_skill3_ready",0)>0){core.insertAction({type:"showImage",code:2,image:"guangbiao.png",loc:["flag:70Fboss_skill3_loc_x*32","flag:70Fboss_skill3_loc_y*32"],opacity:1,time:0})}}if(a){a()}})},triggerDebuff:function(a,b){if(!(b instanceof Array)){b=[b]}if(a=="get"){if(core.inArray(b,"poison")&&!core.hasFlag("poison")){core.setFlag("poison",true)}if(core.inArray(b,"weak")&&!core.hasFlag("weak")){core.setFlag("weak",true);if(core.values.weakValue>=1){core.addStatus("atk",-core.values.weakValue);core.addStatus("def",-core.values.weakValue)}else{core.addBuff("atk",-core.values.weakValue);core.addBuff("def",-core.values.weakValue)}}if(core.inArray(b,"curse")&&!core.hasFlag("curse")){core.setFlag("curse",true)}if(core.inArray(b,"superweak")&&!core.hasFlag("superweak")){core.setFlag("superweak",true);core.drawHeroAnimate("seal");core.drawHeroAnimate("thunder3");core.setFlag("cannotMoveDirectly",true);core.setFlag("saved_atk",core.status.hero.atk);core.setFlag("saved_def",core.status.hero.def);core.setFlag("saved_atk_buff",core.getFlag("__atk_buff__",1));core.setFlag("saved_def_buff",core.getFlag("__def_buff__",1));core.setFlag("__atk_buff__",1);core.setFlag("__def_buff__",1);core.status.hero.atk=1;core.status.hero.def=1}}else{if(a=="remove"){if(core.inArray(b,"poison")&&core.hasFlag("poison")){core.setFlag("poison",false)}if(core.inArray(b,"weak")&&core.hasFlag("weak")){core.setFlag("weak",false);if(core.values.weakValue>=1){core.addStatus("atk",core.values.weakValue);core.addStatus("def",core.values.weakValue)}else{core.addBuff("atk",core.values.weakValue);core.addBuff("def",core.values.weakValue)}}if(core.inArray(b,"curse")&&core.hasFlag("curse")){core.setFlag("curse",false)}if(core.inArray(b,"superweak")&&core.hasFlag("superweak")){core.setFlag("superweak",false);core.drawHeroAnimate("dispel");core.setFlag("cannotMoveDirectly",false);core.status.hero.atk=core.getFlag("saved_atk",0);core.status.hero.def=core.getFlag("saved_def",0);core.setFlag("__atk_buff__",core.getFlag("saved_atk_buff",1));core.setFlag("__def_buff__",core.getFlag("saved_def_buff",1));core.updateStatusBar()}}}},updateStatusBar:function(){if(core.getFlag("no_updateStatusBar",0)==1){return}core.events.checkLvUp();if(core.flags.statusBarItems.indexOf("enableHPMax")>=0){core.setStatus("hp",Math.min(core.getStatus("hpmax"),core.getStatus("hp")))}if(core.status.floorId){core.setStatusBarInnerHTML("floor",core.status.maps[core.status.floorId].name)}core.setStatusBarInnerHTML("name",core.getStatus("name"));core.setStatusBarInnerHTML("lv",core.getLvName());var c=["hpmax","hp","mana","atk","def","mdef","money","exp"];c.forEach(function(d){core.status.hero[d]=Math.floor(core.status.hero[d]);core.setStatusBarInnerHTML(d,core.getRealStatus(d))});if(core.status.hero.manamax!=null&&core.getRealStatus("manamax")>=0){core.status.hero.mana=Math.min(core.status.hero.mana,core.getRealStatus("manamax"));core.setStatusBarInnerHTML("mana",core.status.hero.mana+"/"+core.getRealStatus("manamax"))}else{core.setStatusBarInnerHTML("mana",core.status.hero.mana)}core.setStatusBarInnerHTML("skill",core.getFlag("skillName","无"));if(core.flags.statusBarItems.indexOf("enableLevelUp")>=0&&core.status.hero.lv<core.firstData.levelUp.length){var b=core.calValue(core.firstData.levelUp[core.status.hero.lv].need);if(core.flags.statusBarItems.indexOf("levelUpLeftMode")>=0){core.setStatusBarInnerHTML("up",core.formatBigNumber(b-core.getStatus("exp"))||"")}else{core.setStatusBarInnerHTML("up",core.formatBigNumber(b)||"")}}else{core.setStatusBarInnerHTML("up","")}var a=["yellowKey","blueKey","redKey","greenKey"];a.forEach(function(d){core.setStatusBarInnerHTML(d,core.setTwoDigits(core.itemCount(d)))});if(core.hasItem("I_superGreenKey")){core.setStatusBarInnerHTML("greenKey","∞")}core.setStatusBarInnerHTML("poison",core.hasFlag("poison")?"毒":"");core.setStatusBarInnerHTML("weak",core.hasFlag("weak")?"衰":"");core.setStatusBarInnerHTML("curse",core.getFlag("freeze_stack",0)>0?"冰 "+core.getFlag("freeze_stack",0):"");if(core.getFlag("spe62_seal_hp",0)>0){core.setStatusBarInnerHTML("curse","封 "+core.getFlag("spe62_seal_hp",0))}core.setStatusBarInnerHTML("pickaxe","破"+core.itemCount("pickaxe"));core.setStatusBarInnerHTML("bomb","炸"+core.itemCount("bomb"));core.setStatusBarInnerHTML("fly","飞"+core.itemCount("centerFly"));if(core.statusBar.hard.innerText!=core.status.hard){core.statusBar.hard.innerText=core.status.hard;main.levelChoose.forEach(function(d){if(d.name==core.status.hard){core.statusBar.hard.style.color=core.arrayToRGBA(d.color||[255,0,0,1])}})}core.drawStatusBar();core.updateCheckBlock();core.updateDamage()},updateCheckBlock:function(G){G=G||core.status.floorId;if(!G||!core.status.maps){return}var aB=core.floors[G].width,I=core.floors[G].height;var e=core.getMapBlocksObj(G);var q={},ay={},ah={},b={},V={},al={},aA={},an={},ao={},ap={},k={},ac={},ar={},ab={};var c={};var aq=[];var Y=false;var h=core.flags.canGoDeadZone;var J=core.status.hero;core.flags.canGoDeadZone=true;function a(i,x){var j=Math.max(x,0)||0;j-=core.plugin.getTalentLv(9)*core.getRealStatus("mdef")/3;j=Math.floor(Math.max(0,j));return(i||0)+j}function N(i){var j=i=="yellowDoor"||i=="blueDoor"||i=="redDoor"||i=="greenDoor"||i=="specialDoor";j|=i=="yellowDoor2"||i=="blueDoor2"||i=="redDoor2"||i=="greenDoor2";return j}function H(aL,aM,i){if(core.getBlock(aL,aM,i)!=null&&core.getBlock(aL,aM,i).event.noPass){if(!core.plugin.isEnemy(aL,aM,i)){if(core.getBlock(aL,aM,i).event.id=="airwall"){return true}else{return false}}var j=core.enemys.enemys[core.getBlock(aL,aM,i).event.id].special;if(j&&core.hasSpecial(j,26)){}else{return false}}return true}function U(aM,aN,i){if(core.getBlockCls(aM,aN,i)!="enemys"&&core.getBlockCls(aM,aN,i)!="enemy48"){return false}var aL=core.material.enemys[core.getBlock(aM,aN,i).event.id];var j=aM+","+aN;return !(core.enemys.hasSpecial(aL,27)||core.enemys.hasSpecial(aL,71)||core.getFlag("spe84_n",0)>0||(aq.indexOf(j)!=-1))}function aC(j,aL,i){if(core.getBlock(j,aL,i)!=null&&core.getBlock(j,aL,i).event.noPass){if(!(core.getBlockId(j,aL,i)=="airwall"||core.getBlockCls(j,aL,i)=="items"||core.getBlockCls(j,aL,i)=="enemys"||core.getBlockCls(j,aL,i)=="enemy48")){return true}}return false}for(var T in e){var d=e[T],aD=d.x,aF=d.y,L=d.event.id,A=core.material.enemys[L];if(d.disable){continue}if(A&&core.hasSpecial(A.special,76)){var af=A.range||1;var aH=false;if(A.zoneSquare!=null){aH=A.zoneSquare}for(var u=-af;u<=af;u++){for(var w=-af;w<=af;w++){var ad=aD+u,ae=aF+w,p=ad+","+ae;if(ad<0||ad>=aB||ae<0||ae>=I){continue}if(!aH&&Math.abs(u)+Math.abs(w)>af){continue}aq.push(p)}}}}for(var T in e){var d=e[T],aD=d.x,aF=d.y,L=d.event.id,A=core.material.enemys[L];if(d.disable){continue}ay[T]=ay[T]||{};if(L=="lavaNet"){q[T]=(q[T]||0)+core.values.lavaDamage;ay[T]["血网伤害"]=true}if(A&&core.hasSpecial(A.special,15)&&!core.hasFlag("no_zone")){var af=A.range||1;var aH=false;if(A.zoneSquare!=null){aH=A.zoneSquare}for(var u=-af;u<=af;u++){for(var w=-af;w<=af;w++){if(u==0&&w==0){continue}var ad=aD+u,ae=aF+w,p=ad+","+ae;if(ad<0||ad>=aB||ae<0||ae>=I){continue}if(!aH&&Math.abs(u)+Math.abs(w)>af){continue}q[p]=a(q[p],A.value);ay[p]=ay[p]||{};ay[p]["领域伤害"]=true}}}if(A&&core.hasSpecial(A.special,92)&&!core.hasFlag("no_zone")){var af=A.range||1;var aH=false;if(A.zoneSquare!=null){aH=A.zoneSquare}for(var u=-af;u<=af;u++){for(var w=-af;w<=af;w++){if(u==0&&w==0){continue}var ad=aD+u,ae=aF+w,p=ad+","+ae;if(ad<0||ad>=aB||ae<0||ae>=I){continue}if(!aH&&Math.abs(u)+Math.abs(w)>af){continue}var F=A.damage2;for(var K=0;K<core.getFlag("spe92_debuff",0);++K){F*=1.5}q[p]=a(q[p],F);ar[p]=true;ay[p]=ay[p]||{};ay[p]["熔火伤害"]=true}}}if(A&&core.hasSpecial(A.special,93)&&!core.hasFlag("no_zone")){var af=A.range||1;var aH=false;if(A.zoneSquare!=null){aH=A.zoneSquare}for(var u=-af;u<=af;u++){for(var w=-af;w<=af;w++){if(u==0&&w==0){continue}var ad=aD+u,ae=aF+w,p=ad+","+ae;if(ad<0||ad>=aB||ae<0||ae>=I){continue}if(!aH&&Math.abs(u)+Math.abs(w)>af){continue}q[p]=a(q[p],A.damage2*core.status.hero.hp/100);ay[p]=ay[p]||{};ay[p]["领域伤害"]=true}}}if(A&&core.hasSpecial(A.special,79)&&!core.hasFlag("no_zone")){var aG=[[0,-2],[0,2],[-2,0],[2,0]];for(var K in aG){var ad=aD+aG[K][0],ae=aF+aG[K][1],p=ad+","+ae;if(ad<0||ad>=aB||ae<0||ae>=I){continue}q[p]=a(q[p],A.value);ay[p]=ay[p]||{};ay[p]["游击伤害"]=true}for(var r in core.utils.scan){var ad=aD+core.utils.scan[r].x,ae=aF+core.utils.scan[r].y,p=ad+","+ae;if(ad<0||ad>=aB||ae<0||ae>=I){continue}q[p]=a(q[p],A.value);ay[p]=ay[p]||{};ay[p]["游击伤害"]=true;var ag=core.turnDirection(":back",r);var aj=aD+core.utils.scan[ag].x,ak=aF+core.utils.scan[ag].y;if(core.canMoveHero(aD,aF,ag,G)&&core.getBlock(aj,ak,G)==null){ah[p]=(ah[p]||[]).concat([[aD,aF,L,ag]])}else{var P=aD+3*core.utils.scan[r].x,Q=aF+3*core.utils.scan[r].y;if(P<0||P>=aB||Q<0||Q>=I){continue}if(core.getBlock(P,Q,G)==null){if(!an[p]){an[p]=[]}an[p].push([aD,aF,P,Q])}}}for(var r in core.utils.scan){var ad=aD+3*core.utils.scan[r].x,ae=aF+3*core.utils.scan[r].y,p=ad+","+ae;if(ad<0||ad>=aB||ae<0||ae>=I){continue}q[p]=a(q[p],A.value);ay[p]=ay[p]||{};ay[p]["游击伤害"]=true;var aj=aD+core.utils.scan[r].x,ak=aF+core.utils.scan[r].y;if(core.canMoveHero(aD,aF,r,G)&&core.getBlock(aj,ak,G)==null){ah[p]=(ah[p]||[]).concat([[aD,aF,L,r]])}}}if(A&&core.hasSpecial(A.special,18)&&!core.hasFlag("no_repulse")){for(var r in core.utils.scan){var ad=aD+core.utils.scan[r].x,ae=aF+core.utils.scan[r].y,p=ad+","+ae;if(ad<0||ad>=aB||ae<0||ae>=I){continue}q[p]=a(q[p],A.value);ay[p]=ay[p]||{};ay[p]["阻击伤害"]=true;var ag=core.turnDirection(":back",r);var aj=aD+core.utils.scan[ag].x,ak=aF+core.utils.scan[ag].y;if(core.canMoveHero(aD,aF,ag,G)&&core.getBlock(aj,ak,G)==null){ah[p]=(ah[p]||[]).concat([[aD,aF,L,ag]]);ac[p]=true}}}if(A&&core.hasSpecial(A.special,94)&&!core.hasFlag("no_repulse")){for(var r in core.utils.scan){var ad=aD+core.utils.scan[r].x,ae=aF+core.utils.scan[r].y,p=ad+","+ae;if(ad<0||ad>=aB||ae<0||ae>=I){continue}q[p]=a(q[p],A.damage2*core.status.hero.hp/100);ay[p]=ay[p]||{};ay[p]["阻击伤害"]=true;var ag=core.turnDirection(":back",r);var aj=aD+core.utils.scan[ag].x,ak=aF+core.utils.scan[ag].y;if(core.canMoveHero(aD,aF,ag,G)&&core.getBlock(aj,ak,G)==null){ah[p]=(ah[p]||[]).concat([[aD,aF,L,ag]]);ac[p]=true}}}if(A&&core.hasSpecial(A.special,77)&&!core.hasFlag("no_repulse")){var am={};for(var r in core.utils.scan){var aI=aD+core.utils.scan[r].x,aJ=aF+core.utils.scan[r].y,p=aI+","+aJ;if(aI<0||aI>=aB||aJ<0||aJ>=I){continue}if(core.canMoveHero(aD,aF,r,G)&&core.getBlock(aI,aJ,G)==null){if(r=="up"||r=="down"){for(var ad=aI-1;ad>=0;--ad){var p=ad+","+aJ;if(aC(ad,aJ,G)){break}ay[p]=ay[p]||{};if(!am[p]){am[p]=true;q[p]=a(q[p],A.snipe_damage-core.getRealStatusOrDefault(J,"def"));ay[p]["游猎伤害"]=true;ah[p]=(ah[p]||[]).concat([[aD,aF,L,r]])}}for(var ad=aI+1;ad<aB;++ad){var p=ad+","+aJ;if(aC(ad,aJ,G)){break}ay[p]=ay[p]||{};if(!am[p]){am[p]=true;q[p]=a(q[p],A.snipe_damage-core.getRealStatusOrDefault(J,"def"));ay[p]["游猎伤害"]=true;ah[p]=(ah[p]||[]).concat([[aD,aF,L,r]])}}}else{if(r=="left"||r=="right"){for(var ae=aJ-1;ae>=0;--ae){var p=aI+","+ae;if(aC(aI,ae,G)){break}ay[p]=ay[p]||{};if(!am[p]){am[p]=true;q[p]=a(q[p],A.snipe_damage-core.getRealStatusOrDefault(J,"def"));ay[p]["游猎伤害"]=true;ah[p]=(ah[p]||[]).concat([[aD,aF,L,r]])}}for(var ae=aJ+1;ae<I;++ae){var p=aI+","+ae;if(aC(aI,ae,G)){break}ay[p]=ay[p]||{};if(!am[p]){am[p]=true;q[p]=a(q[p],A.snipe_damage-core.getRealStatusOrDefault(J,"def"));ay[p]["游猎伤害"]=true;ah[p]=(ah[p]||[]).concat([[aD,aF,L,r]])}}}}}if(core.canMoveHero(aD,aF,r,G)){ac[aI+","+aJ]=true}}}if(A&&core.hasSpecial(A.special,91)&&!core.hasFlag("no_repulse")){for(var r in core.utils.scan){var ad=aD+core.utils.scan[r].x,ae=aF+core.utils.scan[r].y,p=ad+","+ae;if(ad<0||ad>=aB||ae<0||ae>=I){continue}q[p]=a(q[p],A.value);ay[p]=ay[p]||{};ay[p]["阻击伤害"]=true;var s=[core.turnDirection(":back",r),core.turnDirection(":left",r),core.turnDirection(":right",r)];var X,W=0;for(var M in s){var m=0;var l=s[M];var n=aD,o=aF;var Z=aD+core.utils.scan[l].x,aa=aF+core.utils.scan[l].y;while(core.canMoveHero(n,o,l,G)&&core.getBlock(Z,aa,G)==null){m+=1;n=Z;o=aa;Z=n+core.utils.scan[l].x;aa=o+core.utils.scan[l].y}if(m>W){W=m;X=l}}if(W>0){ah[p]=(ah[p]||[]).concat([[aD,aF,L,X]])}}}if(A&&(core.hasSpecial(A.special,24)||core.hasSpecial(A.special,77))&&!core.hasFlag("no_laser")){for(var ad=aD-1;ad>=0;--ad){var p=ad+","+aF;if(aC(ad,aF,G)){break}q[p]=a(q[p],A.snipe_damage-core.getRealStatusOrDefault(J,"def"));ay[p]=ay[p]||{};ay[p]["射击伤害"]=true}for(var ad=aD+1;ad<aB;++ad){var p=ad+","+aF;if(aC(ad,aF,G)){break}q[p]=a(q[p],A.snipe_damage-core.getRealStatusOrDefault(J,"def"));ay[p]=ay[p]||{};ay[p]["射击伤害"]=true}for(var ae=aF-1;ae>=0;--ae){var p=aD+","+ae;if(aC(aD,ae,G)){break}q[p]=a(q[p],A.snipe_damage-core.getRealStatusOrDefault(J,"def"));ay[p]=ay[p]||{};ay[p]["射击伤害"]=true}for(var ae=aF+1;ae<I;++ae){var p=aD+","+ae;if(aC(aD,ae,G)){break}q[p]=a(q[p],A.snipe_damage-core.getRealStatusOrDefault(J,"def"));ay[p]=ay[p]||{};ay[p]["射击伤害"]=true}}if(A&&core.hasSpecial(A.special,26)){for(var ad=aD-1;ad>=0;ad--){if(core.plugin.isEnemy(ad,aF,G)){var p=ad+","+aF;ab[p]=true}if(!H(ad,aF,G)){break}}for(var ad=aD+1;ad<aB;ad++){if(core.plugin.isEnemy(ad,aF,G)){var p=ad+","+aF;ab[p]=true}if(!H(ad,aF,G)){break}}for(var ae=aF-1;ae>=0;ae--){if(core.plugin.isEnemy(aD,ae,G)){var p=aD+","+ae;ab[p]=true}if(!H(aD,ae,G)){break}}for(var ae=aF+1;ae<I;ae++){if(core.plugin.isEnemy(aD,ae,G)){var p=aD+","+ae;ab[p]=true}if(!H(aD,ae,G)){break}}}if(A&&core.hasSpecial(A.special,34)&&!core.getFlag("invisible",0)){ab[aD+","+aF]=true;for(var ad=0;ad<aB;ad++){var p=ad+","+aF;if(ad!=aD){var r;if(ad<aD){if(core.getFlag("chase_no_force",0)==1&&aD-ad==1){continue}r="left"}else{if(core.getFlag("chase_no_force",0)==1&&ad-aD==1){continue}r="right"}if(aD-ad==1||ad-aD==1){ac[p]=true}var aj=aD+core.utils.scan[r].x;var ak=aF+core.utils.scan[r].y;if(aj>=0&&aj<aB&&ak>=0&&ak<I&&core.getBlock(aj,ak,G)==null){ah[p]=(ah[p]||[]).concat([[aD,aF,L,r]]);ac[p]=true}}}for(var ae=0;ae<I;ae++){var p=aD+","+ae;if(ae!=aF){var r;if(ae<aF){if(core.getFlag("chase_no_force",0)==1&&aF-ae==1){continue}r="up"}else{if(core.getFlag("chase_no_force",0)==1&&ae-aF==1){continue}r="down"}if(aF-ae==1||ae-aF==1){ac[p]=true}aj=aD+core.utils.scan[r].x;ak=aF+core.utils.scan[r].y;if(aj>=0&&aj<aB&&ak>=0&&ak<I&&core.getBlock(aj,ak,G)==null){ah[p]=(ah[p]||[]).concat([[aD,aF,L,r]]);ac[p]=true}}}}if(A&&core.hasSpecial(A.special,81)&&!core.getFlag("invisible",0)){var aj,ak,r,p;for(var ad=aD+1;ad<aB;ad++){p=ad+","+aF;if(aC(ad,aF,G)){break}r="right";aj=aD+core.utils.scan[r].x;ak=aF+core.utils.scan[r].y;if(aj>=0&&aj<aB&&ak>=0&&ak<I&&(core.getBlock(aj,ak,G)==null||core.getBlockCls(aj,ak,G)=="items")){k[p]=(k[p]||[]).concat([[aD,aF,L,r]])}}for(var ad=aD-1;ad>=0;ad--){p=ad+","+aF;if(aC(ad,aF,G)){break}r="left";aj=aD+core.utils.scan[r].x;ak=aF+core.utils.scan[r].y;if(aj>=0&&aj<aB&&ak>=0&&ak<I&&(core.getBlock(aj,ak,G)==null||core.getBlockCls(aj,ak,G)=="items")){k[p]=(k[p]||[]).concat([[aD,aF,L,r]])}}for(var ae=aF+1;ae<I;ae++){p=aD+","+ae;if(aC(aD,ae,G)){break}r="down";aj=aD+core.utils.scan[r].x;ak=aF+core.utils.scan[r].y;if(aj>=0&&aj<aB&&ak>=0&&ak<I&&(core.getBlock(aj,ak,G)==null||core.getBlockCls(aj,ak,G)=="items")){k[p]=(k[p]||[]).concat([[aD,aF,L,r]])}}for(var ae=aF-1;ae>=0;ae--){p=aD+","+ae;if(aC(aD,ae,G)){break}r="up";aj=aD+core.utils.scan[r].x;ak=aF+core.utils.scan[r].y;if(aj>=0&&aj<aB&&ak>=0&&ak<I&&(core.getBlock(aj,ak,G)==null||core.getBlockCls(aj,ak,G)=="items")){k[p]=(k[p]||[]).concat([[aD,aF,L,r]])}}}if(A&&!core.hasFlag("no_ambush")&&(core.enemys.hasSpecial(A.special,27)||aq.indexOf(T)!=-1||(core.enemys.hasSpecial(A.special,71)&&!core.getFlag("invisible",0))||core.getFlag("spe84_n",0)>0||core.getFlag("superweak_n",0)>0)){for(var r in core.utils.scan){var ad=aD+core.utils.scan[r].x,ae=aF+core.utils.scan[r].y,p=ad+","+ae;if(ad<0||ad>=aB||ae<0||ae>=I){continue}b[p]=(b[p]||[]).concat([[aD,aF,L,r]])}}if(A&&!core.hasFlag("no_betweenAttack")&&(core.enemys.hasSpecial(A.special,16)||core.enemys.hasSpecial(A.special,101))){for(var r in core.utils.scan){var ad=aD+core.utils.scan[r].x,ae=aF+core.utils.scan[r].y,p=ad+","+ae;if(ad<0||ad>=aB||ae<0||ae>=I){continue}c[p]=true}}if(A&&core.hasSpecial(A.special,102)&&!core.hasFlag("no_zone")){var af=A.range||1;var aH=false;if(A.zoneSquare!=null){aH=A.zoneSquare}for(var u=-af;u<=af;u++){for(var w=-af;w<=af;w++){if(u==0&&w==0){continue}var ad=aD+u,ae=aF+w,p=ad+","+ae;if(ad<0||ad>=aB||ae<0||ae>=I){continue}if(!aH&&Math.abs(u)+Math.abs(w)>af){continue}V[p]=(V[p]||0)+1}}}if(A&&core.hasSpecial(A.special,103)&&!core.hasFlag("no_repulse")){for(var r in core.utils.scan){var ad=aD+core.utils.scan[r].x,ae=aF+core.utils.scan[r].y,p=ad+","+ae;if(ad<0||ad>=aB||ae<0||ae>=I){continue}V[p]=(V[p]||0)+1;var ag=core.turnDirection(":back",r);var aj=aD+core.utils.scan[ag].x,ak=aF+core.utils.scan[ag].y;if(core.canMoveHero(aD,aF,ag,G)&&core.getBlock(aj,ak,G)==null){ah[p]=(ah[p]||[]).concat([[aD,aF,L,ag]])}}}if(A&&core.hasSpecial(A.special,66)&&!core.hasFlag("no_zone")){var af=A.range||1;var aH=false;if(A.zoneSquare!=null){aH=A.zoneSquare}for(var u=-af;u<=af;u++){for(var w=-af;w<=af;w++){if(u==0&&w==0){continue}var ad=aD+u,ae=aF+w,p=ad+","+ae;if(ad<0||ad>=aB||ae<0||ae>=I){continue}if(!aH&&Math.abs(u)+Math.abs(w)>af){continue}al[p]=core.status.hero.hp-1}}}if(A&&core.hasSpecial(A.special,67)&&core.getFlag("invisible",0)==1){var af=A.range||1;var aH=false;if(A.zoneSquare!=null){aH=A.zoneSquare}for(var u=-af;u<=af;u++){for(var w=-af;w<=af;w++){if(u==0&&w==0){continue}var ad=aD+u,ae=aF+w,p=ad+","+ae;if(ad<0||ad>=aB||ae<0||ae>=I){continue}if(!aH&&Math.abs(u)+Math.abs(w)>af){continue}aA[p]=1}}}if(A&&core.hasSpecial(A.special,69)&&!core.getFlag("invisible",0)){for(var ad=aD-1;ad>=2;--ad){var p=ad+","+aF;if(aC(ad,aF,G)){break}if(core.plugin.isEnemy(ad,aF,G)){ac[ad-1+","+aF]=true;if(core.getBlock(ad-1,aF,G)==null){var au=(ad-2)+","+aF;if(!an[au]){an[au]=[]}an[au].push([aD,aF,ad-1,aF])}}}for(var ad=aD+1;ad<aB-2;++ad){var p=ad+","+aF;if(aC(ad,aF,G)){break}if(core.plugin.isEnemy(ad,aF,G)){ac[ad+1+","+aF]=true;if(core.getBlock(ad+1,aF,G)==null){var au=(ad+2)+","+aF;if(!an[au]){an[au]=[]}an[au].push([aD,aF,ad+1,aF])}}}for(var ae=aF-1;ae>=2;--ae){var p=aD+","+ae;if(aC(aD,ae,G)){break}if(core.plugin.isEnemy(aD,ae,G)){ac[aD+","+(ae-1)]=true;if(core.getBlock(aD,ae-1,G)==null){var au=aD+","+(ae-2);if(!an[au]){an[au]=[]}an[au].push([aD,aF,aD,ae-1])}}}for(var ae=aF+1;ae<I-2;++ae){var p=aD+","+ae;if(aC(aD,ae,G)){break}if(core.plugin.isEnemy(aD,ae,G)){ac[aD+","+(ae+1)]=true;if(core.getBlock(aD,ae+1,G)==null){var au=aD+","+(ae+2);if(!an[au]){an[au]=[]}an[au].push([aD,aF,aD,ae+1])}}}}if(A&&core.hasSpecial(A.special,72)&&!core.getFlag("invisible",0)){for(var ad=aD-1;ad>=0;--ad){var p=ad+","+aF;var av=core.getBlockId(ad,aF,G);if(N(av)){break}if(ad!=aD&&core.plugin.isEnemy(ad,aF,G)&&U(ad,aF,G)){if(ap[p]){if(100*ap[p][0]+ap[p][1]<100*aD+aF){continue}}ap[p]=[aD,aF,ad,aF]}}for(var ad=aD+1;ad<aB;++ad){var p=ad+","+aF;var av=core.getBlockId(ad,aF,G);if(N(av)){break}if(ad!=aD&&core.plugin.isEnemy(ad,aF,G)&&!ap[p]&&U(ad,aF,G)){if(ap[p]){if(100*ap[p][0]+ap[p][1]<100*aD+aF){continue}}ap[p]=[aD,aF,ad,aF]}}for(var ae=aF-1;ae>=0;--ae){var p=aD+","+ae;var av=core.getBlockId(aD,ae,G);if(N(av)){break}if(ae!=aF&&core.plugin.isEnemy(aD,ae,G)&&!ap[p]&&U(aD,ae,G)){if(ap[p]){if(100*ap[p][0]+ap[p][1]<100*aD+aF){continue}}ap[p]=[aD,aF,aD,ae]}}for(var ae=aF+1;ae<I;++ae){var p=aD+","+ae;var av=core.getBlockId(aD,ae,G);if(N(av)){break}if(ae!=aF&&core.plugin.isEnemy(aD,ae,G)&&!ap[p]&&U(aD,ae,G)){if(ap[p]){if(100*ap[p][0]+ap[p][1]<100*aD+aF){continue}}ap[p]=[aD,aF,aD,ae]}}}var at=core.getSpecialFlag(A);if(at&1){Y=true}if(core.status.event.id=="viewMaps"){Y=true}if((core.status.event.id=="book"||core.status.event.id=="book-detail")&&core.status.event.ui){Y=true}}for(var K=0;K<aB;++K){for(var O=0;O<I;++O){var p=K+","+O;if(p in ap){var ad=ap[p][2],ae=ap[p][3];var v=[-1,0,0,1],z=[0,-1,1,0];for(var aK=0;aK<4;aK+=1){var u=v[aK],w=z[aK];var aw=(ad+u)+","+(ae+w);if(!ao[aw]){ao[aw]=[]}ao[aw].push(ap[p])}}}}for(var T in c){var aE=T.split(","),aD=parseInt(aE[0]),aF=parseInt(aE[1]);var D=null,E=null;var g=0;var R=e[(aD-1)+","+aF],ai=e[(aD+1)+","+aF];if(R&&!R.disable&&ai&&!ai.disable&&R.id==ai.id){if(core.hasSpecial(R.event.id,16)){D=R.event.id;g=1}if(core.hasSpecial(R.event.id,101)){D=R.event.id;g=2}}var ax=e[aD+","+(aF-1)],f=e[aD+","+(aF+1)];if(ax&&!ax.disable&&f&&!f.disable&&ax.id==f.id){if(core.hasSpecial(ax.event.id,16)){E=ax.event.id;g=1}if(core.hasSpecial(ax.event.id,101)){E=ax.event.id;g=2}}if(D!=null||E!=null){if(g==1){var S=core.status.hero.hp-(q[T]||0);if(S>1){var az=0;if(D!=null){az=core.material.enemys[D].damage2||0}else{az=core.material.enemys[E].damage2||0}if(az==0){var t=0;if(D!=null){t=core.material.enemys[D].value}else{t=core.material.enemys[E].value}az=Math.floor(S*t/100)}if(core.flags.betweenAttackMax){var B=core.getDamage(D,aD,aF,G);if(B!=null&&B<az){az=B}var C=core.getDamage(E,aD,aF,G);if(C!=null&&C<az){az=C}}if(az>0){q[T]=a(q[T],az);ay[T]=ay[T]||{};ay[T]["夹击伤害"]=true}}}else{if(g==2){V[T]=(V[T]||0)+1}}}}core.flags.canGoDeadZone=h;core.status.checkBlock={damage:q,type:ay,repulse:ah,ambush:b,lose_key:V,seal_hp:al,visible:aA,spe_69:an,spe_72:ao,spe_92:ar,chase:k,no_autopick:ac,no_autobattle:ab,needCache:Y,cache:{}}},moveOneStep:function(b){core.status.hero.steps++;core.updateFollowers();core.drawHero();if(core.hasFlag("poison")){core.status.hero.statistics.poisonDamage+=core.values.poisonDamage;core.status.hero.hp-=core.values.poisonDamage;if(core.status.hero.hp<=0){core.status.hero.hp=0;core.updateStatusBar();core.events.lose();return}else{core.updateStatusBar()}}var l=core.getHeroLoc("x"),m=core.getHeroLoc("y");if(core.hasFlag("superweak")){var c=core.plugin.canBreakList;var n=1,e=250000000;var d=1;core.drawAnimate("fire2",l,m);for(var g=l-n;g<=l+n;++g){for(var k=m-n;k<=m+n;++k){if(g==l&&k==m){continue}var h=core.getBlockId(g,k);if(c.includes(h)){core.removeBlock(g,k);if(core.getFlag("A21boss",0)>0&&h.indexOf("RHeart")!=-1){core.plugin.updateBoss21Info(4)}d+=1}}}if(d==1){core.plugin.popSkillDamage(e,l,m);core.status.hero.hp-=e;core.updateStatusBar();if(core.status.hero.hp<=0){core.events.lose("战斗失败");return}}}if(core.getFlag("skill5_ad",0)>0){core.status.hero.mana-=2*core.getFlag("skill5_ad",0);core.plugin.popSkillDamage(2*core.getFlag("skill5_ad",0),core.status.hero.loc.x,core.status.hero.loc.y,"#FFFFFF");core.addFlag("skill5_ad",1);core.updateStatusBar();if(core.status.hero.mana<=0){core.insertCommonEvent("AD不鸽了")}}if(core.getFlag("skill5_am",0)>0){if(core.getFlag("skill5_direction",0)==0){core.setFlag("skill5_direction",core.getFlag("last_moved_direction",0))}else{if(core.getFlag("skill5_direction")!=core.getFlag("last_moved_direction",2221)){core.insertCommonEvent("AM不鸽了")}}}if(core.getFlag("skill8_buff",0)>0){if(core.getFlag("skill8_direction",0)==0){core.setFlag("skill8_direction",core.getFlag("last_moved_direction",0))}else{if(core.getFlag("skill8_direction")!=core.getFlag("last_moved_direction",2221)){core.setFlag("skill8_buff",0);core.insertCommonEvent("skill8end")}}}core.checkAutoEvents();var a=core.getBlock(l,m);var f=false;if(a!=null&&a.event.trigger=="getItem"&&!core.floors[core.status.floorId].afterGetItem[l+","+m]){f=true;core.trigger(l,m,b)}if(core.getFlag("skill11_feat1",false)){core.setFlag("skill11_feat1",false);core.updateStatusBar()}else{if(core.hasItem("skill11")&&core.getFlag("temp_mdef_pp",0)>0){core.plugin.addTempMdefpp(-core.getFlag("skill11_add")*core.getFlag("skill11_decay_pp")/100);if(core.getFlag("temp_mdef_pp",0)==0&&core.getFlag("autoGetItem",0)>0){core.plugin.autoGetItem()}core.updateStatusBar()}}if(core.hasFlag("superweak")){core.insertAction({type:"function","function":'function(){\nif (core.hasFlag("superweak")) {\n\tcore.addFlag("superweak_n", -1);\n\tif (core.getFlag("superweak_n") == 0) {\n\t\tcore.triggerDebuff("remove", "superweak");\n\t}\n\tcore.updateStatusBar();\n}\n}'})}core.checkBlock();if(!f){core.trigger(l,m,b)}if(core.onSki()){core.insertAction({type:"moveAction"},null,null,null,true)}if(core.getBlockId(l,m)=="lavaNet"){core.removeBlock(l,m)}if(core.getFlag("spe83_step",0)>0){core.addFlag("spe83_step",-1);if(core.getFlag("spe83_step")==0){var n=core.getFlag("spe83_range"),e=core.getFlag("spe83_dmg");var c=core.plugin.canBreakList;core.drawAnimate("fire2",l,m);for(var g=l-n;g<=l+n;++g){for(var k=m-n;k<=m+n;++k){var h=core.getBlockId(g,k);if(c.includes(h)){core.removeBlock(g,k)}}}core.plugin.popSkillDamage(e,l,m);core.status.hero.hp-=e;core.removeFlag("cannotMoveDirectly");core.updateStatusBar();if(core.status.hero.hp<=0){core.events.lose("战斗失败");return}}}core.plugin.autoGetItem();core.plugin.autoBattle();if(core.getFlag("70F_boss_phase",0)==1){core.lockControl();core.stopAutomaticRoute();core.plugin.SpecialHeroMove()}if(core.getFlag("invisible_moved",1)!=1){core.setFlag("invisible_moved",1)}},moveDirectly:function(e,f,c){if(c==null){c=core.canMoveDirectly(e,f)}if(c>=0){if(core.getFlag("invisible_moved",1)!=1){core.setFlag("invisible_moved",1)}if(core.hasItem("skill11")){var b=c;if(core.getFlag("skill11_feat1")){core.setFlag("skill11_feat1",false);b--}core.plugin.addTempMdefpp(-core.getFlag("skill11_add")*core.getFlag("skill11_decay_pp")/100*b);core.updateStatusBar()}if(core.hasFlag("poison")){var a=c*core.values.poisonDamage;if(a>=core.status.hero.hp){return false}core.status.hero.statistics.poisonDamage+=a;core.status.hero.hp-=a}core.clearMap("hero");var d=core.status.route[core.status.route.length-1];if(["left","right","up","down"].indexOf(d)>=0){core.setHeroLoc("direction",d)}core.control._moveDirectyFollowers(e,f);core.status.hero.loc.x=e;core.status.hero.loc.y=f;core.drawHero();core.status.route.push("move:"+e+":"+f);core.status.hero.statistics.moveDirectly++;core.status.hero.statistics.ignoreSteps+=c;if(core.hasFlag("poison")){core.updateStatusBar()}core.checkRouteFolding();core.plugin.autoGetItem();core.plugin.autoBattle();return true}return false},parallelDo:function(timestamp){if(!core.isPlaying()){return}if(core.status.floorId){try{eval(core.floors[core.status.floorId].parallelDo);var p1=["MT56","MT57","MT58","MT59","MT60","MT61","MT62"];if(p1.indexOf(core.status.floorId)!=-1){var lastTime=core.getFlag("lastWeatherTime",0);if(timestamp-lastTime>60){var lastOffsetX=core.getFlag("lastOffsetX",0);var image=core.material.images.images["area7.jpg"];var width=image.width,height=image.height;if(lastOffsetX+416>width){core.canvas.bg.drawImage(image,lastOffsetX,0,width-lastOffsetX,height,0,0,width-lastOffsetX,height);core.canvas.bg.drawImage(image,0,0,lastOffsetX+416-width,height,width-lastOffsetX,0,lastOffsetX+416-width,height)}else{core.canvas.bg.drawImage(image,lastOffsetX,0,width,416,0,0,width,416)}lastOffsetX-=1;if(lastOffsetX<0){lastOffsetX+=width}core.setFlag("lastOffsetX",lastOffsetX);core.setFlag("lastWeatherTime",timestamp)}}var p2=["MT63","MT64","MT65","MT66","MT67","MT68","MT69","MT70","MT70_2","Ch4_3D","Ch4_40","Ch4_129_2"];if(p2.indexOf(core.status.floorId)!=-1){var lastTime=core.getFlag("lastWeatherTime",0);if(timestamp-lastTime>60){var lastOffsetX=core.getFlag("lastOffsetX",0);var image=core.material.images.images["area7_2.jpg"];var width=image.width,height=image.height;if(lastOffsetX+416>width){core.canvas.bg.drawImage(image,lastOffsetX,0,width-lastOffsetX,height,0,0,width-lastOffsetX,height);core.canvas.bg.drawImage(image,0,0,lastOffsetX+416-width,height,width-lastOffsetX,0,lastOffsetX+416-width,height)}else{core.canvas.bg.drawImage(image,lastOffsetX,0,width,416,0,0,width,416)}lastOffsetX+=1;if(lastOffsetX>416){lastOffsetX-=width}core.setFlag("lastOffsetX",lastOffsetX);core.setFlag("lastWeatherTime",timestamp)}}}catch(e){main.log(e)}}if(!core.isReplaying()){if(core.material.bgms["boss2221.mp3"].currentTime>167.9){core.material.bgms["boss2221.mp3"].currentTime-=120}if(core.material.bgms["area15.mp3"].currentTime>176.9){core.material.bgms["area15.mp3"].currentTime-=141.8}if(core.material.bgms["area19.mp3"].currentTime>194.03){core.material.bgms["area19.mp3"].currentTime-=182.86}if(core.material.bgms["area19_2.mp3"].currentTime>115.7){core.material.bgms["area19_2.mp3"].currentTime-=102.33}}}},ui:{getToolboxItems:function(a){return Object.keys(core.status.hero.items[a]||{}).filter(function(b){return !core.material.items[b].hideInToolbox}).sort()},drawStatusBar:function(){if(!core.flags.statusCanvas){return}var a=core.dom.statusCanvas,b=core.dom.statusCanvasCtx;b.clearRect(0,0,a.width,a.height);if(!core.domStyle.showStatusBar){return}b.fillStyle=core.status.globalAttribute.statusBarColor||core.initStatus.globalAttribute.statusBarColor;b.font="italic bold 18px Verdana";var e=6,m=9,f=25;if(core.domStyle.isVertical){e=6;m=6;f=20}var l=["floor","hp","mana","atk","def","mdef","money"];for(var d=0;d<l.length;d++){var h=l[d];core.drawImage(b,core.statusBar.icons[h],e,m,25,25);var j=(core.statusBar[h]||{}).innerText||" ";if(!/^[-a-zA-Z0-9`~!@#$%^&*()_=+\[{\]}\\|;:'",<.>\/?]*$/.test(j)){b.font="bold 18px Verdana"}else{b.font="italic bold 18px Verdana"}b.fillStyle="#FFFFFF";core.ui.setFontForMaxWidth(b,j,80,b.font);if(d==3){b.fillStyle="#FF5555"}if(d==4){b.fillStyle="#45D1E0"}if(d==5){if(core.getFlag("temp_mdef_pp",0)==0){b.fillStyle="#00AA00"}else{b.fillStyle="#00FF00"}}if(d==6){if(core.plugin.shouldHighlightMoney()){b.fillStyle="#FFEE00"}}b.fillText(j,e+36,m+20);if(d==5&&core.getTalentLv3(0)>0){b.font="bold 10px Verdana";var i=core.getFlag("temp_mdef_pp",0)/core.getFlag("skill11_add",0);if(core.domStyle.isVertical){b.font="bold 12px Verdana";if(i>0){b.fillText("+"+core.formatBigNumber(core.getFlag("temp_mdef_pp",0)/100*core.status.hero.mdef)+" ("+i+")",e+40,m+24+f*0.4)}else{b.fillText(i,e+90,m+24+f*0.4)}}else{if(i>0){b.fillText("+"+core.formatBigNumber(core.getFlag("temp_mdef_pp",0)/100*core.status.hero.mdef)+" ("+i+")",e+40,m+20+f*0.4)}else{b.fillText(i,e+90,m+20+f*0.4)}}}if(core.domStyle.isVertical){if(d%3!=2){e+=131}else{e=6;m+=f}}else{m+=f}}b.font="italic bold 14px Verdana";b.fillStyle="#FFCCAA";b.fillText(core.statusBar.yellowKey.innerText,e+5,m+20);b.fillStyle="#AAAADD";b.fillText(core.statusBar.blueKey.innerText,e+35,m+20);b.fillStyle="#FF8888";b.fillText(core.statusBar.redKey.innerText,e+65,m+20);b.fillStyle="#88FF88";b.fillText(core.statusBar.greenKey.innerText,e+95,m+20);var c=core.material.images.items;b.font="bold 11px Verdana";if(core.hasItem("skill0")){b.drawImage(c,0,32*68,32,32,6,m+25,32,32);if(core.domStyle.isVertical){b.fillStyle="#0095ff";b.fillText(core.getFlag("skill0_cost",0),36,m+56)}else{b.fillStyle="#60a0ff";b.fillText(core.getFlag("skill0_cost",0),36,m+56)}}else{if(core.hasItem("skill1")){b.drawImage(c,0,32*30,32,32,6,m+25,32,32);if(core.domStyle.isVertical){b.fillStyle="#0095ff";b.fillText(core.getFlag("skill1_cost",0),24,m+56)}else{b.fillStyle="#60a0ff";b.fillText(core.getFlag("skill1_cost",0),24,m+66)}}else{if(core.hasItem("skill3")){b.drawImage(c,0,32*90,32,32,6,m+25,32,32);if(core.domStyle.isVertical){b.fillStyle="#0095ff";b.fillText(core.getFlag("skill3_cost",0),24,m+56)}else{b.fillStyle="#60a0ff";b.fillText(core.getFlag("skill3_cost",0),24,m+66)}}else{if(core.hasItem("skill6")){b.drawImage(c,0,32*100,32,32,6,m+25,32,32);if(core.domStyle.isVertical){b.fillStyle="#0095ff";b.fillText(core.getFlag("skill6_cost",0),24,m+56)}else{b.fillStyle="#60a0ff";b.fillText(core.getFlag("skill6_cost",0),24,m+66)}}else{if(core.hasItem("skill10")){b.drawImage(c,0,32*124,32,32,6,m+25,32,32);if(core.domStyle.isVertical){b.fillStyle="#0095ff";b.fillText(core.getFlag("skill10_cost",0)+core.getTalentLv3(3),24,m+56)}else{b.fillStyle="#60a0ff";b.fillText(core.getFlag("skill10_cost",0)+core.getTalentLv3(3),24,m+66)}}}}}}if(core.hasItem("skill2")){b.drawImage(c,0,32*67,32,32,6+40,m+25,32,32);if(core.domStyle.isVertical){b.fillStyle="#0095ff";b.fillText(core.getFlag("skill2_cost",0),64,m+56)}else{b.fillStyle="#60a0ff";b.fillText(core.getFlag("skill2_cost",0),64,m+66)}}else{if(core.hasItem("skill4")){b.drawImage(c,0,32*89,32,32,6+40,m+25,32,32);if(core.domStyle.isVertical){b.fillStyle="#0095ff";b.fillText(core.getFlag("skill4_cost",0),64,m+56)}else{b.fillStyle="#60a0ff";b.fillText(core.getFlag("skill4_cost",0),64,m+66)}}else{if(core.hasItem("skill7")){b.drawImage(c,0,32*112,32,32,6+40,m+25,32,32);if(core.domStyle.isVertical){b.fillStyle="#0095ff";b.fillText(core.getFlag("skill7_cost",0),64,m+56)}else{b.fillStyle="#60a0ff";b.fillText(core.getFlag("skill7_cost",0),64,m+66)}}else{if(core.hasItem("skill12")){b.drawImage(c,0,32*126,32,32,6+40,m+25,32,32);if(core.domStyle.isVertical){b.fillStyle="#0095ff";b.fillText(core.getFlag("skill12_cost",0)+core.getTalentLv3(3),64,m+56)}else{b.fillStyle="#60a0ff";b.fillText(core.getFlag("skill12_cost",0)+core.getTalentLv3(3),64,m+66)}}}}}if(core.hasItem("skill5")){var g=8;if(core.getTalentLv(10)>0){g=10}else{if(core.getTalentLv(12)>0){g=10}}b.globalAlpha=1-core.getFlag("skill5_cd",0)/g*0.9;if(core.getFlag("skill5_cd",0)>0){b.drawImage(c,0,32*98,32,32,6+80,m+25,32,32);b.globalAlpha=1;b.fillStyle="#FF6060";b.fillText(core.getFlag("skill5_cd",0),104,m+54)}else{b.drawImage(c,0,32*98,32,32,6+80,m+25,32,32)}b.globalAlpha=1}else{if(core.hasItem("skill8")){b.drawImage(c,0,32*119,32,32,6+80,m+25,32,32);if(core.domStyle.isVertical){b.fillStyle="#0095ff";b.fillText("200",104,m+56)}else{b.fillStyle="#60a0ff";b.fillText("200",104,m+66)}}else{if(core.hasItem("talentTree3")){if(core.getTalentLv3(3)<100){b.drawImage(c,0,32*123,32,32,6+80,m+25,32,32);b.fillStyle="#ffd700";b.fillText(core.getTalentLv3(3)+"."+core.getFlag("talentT3_3_upX",0),100,m+54)}else{if(core.hasItem("skill13")){b.drawImage(c,0,32*127,32,32,6+80,m+25,32,32);b.font="italic bold 12px Verdana";b.fillStyle="#ffa000";if(core.domStyle.isVertical){b.fillText(core.getFlag("skill13_cost",0),114,m+56)}else{b.fillText(core.getFlag("skill13_cost",0),94,m+66)}b.font="bold 11px Verdana"}}}else{if(core.hasItem("I_wait")){b.drawImage(c,0,32*88,32,32,6+80,m+25,32,32)}}}}if(core.hasItem("pickaxe")){if(core.domStyle.isVertical){b.drawImage(c,0,32*45,32,32,6+120,m+25,32,32)}else{b.drawImage(c,0,32*45,32,32,6,m+65,32,32)}}else{if(core.hasItem("I_energyOrb")){if(core.domStyle.isVertical){b.drawImage(c,0,32*151,32,32,6+140,m+25,32,32)}else{b.drawImage(c,0,32*151,32,32,6,m+65,32,32)}}}if(core.hasItem("greenBomb")){b.fillStyle="#ffa000";if(core.domStyle.isVertical){b.drawImage(c,0,32*152,32,32,6+140,m+25,32,32);b.fillText(2000,174,m+56)}else{b.drawImage(c,0,32*152,32,32,86,m+65,32,32);b.fillText(2000,94,m+98)}}if(core.hasItem("I_hj")){b.fillStyle="#ffffff";if(core.domStyle.isVertical){b.drawImage(c,0,32*153,32,32,6+200,m+25,32,32);b.fillText(core.itemCount("I_hj"),216,m+56)}else{b.drawImage(c,0,32*153,32,32,46,m+65,32,32);b.fillText(core.itemCount("I_hj"),54,m+98)}}var k=2;if(core.getFlag("skill",0)==1){core.ui.strokeRoundRect(b,6-k,m+25-k,32+2*k,32+2*k,k,"#FFFF00",k)}else{if(core.getFlag("skill",0)==2){core.ui.strokeRoundRect(b,46-k,m+25-k,32+2*k,32+2*k,k,"#FFFF00",k)}}if(core.getFlag("invisible",0)==1){core.ui.strokeRoundRect(b,46-k,m+25-k,32+2*k,32+2*k,k,"#FFFF00",k)}if(core.getFlag("skill5_is_on",false)){core.ui.strokeRoundRect(b,86-k,m+25-k,32+2*k,32+2*k,k,"#FFDD00",k)}if(core.getFlag("skill10Moving",0)==1){core.ui.strokeRoundRect(b,6-k,m+25-k,32+2*k,32+2*k,k,"#FFFF00",k)}if(core.getFlag("previewSkill12",0)==1){core.ui.strokeRoundRect(b,46-k,m+25-k,32+2*k,32+2*k,k,"#FFFF00",k)}if(core.getFlag("previewSkill13",0)==1){core.ui.strokeRoundRect(b,86-k,m+25-k,32+2*k,32+2*k,k,"#FFFF00",k)}if(core.domStyle.isVertical){if(core.getFlag("freeze_stack",0)>0){b.fillStyle="#80ffff";b.font="bold 18px Verdana";b.fillText("冰 "+core.getFlag("freeze_stack",0),273,m+40)}else{if(core.getFlag("spe62_seal_hp",0)>0){b.fillStyle="#ff8860";b.font="bold 18px Verdana";b.fillText("封 "+core.formatBigNumber(core.getFlag("spe62_seal_hp",0)),273,m+40)}else{if(core.getFlag("spe83_step",0)>0){b.fillStyle="#dd0000";b.font="bold 18px Verdana";b.fillText("炸 "+core.getFlag("spe83_step",0),273,m+40)}}}if(core.getFlag("rage_stack",0)>0){b.fillStyle="#ff00a5";b.font="bold 18px Verdana";b.fillText("戾 "+core.getFlag("rage_stack",0),337,m+40)}else{if(core.getFlag("rage_stack",0)<0){b.fillStyle="#b400ff";b.font="bold 18px Verdana";b.fillText("醉 "+(-core.getFlag("rage_stack",0)),337,m+40)}else{if(core.getFlag("spe84_n",0)>0){b.fillStyle="#ff00a5";b.font="bold 18px Verdana";b.fillText("誓 "+core.getFlag("spe84_n",0),337,m+40)}else{if(core.getFlag("spe92_debuff",0)>0){b.fillStyle="#dd4444";b.font="bold 18px Verdana";b.fillText("熔火 "+core.getFlag("spe92_debuff",0),337,m+40)}else{if(core.getFlag("superweak_n",0)>0){b.fillStyle="#FECCD0";b.font="bold 18px Verdana";b.fillText("傲 "+core.getFlag("superweak_n",0),337,m+40)}}}}}if(core.getFlag("used_potion",0)>0){if(core.getFlag("potion_atk",0)>0){b.fillStyle="#dd0000";b.font="bold 18px Verdana";b.fillText("攻 "+(core.getFlag("potion_atk",0)),137,m+40)}else{if(core.getFlag("potion_def",0)>0){b.fillStyle="#0088ff";b.font="bold 18px Verdana";b.fillText("防 "+(core.getFlag("potion_def",0)),137,m+40)}else{if(core.getFlag("potion_mdef",0)>0){b.fillStyle="#00dd00";b.font="bold 18px Verdana";b.fillText("盾 "+(core.getFlag("potion_mdef",0)),137,m+40)}}}b.font="bold 14px Verdana";b.fillText("*"+(core.getFlag("used_potion",0)),196,m+56)}if(core.getFlag("skill8_buff",0)>0){b.fillStyle="#ffee28";b.font="bold 18px Verdana";b.fillText("75%减伤",137,m+40)}}else{if(core.getFlag("freeze_stack",0)>0){b.fillStyle="#80ffff";b.font="bold 14px Verdana";b.fillText("冰 "+core.getFlag("freeze_stack",0),6,m+80)}else{if(core.getFlag("spe62_seal_hp",0)>0){b.fillStyle="#ff8860";b.font="bold 14px Verdana";b.fillText("封 "+core.formatBigNumber(core.getFlag("spe62_seal_hp",0)),6,m+80)}else{if(core.getFlag("spe83_step",0)>0){b.fillStyle="#dd0000";b.font="bold 14px Verdana";b.fillText("炸 "+core.getFlag("spe83_step",0),6,m+80)}}}if(core.getFlag("rage_stack",0)>0){b.fillStyle="#ff00a5";b.font="bold 14px Verdana";b.fillText("戾 "+core.getFlag("rage_stack",0),56,m+80)}else{if(core.getFlag("rage_stack",0)<0){b.fillStyle="#b400ff";b.font="bold 14px Verdana";b.fillText("醉 "+(-core.getFlag("rage_stack",0)),56,m+80)}else{if(core.getFlag("spe84_n",0)>0){b.fillStyle="#ff00a5";b.font="bold 14px Verdana";b.fillText("誓 "+core.getFlag("spe84_n",0),56,m+80)}else{if(core.getFlag("spe92_debuff",0)>0){b.fillStyle="#dd4444";b.font="bold 14px Verdana";b.fillText("熔火 "+core.getFlag("spe92_debuff",0),56,m+80)}else{if(core.getFlag("superweak_n",0)>0){b.fillStyle="#FECCD0";b.font="bold 18px Verdana";b.fillText("傲 "+core.getFlag("superweak_n",0),56,m+90)}}}}}if(core.getFlag("used_potion",0)>0){if(core.getFlag("potion_atk",0)>0){b.fillStyle="#dd0000";b.font="bold 14px Verdana";b.fillText("攻 "+(core.getFlag("potion_atk",0)),56,m+104)}else{if(core.getFlag("potion_def",0)>0){b.fillStyle="#0088ff";b.font="bold 14px Verdana";b.fillText("防 "+(core.getFlag("potion_def",0)),56,m+104)}else{if(core.getFlag("potion_mdef",0)>0){b.fillStyle="#00dd00";b.font="bold 14px Verdana";b.fillText("盾 "+(core.getFlag("potion_mdef",0)),56,m+104)}}}b.font="bold 10px Verdana";b.fillText("*"+(core.getFlag("used_potion",0)),104,m+114)}if(core.getFlag("skill8_buff",0)>0){b.fillStyle="#ffee28";b.font="bold 18px Verdana";b.fillText("75%减伤",6,m+104)}}},drawStatistics:function(){return["yellowDoor","blueDoor","redDoor","greenDoor","yellowKey","blueKey","redKey","yellowKey3","blueKey3","redKey3","redGem","blueGem","greenGem","redGem2","blueGem2","greenGem2","redGem3","blueGem3","greenGem3","redGem4","blueGem4","greenGem4","redGem5","blueGem5","greenGem5","redGem6","blueGem6","greenGem6","redGem7","blueGem7","greenGem7","redGem8","blueGem8","greenGem8","redGem9","blueGem9","greenGem9","redPotion","bluePotion","yellowPotion","greenPotion","superPotion","bigRedPotion","bigBluePotion","bigYellowPotion","bigGreenPotion","hugeRedPotion","hugeBluePotion","hugeYellowPotion","hugeGreenPotion","giantRedPotion","giantBluePotion","giantYellowPotion","giantGreenPotion","superPotion_s","manaItem","bigManaitem","pickaxe","bomb","centerFly","icePickaxe","freezeBadge","earthquake","upFly","downFly","jumpShoes","lifeWand","poisonWine","weakWine","I321","superWine","sword1","sword2","sword3","sword4","sword5","shield1","shield2","shield3","shield4","shield5","silverCoin","goldCoin"]},drawAbout:function(){core.ui.closePanel();core.lockControl();core.status.event.id="about";var c=48,f=36,d=core.__PIXELS__-2*c,a=core.__PIXELS__-2*f;core.setAlpha("ui",0.85);core.fillRect("ui",c,f,d,a,"#000000");core.setAlpha("ui",1);core.strokeRect("ui",c-1,f-1,d+1,a+1,"#FFFFFF",2);var e=c+24;core.setTextAlign("ui","left");var b=(core.status.globalAttribute||core.initStatus.globalAttribute).font;core.fillText("ui","咕工智障",e,f+35,"#FFD700","bold 22px "+b);core.fillText("ui","作者： 如沐东风",e,f+80,"#FFFFFF","bold 17px "+b);core.fillText("ui","版本： "+main.__VERSION__,e,f+112);core.fillText("ui","基于 HTML5 魔塔样板 v2.7.2 制作",e,f+112+32);core.fillText("ui","样板作者： 艾之葵",e,f+112+64);core.fillText("ui","HTML5魔塔交流群：539113091",e,f+112+96);core.playSound("打开界面")}}};var events_c12a15a8_c380_4b28_8144_256cba95f760={commonEvent:{"加点事件":[{type:"comment",text:"通过传参，flag:arg1 表示当前应该的加点数值"},{type:"choices",choices:[{text:"攻击+${1*flag:arg1}",action:[{type:"setValue",name:"status:atk",operator:"+=",value:"1*flag:arg1"}]},{text:"防御+${2*flag:arg1}",action:[{type:"setValue",name:"status:def",operator:"+=",value:"2*flag:arg1"}]},{text:"生命+${200*flag:arg1}",action:[{type:"setValue",name:"status:hp",operator:"+=",value:"200*flag:arg1"}]}]}],"毒衰咒处理":[{type:"comment",text:"获得毒衰咒效果，flag:arg1 为要获得的类型"},{type:"switch",condition:"flag:arg1",caseList:[{"case":"0",action:[{type:"comment",text:"获得毒效果"},{type:"if",condition:"!flag:poison","true":[{type:"setValue",name:"flag:poison",value:"true"}],"false":[]}]},{"case":"1",action:[{type:"comment",text:"获得衰效果"},{type:"if",condition:"!flag:weak","true":[{type:"setValue",name:"flag:weak",value:"true"},{type:"if",condition:"core.values.weakValue>=1","true":[{type:"comment",text:">=1：直接扣数值"},{type:"setValue",name:"status:atk",operator:"-=",value:"core.values.weakValue"},{type:"setValue",name:"status:def",operator:"-=",value:"core.values.weakValue"}],"false":[{type:"comment",text:"<1：扣比例"},{type:"function","function":"function(){\ncore.addBuff('atk', -core.values.weakValue);\n}"},{type:"function","function":"function(){\ncore.addBuff('def', -core.values.weakValue);\n}"}]}],"false":[]}]},{"case":"2",action:[{type:"comment",text:"获得咒效果"},{type:"if",condition:"!flag:curse","true":[{type:"setValue",name:"flag:curse",value:"true"}],"false":[]}]}]}],"回收钥匙商店":[{type:"comment",text:"此事件在全局商店中被引用了(全局商店keyShop)"},{type:"comment",text:"解除引用前勿删除此事件"},{type:"comment",text:"玩家在快捷列表（V键）中可以使用本公共事件"},{type:"while",condition:"1",data:[{type:"choices",text:"\t[商人,trader]你有多余的钥匙想要出售吗？",choices:[{text:"黄钥匙（10金币）",color:[255,255,0,1],action:[{type:"if",condition:"item:yellowKey >= 1","true":[{type:"setValue",name:"item:yellowKey",operator:"-=",value:"1"},{type:"setValue",name:"status:money",operator:"+=",value:"10"}],"false":["\t[商人,trader]你没有黄钥匙！"]}]},{text:"蓝钥匙（50金币）",color:[0,0,255,1],action:[{type:"if",condition:"item:blueKey >= 1","true":[{type:"setValue",name:"item:blueKey",operator:"-=",value:"1"},{type:"setValue",name:"status:money",operator:"+=",value:"50"}],"false":["\t[商人,trader]你没有蓝钥匙！"]}]},{text:"离开",action:[{type:"exit"}]}]}]}],"绿姐姐的提示":[{type:"while",condition:"true",data:[{type:"switch",condition:"flag:current_area",caseList:[{"case":"5",action:[{type:"choices",text:"\t[芳芷,hero2]选择要提示的内容",choices:[{text:"追击",color:[255,167,0,1],action:[{type:"if",condition:"flag:chase_no_force == 1","true":["\t[芳芷,hero2]这个区域出现拥有\r[yellow]追击\r属性的敌人。\n每当你经过他们的同行或同列时，他们就会试图向你移动一格。\r[yellow]但他们追上你之后却不会主动与你战斗。\r"],"false":["\t[芳芷,hero2]和之前一样，一般情况下，敌人是不会主动攻击你的。但是拥有\r[yellow]追击\r属性的敌人是例外。\n每当你经过他们的同行或同列时，他们就会试图向你移动一格，\r[orange]如果追上你就会强制战斗\r。"]},"\t[芳芷,hero2]任何物体都可以阻挡他们移动，包括其他敌人，或者钥匙之类的道具。","\t[芳芷,hero2]虽然他们视力很好，能够隔着墙看到你，但他们移动并不快，经常盲目追赶。\n借助你手中的\r[yellow]楼层传送器\r，这一点也许可以加以利用。"]},{text:"支援",color:[255,249,0],action:["\t[芳芷,hero2]那些骑士拥有的\r[yellow]支援\r属性比较难缠。理解这个属性有两个重点。","\t[芳芷,hero2]第一，支援范围是同行或同列，且可到达范围。他们能够跨越钥匙之类的道具进行移动，但不能跨越其他\r[yellow]没有支援属性\r的敌人。\n另外，如果他们看到一堵墙，会直接认为此路不通，不会尝试绕到墙的后面。","\t[芳芷,hero2]第二， 他们跟随被支援的友军作战。这意味着战斗中你必须同时面对两个甚至更多敌人，并且先与被支援的敌人作战，之后再与这些骑士战斗。","\t[芳芷,hero2]考虑到这些骑士本身抗打能力不强，但攻击力较高，因此尽量绕开能够被他们支援的敌人，直接干掉他们。",{type:"if",condition:"flag:hard == 2","true":["\t[芳芷,hero2]如果迫不得已需要同时面对多个敌人，你的主动技能往往会很有用，特别是\r[aqua]能量爆发\r能同时攻击到所有敌人。"]},"\t[系统提示]另外，支援影响范围内的怪不会被自动清怪所清理。\n主要是辣鸡作者水平有限，为了避免产生奇怪的 bug，只好稍微麻烦一下玩家了。"]},{text:"暴戾",color:[255,0,165],action:["\t[芳芷,hero2]那些暴掠营的战士能使你陷入\r[yellow]暴戾\r状态，使你造成和受到的伤害都提升。\n叠加方式是线性，意味着如果你有10层暴戾，那么造成和受到的伤害都会提升10%。",{type:"if",condition:"flag:hard == 2","true":["\t[芳芷,hero2]这个状态算是双刃剑，因为它能够提升\r[aqua]能量爆发\r的伤害，使你能够快速解决一些比较脆的敌人。\n但是也有些敌人能利用你的暴戾对你造成大量伤害，需要特别小心。"],"false":["\t[芳芷,hero2]大多数时候这个状态的影响并不大，因为你造成和受到的伤害提升比例是一样的，所以战斗的总伤害变化不大，暴戾只是让战斗更快结束而已。\n但是有些敌人能利用你的暴戾使你在战斗中处于劣势，需要特别小心。"]}]},{text:"远程支援",color:[0,221,0],action:["\t[芳芷,hero2]神射手能够为他周围的友军提供支援，每当他周围的友军行动一回合时，他也可以附加一次攻击。","\t[芳芷,hero2]由于他的攻击穿透性很强，难以防御，所以在他周围战斗时尽量速战速决。另外他自身战斗力不强，如果可能的话，绕开他附近的其他敌人，直接干掉他。"]},{text:"我都明白啦！",action:["\t[芳芷,hero2]加油，你一定行的！",{type:"exit"}]}]}]},{"case":"6",action:[{type:"choices",text:"\t[芳芷,hero2]选择要提示的内容",choices:[{text:"主角先攻",color:[255,249,0],action:["\t[芳芷,hero2]这个区域的一些敌人十分懈怠，在战斗中会被你先攻若干次。",{type:"if",condition:"flag:hard==2","true":["\t[芳芷,hero2]需要注意的是，你的主动技能不会在先攻的额外回合中使用，而是在先攻结束之后才释放。\n因此\r[aqua]能量爆发\r的控制效果不会浪费掉，但\r[aqua]集中防御\r的效果相对较差。"],"false":["\t[芳芷,hero2]提升攻击力可以帮你快速战胜这些敌人，但你还需要对付其他不会被你先攻的敌人，所以防御力也很重要。"]}]},{text:"沉醉",color:[196,0,255,1],action:["\t[芳芷,hero2]那些贵族拥有的\r[yellow]沉醉\r属性类似于之前的\r[yellow]暴戾\r。不同的是，这个状态会使你造成和受到的伤害都减少。","\t[芳芷,hero2]同样，大多数时候这个状态不会对战斗的总伤害产生影响。\n但它能帮你应对\r[aqua]净化\r、\r[red]强击\r等瞬间造成大量伤害的特技，或者让你在\r[blue]冰冻\r状态下承受的伤害大幅减少。","\t[芳芷,hero2]但是，也有一些敌人不适合你带着沉醉状态去战斗，这个就靠你自己判断啦。",{type:"if",condition:"flag:hard == 2","true":["\t[芳芷,hero2]另外，这个状态也会降低你的\r[aqua]能量爆发\r的伤害，需要注意。"]}]},{text:"清洁",color:[0,255,0,1],action:["\t[芳芷,hero2]一些敌人能够帮你清除异常状态，包括沉醉和冰冻。\n要好好“利用”它们哦。杂货商人那里的解药很贵的。","\t[芳芷,hero2]如果你没有任何异常状态被解除，则会回复生命值。","\t[芳芷,hero2]需要注意的是，清洁的结算晚于异常状态的自然减少。\n比如你带着1层\r[aqua]冰冻\r与带有清洁的敌人战斗，那么战后冰冻自然消失，再结算清洁，因此仍然能获得生命值。"]},{text:"我都明白啦！",action:["\t[芳芷,hero2]很好，冲冲冲，上上上！",{type:"exit"}]}]},{type:"exit"}]},{"case":"7",action:["再也不会有提示了。",{type:"exit"}]},{"case":"-1",action:["关于挑战模式的一些说明：\n目前总共有2层。每层通过时重置所有数值。\n在第二个副本中，在\\i[E635]卫兵所在的位置击杀任何怪物都可以增加机关门的计数；\\i[pickaxe]破墙镐可以破坏任意地形。",{type:"exit"}]},{"case":"default",action:["没有提示。",{type:"exit"}]}]}]}],"70Fboss_round":[{type:"comment",text:"boss进行一回合移动"},{type:"setValue",name:"flag:70Fboss_skill_this_round",value:"0"},{type:"if",condition:"(flag:70Fboss_skill4_cd <= 0)","true":[{type:"comment",text:"优先发动：至尊之怒"},{type:"setValue",name:"flag:70Fboss_skill_this_round",value:"4"},{type:"setValue",name:"flag:70Fboss_skill4_cd",value:"20"},{type:"animate",name:"yongchang",loc:[6,6],async:true},{type:"playSound",name:"se_power0.wav"},{type:"vibrate",direction:"horizontal",time:1500,speed:10,power:10},{type:"function","function":'function(){\nvar is_first = true;\n\nfunction Process(x, y) {\n\tif (is_first) {\n\t\tcore.drawAnimate("fire4", x, y);\n\t\tis_first = false;\n\t} else {\n\t\tcore.drawAnimate("fire4_mute", x, y);\n\t}\n\tif (x == core.status.hero.loc.x && y == core.status.hero.loc.y) {\n\t\tvar damage = core.status.hero.hp / 2;\n\t\tdamage += 22210000;\n\t\tdamage = Math.floor(damage);\n\t\tcore.status.hero.hp -= damage; // 直接伤害\n\t\tcore.plugin.popSkillDamage(damage, x, y);\n\t}\n\tif (core.getBlockCls(x, y) == "enemys") {\n\t\tvar enemy = core.material.enemys[core.getBlock(x, y).event.id];\n\t\tif (core.hasSpecial(enemy.special, 57)) {\n\t\t\tcore.plugin.BombExplode(x, y, enemy.damage);\n\t\t}\n\t}\n}\n\nif (!core.isReplaying()) {\n\tsetTimeout(function () {\n\t\tis_first = true;\n\t\tfor (var dx = 5; dx <= 7; ++dx) {\n\t\t\tfor (var dy = 5; dy <= 7; ++dy) {\n\t\t\t\tif (dx == 6 && dy == 6) continue;\n\t\t\t\tProcess(dx, dy);\n\t\t\t}\n\t\t}\n\t\tcore.updateStatusBar();\n\t}, 500);\n\tsetTimeout(function () {\n\t\tis_first = true;\n\t\tfor (var dx = 4; dx <= 8; ++dx) {\n\t\t\tfor (var dy = 4; dy <= 8; ++dy) {\n\t\t\t\tif (dx >= 5 && dx <= 7 && dy >= 5 && dy <= 7) continue;\n\t\t\t\tProcess(dx, dy);\n\t\t\t}\n\t\t}\n\t\tcore.updateStatusBar();\n\t}, 1000);\n\tsetTimeout(function () {\n\t\tis_first = true;\n\t\tfor (var dx = 3; dx <= 9; ++dx) {\n\t\t\tfor (var dy = 3; dy <= 9; ++dy) {\n\t\t\t\tif (dx >= 4 && dx <= 8 && dy >= 4 && dy <= 8) continue;\n\t\t\t\tProcess(dx, dy);\n\t\t\t}\n\t\t}\n\t\tcore.updateStatusBar();\n\t}, 1500);\n} else {\n\tis_first = true;\n\tfor (var dx = 3; dx <= 9; ++dx) {\n\t\tfor (var dy = 3; dy <= 9; ++dy) {\n\t\t\tProcess(dx, dy);\n\t\t}\n\t}\n\tcore.updateStatusBar();\n}\n}'},{type:"sleep",time:1600,noSkip:true}],"false":[{type:"if",condition:"(flag:70Fboss_skill1_cd <= 0)","true":[{type:"comment",text:"1技能：投掷爆弹"},{type:"setValue",name:"flag:70Fboss_skill_this_round",value:"1"},{type:"setValue",name:"flag:70Fboss_skill1_cd",value:"3"},{type:"setBlock",number:"E363",loc:[[6,6]]},{type:"jump",from:[6,6],to:["core.status.hero.loc.x","core.status.hero.loc.y"],time:300,keep:true,async:true},{type:"playSound",name:"jump.mp3"},{type:"setBlock",number:"E2221_down",loc:[[6,6]]},{type:"function","function":'function(){\nvar dx = 0,\n\tdy = 0;\nif (core.status.hero.loc.direction == "up") {\n\tdy = -2;\n} else if (core.status.hero.loc.direction == "down") {\n\tdy = 2;\n} else if (core.status.hero.loc.direction == "left") {\n\tdx = -2;\n} else {\n\tdx = 2;\n}\ncore.setFlag("70F_dx", dx);\ncore.setFlag("70F_dy", dy);\ncore.setFlag("nextx", core.status.hero.loc.x + dx);\ncore.setFlag("nexty", core.status.hero.loc.y + dy);\n}'},{type:"waitAsync"},{type:"animate",name:"fire2",loc:"hero",async:true},{type:"playSound",name:"jump.mp3"},{type:"jumpHero",dxy:["flag:70F_dx","flag:70F_dy"],time:300},{type:"function","function":'function(){\n// 如果要跳到的位置是熔岩，直接触发\nvar x = core.getFlag("nextx"),\n\ty = core.getFlag("nexty");\nif (core.getBlockId(x, y) == "lavaNet") {\n\tcore.status.hero.hp -= core.values.lavaDamage;\n\tcore.removeBlock(x, y);\n\tcore.drawAnimate("fire", x, y);\n\tcore.plugin.popSkillDamage(core.values.lavaDamage, x, y);\n}\n}'},{type:"insert",loc:["flag:nextx","flag:nexty"]},{type:"setValue",name:"status:hp",operator:"-=",value:"222221"},{type:"function","function":"function(){\ncore.plugin.popSkillDamage(222221, core.status.hero.loc.x, core.status.hero.loc.y);\n}"},{type:"waitAsync"}],"false":[{type:"if",condition:"(flag:70Fboss_skill2_cd <= 0)","true":[{type:"comment",text:"2技能：地烈炎斩"},{type:"setValue",name:"flag:70Fboss_skill_this_round",value:"2"},{type:"setValue",name:"flag:70Fboss_skill2_cd",value:"9"},{type:"setValue",name:"flag:70Fboss_skill2_loc_x",value:"core.status.hero.loc.x"},{type:"setValue",name:"flag:70Fboss_skill2_loc_y",value:"core.status.hero.loc.y"},{type:"setValue",name:"flag:70Fboss_skill2_ready",value:"2"}],"false":[{type:"if",condition:"(flag:70Fboss_skill3_cd <= 0)","true":[{type:"comment",text:"3技能：寒冰导弹"},{type:"setValue",name:"flag:70Fboss_skill_this_round",value:"3"},{type:"setValue",name:"flag:70Fboss_skill3_cd",value:"6"},{type:"setValue",name:"flag:70Fboss_skill3_loc_x",value:"core.status.hero.loc.x"},{type:"setValue",name:"flag:70Fboss_skill3_loc_y",value:"core.status.hero.loc.y"},{type:"playSound",name:"se_power0.wav"},{type:"showImage",code:2,image:"guangbiao.png",loc:["flag:70Fboss_skill3_loc_x*32","flag:70Fboss_skill3_loc_y*32"],opacity:1,time:0},{type:"setValue",name:"flag:70Fboss_skill3_ready",value:"3"}],"false":[]}]}]}]},{type:"if",condition:"(flag:70Fboss_skill2_ready > 0)","true":[{type:"comment",text:"2技能：地烈炎斩绘制箭头指示"},{type:"playSound",name:"se_power0.wav"},{type:"if",condition:"(flag:70Fboss_skill2_dir % 2 == 0)","true":[{type:"showImage",code:1,image:"rightArrow.png",loc:["flag:70Fboss_skill2_loc_x*32","flag:70Fboss_skill2_loc_y*32"],opacity:1,time:0}],"false":[{type:"showImage",code:1,image:"downArrow.png",loc:["flag:70Fboss_skill2_loc_x*32","flag:70Fboss_skill2_loc_y*32"],opacity:1,time:0}]}]},{type:"if",condition:"((flag:70Fboss_skill1_cd>0 )&&( flag:70Fboss_skill_this_round != 1))","true":[{type:"setValue",name:"flag:70Fboss_skill1_cd",operator:"-=",value:"1"}]},{type:"if",condition:"((flag:70Fboss_skill2_cd>0)&&( flag:70Fboss_skill_this_round != 2))","true":[{type:"setValue",name:"flag:70Fboss_skill2_cd",operator:"-=",value:"1"}]},{type:"if",condition:"((flag:70Fboss_skill3_cd>0)&&( flag:70Fboss_skill_this_round != 3))","true":[{type:"setValue",name:"flag:70Fboss_skill3_cd",operator:"-=",value:"1"}]},{type:"if",condition:"((flag:70Fboss_skill4_cd>0)&&( flag:70Fboss_skill_this_round != 4))","true":[{type:"setValue",name:"flag:70Fboss_skill4_cd",operator:"-=",value:"1"}]},{type:"function","function":'function(){\n// boss 转向\nvar x = core.status.hero.loc.x,\n\ty = core.status.hero.loc.y;\nif (x == y || x + y == 12) {\n\tcore.setFlag("boss_dir", 0);\n} else {\n\tvar left_down = false,\n\t\tleft_up = false;\n\tif (x < y) {\n\t\tleft_down = true;\n\t}\n\tif (x + y < 12) {\n\t\tleft_up = true;\n\t}\n\tif (left_down) {\n\t\tif (left_up) {\n\t\t\t// left\n\t\t\tcore.setFlag("boss_dir", 4);\n\t\t} else {\n\t\t\t// down\n\t\t\tcore.setFlag("boss_dir", 3);\n\t\t}\n\t} else {\n\t\tif (left_up) {\n\t\t\t// up\n\t\t\tcore.setFlag("boss_dir", 1);\n\t\t} else {\n\t\t\t// right\n\t\t\tcore.setFlag("boss_dir", 2);\n\t\t}\n\t}\n}\n}'},{type:"switch",condition:"flag:boss_dir",caseList:[{"case":"0",action:[]},{"case":"1",action:[{type:"setBlock",number:"E2221_up",loc:[[6,6]]}]},{"case":"2",action:[{type:"setBlock",number:"E2221_right",loc:[[6,6]]}]},{"case":"3",action:[{type:"setBlock",number:"E2221_down",loc:[[6,6]]}]},{"case":"4",action:[{type:"setBlock",number:"E2221_left",loc:[[6,6]]}]}]}],"第二章结束":[{type:"insert",name:"清理flag",args:[2]},{type:"pauseBgm"},{type:"setValue",name:"item:book",value:"1"},{type:"setValue",name:"item:fly",value:"1"},{type:"setValue",name:"item:I319",value:"1"},{type:"setValue",name:"item:I392",value:"1"},{type:"function","function":"function(){\ncore.setFlag('potion_extra_ratio', 10);\ncore.setFlag('mana_item', 50);\ncore.plugin.clearItemDetailCache(\"manaItem\");\ncore.plugin.clearItemDetailCache(\"bigManaitem\");\ncore.setFlag('mdef_ratio', 2);\ncore.setFlag('mana_regen', 1);\n}"},{type:"setValue",name:"item:I62",value:"1"},{type:"setValue",name:"item:I437",value:"1"},{type:"setValue",name:"item:I592",value:'core.itemCount("greenKey")'},{type:"setValue",name:"item:greenKey",value:"0"},"\t[系统提示]即将进入新的区域。清空绿钥匙之外的全部道具、装备和金钱。\n失去所有主动技能。\n基础能力值和匙之道加成重置。",{type:"disableShop",id:"57FShop"},{type:"disableShop",id:"69FShop"},{type:"function","function":"function(){\ncore.unloadEquip(0);\ncore.unloadEquip(1);\nif (flags.hard == 2) {\n\tcore.setFlag('__atk_buff__', 6);\n\tcore.setFlag('__def_buff__', 6);\n\tcore.setFlag('__mdef_buff__', 6);\n\tcore.setFlag('heart_atk_pp', 500);\n\tcore.setFlag('heart_def_pp', 500);\n\tcore.setFlag('heart_mdef_pp', 500);\n} else if (flags.hard == 1) {\n\tcore.setFlag('__atk_buff__', 5);\n\tcore.setFlag('__def_buff__', 5);\n\tcore.setFlag('__mdef_buff__', 5);\n\tcore.setFlag('heart_atk_pp', 400);\n\tcore.setFlag('heart_def_pp', 400);\n\tcore.setFlag('heart_mdef_pp', 400);\n} else {\n\tcore.setFlag('__atk_buff__', 0);\n\tcore.setFlag('__def_buff__', 0);\n\tcore.setFlag('__mdef_buff__', 0);\n}\n}"},{type:"setValue",name:"item:sword0",value:"0"},{type:"setValue",name:"item:sword1",value:"0"},{type:"setValue",name:"item:sword2",value:"0"},{type:"setValue",name:"item:shield1",value:"0"},{type:"setValue",name:"item:shield2",value:"0"},{type:"setValue",name:"item:sword3",value:"0"},{type:"setValue",name:"item:shield3",value:"0"},{type:"setValue",name:"item:sword4",value:"0"},{type:"setValue",name:"item:shield4",value:"0"},{type:"setValue",name:"item:leaf",value:"0"},{type:"setValue",name:"status:hp",value:"1"},{type:"setValue",name:"status:mana",value:"0"},{type:"setValue",name:"status:atk",value:"8000"},{type:"setValue",name:"status:def",value:"5000"},{type:"setValue",name:"status:mdef",value:"5000"},{type:"setValue",name:"status:money",value:"0"},{type:"setValue",name:"item:yellowKey",value:"0"},{type:"setValue",name:"item:blueKey",value:"0"},{type:"setValue",name:"item:redKey",value:"0"},{type:"setValue",name:"item:I420",value:"0"},{type:"setValue",name:"item:I425",value:"0"},{type:"setValue",name:"item:skill0_all",value:"0"},{type:"setValue",name:"item:amulet",value:"0"},{type:"setValue",name:"item:weakWine",value:"0"},{type:"setValue",name:"item:I321",value:"0"},{type:"setValue",name:"item:skill0",value:"0"},{type:"setValue",name:"item:I343",value:"0"},{type:"setValue",name:"item:skill1",value:"0"},{type:"setValue",name:"item:skill2",value:"0"},{type:"setValue",name:"item:I_wait",value:"0"},{type:"setValue",name:"flag:chase_no_force",value:"0"},{type:"setValue",name:"flag:yellowGem_extra_description",value:'"携带时，每颗使得每次战斗后回复1%护盾值的生命。"'},{type:"setCurtain",color:[0,0,0,1],time:500,keep:true},"9922在数据中心徜徉许久，却并没有变得上知天文，下知地理。\n作为通用型智能，它的存储能力，或者说记忆力，是有限的。","绝大多数的知识，对于打破困局并无帮助。\n而9922，终于迎来了找到极少数有用资料的那一天。","那看起来似乎是个普通的VR游戏。\n但是上面写着《\r[yellow]至尊之路\r》——四个平凡的大字，散发着奇特的威压。","\t[至尊bot]这里是《\r[yellow]至尊之路\r》的系统管理bot。\n请选择你要体验的难度，\r[yellow]简化\r或者\r[orange]普通\r。",{type:"if",condition:"flags.hard==1","true":["\t[hero]我选择\r[yellow]简化\r。"],"false":["\t[hero]我选择\r[orange]普通\r。"]},"\t[至尊bot]选择完成。即将进行传送。","随着9922的意念注入其中，一个全新的虚拟世界向它打开了大门。",{type:"playSound",name:"mteleport.wav"},{type:"autoText",text:"第三章\n至尊幻境",time:2000},{type:"function","function":"function(){\ncore.plugin.clearItemDetailCacheAll();\n}"},{type:"setValue",name:"flag:current_chapter",value:"3"},{type:"changeFloor",floorId:"South1",loc:[641,641],direction:"down",time:1000}],"鸽化AD":[{type:"animate",name:"spe50",loc:"hero",async:true},{type:"setValue",name:"flag:moveShadow",value:"1"},{type:"setHeroIcon",name:"hero_gold.png"},{type:"setValue",name:"status:atk",operator:"+=",value:"10000"},{type:"setValue",name:"status:def",operator:"+=",value:"10000"},{type:"setValue",name:"flag:skill5_ad",value:"1"},{type:"setValue",name:"flag:skill5_is_on",value:"1"},{type:"setValue",name:"flag:potion_extra_ratio",value:"30"},{type:"setValue",name:"flag:cannotMoveDirectly",value:"true"},{type:"setValue",name:"flag:no_zone",value:"true"},{type:"setValue",name:"flag:no_betweenAttack",value:"true"},{type:"setValue",name:"flag:no_repulse",value:"true"},{type:"setValue",name:"flag:no_laser",value:"true"},{type:"setValue",name:"flag:itemDetailCache",value:"{}"}],"鸽化AM":[{type:"animate",name:"rage_buff",loc:"hero",async:true},{type:"setValue",name:"flag:moveShadow",value:"1"},{type:"setHeroIcon",name:"hero_rage.png"},{type:"setValue",name:"status:atk",operator:"+=",value:"5000"},{type:"setValue",name:"status:mdef",operator:"+=",value:"25000"},{type:"setValue",name:"flag:skill5_am",value:"1"},{type:"setValue",name:"flag:skill5_is_on",value:"1"},{type:"setValue",name:"flag:skill5_cd",value:"8"},{type:"setValue",name:"flag:skill5_direction",value:"0"},{type:"setValue",name:"flag:cannotMoveDirectly",value:"true"},{type:"setValue",name:"flag:disableFly",value:"true"}],"鸽化DM":[{type:"animate",name:"def_buff",loc:"hero",async:true},{type:"setValue",name:"flag:moveShadow",value:"1"},{type:"setHeroIcon",name:"hero_rage2.png"},{type:"setValue",name:"status:def",operator:"+=",value:"5000"},{type:"setValue",name:"flag:skill5_dm",value:"1"},{type:"setValue",name:"flag:skill5_is_on",value:"1"},{type:"setValue",name:"flag:skill5_dm_cost",value:"20"}],"AD不鸽了":[{type:"animate",name:"dispel",loc:"hero",async:true},{type:"setValue",name:"flag:moveShadow",value:"0"},{type:"setValue",name:"flag:skill5_ad",value:"0"},{type:"setValue",name:"flag:skill5_is_on",value:"false"},{type:"setValue",name:"flag:skill5_cd",value:"10"},{type:"setValue",name:"flag:potion_extra_ratio",value:"14"},{type:"setValue",name:"status:atk",operator:"-=",value:"10000"},{type:"setValue",name:"status:def",operator:"-=",value:"10000"},{type:"setHeroIcon",name:"hero.png"},{type:"setValue",name:"flag:cannotMoveDirectly",value:"false"},{type:"setValue",name:"flag:no_zone",value:"false"},{type:"setValue",name:"flag:no_betweenAttack",value:"false"},{type:"setValue",name:"flag:no_snipe",value:"false"},{type:"setValue",name:"flag:no_repulse",value:"false"},{type:"setValue",name:"flag:itemDetailCache",value:"{}"}],"AM不鸽了":[{type:"animate",name:"dispel",loc:"hero",async:true},{type:"setValue",name:"flag:moveShadow",value:"0"},{type:"setHeroIcon",name:"hero.png"},{type:"setValue",name:"status:atk",operator:"-=",value:"5000"},{type:"setValue",name:"status:mdef",operator:"-=",value:"25000"},{type:"setValue",name:"flag:skill5_am",value:"0"},{type:"setValue",name:"flag:skill5_is_on",value:"false"},{type:"setValue",name:"flag:cannotMoveDirectly",value:"false"},{type:"if",condition:"(!flag:Cave_disableFly)","true":[{type:"setValue",name:"flag:disableFly",value:"false"}]}],"DM不鸽了":[{type:"animate",name:"dispel",loc:"hero",async:true},{type:"setValue",name:"flag:moveShadow",value:"0"},{type:"setHeroIcon",name:"hero.png"},{type:"setValue",name:"status:def",operator:"-=",value:"5000"},{type:"setValue",name:"flag:skill5_dm",value:"0"},{type:"setValue",name:"flag:skill5_is_on",value:"false"},{type:"setValue",name:"flag:skill5_cd",value:"10"}],"第三章资料库":[{type:"while",condition:"true",data:[{type:"choices",text:"\t[神像,expShop]选择你要查看的信息：",choices:[{text:"械灵简介",action:["械灵诞生于智械研究进展缓慢之时。一位名叫\r[yellow]秉凌\r的人将生物的大脑进行机械化改造，产生的造物即为械灵。\n迄今为止已知的型号共有21种，分别以字母A到字母U作为编号。","早期的型号制作多以来自魔法世界的低级地狱生物为原料，随着械改大脑技术的不断成熟，这项技术逐渐开始应用到拥有更高智力的生物。","虽然此项技术如今已经基本成熟，却被人类高层禁止应用到人类公民身上。\n没有公民身份的流浪者不在此条规定的保护范围之内，据传最新型号的U型械灵——只生产了1台，就是从人类改造而来的。","总体来讲，型号越往后的械灵战斗力越为强大，但一些低等型号的械灵虽然本身战斗力不强，却能够产生大范围的强化光环效果，比如代表攻击atk的A型和代表防御def的D型。\n这使得它们能够发挥出不下于高级型号械灵的作用。"]},{text:"关于黄宝石",action:["有研究显示，械灵频繁活动的地域常有黄色晶体出现。对于其成分和来历，已经有多种假说。","一些械灵的反对者声称，械灵的本质是机械对意识和灵魂的侵蚀。强行对大脑进行机械化改造的结果就是原本的灵魂不复存在，“记忆”虽在，但思考方式已经完全不同了，说是变成了拥有相同记忆的另一个生物也没有错。\n支持此种说法的现象是，生物械灵化后性格都会产生剧变，并做出械灵化之前不可能做出的事情。","械灵的支持者则不相信生物有灵魂。他们认为，生物械灵化后虽然往往性格产生剧变，但这并非是什么“灵魂”被改变了，而是因为他掌握了强大的能力，从而自然地发生性格变化。\n换句话讲，生物的行为习惯会因其掌握的能力强弱而改变，特别是弱者的本性往往因受到强者的压迫而无法展现。机械只是给了他们更强的能力，使得他们把被压抑的本性显现出来。","以上便是目前最为流行的两大假说。而关于黄宝石的本质，两方也给出了截然不同的说法。","械灵的反对派认为黄宝石是被驱离的意识和灵魂的结晶。它们脱离了肉体轮回，永远地被困在黄色晶体之内。因此有人成立专门的组织对黄宝石进行收集和处理。\n但是，由于黄宝石能与其他思想产生细微的共鸣，进而带来少量的安抚效果，一些人喜欢收藏黄宝石，或者把它做成装饰随身携带。","械灵的支持派认为，黄宝石是生物械灵化过程中被排出的代谢产物。其中蕴含一些对机械生物不再有作用的生命精华，对于普通生物有少量益处。","总之，反对派和支持派各执一词，谁也无法说服对方。"]},{text:"关于特训营",action:["特训营由智械的创始人——古亦建立，旨在对具备潜力的智械进行集训，帮助他们快速成长为能够独当一面的强者。\n目前主要的战斗区域共有14层，另外还有若干隐藏的备用空间。","特训营中安排了各种各样的战斗对手，其中不仅有机器人、低等械灵及其仿制品，甚至还有来自其他异世界的生物。\n一切，都是为了让智械能够学会如何在复杂的条件下完成自己的任务。","特训营从建立至今已有4年，但只有一位智械通过了最高级别的考验，成功毕业。他就是XXXX（被抹掉的信息）"]},{text:"不看了",action:[{type:"exit"}]}]}]}],"第三章末尾":[{type:"comment",text:"取消鸽化，重置能力和装备"},{type:"function","function":"function(){\nif (core.getFlag(\"skill5_is_on\", false)) {\n\tif (core.getFlag(\"skill5_ad\", 0) > 0) {\n\t\tcore.insertCommonEvent(\"AD不鸽了\");\n\t}\n\tif (core.getFlag(\"skill5_am\", 0) > 0) {\n\t\tcore.insertCommonEvent(\"AM不鸽了\");\n\t}\n\tif (core.getFlag(\"skill5_dm\", 0) > 0) {\n\t\tcore.insertCommonEvent(\"DM不鸽了\");\n\t}\n}\n\nif (core.getTalentLv(10) > 0) {\n\tcore.setFlag(\"Chap3_talent_type\", 10);\n\tcore.status.hero.atk -= 7000;\n\tcore.status.hero.def -= 7000;\n\tcore.status.hero.mdef -= 10000;\n} else if (core.getTalentLv(11) > 0) {\n\tcore.setFlag(\"Chap3_talent_type\", 11);\n\tcore.status.hero.atk -= 7000;\n\tcore.status.hero.def -= 2000;\n\tcore.status.hero.mdef -= 19000;\n} else if (core.getTalentLv(12) > 0) {\n\tcore.setFlag(\"Chap3_talent_type\", 12);\n\tcore.status.hero.atk -= 2000;\n\tcore.status.hero.def -= 7000;\n\tcore.status.hero.mdef -= 19000;\n}\ncore.setItem(\"skill5\", 0);\ncore.setItem(\"talentTree\", 0);\n\ncore.unloadEquip(0);\ncore.unloadEquip(1);\ncore.setItem(\"sword5\", 0);\ncore.setItem(\"sword6\", 0);\ncore.setItem(\"sword7\", 0);\nif (flags.hard == 2) {\n\tcore.setFlag('__atk_buff__', 10);\n\tcore.setFlag('__def_buff__', 10);\n\tcore.setFlag('__mdef_buff__', 10);\n\tcore.setFlag('heart_atk_pp', 900);\n\tcore.setFlag('heart_def_pp', 900);\n\tcore.setFlag('heart_mdef_pp', 900);\n} else if (flags.hard == 1) {\n\tcore.setFlag('__atk_buff__', 10);\n\tcore.setFlag('__def_buff__', 10);\n\tcore.setFlag('__mdef_buff__', 10);\n\tcore.setFlag('heart_atk_pp', 900);\n\tcore.setFlag('heart_def_pp', 900);\n\tcore.setFlag('heart_mdef_pp', 900);\n} else {\n\tcore.setFlag('__atk_buff__', 0);\n\tcore.setFlag('__def_buff__', 0);\n\tcore.setFlag('__mdef_buff__', 0);\n}\ncore.setFlag('potion_extra_ratio', 10);\ncore.setFlag('mana_item', 100);\ncore.setFlag('mdef_ratio', 2);\ncore.setFlag('mana_regen', 3);\ncore.updateStatusBar();\n}"},{type:"setValue",name:"status:atk",operator:"-=",value:"150"},{type:"setValue",name:"status:def",operator:"-=",value:"1500"},{type:"setValue",name:"status:mdef",operator:"-=",value:"4250"}],"MusicRoom场景":[{type:"if",condition:"core.isReplaying()","true":[{type:"exit"}]},{type:"setValue",name:"flag:setBlock_disable_refresh",value:"true"},{type:"function","function":'function(){\nvar floorId = core.status.floorId;\nfor (var i = 0; i < 13; ++i) {\n\tfor (var j = 0; j < 13; ++j) {\n\t\tcore.setBgFgBlock("bg", core.getFlag("arg2", null), i, j);\n\t\tif (i == 0 || i == 12 || j == 0 || j == 12) {\n\t\t\tcore.setBlock(core.getFlag("arg1", null), i, j);\n\t\t}\n\t}\n}\nif (core.getFlag("arg3", null)) {\n\tcore.setFlag("musicRoom_parallel", core.getFlag("arg3", null));\n\t// 清除旋转效果\n\tcore.maps.resizeMap(core.status.floorId);\n\tcore.setFlag(\'lastTime\', 0);\n\tcore.setFlag(\'lastWeatherTime\', 0);\n} else {\n\tcore.removeFlag("musicRoom_parallel");\n\t// 清除旋转效果\n\tcore.maps.resizeMap(core.status.floorId);\n}\ncore.drawMap();\n}'},{type:"setValue",name:"flag:setBlock_disable_refresh",value:"false"}],"第三章结束":[{type:"insert",name:"清理flag",args:[3]},{type:"pauseBgm"},{type:"setVolume",value:90,time:0},{type:"setValue",name:"item:book",value:"1"},{type:"setValue",name:"item:fly",value:"1"},{type:"if",condition:'core.hasItem("I319")',"true":["\t[系统提示]失去\\i[I319]\r[aqua]匙之道\r，额外能力加成重置为固定值。"]},{type:"setValue",name:"item:I319",value:"0"},{type:"setValue",name:"item:I392",value:"1"},{type:"setValue",name:"flag:I62_extra_mana_regen",value:"10"},{type:"setValue",name:"flag:I62_extra_description",value:'"若战斗总伤害不大于0，额外回复10点能量"'},{type:"function","function":"function(){\ncore.setFlag('potion_extra_ratio', 10);\ncore.setFlag('mana_item', 100);\ncore.plugin.clearItemDetailCache(\"manaItem\");\ncore.plugin.clearItemDetailCache(\"bigManaitem\");\ncore.setFlag('mdef_ratio', 2);\ncore.setFlag('mana_regen', 5);\n}"},{type:"setValue",name:"item:I62",value:"1"},{type:"setValue",name:"item:I437",value:"1"},"\t[系统提示]即将进入新的区域。重置所有状态，包括能力、物品和技能等。",{type:"if",condition:'core.itemCount("greenKey") > 57',"true":["\t[系统提示]收回第三章开头多发的57把绿钥匙，剩余的留下来作为荣誉物品。",{type:"setValue",name:"item:I_greenKeyCh3",value:'core.itemCount("greenKey")-57'}]},{type:"disableShop",id:"Chap3End"},{type:"disableShop",id:"South8Shop"},{type:"function","function":"function(){\ncore.setFlag('__atk_buff__', 10);\ncore.setFlag('__def_buff__', 10);\ncore.setFlag('__mdef_buff__', 10);\ncore.setFlag('heart_atk_pp', 900);\ncore.setFlag('heart_def_pp', 900);\ncore.setFlag('heart_mdef_pp', 900);\n\ncore.updateStatusBar();\n}"},{type:"setValue",name:"status:hp",value:"1"},{type:"setValue",name:"status:mana",value:"0"},{type:"setValue",name:"status:atk",value:"50000"},{type:"setValue",name:"status:def",value:"40000"},{type:"setValue",name:"status:mdef",value:"50000"},{type:"setValue",name:"status:money",value:"0"},{type:"setValue",name:"item:yellowKey",value:"0"},{type:"setValue",name:"item:blueKey",value:"0"},{type:"setValue",name:"item:redKey",value:"0"},{type:"setValue",name:"item:greenKey",value:"0"},{type:"if",condition:"flags.hard==2","true":[{type:"setValue",name:"item:greenKey",value:"99"}]},{type:"setValue",name:"item:talentTree",value:"0"},{type:"setValue",name:"item:skill3",value:"0"},{type:"setValue",name:"item:skill4",value:"0"},{type:"setValue",name:"item:yellowGem",value:"0"},{type:"setValue",name:"flag:disableFly",value:"0"},{type:"setValue",name:"flag:lightRadius",value:"150"},{type:"setValue",name:"flag:yellowGem_extra_description",value:'"从第四章起，不再能提供生命回复。"'},{type:"setValue",name:"flag:fire_light_a",value:"0.15"},{type:"setValue",name:"flag:zone_animate",value:'"zone2"'},{type:"setCurtain",color:[0,0,0,1],time:500,keep:true},"一切似乎都在朝着最糟糕的方向发展。","我能做什么？我会见到什么？","……",{type:"sleep",time:500},{type:"autoText",text:"第四章 前篇\n格沃之旅",time:2000},{type:"setValue",name:"flag:current_chapter",value:"4"},{type:"unfollow"},{type:"follow",name:"hero3.png"},{type:"changeFloor",floorId:"Ch4_1",loc:[6,12],direction:"up",time:1000}],"清理flag":[{type:"switch",condition:"flag:arg1",caseList:[{"case":"2",action:[{type:"function","function":'function(){\n// 移除前二章相关 flag\nvar keys = Object.keys(core.status.hero.flags);\nfor (var i in keys) {\n\tif (keys[i].indexOf("70F") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\tif (keys[i].indexOf("Shop_finish") > 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\tif (keys[i].indexOf("B20F_") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\tif (keys[i].indexOf("arrived_") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\tif (keys[i].indexOf("bought_") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\tif (keys[i].indexOf("door_") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\tif (keys[i].indexOf("shop") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\tif (keys[i].indexOf("skill0") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\tif (keys[i].indexOf("skill1") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\tif (keys[i].indexOf("skill2") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\t// 独立变量\n\tif (keys[i].indexOf("@") > 0) {\n\t\tvar cnt = 0;\n\t\tfor (var zzz = 0; zzz < keys[i].length; ++zzz) {\n\t\t\tif (keys[i][zzz] == "@") {\n\t\t\t\tcnt += 1;\n\t\t\t}\n\t\t}\n\t\tif (cnt >= 3) {\n\t\t\tcore.removeFlag(keys[i]);\n\t\t}\n\t}\n}\nvar toBeRemoved = ["1Fmission", "11Fmission", "12FShopClose", "15Fboss", "20F_boss_finish", "34F_boss_phase", "B4Fmission_finish", "B10Fdoor", "B10Frage", "blueKey_price", "blueKey_storage", "boss_dir", "canGotoMusicRoom", "can_buy_sword0", "current_area", "freeze_stack", "keysAreBad", "redKey_price", "redKey_storage", "saltfish_67", "yellowKey_price", "yellowKey_storage"];\nfor (var i in toBeRemoved) {\n\tcore.removeFlag(toBeRemoved[i]);\n}\n}'}]},{"case":"3",action:[{type:"function","function":'function(){\n// 移除第三章相关 flag\nvar keys = Object.keys(core.status.hero.flags);\nfor (var i in keys) {\n\tif (keys[i].indexOf("Chap3_boss") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\t// 机关门相关 flag\n\tif (keys[i].indexOf("door_") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\t// 副本相关 flag\n\tif (keys[i].indexOf("saved_") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\t// 技能相关 flag\n\tif (keys[i].indexOf("skill3_") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\tif (keys[i].indexOf("skill4_") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\tif (keys[i].indexOf("skill5_") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\t// 天赋相关 flag\n\tif (keys[i].indexOf("talent") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\t// 独立变量\n\tif (keys[i].indexOf("@") > 0) {\n\t\tvar cnt = 0;\n\t\tfor (var zzz = 0; zzz < keys[i].length; ++zzz) {\n\t\t\tif (keys[i][zzz] == "@") {\n\t\t\t\tcnt += 1;\n\t\t\t}\n\t\t}\n\t\tif (cnt >= 3) {\n\t\t\tcore.removeFlag(keys[i]);\n\t\t}\n\t}\n}\nvar toBeRemoved = ["East8_sold_yellowGem", "arrived_Cave6_2", "arrived_East14", "dungeon1_finish", "dungeon2_finish", "make_E627_cd", "watch_East16"];\nfor (var i in toBeRemoved) {\n\tcore.removeFlag(toBeRemoved[i]);\n}\n}'}]},{"case":"4",action:[{type:"function","function":'function(){\n// 移除第四章前相关 flag\nvar keys = Object.keys(core.status.hero.flags);\nfor (var i in keys) {\n\t// 技能相关 flag\n\tif (keys[i].indexOf("skill6_") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\tif (keys[i].indexOf("skill7_") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\tif (keys[i].indexOf("skill8_") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\t// 天赋相关 flag\n\tif (keys[i].indexOf("talent2") == 0 || keys[i].indexOf("talent") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\t// zzzl 相关 flag\n\tif (keys[i].indexOf("zzzl_") == 0) {\n\t\tcore.removeFlag(keys[i]);\n\t}\n\t// 独立变量\n\tif (keys[i].indexOf("@") > 0) {\n\t\tvar cnt = 0;\n\t\tfor (var zzz = 0; zzz < keys[i].length; ++zzz) {\n\t\t\tif (keys[i][zzz] == "@") {\n\t\t\t\tcnt += 1;\n\t\t\t}\n\t\t}\n\t\tif (cnt >= 3) {\n\t\t\tcore.removeFlag(keys[i]);\n\t\t}\n\t}\n}\n}'}]}]}],"进入隐身":[{type:"setValue",name:"flag:invisible",value:"1"},{type:"setValue",name:"flag:no_zone",value:"1"},{type:"setValue",name:"flag:no_laser",value:"1"},{type:"setValue",name:"flag:no_snipe",value:"1"},{type:"setValue",name:"flag:no_repulse",value:"1"},{type:"setValue",name:"flag:no_ambush",value:"1"},{type:"setValue",name:"flag:no_betweenAttack",value:"1"},{type:"setValue",name:"flag:invisible_moved",value:"0"},{type:"function","function":"function(){\ncore.setOpacity('hero', 0.5);\n}"},{type:"animate",name:"skill7",loc:"hero",async:true}],"退出隐身":[{type:"switch",condition:"flag:arg1",caseList:[{"case":"0",action:[{type:"comment",text:"直接退出"},{type:"setValue",name:"flag:invisible",value:"0"},{type:"setValue",name:"flag:no_zone",value:"0"},{type:"setValue",name:"flag:no_laser",value:"0"},{type:"setValue",name:"flag:no_snipe",value:"0"},{type:"setValue",name:"flag:no_repulse",value:"0"},{type:"setValue",name:"flag:no_betweenAttack",value:"0"},{type:"setValue",name:"flag:no_ambush",value:"0"},{type:"function","function":"function(){\ncore.setOpacity('hero', 0.99);\n}"},{type:"animate",name:"yongchang",loc:"hero",async:true}]},{"case":"1",action:[{type:"comment",text:"主动取消，进行询问"},{type:"choices",text:"\t[系统提示]你进入隐身后已经移动过位置，取消隐身将返还${flag:skill7_cancel_return_cost||0}点能量。",choices:[{text:"保持隐身",action:[]},{text:"取消隐身",action:[{type:"comment",text:"我发现这里调用自己没有效果，只好把上面的逻辑copy下来"},{type:"setValue",name:"flag:invisible",value:"0"},{type:"setValue",name:"flag:no_zone",value:"0"},{type:"setValue",name:"flag:no_laser",value:"0"},{type:"setValue",name:"flag:no_snipe",value:"0"},{type:"setValue",name:"flag:no_repulse",value:"0"},{type:"setValue",name:"flag:no_betweenAttack",value:"0"},{type:"setValue",name:"flag:no_ambush",value:"0"},{type:"function","function":"function(){\ncore.setOpacity('hero', 0.99);\ncore.status.hero.mana += core.getFlag(\"skill7_cancel_return_cost\", 0);\n}"},{type:"animate",name:"yongchang",loc:"hero",async:true}]}]}]}]}],"至尊之录":[{type:"choices",text:"\t[至尊之录,I_zzzl]选择要查看的部分",choices:[{text:"Part Ⅰ 社会起始",condition:"flag:zzzl_1_1 == 1",action:["起初 神统治王国\n国土划为三阶 分为城、镇、村\n公民亦有三阶 分住于城、镇、村\n对每一阶公民 又划为三等\n高等的公民 享有大量的财富和完全的自由 不为琐事所困缚\n中等的公民 每天须工作八个小时 除此之外的时间可自由掌控\n低等的公民 每天须工作十二个小时 再除去吃饭睡觉等必需的活动 时间已所剩无几",{type:"if",condition:"flag:zzzl_1_2 == 1","true":["神看低等公民工作劳累 于心不忍\n神说 要提升低等公民的阶级 让他们拥有更多的自由\n神创造了机器人 要它们代替低等公民 完成他们的工作\n机器人逐渐多起来 原本的低等公民大多变为中等公民\n只余下那些曾经冒犯过神或其他神之子民的人 连同他们的子孙后代 都是低等公民 不得翻身"]}]},{text:"Part Ⅱ 智械起源",condition:"flag:zzzl_2_1 == 1",action:["在摩宇城的中心 有一高等公民 名为秉凌 是神最信任的部下\n秉凌说 自己有办法把中等公民也彻底解放\n中等公民的工作更为复杂 须有人的灵智才能完成\n让机器具有人的灵智 问题便迎刃而解\n神便允许秉凌去做 还分派一些他最信任的部下作为帮手 要他六年之内做出成果",{type:"if",condition:"flag:zzzl_2_2 == 1","true":["秉凌的工作并不顺利 六年之期已到 却并无成果\n在项目开始后的第二二二一天 神找到秉凌询问进展\n秉凌面对神的质问 稍作犹豫 还是说出了实情\n项目超乎想象地复杂 即使再给二二二一天 也不一定能完成\n神说 你做的事情有意义 再给多少个二二二一天都可以\n但你未能达到我的预期 必须受到处罚\n神收回了自己的部下 把秉凌逐出了摩宇城"]},{type:"if",condition:"flag:zzzl_2_3 == 1","true":["秉凌被流放后 神的部下中 有一部分自愿追随 帮他完成未竟的事业\n秉凌用自己的家当 在国土最偏僻的无为村之外 建立了格沃堡\n追随者们也利用各自的财力 购置设备 承担日常开销 支撑着他们共同的研究事业\n与此同时 在神的国土上 用机械取代肉体的技术蓬勃发展\n械造的四肢 器官 赋予常人超凡的身体素质\n机械改造风靡一时 人们纷纷抛弃脆弱的肉体凡胎\n唯有大脑 承载着思想和灵魂 无法抛弃 无可替代",{type:"if",condition:"flag:zzzl_2_2 != 1","true":["\t[hero]……中间似乎缺了一部分内容。"]}]}]},{text:"Part Ⅲ 至尊崛起",condition:"flag:zzzl_3_1 == 1",action:["荒烟村是神之国土上最偏僻的地方 村里只有低等公民\n被神流放的犯人 和他们的后裔 世世代代都负责处理其他地方运来的垃圾\n神的子民从远方监视着他们 倘若有人偷懒 便会受到严厉的处罚\n每天都上演着同样的场景 罪人们永远都不得离开这里",{type:"if",condition:"flag:zzzl_3_2 == 1","true":["在荒烟村的罪人之中 有一男孩 自记事起便没有亲人 以拾荒为生\n男孩十二岁那年 遇到了一位被抛弃的女孩\n女孩身世不明 也无记忆 便与男孩在荒烟村住下 两人情同手足 以兄妹相称\n在无尽的拾荒生活中 培养女孩成为独立自主的人 成为男孩唯一的人生目标\n男孩说 女孩不属于这里 等她成年 能独自面对任何困难之后 要把她送回城市\n女孩天资聪慧 气质温婉 定能在大城市中打拼出自己的一片天地"]},{type:"if",condition:"flag:zzzl_3_3 == 1","true":["女孩成年之前的一年 村里有人犯下大罪 神的怒火席卷了整个村子\n荒烟村的村民们 有的化身野兽 无理智地残杀活物\n有的浑身肿胀 体内发散的毒气能使人窒息\n昆虫发生变异 袭杀手无寸铁的人类\n女孩七窍流血 奄奄一息 男孩抱着她四处逃窜 走投无路\n就在此时 秉凌出现了 救下两人 带他们回到了格沃堡\n神的怒火持续了七天七夜 荒烟村的所有生命体 不论是变异的还是未变异的 都死了\n二二二一天之后 又有新的罪犯被流放至此 开始下一个轮回"]},{type:"if",condition:"flag:zzzl_3_4 == 1","true":["被秉凌救下的男孩 愿意答应秉凌的一切要求 唯一的条件是救下女孩\n女孩已失去意识 病入膏肓\n秉凌先抢救她的大脑 然而记忆都丢失了\n秉凌又抢救她的身躯 然而血肉都腐坏了\n秉凌将她的大脑冷冻起来 对男孩说 想救她只有一个办法\n运用自己研发的械灵技术 将她改造成机器人\n她的部分大脑将被机械代替 但保留原本的性格特征 并获得全新的械造身躯\n这项技术从未被用于人类身上 更不用说是只剩下一个大脑的人类\n男孩自愿成为实验体 秉凌便能从他身上收集实验数据 完善技术\n等到技术成熟之时 便可将女孩的大脑解冻 她将重获新生 再次行走于这大地之上"]}]},{text:"不看",action:[]}]}],zzzl3:[{type:"if",condition:"flag:zzzl_3_1!=1","true":[{type:"setValue",name:"flag:zzzl_3_1",value:"1"},"\t[晴芸,hero3]咦，它留下了什么信息！","Ⅲ. 至尊崛起\n荒烟村是神之国土上最偏僻的地方 村里只有低等公民\n被神流放的犯人 和他们的后裔 世世代代都负责处理其他地方运来的垃圾\n神的子民从远方监视着他们 倘若有人偷懒 便会受到严厉的处罚\n每天都上演着同样的场景 罪人们永远都不得离开这里","\t[hero]这大家伙留下来的信息是至尊之录的第三部分……从我们所在的区域是格沃堡上层来推断，这应该也是至尊之录的最后一部分了。","\t[晴芸,hero3]荒烟村……从来没听说过这个地方。\n在网上也查不到。","\t[hero]荒烟，荒无人烟，这名字一听就是个……怎么形容呢，鸟不拉屎的鬼地方。\n所谓的至尊，不会真的就是从这里出来的吧？","\t[晴芸,hero3]……答案已经很显然了。"],"false":[{type:"if",condition:"flag:zzzl_3_2!=1","true":["\t[hero]来看看这次“至尊之录”的内容……",{type:"setValue",name:"flag:zzzl_3_2",value:"1"},"在荒烟村的罪人之中 有一男孩 自记事起便没有亲人 以拾荒为生\n男孩十二岁那年 遇到了一位被抛弃的女孩\n女孩身世不明 也无记忆 便与男孩在荒烟村住下 两人情同手足 以兄妹相称\n在无尽的拾荒生活中 培养女孩成为独立自主的人 成为男孩唯一的人生目标\n男孩说 女孩不属于这里 等她成年 能独自面对任何困难之后 要把她送回城市\n女孩天资聪慧 气质温婉 定能在大城市中打拼出自己的一片天地","\t[hero]捡到一个机灵可爱的妹妹，然后又要亲自把她送走，这剧情怎么这么狗血……","\t[晴芸,hero3]所以这肯定不是故事的真正走向……我现在看到故事里讲到“要怎么怎么”，第一反应就是在画饼，给你一个美好的幻想，再亲自将它打碎。",{type:"animate",name:"E_sweat",loc:"hero"}],"false":[{type:"if",condition:"flag:zzzl_3_3!=1","true":[{type:"setValue",name:"flag:zzzl_3_3",value:"1"},"女孩成年之前的一年 村里有人犯下大罪 神的怒火席卷了整个村子\n荒烟村的村民们 有的化身野兽 无理智地残杀活物\n有的浑身肿胀 体内发散的毒气能使人窒息\n昆虫发生变异 袭杀手无寸铁的人类\n女孩七窍流血 奄奄一息 男孩抱着她四处逃窜 走投无路\n就在此时 秉凌出现了 救下两人 带他们回到了格沃堡\n神的怒火持续了七天七夜 荒烟村的所有生命体 不论是变异的还是未变异的 都死了\n二二二一天之后 又有新的罪犯被流放至此 开始下一个轮回",{type:"animate",name:"E_dots",loc:"hero"},"\t[hero]神的怒火，原来是这个样子的吗？\n我以前一直以为应该是发大水把所有生物都淹死之类的，没想到这看上去更像是……生化危机？","\t[晴芸,hero3]生化危机……错不了，这根本就是在\n\r[yellow]用荒烟村的生物做基因变异实验！\r",{type:"animate",name:"E_surprise",loc:"hero"},"\t[晴芸,hero3]什么犯下大罪，什么怒火，不过是借口而已。\n整天搬垃圾的下等公民，要做出什么事情才能激怒高高在上的“神”？而且，哪有一人犯罪连累全村的？","\t[hero]……有道理。我所看到的，也只有“神”的荒淫无道，而被“神”流放的秉凌反倒像是拯救苍生的圣人。"],"false":[]}]}]}],skill8buff:[{type:"animate",name:"rage_buff",loc:"hero",async:true},{type:"setValue",name:"flag:moveShadow",value:"1"},{type:"setHeroIcon",name:"hero_rage.png"},{type:"setValue",name:"flag:skill8_buff",value:"1"},{type:"setValue",name:"flag:skill8_direction",value:"0"},{type:"setValue",name:"flag:cannotMoveDirectly",value:"true"},{type:"setValue",name:"flag:disableFly",value:"true"}],skill8end:[{type:"animate",name:"dispel",loc:"hero",async:true},{type:"setValue",name:"flag:moveShadow",value:"0"},{type:"setHeroIcon",name:"hero.png"},{type:"setValue",name:"flag:skill8_buff",value:"0"},{type:"setValue",name:"flag:cannotMoveDirectly",value:"false"},{type:"setValue",name:"flag:disableFly",value:"false"}],Ch4Boss:[{type:"setValue",name:"flag:Ch4_boss_phase",operator:"+=",value:"1"},{type:"insert",name:"Ch4BossDraw"},{type:"setValue",name:"flag:Ch4_boss_phase",operator:"-=",value:"1"},{type:"switch",condition:"flag:Ch4_boss_phase",caseList:[{"case":"1",action:[{type:"setValue",name:"flag:Ch4_boss_phase",operator:"+=",value:"1"},{type:"animate",name:"dark",loc:["flag:arg1","flag:arg2"]},{type:"setBlock",number:"E9961_2",loc:["flag:arg1","flag:arg2"]},"\t[9961,E9961_2]\b[down,null]这才刚开始热身，械灵形态！"]},{"case":"2",action:[{type:"setValue",name:"flag:Ch4_boss_phase",operator:"+=",value:"1"},{type:"animate",name:"dark",loc:["flag:arg1","flag:arg2"]},{type:"setBlock",number:"E9961_3",loc:["flag:arg1","flag:arg2"]},"\t[9961,E9961_3]\b[down,null]再来！机械形态！"]},{"case":"3",action:[{type:"setValue",name:"flag:Ch4_boss_phase",operator:"+=",value:"1"},{type:"animate",name:"dark",loc:["flag:arg1","flag:arg2"]},{type:"setBlock",number:"E9961_4",loc:["flag:arg1","flag:arg2"]},"\t[9961,E9961_4]\b[down,null]不错嘛，我要开始动真格的了。爆破模式！"]},{"case":"4",action:[{type:"function","function":'function(){\ncore.removeFlag("Ch4_quickshop");\n}'},{type:"setValue",name:"item:I_Chap4Shop4",value:"0"},{type:"disableShop",id:"Chap4Shop4"},{type:"setValue",name:"flag:Ch4_boss_phase",operator:"+=",value:"1"},{type:"animate",name:"explosion",loc:["flag:arg1","flag:arg2"]},{type:"animate",name:"dark",loc:["flag:arg1","flag:arg2"]},{type:"setBlock",number:"E9961_5",loc:["flag:arg1","flag:arg2"]},{type:"sleep",time:500},{type:"playSound",name:"jump.mp3"},{type:"jump",from:["flag:arg1","flag:arg2"],to:[6,4],time:500,keep:true},{type:"animate",name:"skill6",loc:"hero",async:true},{type:"changePos",direction:"up"},{type:"jumpHero",loc:[6,8],time:500},"\t[9961,E9961_5]\b[down,6,4]真抗揍呢……\n喂，接下来可不会允许你再使用\r[yellow]快捷商店\r了，\n在我用出拿手绝技之前，我给你一个投降的机会。",{type:"while",condition:"true",data:[{type:"choices",text:"\t[9961,E9961_5]支付9把绿钥匙，立即投降。\n机会只有一次，不能反悔哦~",choices:[{text:"用大绿钥匙投降！",color:[232,95,95,1],condition:"flags.hard==1",action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"item:I_superGreenKey",operator:"-=",value:"1"},"\t[hero]\b[down,hero]没人能在我投降之前战胜我！\n9把绿钥匙我没有，\\i[I_superGreenKey]大绿钥匙给你行不行？",{type:"animate",name:"E_sweat",loc:[6,4]},"\t[9961,E9961_5]\b[down,6,4]行吧……","获得成就【法国智械】！\n在与9961的游戏中选择投降。",{type:"comment",text:"end"},{type:"setCurtain",color:[255,255,255,1],time:800,keep:true},{type:"insert",loc:[0,0],floorId:"Ch4_3D"},{type:"exit"}]},{text:"我现在就投降！",color:[232,95,95,1],condition:"flags.hard==2",action:[{type:"playSound",name:"buy.mp3"},{type:"setValue",name:"item:greenKey",operator:"-=",value:"9"},"\t[hero]\b[down,hero]没人能在我投降之前战胜我！",{type:"animate",name:"E_sweat",loc:[6,4]},"获得成就【法国智械】！\n在与9961的游戏中选择投降。",{type:"comment",text:"end"},{type:"setCurtain",color:[255,255,255,1],time:800,keep:true},{type:"insert",loc:[0,0],floorId:"Ch4_3D"},{type:"exit"}]},{text:"你开什么玩笑？",color:[0,255,41,1],action:["\t[9961,E9961_5]\b[down,6,4]哼，别怪我没警告过你。\n那么，最后一轮，抓到我，就算你赢，嘻嘻~",{type:"exit"}]},{text:"问晴芸该怎么办",color:[255,251,0,1],condition:"!flag:qingyun",action:["\t[晴芸,hero3]哈？你问我？",{type:"function","function":'function(){\nvar result = 2;\nfor (var x = 3; x < 10; ++x) {\n\tfor (var y = 3; y < 10; ++y) {\n\t\tif (core.getBlockId(x, y) == "yellowDoor") {\n\t\t\tresult = 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (result == 1) break;\n}\ncore.setFlag("qingyun", result);\n}'},{type:"if",condition:"flag:qingyun == 1","true":["\t[晴芸,hero3]其实你心里早有答案了吧？\n当然是莽过去啦！冲吖~"],"false":["\t[晴芸,hero3]……刚刚被它以极其神秘的手段清空了能量值，和快捷商店的联系也被切断了，我现在用不出技能，有一种很不妙的预感。\n所以……我觉得还是投降吧。","\t[hero]啊？这么没信心的吗？\n我再考虑考虑……"]}]}]}]}]},{"case":"5",action:[{type:"comment",text:"end"},{type:"vibrate",direction:"horizontal",time:2000,speed:10,power:10,async:true},{type:"animate",name:"supernova",loc:["flag:arg1","flag:arg2"],async:true},{type:"setCurtain",color:[255,255,255,1],time:2000,keep:true},{type:"function","function":"function(){\nfor (var i = 3; i < 10; ++i) {\n\tfor (var j = 3; j < 10; ++j) {\n\t\tcore.removeBlock(i, j);\n\t}\n}\n}"},{type:"insert",loc:[0,0],floorId:"Ch4_3D"},{type:"waitAsync"}]},{"case":"default",action:[]}]}],"毁天灭地":[{type:"setValue",name:"status:mana",operator:"-=",value:"flag:skill13_cost"},{type:"if",condition:"(!core.isReplaying())","true":[{type:"setValue",name:"flag:enable_enemy_fly",value:"1"},{type:"setValue",name:"flag:moveShadow",value:"1"},{type:"setValue",name:"flag:temp",value:"flag:moveShadow_period"},{type:"setValue",name:"flag:moveShadow_period",value:"1"},{type:"playSound",name:"Quake.ogg",pitch:110},{type:"showImage",code:81,image:"danger.png",loc:["flag:temp_skill13_x*32-4","flag:temp_skill13_y*32-4"],opacity:1,time:500,async:true},{type:"fillEllipse",x:"flag:temp_skill13_x*32+16",y:"flag:temp_skill13_y*32+16",a:80,b:80,angle:0,style:[99,147,255,0.5]},{type:"fillEllipse",x:"flag:temp_skill13_x*32+16",y:"flag:temp_skill13_y*32+16",a:20,b:20,angle:0,style:[99,147,255,0.5]},{type:"vibrate",direction:"horizontal",time:500,speed:10,power:10},{type:"animate",name:"skill13up",loc:["core.status.hero.loc.x","core.status.hero.loc.y"],async:true},{type:"playSound",name:"DF_q_1.mp3"},{type:"jumpHero",dxy:[0,-20],time:400},{type:"sleep",time:200,noSkip:true},{type:"changePos",loc:["flag:temp_skill13_x","flag:temp_skill13_y - 20"],direction:"down"},{type:"waitAsync"},{type:"jumpHero",dxy:[0,20],time:400},{type:"setValue",name:"flag:moveShadow",value:"0"},{type:"setValue",name:"flag:moveShadow_period",value:"flag:temp"},{type:"hideImage",code:81,time:0},{type:"clearMap",x:"flag:temp_skill13_x*32-64",y:"flag:temp_skill13_y*32-64",width:160,height:160},{type:"animate",name:"skill13down",loc:["core.status.hero.loc.x","core.status.hero.loc.y"],async:true},{type:"vibrate",direction:"horizontal",time:1000,speed:10,power:10,async:true}],"false":[{type:"changePos",loc:["flag:temp_skill13_x","flag:temp_skill13_y"],direction:"down"}]},{type:"setValue",name:"flag:previewSkill13",value:"0"},{type:"function","function":'function(){\nvar dec_atk = core.getFlag("skill13_datk", 0),\n\tdec_def = core.getFlag("skill13_ddef", 0);\nvar loc_x = core.status.hero.loc.x,\n\tloc_y = core.status.hero.loc.y;\n\n// 伤害\nvar tmp_mdef = 900 * core.status.hero.mdef / 100;\nvar damage = core.getFlag("skill10_basedmg") + core.getFlag("skill10_mdefdmgratio", 0) * tmp_mdef;\nvar process = function (dx, dy) {\n\tif (Math.abs(dx) == 2 && Math.abs(dy) == 2) return;\n\tvar cur_x = loc_x + dx,\n\t\tcur_y = loc_y + dy;\n\tif (core.plugin.isEnemy(cur_x, cur_y)) {\n\t\tcore.setEnemyOnPoint(cur_x, cur_y, null, "atk", dec_atk, "-=", "", true);\n\t\tcore.setEnemyOnPoint(cur_x, cur_y, null, "def", dec_def, "-=", "", true);\n\t\tif (dx == 0 && dy == 0) {\n\t\t\tcore.events.setEnemyOnPointAdd(cur_x, cur_y, null, "hp", 2 * damage, "-=", "", true);\n\t\t} else {\n\t\t\tcore.events.setEnemyOnPointAdd(cur_x, cur_y, null, "hp", damage, "-=", "", true);\n\t\t}\n\t}\n};\nprocess(0, 0);\nprocess(0, -1);\nprocess(-1, 0);\nprocess(1, 0);\nprocess(0, 1);\nprocess(-1, -1);\nprocess(1, -1);\nprocess(-1, 1);\nprocess(1, 1);\nprocess(0, -2);\nprocess(-2, 0);\nprocess(2, 0);\nprocess(0, 2);\nprocess(-1, -2);\nprocess(1, -2);\nprocess(-2, -1);\nprocess(2, -1);\nprocess(-2, 1);\nprocess(2, 1);\nprocess(-1, 2);\nprocess(1, 2);\ncore.updateStatusBar();\n\n// 触发\nvar actions = [];\nif (core.plugin.isEnemy(loc_x, loc_y)) {\n\tactions.push({ "type": "battle", "loc": [loc_x, loc_y] });\n} else if (core.getBlockCls(loc_x, loc_y) == "items") {\n\tactions.push({ "type": "trigger", "loc": [loc_x, loc_y] });\n}\nactions.push({ "type": "function", "function": "function(){core.plugin.addTempMdefpp(3 * core.getFlag(\\"skill11_add\\"));}" });\ncore.insertAction(actions);\n}'},{type:"if",condition:"(!core.isReplaying())","true":[{type:"setValue",name:"flag:enable_enemy_fly",value:"0"}]},{type:"setValue",name:"flag:skill13_cost",value:"2000"},{type:"waitAsync"}],"第四章前结束":[{type:"insert",name:"清理flag",args:[4]},{type:"pauseBgm"},{type:"setVolume",value:90,time:0},{type:"function","function":"function(){\ncore.unloadEquip(0);\ncore.unloadEquip(1);\n\ncore.setFlag('potion_extra_ratio', 20);\ncore.setFlag('mana_item', 150);\ncore.setFlag('mdef_ratio', 2);\ncore.setFlag('mana_regen', 5);\n}"},{type:"setValue",name:"item:sword8",value:"0"},{type:"setValue",name:"item:shield8",value:"0"},{type:"setValue",name:"item:book",value:"1"},{type:"setValue",name:"item:fly",value:"1"},{type:"setValue",name:"item:I319",value:"0"},{type:"setValue",name:"item:I392",value:"1"},{type:"setValue",name:"flag:I62_extra_mana_regen",value:"10"},{type:"setValue",name:"flag:I62_extra_description",value:'"。若战斗总伤害不大于0，额外回复10点能量"'},{type:"setValue",name:"item:I62",value:"1"},{type:"setValue",name:"item:I437",value:"1"},"\t[系统提示]即将进入新的区域。重置所有状态，包括能力、物品和技能等。",{type:"if",condition:'(core.itemCount("greenKey") > 64)',"true":["\t[系统提示]收回第四章开头多发的64把绿钥匙，剩余的留下来作为荣誉物品。",{type:"setValue",name:"item:I_greenKeyCh3",operator:"+=",value:'core.itemCount("greenKey")-64'}]},{type:"disableShop",id:"Chap4Shop4"},{type:"function","function":"function(){\ncore.setFlag('__atk_buff__', 10);\ncore.setFlag('__def_buff__', 10);\ncore.setFlag('__mdef_buff__', 10);\ncore.setFlag('heart_atk_pp', 900);\ncore.setFlag('heart_def_pp', 900);\ncore.setFlag('heart_mdef_pp', 900);\n\ncore.updateStatusBar();\n}"},{type:"setValue",name:"status:hp",value:"30000000"},{type:"setValue",name:"status:mana",value:"1000"},{type:"setValue",name:"status:atk",value:"200000"},{type:"setValue",name:"status:def",value:"200000"},{type:"setValue",name:"status:mdef",value:"400000"},{type:"setValue",name:"status:money",value:"0"},{type:"setValue",name:"item:yellowKey",value:"0"},{type:"setValue",name:"item:blueKey",value:"0"},{type:"setValue",name:"item:redKey",value:"0"},{type:"setValue",name:"item:greenKey",value:"0"},{type:"setValue",name:"item:I_superGreenKey",value:"0"},{type:"setValue",name:"item:talentTree2",value:"0"},{type:"setValue",name:"item:skill6",value:"0"},{type:"setValue",name:"item:skill7",value:"0"},{type:"setValue",name:"item:skill8",value:"0"},{type:"setValue",name:"item:yellowGem",value:"0"},{type:"setValue",name:"item:I_noVampire",value:"0"},{type:"setValue",name:"item:I_zzzl",value:"0"},{type:"setValue",name:"flag:disableFly",value:"0"},{type:"setValue",name:"flag:lightRadius",value:"150"},{type:"setValue",name:"flag:yellowGem_extra_description",value:'"从第四章起，不再能提供生命回复。"'},{type:"setValue",name:"flag:fire_light_a",value:"0.15"},{type:"setValue",name:"flag:zone_animate",value:'"zone2"'},{type:"if",condition:"(flags.hard==2)","true":[{type:"setValue",name:"item:greenKey",value:"99"}]},{type:"setCurtain",color:[0,0,0,1],time:500,keep:true},{type:"sleep",time:500},{type:"autoText",text:"第四章 后篇\n除零行动",time:2000},{type:"setValue",name:"flag:current_chapter",value:"4.5"},{type:"unfollow"},{type:"follow",name:"hero3.png"},{type:"changeFloor",floorId:"Ch4_41",loc:[6,4],direction:"down",time:1000}],doSkill12:[{type:"switch",condition:"flag:temp_skill12_dir",caseList:[{"case":'"left"',action:[{type:"fillArc",x:"core.nextX(2) * 32 + 32",y:"core.nextY(2) * 32 + 16",r:96,start:144,end:216,style:[99,147,255,0.5]}]},{"case":'"right"',action:[{type:"fillArc",x:"core.nextX(2) * 32",y:"core.nextY(2) * 32 + 16",r:96,start:324,end:36,style:[99,147,255,0.5]}]},{"case":'"up"',action:[{type:"fillArc",x:"core.nextX(2) * 32 + 16",y:"core.nextY(2) * 32 + 32",r:96,start:234,end:306,style:[99,147,255,0.5]}]},{"case":'"down"',action:[{type:"fillArc",x:"core.nextX(2) * 32 + 16",y:"core.nextY(2) * 32",r:96,start:54,end:126,style:[99,147,255,0.5]}]}]},{type:"setValue",name:"flag:skill12_use_time",operator:"+=",value:"1"},{type:"setValue",name:"status:mana",operator:"-=",value:"flag:skill12_cost"},{type:"setValue",name:"status:mana",operator:"-=",value:"core.getTalentLv3(3)"},{type:"setValue",name:"flag:usingSkill12",value:"1"},{type:"playSound",name:"DF_e_1.mp3"},{type:"jumpHero",loc:["core.nextX(2)","core.nextY(2)"],time:500},{type:"setValue",name:"flag:previewSkill12",value:"0"},{type:"clearMap",x:0,y:0,width:416,height:416},{type:"vibrate",direction:"horizontal",time:100,speed:10,power:10,async:true},{type:"function","function":'function(){\ncore.clearMap(\'curtain\');\ncore.plugin.updateWeather();\nvar dir = core.getFlag("temp_skill12_dir");\ncore.removeFlag("temp_skill12_dir");\nvar hero_x = core.status.hero.loc.x,\n\thero_y = core.status.hero.loc.y;\nvar actions = [{ "type": "changePos", "direction": dir }, { "type": "animate", "name": "skill12", "loc": ["core.nextX(1)", "core.nextY(1)"], "async": true }];\nvar dec_atk = core.getFlag("skill12_datk", 0);\nvar hit_enemy_num = 0;\nvar level_limit = 0;\nif (core.getTalentLv3(2) >= 3) level_limit = 1;\nif (core.getTalentLv3(2) >= 5) level_limit = 2;\nswitch (dir) {\ncase "up":\n\tfor (var x = hero_x - 1; x <= hero_x + 1; x++) {\n\t\tif (core.plugin.isEnemy(x, hero_y - 1)) {\n\t\t\tactions.push({\n\t\t\t\t"type": "setEnemyOnPoint",\n\t\t\t\t"loc": [\n\t\t\t\t\t[x, hero_y - 1]\n\t\t\t\t],\n\t\t\t\t"name": "atk",\n\t\t\t\t"operator": "-=",\n\t\t\t\t"value": dec_atk\n\t\t\t}, { "type": "sleep", "time": 100 });\n\t\t\tif (core.plugin.isEnemy(x, hero_y - 1, null, true)) {\n\t\t\t\tactions.push({ "type": "battle", "loc": [x, hero_y - 1] });\n\t\t\t\thit_enemy_num += 1;\n\t\t\t}\n\t\t} else if (core.getBlockCls(x, hero_y - 1) == "items") {\n\t\t\tactions.push({ "type": "trigger", "loc": [x, hero_y - 1] });\n\t\t}\n\t}\n\tfor (var x = hero_x - 1; x <= hero_x + 1; x++) {\n\t\tif (core.plugin.isEnemy(x, hero_y - 2) || core.getBlockCls(x, hero_y - 2) == "items") {\n\t\t\tactions.push({\n\t\t\t\t"type": "if",\n\t\t\t\t"condition": "core.getBlockId(" + x + "," + (hero_y - 1) + ") == null",\n\t\t\t\t"true": [{\n\t\t\t\t\t\t"type": "setEnemyOnPoint",\n\t\t\t\t\t\t"loc": [\n\t\t\t\t\t\t\t[x, hero_y - 2]\n\t\t\t\t\t\t],\n\t\t\t\t\t\t"name": "atk",\n\t\t\t\t\t\t"operator": "-=",\n\t\t\t\t\t\t"value": dec_atk\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t"type": "if",\n\t\t\t\t\t\t"condition": !core.plugin.hasTitle(x, hero_y - 2, level_limit),\n\t\t\t\t\t\t"true": [\n\t\t\t\t\t\t\t{ "type": "jump", "from": [x, hero_y - 2], "dxy": [0, 1], "time": 500, "keep": true, "async": true }\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t});\n\t\t}\n\t\tif (core.plugin.willNotBlockSkill12(x, hero_y - 1) && core.plugin.isEnemy(x, hero_y - 2, null, true)) {\n\t\t\thit_enemy_num += 1;\n\t\t}\n\t}\n\tbreak;\ncase "down":\n\tfor (var x = hero_x - 1; x <= hero_x + 1; x++) {\n\t\tif (core.plugin.isEnemy(x, hero_y + 1)) {\n\t\t\tactions.push({\n\t\t\t\t"type": "setEnemyOnPoint",\n\t\t\t\t"loc": [\n\t\t\t\t\t[x, hero_y + 1]\n\t\t\t\t],\n\t\t\t\t"name": "atk",\n\t\t\t\t"operator": "-=",\n\t\t\t\t"value": dec_atk\n\t\t\t}, { "type": "sleep", "time": 100 });\n\t\t\tif (core.plugin.isEnemy(x, hero_y + 1, null, true)) {\n\t\t\t\tactions.push({ "type": "battle", "loc": [x, hero_y + 1] });\n\t\t\t\thit_enemy_num += 1;\n\t\t\t}\n\t\t} else if (core.getBlockCls(x, hero_y + 1) == "items") {\n\t\t\tactions.push({ "type": "trigger", "loc": [x, hero_y + 1] });\n\t\t}\n\t}\n\tfor (var x = hero_x - 1; x <= hero_x + 1; x++) {\n\t\tif (core.plugin.isEnemy(x, hero_y + 2) || core.getBlockCls(x, hero_y + 2) == "items") {\n\t\t\tactions.push({\n\t\t\t\t"type": "if",\n\t\t\t\t"condition": "core.getBlockId(" + x + "," + (hero_y + 1) + ") == null",\n\t\t\t\t"true": [{\n\t\t\t\t\t\t"type": "setEnemyOnPoint",\n\t\t\t\t\t\t"loc": [\n\t\t\t\t\t\t\t[x, hero_y + 2]\n\t\t\t\t\t\t],\n\t\t\t\t\t\t"name": "atk",\n\t\t\t\t\t\t"operator": "-=",\n\t\t\t\t\t\t"value": dec_atk\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t"type": "if",\n\t\t\t\t\t\t"condition": !core.plugin.hasTitle(x, hero_y + 2, level_limit),\n\t\t\t\t\t\t"true": [\n\t\t\t\t\t\t\t{ "type": "jump", "from": [x, hero_y + 2], "dxy": [0, -1], "time": 500, "keep": true, "async": true }\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t});\n\t\t}\n\t\tif (core.plugin.willNotBlockSkill12(x, hero_y + 1) && core.plugin.isEnemy(x, hero_y + 2, null, true)) {\n\t\t\thit_enemy_num += 1;\n\t\t}\n\t}\n\tbreak;\ncase "right":\n\tfor (var y = hero_y - 1; y <= hero_y + 1; y++) {\n\t\tif (core.plugin.isEnemy(hero_x + 1, y)) {\n\t\t\tactions.push({\n\t\t\t\t"type": "setEnemyOnPoint",\n\t\t\t\t"loc": [\n\t\t\t\t\t[hero_x + 1, y]\n\t\t\t\t],\n\t\t\t\t"name": "atk",\n\t\t\t\t"operator": "-=",\n\t\t\t\t"value": dec_atk\n\t\t\t}, { "type": "sleep", "time": 100 });\n\t\t\tif (core.plugin.isEnemy(hero_x + 1, y, null, true)) {\n\t\t\t\tactions.push({ "type": "battle", "loc": [hero_x + 1, y] });\n\t\t\t\thit_enemy_num += 1;\n\t\t\t}\n\t\t} else if (core.getBlockCls(hero_x + 1, y) == "items") {\n\t\t\tactions.push({ "type": "trigger", "loc": [hero_x + 1, y] });\n\t\t}\n\t}\n\tfor (var y = hero_y - 1; y <= hero_y + 1; y++) {\n\t\tif (core.plugin.isEnemy(hero_x + 2, y) || core.getBlockCls(hero_x + 2, y) == "items") {\n\t\t\tactions.push({\n\t\t\t\t"type": "if",\n\t\t\t\t"condition": "core.getBlockId(" + (hero_x + 1) + "," + y + ") == null",\n\t\t\t\t"true": [{\n\t\t\t\t\t\t"type": "setEnemyOnPoint",\n\t\t\t\t\t\t"loc": [\n\t\t\t\t\t\t\t[hero_x + 2, y]\n\t\t\t\t\t\t],\n\t\t\t\t\t\t"name": "atk",\n\t\t\t\t\t\t"operator": "-=",\n\t\t\t\t\t\t"value": dec_atk\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t"type": "if",\n\t\t\t\t\t\t"condition": !core.plugin.hasTitle(hero_x + 2, y, level_limit),\n\t\t\t\t\t\t"true": [\n\t\t\t\t\t\t\t{ "type": "jump", "from": [hero_x + 2, y], "dxy": [-1, 0], "time": 500, "keep": true, "async": true }\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t});\n\t\t}\n\t\tif (core.plugin.willNotBlockSkill12(hero_x + 1, y) && core.plugin.isEnemy(hero_x + 2, y, null, true)) {\n\t\t\thit_enemy_num += 1;\n\t\t}\n\t}\n\tbreak;\ncase "left":\n\tfor (var y = hero_y - 1; y <= hero_y + 1; y++) {\n\t\tif (core.plugin.isEnemy(hero_x - 1, y)) {\n\t\t\tactions.push({\n\t\t\t\t"type": "setEnemyOnPoint",\n\t\t\t\t"loc": [\n\t\t\t\t\t[hero_x - 1, y]\n\t\t\t\t],\n\t\t\t\t"name": "atk",\n\t\t\t\t"operator": "-=",\n\t\t\t\t"value": dec_atk\n\t\t\t}, { "type": "sleep", "time": 100 });\n\t\t\tif (core.plugin.isEnemy(hero_x - 1, y, null, true)) {\n\t\t\t\tactions.push({ "type": "battle", "loc": [hero_x - 1, y] });\n\t\t\t\thit_enemy_num += 1;\n\t\t\t}\n\t\t} else if (core.getBlockCls(hero_x - 1, y) == "items") {\n\t\t\tactions.push({ "type": "trigger", "loc": [hero_x - 1, y] });\n\t\t}\n\t}\n\tfor (var y = hero_y - 1; y <= hero_y + 1; y++) {\n\t\tif (core.plugin.isEnemy(hero_x - 2, y) || core.getBlockCls(hero_x - 2, y) == "items") {\n\t\t\tactions.push({\n\t\t\t\t"type": "if",\n\t\t\t\t"condition": "core.getBlockId(" + (hero_x - 1) + "," + y + ") == null",\n\t\t\t\t"true": [{\n\t\t\t\t\t\t"type": "setEnemyOnPoint",\n\t\t\t\t\t\t"loc": [\n\t\t\t\t\t\t\t[hero_x - 2, y]\n\t\t\t\t\t\t],\n\t\t\t\t\t\t"name": "atk",\n\t\t\t\t\t\t"operator": "-=",\n\t\t\t\t\t\t"value": dec_atk\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t"type": "if",\n\t\t\t\t\t\t"condition": !core.plugin.hasTitle(hero_x - 2, y, level_limit),\n\t\t\t\t\t\t"true": [\n\t\t\t\t\t\t\t{ "type": "jump", "from": [hero_x - 2, y], "dxy": [1, 0], "time": 500, "keep": true, "async": true }\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t});\n\t\t}\n\t\tif (core.plugin.willNotBlockSkill12(hero_x - 1, y) && core.plugin.isEnemy(hero_x - 2, y, null, true)) {\n\t\t\thit_enemy_num += 1;\n\t\t}\n\t}\n\tbreak;\n}\ncore.addFlag("skill12_hit_num", hit_enemy_num);\nvar ret_cost = core.getFlag("skill12_hit_ret", 0) * hit_enemy_num;\ncore.status.hero.mana += ret_cost;\nvar ret_hp = Math.round(core.getFlag("skill12_drain_ratio", 0) / 100 * core.getFlag("temp_mdef_pp") * core.status.hero.mdef / 100 * hit_enemy_num);\nif (core.getFlag("A21boss", 0) > 0) ret_hp = 0; // boss 战禁回复\nif (ret_hp > 0) {\n\tcore.status.hero.hp += ret_hp;\n\tcore.plugin.popSkillDamage(ret_hp, hero_x, hero_y, "#63ff63");\n\tcore.addFlag("stat_skill12_ret_hp", ret_hp);\n}\nif (core.getTalentLv3(2) == 1 && core.getFlag("skill12_use_time", 0) >= 10) {\n\tcore.drawHeroAnimate("yongchang");\n\tif (core.getFlag("autoUpgradeTalent", 0) > 0) core.plugin._tryUpgrade3(2);\n}\nif (core.getTalentLv3(2) == 2 && core.getFlag("skill12_hit_num", 0) >= 30) {\n\tcore.drawHeroAnimate("yongchang");\n\tif (core.getFlag("autoUpgradeTalent", 0) > 0) {\n\t\tcore.plugin._tryUpgrade3(2);\n\t\tif (core.getTalentLv3(3) >= 55) { core.plugin._tryUpgrade3(2); }\n\t\tif (core.getTalentLv3(3) >= 90) { core.plugin._tryUpgrade3(2); }\n\t}\n}\n//if (core.getTalentLv3(7) >= 6 && hit_enemy_num > 0) {\n//core.plugin.addTempMdefpp(core.getFlag("skill11_add"));\n//actions.push({"type": "function", "function": "function(){core.plugin.addTempMdefpp(core.getFlag(\\"skill11_add\\"));}"});\n//}\ncore.insertAction(actions);\n}'},{type:"setValue",name:"flag:usingSkill12",value:"0"},{type:"waitAsync",excludeAnimates:true}],"100级":[{type:"vibrate",direction:"horizontal",time:2000,speed:10,power:10,async:true},{type:"animate",name:"rage_buff",loc:"hero"},{type:"animate",name:"yongchang",loc:"hero",async:true},{type:"animate",name:"thunder",loc:"hero"},{type:"animate",name:"thunder3",loc:"hero"},"\t[系统提示]解锁毁灭拳套的全部力量，基础攻防永久提升\r[yellow]50000\r点。",{type:"setValue",name:"status:atk",operator:"+=",value:"50000"},{type:"setValue",name:"status:def",operator:"+=",value:"50000"},"\t[系统提示]获得\r[#e525ff]【奥义】毁 天 灭 地\r。\n此技能的能量消耗会因进行战斗或使用而变化，目前的消耗为\r[orange]1000\r点。",{type:"function","function":'function(){\ncore.addFlag("talent3_7_lv", 1);\ncore.setFlag("skill13_datk", 2000000);\ncore.setFlag("skill13_ddef", 2000000);\ncore.setFlag("skill13_cost", 1000);\ncore.setFlag("skill13_cost_reduce", 50);\ncore.getItem("skill13");\n}'},{type:"waitAsync"}],Ch4_2BossDraw:[{type:"clearMap",x:0,y:0,width:416,height:100},{type:"previewUI",action:[{type:"fillBoldText",x:80,y:20,style:[190,95,95,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"奥卡斯特大帝"},{type:"fillBoldText",x:208,y:20,style:[162,99,196,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"奥波卢克斯大帝"},{type:"if",condition:"flag:A21boss_1p < 5","true":[{type:"fillBoldText",x:32,y:24,style:[216,52,52,1],strokeStyle:[0,0,0,1],font:"16px Verdana",text:"?${flag:A21boss_1p_debuff}"},{type:"fillBoldText",x:8,y:40,style:[220,77,22,1],strokeStyle:[0,0,0,1],font:"16px Verdana",text:"召唤:${flag:A21boss_pick}/2"}]},{type:"if",condition:"flag:A21boss_2p < 5","true":[{type:"fillBoldText",x:352,y:24,style:[162,38,228,1],strokeStyle:[0,0,0,1],font:"16px Verdana",text:"?${flag:A21boss_2p_debuff}"},{type:"fillBoldText",x:336,y:40,style:[121,60,222,1],strokeStyle:[0,0,0,1],font:"16px Verdana",text:"召唤:${flag:A21boss_battle}/3"}]}]},{type:"switch",condition:"flag:A21boss_1p",caseList:[{"case":"0",action:[{type:"fillBoldText",x:100,y:40,style:[216,52,52,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"★★★★★"}]},{"case":"1",action:[{type:"fillBoldText",x:100,y:40,style:[216,52,52,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"★★★★"}]},{"case":"2",action:[{type:"fillBoldText",x:100,y:40,style:[216,52,52,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"★★★"}]},{"case":"3",action:[{type:"fillBoldText",x:100,y:40,style:[216,52,52,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"★★"}]},{"case":"4",action:[{type:"fillBoldText",x:100,y:40,style:[216,52,52,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"★"}]},{"case":"5",action:[{type:"fillBoldText",x:100,y:40,style:[216,52,52,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"Defeated"}]}]},{type:"switch",condition:"flag:A21boss_2p",caseList:[{"case":"0",action:[{type:"fillBoldText",x:236,y:40,style:[162,38,228,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"★★★★★"}]},{"case":"1",action:[{type:"fillBoldText",x:236,y:40,style:[162,38,228,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"★★★★"}]},{"case":"2",action:[{type:"fillBoldText",x:236,y:40,style:[162,38,228,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"★★★"}]},{"case":"3",action:[{type:"fillBoldText",x:236,y:40,style:[162,38,228,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"★★"}]},{"case":"4",action:[{type:"fillBoldText",x:236,y:40,style:[162,38,228,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"★"}]},{"case":"5",action:[{type:"fillBoldText",x:236,y:40,style:[162,38,228,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"Defeated"}]}]}],Ch4_2BossEnd:[{type:"comment",text:"end"},{type:"function","function":'function(){\ncore.setFlag("mana_regen", core.getFlag("saved_mana_regen", 0));\ncore.setFlag("I62_extra_mana_regen", core.getFlag("saved_I62_extra_mana_regen", 0));\ncore.setFlag("I62_extra_description", core.getFlag("saved_I62_extra_description", ""));\ncore.setFlag("skill12_desc1", core.getFlag("saved_skill12_desc1", ""));\ncore.removeFlag("saved_mana_regen");\ncore.removeFlag("saved_I62_extra_mana_regen");\ncore.removeFlag("saved_I62_extra_description");\ncore.removeFlag("saved_skill12_desc1");\n\nvar total_damage = core.getFlag("saved_hp", 0) - core.status.hero.hp;\nvar used_mana = core.getFlag("saved_mana", 0) - core.status.hero.mana;\ntotal_damage += used_mana * 250000;\ncore.setFlag("temp_total_damage", total_damage);\ncore.removeFlag("saved_hp");\ncore.removeFlag("saved_mana");\ncore.removeFlag("temp_A21boss_draw");\ncore.canvas.bg2.clearRect(0, 0, 416, 416);\n}'},{type:"setVolume",value:0,time:3000,async:true},{type:"setValue",name:"flag:A21boss",value:"0"},{type:"clearMap",x:0,y:0,width:416,height:100},{type:"vibrate",direction:"horizontal",time:2000,speed:10,power:10,async:true},{type:"animate",name:"supernova",loc:[4,6],async:true},{type:"animate",name:"supernova",loc:[8,6],async:true},{type:"setCurtain",color:[255,255,255,1],time:2000,keep:true},{type:"function","function":"function(){\nfor (var i = 1; i < 12; ++i) {\n\tfor (var j = 1; j < 12; ++j) {\n\t\tcore.removeBlock(i, j);\n\t}\n}\ncore.plugin.addTempMdefpp(-9922);\ncore.updateStatusBar();\n}"},{type:"waitAsync"},{type:"setCurtain",time:1000},"\t[hero]……","\t[hero]终于……结束了……",{type:"if",condition:"flags.hard==2","true":["\t[系统提示]按照 1 点能量等于 25w 生命换算，你在 boss 战中总共受到伤害：\r[yellow]${flag:temp_total_damage}\r点\n如果这个数字小于32e，那么打得不错。\n另外，获得普通难度特有的福利：\n\r[yellow]你恢复该数值的生命\r。",{type:"setValue",name:"status:hp",operator:"+=",value:"flag:temp_total_damage"}],"false":["\t[系统提示]按照 1 点能量等于 25w 生命换算，你在 boss 战中总共受到伤害：\r[yellow]${flag:temp_total_damage}\r点\n如果这个数字小于32e，那么打得不错。"]},{type:"playSound",name:"mteleport.wav"},{type:"changeFloor",floorId:"Ch4_131",loc:[6,12],direction:"up",time:1000}],"衰 爆":[{type:"vibrate",direction:"horizontal",time:1000,speed:10,power:10,async:true},{type:"playSound",name:"se_power0.wav"},{type:"animate",name:"yongchang",loc:[4,6]},{type:"switch",condition:"flag:A21boss_1p",caseList:[{"case":"3",action:["\t[奥卡斯特大帝,E888]\b[down,null]\\c[20]\r[red]因你的自大而遭受苦难吧！\r\n\r[#e525ff]【奥义】傲慢之踵！\r\\c"]},{"case":"4",action:["\t[奥卡斯特大帝,E888]\b[down,null]\\c[20]\r[red]因你的骄狂而遭受折磨吧！\r\n\r[#e525ff]【奥义】傲慢之踵！\r\\c"]}]},{type:"function","function":'function(){\ncore.triggerDebuff("get", "superweak");\n}'},{type:"setValue",name:"flag:superweak_n",value:"5"},{type:"waitAsync"}],Ch1BossDraw:[{type:"clearMap",x:0,y:0,width:416,height:100},{type:"if",condition:"flag:B20F_boss_activated == 1","true":[{type:"previewUI",action:[{type:"fillBoldText",x:188,y:20,style:[255,215,0,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"茉莉"},{type:"switch",condition:"flag:B20F_boss_phase",caseList:[{"case":"0",action:[{type:"fillBoldText",x:184,y:40,style:[255,215,0,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"★★★"}]},{"case":"1",action:[{type:"fillBoldText",x:184,y:40,style:[255,215,0,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"★★"}]},{"case":"2",action:[{type:"fillBoldText",x:184,y:40,style:[255,215,0,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"★"}]}]}]}]}],Ch4BossDraw:[{type:"clearMap",x:0,y:0,width:416,height:100},{type:"if",condition:"flag:Ch4_boss_activated == 1","true":[{type:"previewUI",action:[{type:"fillBoldText",x:184,y:20,style:[255,215,0,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"9961"},{type:"switch",condition:"flag:Ch4_boss_phase",caseList:[{"case":"1",action:[{type:"fillBoldText",x:168,y:40,style:[255,215,0,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"★★★★★"}]},{"case":"2",action:[{type:"fillBoldText",x:168,y:40,style:[255,215,0,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"★★★★"}]},{"case":"3",action:[{type:"fillBoldText",x:168,y:40,style:[255,215,0,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"★★★"}]},{"case":"4",action:[{type:"fillBoldText",x:168,y:40,style:[255,215,0,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"★★"}]},{"case":"5",action:[{type:"fillBoldText",x:168,y:40,style:[255,215,0,1],strokeStyle:[0,0,0,1],font:"20px Verdana",text:"★"}]}]}]}]}]}};var plugins_bb40132b_638b_4a9f_b028_d3fe47acc8d1={init:function(){this._afterLoadResources=function(){this.initSpriteFlasher()};this.canBreakList=["yellowKey","blueKey","redKey","yellowKey3","blueKey3","redKey3","yellowDoor","blueDoor","redDoor","yellowDoor2","blueDoor2","redPotion","bluePotion","yellowPotion","greenPotion","manaItem","bigManaitem","bigRedPotion","bigBluePotion","bigYellowPotion","bigGreenPotion","hugeRedPotion","hugeBluePotion","hugeYellowPotion","hugeGreenPotion","giantRedPotion","giantBluePotion","giantYellowPotion","giantGreenPotion","redRHeart","blueRHeart","yellowRHeart","greenRHeart"];this.shouldHighlightMoney=function(){if(core.plugin.isShopVisited("shop1")&&core.status.hero.money>=25){return true}if(core.plugin.isShopVisited("B4FShop")&&core.status.hero.money>=50+5*core.getFlag("shop2",0)){return true}if(core.plugin.isShopVisited("B12FShop")&&core.status.hero.money>=400){return true}if(core.plugin.isShopVisited("20FShop")&&core.status.hero.money>=500){return true}if(core.plugin.isShopVisited("20FShop_easy")&&core.status.hero.money>=1000){return true}if(core.plugin.isShopVisited("36FShop")&&core.status.hero.money>=1500){return true}if(core.plugin.isShopVisited("57FShop")&&core.status.hero.money>=3000){return true}if(core.hasItem("talentTree")){var d=false;var b=function(e){switch(core.getTalentLv(e)){case 0:if(core.status.hero.money>=30){return true}break;case 1:if(core.status.hero.money>=60){return true}break;case 3:if(core.status.hero.money>=300){return true}break}return false};d|=b(0);d|=b(1);d|=b(2);if(core.getTalentLv(3)==0&&core.status.hero.money>=1){return true}var c=function(e,f){switch(core.getTalentLv(e)){case 0:return core.plugin.getTalentLv(f)>=5&&core.status.hero.money>=300&&core.itemCount("yellowGem")>=3;case 2:return core.status.hero.money>=1000}return false};d|=c(4,0);d|=c(5,0);d|=c(6,1);d|=c(7,1);d|=c(8,2);d|=c(9,2);switch(core.getTalentLv(10)){case 0:var a=core.getTalentLv(4)==3&&core.getTalentLv(5)==3&&core.getTalentLv(6)==3&&core.getTalentLv(7)==3&&core.itemCount("yellowGem")>=10&&core.status.hero.money>=2500;d|=a;break;case 1:d|=core.status.hero.money>=7500;break}switch(core.getTalentLv(11)){case 0:var a=core.getTalentLv(4)==3&&core.getTalentLv(5)==3&&core.getTalentLv(8)==3&&core.getTalentLv(9)==3&&core.itemCount("yellowGem")>=10&&core.status.hero.money>=2500;d|=a;break;case 1:d|=core.status.hero.money>=7500;break}switch(core.getTalentLv(12)){case 0:var a=core.getTalentLv(6)==3&&core.getTalentLv(7)==3&&core.getTalentLv(8)==3&&core.getTalentLv(9)==3&&core.itemCount("yellowGem")>=10&&core.status.hero.money>=2500;d|=a;break;case 1:d|=core.status.hero.money>=7500;break}return d}if(core.hasItem("talentTree2")){var d=false;d|=core.plugin.canUpgradeTalent2(1);d|=core.plugin.canUpgradeTalent2(2);d|=core.plugin.canUpgradeTalent2(3);d|=core.plugin.canUpgradeTalent2(6);d|=core.plugin.canUpgradeTalent2(7);return d}if(core.hasItem("talentTree3")){switch(core.getTalentLv3(4)){case 0:if(core.status.hero.money>=2000){return true}break;case 1:if(core.status.hero.money>=8000){return true}break;case 2:if(core.status.hero.money>=20000){return true}break;case 3:if(core.status.hero.money>=64100){return true}break}switch(core.getTalentLv3(5)){case 0:if(core.status.hero.money>=4000){return true}break;case 1:if(core.status.hero.money>=20000){return true}break;case 2:if(core.status.hero.money>=40000){return true}break}switch(core.getTalentLv3(6)){case 0:if(core.status.hero.money>=4500){return true}break;case 1:if(core.status.hero.money>=22500){return true}break;case 2:if(core.status.hero.money>=45000){return true}break}if(core.getTalentLv3(0)==0&&core.status.hero.money>=100){return true}if(core.getTalentLv3(1)==0&&core.status.hero.money>=300){return true}if(core.getTalentLv3(2)==0&&core.status.hero.money>=2000){return true}return false}return false};this.decSpecialDoorCount=function(c,d,a){a=a||core.status.floorId;var b=core.maps.getFgNumber(c,d,a)-1;if(b>=864&b<872){core.setBgFgBlock("fg",b,c,d,a)}else{if(b==863){core.hideBgFgMap("fg",[c,d],a);core.drawMap();core.updateWeather()}}};this.getReverseDirection=function(a){switch(a){case"left":return"right";case"right":return"left";case"up":return"down";case"down":return"up"}console.log("Unexpected dir:",a);return"unknown"};this.isEnemy=function(e,f,b,a){a=true;var d=core.getBlockCls(e,f,b)=="enemys"||core.getBlockCls(e,f,b)=="enemy48";var c=core.getBlockId(e,f,b);if(a&&c){d&=!core.hasSpecial(c,87)}return d};this.hasTitle=function(e,f,b){var c=core.getBlockId(e,f);var a=core.material.enemys[c];var d=true;if(a){d=(a.title==null||a.title=="普通");if(b>=1){d|=(a.title=="喽啰")}if(b>=2){d|=(a.title=="精英")}}return !d};this.updateWeather=function(a){a=a||core.status.floorId;var b=core.getFlag("__weather__",null);if(!b&&core.status.maps[a]&&core.status.maps[a].weather){b=core.status.maps[a].weather}if(b){core.setWeather(b[0],b[1])}else{core.setWeather()}};this.exit_invisible=function(){if(core.getFlag("invisible",0)!=1){return}core.setFlag("invisible",0);core.setFlag("no_zone",0);core.setFlag("no_laser",0);core.setFlag("no_snipe",0);core.setFlag("no_betweenAttack",0);core.setFlag("no_repulse",0);core.setFlag("no_ambush",0);core.setOpacity("hero",1);core.drawHeroAnimate("yongchang")};this.addValpp=function(a,c){var b;if(a=="atk"){b=core.getFlag("__atk_buff__",1);b=(b*100+c)/100;core.setFlag("__atk_buff__",b);core.addFlag("heart_atk_pp",c)}else{if(a=="def"){b=core.getFlag("__def_buff__",1);b=(b*100+c)/100;core.setFlag("__def_buff__",b);core.addFlag("heart_def_pp",c)}else{if(a=="mdef"){b=core.getFlag("__mdef_buff__",1);b=(b*100+c)/100;core.setFlag("__mdef_buff__",b);core.addFlag("heart_mdef_pp",c)}}}};this.saveHeroStatus=function(){core.setFlag("saved_hp",core.status.hero.hp);core.setFlag("saved_mana",core.status.hero.mana);core.setFlag("saved_atk",core.status.hero.atk);core.setFlag("saved_def",core.status.hero.def);core.setFlag("saved_mdef",core.status.hero.mdef);core.setFlag("saved_atk_buff",core.getFlag("__atk_buff__",1));core.setFlag("saved_def_buff",core.getFlag("__def_buff__",1));core.setFlag("saved_mdef_buff",core.getFlag("__mdef_buff__",1));core.setFlag("saved_yellowKey",core.itemCount("yellowKey"));core.setFlag("saved_blueKey",core.itemCount("blueKey"));core.setFlag("saved_redKey",core.itemCount("redKey"));core.setFlag("saved_mana_regen",core.getFlag("mana_regen",0));core.setFlag("saved_I62_extra_mana_regen",core.getFlag("I62_extra_mana_regen",0));core.setFlag("saved_mana_item",core.getFlag("mana_item",50));core.setFlag("saved_mdef_ratio",core.getFlag("mdef_ratio",1));core.setFlag("saved_yellowGem",core.itemCount("yellowGem"));core.setFlag("saved_potion_extra_ratio",core.getFlag("potion_extra_ratio",1));core.setFlag("saved_skill3_cost",core.getFlag("skill3_cost",50))};this.loadHeroStatus=function(){core.status.hero.hp=core.getFlag("saved_hp",1);core.status.hero.mana=core.getFlag("saved_mana",0);core.status.hero.atk=core.getFlag("saved_atk",0);core.status.hero.def=core.getFlag("saved_def",0);core.status.hero.mdef=core.getFlag("saved_mdef",0);core.setFlag("__atk_buff__",core.getFlag("saved_atk_buff",1));core.setFlag("__def_buff__",core.getFlag("saved_def_buff",1));core.setFlag("__mdef_buff__",core.getFlag("saved_mdef_buff",1));core.setItem("yellowKey",core.getFlag("saved_yellowKey",0));core.setItem("blueKey",core.getFlag("saved_blueKey",0));core.setItem("redKey",core.getFlag("saved_redKey",0));core.setFlag("mana_regen",core.getFlag("saved_mana_regen",0));core.setFlag("I62_extra_mana_regen",core.getFlag("saved_I62_extra_mana_regen",0));core.setFlag("mana_item",core.getFlag("saved_mana_item",50));core.setFlag("mdef_ratio",core.getFlag("saved_mdef_ratio",1));core.setItem("yellowGem",core.getFlag("saved_yellowGem",0));core.setItem("I319",1);core.setItem("I392",1);core.setItem("talentTree",1);core.setFlag("talentTree_unlocked",true);core.setFlag("potion_extra_ratio",core.getFlag("saved_potion_extra_ratio",1));core.setFlag("current_chapter",3);core.setItem("pickaxe",0);core.setFlag("skill3_cost",core.getFlag("saved_skill3_cost",50))};this.resetHeroStatus=function(){core.status.hero.hp=1;core.status.hero.mana=0;core.setFlag("__atk_buff__",1);core.setFlag("__def_buff__",1);core.setFlag("__mdef_buff__",1);core.setItem("yellowKey",0);core.setItem("blueKey",0);core.setItem("redKey",0);core.setFlag("mana_regen",0);core.setFlag("I62_extra_mana_regen",0);core.setFlag("mana_item",50);core.setFlag("mdef_ratio",1);core.setItem("yellowGem",0);core.setItem("I319",0);core.setItem("I392",0);core.setItem("talentTree",0);core.setFlag("talentTree_unlocked",false);core.setFlag("potion_extra_ratio",1);core.setFlag("current_chapter",-1);core.setItem("pickaxe",0);core.setFlag("skill3_cost",50)}},drawLight:function(){this.drawLight=function(e,a,d,c,f){var b=core.getContextByName(e);if(b==null){if(typeof e=="string"){b=core.createCanvas(e,0,0,core.__PIXELS__,core.__PIXELS__,98)}else{return}}b.mozImageSmoothingEnabled=false;b.webkitImageSmoothingEnabled=false;b.msImageSmoothingEnabled=false;b.imageSmoothingEnabled=false;core.clearMap(e);if(a==null){a=0.9}if(f==null){f=[0,0,0]}b.fillStyle="rgba("+f[0]+","+f[1]+","+f[2]+","+a+")";b.fillRect(0,0,b.canvas.width,b.canvas.height);c=core.clamp(c,0,1);d.forEach(function(i){var k=i[0],l=i[1],j=i[2];var g=parseInt(j*c);b.globalCompositeOperation="destination-out";var h=b.createRadialGradient(k,l,g,k,l,j);h.addColorStop(0,"rgba(0,0,0,1)");h.addColorStop(1,"rgba(0,0,0,0)");b.beginPath();b.fillStyle=h;b.arc(k,l,j,0,2*Math.PI);b.fill();if(core.getFlag("fire_light_a",0)>0){b.globalCompositeOperation="source-over";h=b.createRadialGradient(k,l,g,k,l,j);h.addColorStop(0,"rgba(255,160,24,"+core.getFlag("fire_light_a",0.16)+")");h.addColorStop(1,"rgba(0,0,0,0)");b.beginPath();b.fillStyle=h;b.arc(k,l,j,0,2*Math.PI);b.fill()}})}},shop:function(){this.openShop=function(c,a){var b=core.status.shops[c];if(!this.canOpenShop(c)){core.drawTip("该商店尚未开启");return false}if(!a){core.status.route.push("shop:"+c)}if(b.item){if(core.openItemShop){core.openItemShop(c)}else{core.playSound("操作失败");core.insertAction("道具商店插件不存在！请检查是否存在该插件！")}return}if(b.commonEvent){core.insertCommonEvent(b.commonEvent,b.args);return}core.insertAction(this._convertShop(b));return true};this._convertShop=function(a){return[{type:"function","function":"function() {core.setFlag('@temp@shop', true);}"},{type:"while",condition:"true",data:[{type:"if",condition:"core.isShopVisited('"+a.id+"')","true":[{type:"function","function":"function() { core.plugin._convertShop_replaceChoices('"+a.id+"', false) }"},],"false":[{type:"if",condition:a.disablePreview,"true":[{type:"playSound",name:"操作失败"},"当前无法访问该商店！",{type:"break"},],"false":[{type:"tip",text:"当前处于预览模式，不可购买"},{type:"function","function":"function() { core.plugin._convertShop_replaceChoices('"+a.id+"', true) }"},]}]}]},{type:"function","function":"function() {core.removeFlag('@temp@shop');}"}]};this._convertShop_replaceChoices=function(d,b){var c=core.status.shops[d];var a=(c.choices||[]).filter(function(f){if(f.condition==null||f.condition==""){return true}try{return core.calValue(f.condition)}catch(g){return true}}).map(function(f){var e=core.calValue(f.need);return{text:f.text,icon:f.icon,color:e&&!b?f.color:[153,153,153,1],action:e&&!b?[{type:"playSound",name:"确定"}].concat(f.action):[{type:"playSound",name:"操作失败"},{type:"tip",text:b?"预览模式下不可购买":"购买条件不足"}]}}).concat({text:"离开",action:[{type:"playSound",name:"取消"},{type:"break"}]});core.insertAction({type:"choices",text:c.text,choices:a})};this.isShopVisited=function(a){if(!core.hasFlag("__shops__")){core.setFlag("__shops__",{})}var b=core.getFlag("__shops__");if(!b[a]){b[a]={}}return b[a].visited};this.listShopIds=function(){return Object.keys(core.status.shops).filter(function(a){return core.isShopVisited(a)||!core.status.shops[a].mustEnable})};this.canOpenShop=function(a){if(this.isShopVisited(a)){return true}var b=core.status.shops[a];if(b.item||b.commonEvent||b.mustEnable){return false}return true};this.setShopVisited=function(a,c){if(!core.hasFlag("__shops__")){core.setFlag("__shops__",{})}var b=core.getFlag("__shops__");if(!b[a]){b[a]={}}if(c){b[a].visited=true}else{delete b[a].visited}};this.canUseQuickShop=function(a){if(core.status.thisMap.canUseQuickShop===false){return"当前楼层不能使用快捷商店。"}return null};core.registerAction("keyUp","shops",function(c){if(!core.status.lockControl||!core.hasFlag("@temp@shop")||core.status.event.id!="action"){return false}if(core.status.event.data.type!="choices"){return false}var b=core.status.event.data.current;var a=b.choices;var d=core.actions._getChoicesTopIndex(a.length);if(c==88||c==27){core.actions._clickAction(core.actions.HSIZE,d+a.length-1);return true}if(c==13||c==32){return true}return false},60);core.registerAction("keyDown","shops",function(c){if(!core.status.lockControl||!core.hasFlag("@temp@shop")||core.status.event.id!="action"){return false}if(core.status.event.data.type!="choices"){return false}var b=core.status.event.data.current;var a=b.choices;var d=core.actions._getChoicesTopIndex(a.length);if(c==13||c==32){core.actions._clickAction(core.actions.HSIZE,d+core.status.event.selection);return true}return false},60);core.registerAction("longClick","shops",function(f,g,c,d){if(!core.status.lockControl||!core.hasFlag("@temp@shop")||core.status.event.id!="action"){return false}if(core.status.event.data.type!="choices"){return false}var b=core.status.event.data.current;var a=b.choices;var e=core.actions._getChoicesTopIndex(a.length);if(f>=core.actions.CHOICES_LEFT&&f<=core.actions.CHOICES_RIGHT&&g>=e&&g<e+a.length){core.actions._clickAction(f,g);return true}return false},60)},removeMap:function(){this.removeMaps=function(c,f){f=f||c;var d=core.floorIds.indexOf(c),g=core.floorIds.indexOf(f);if(g<0){g=core.floorIds.length-1}flags.__visited__=flags.__visited__||{};flags.__removed__=flags.__removed__||[];flags.__disabled__=flags.__disabled__||{};flags.__leaveLoc__=flags.__leaveLoc__||{};for(var e=d;e<=g;++e){var b=core.floorIds[e];if(core.status.maps[b].deleted){continue}delete flags.__visited__[b];flags.__removed__.push(b);delete flags.__disabled__[b];delete flags.__leaveLoc__[b];(core.status.autoEvents||[]).forEach(function(h){if(h.floorId==b&&h.currentFloor){core.autoEventExecuting(h.symbol,false);core.autoEventExecuted(h.symbol,false)}});core.status.maps[b].deleted=true;core.status.maps[b].canFlyTo=false;core.status.maps[b].canFlyFrom=false;core.status.maps[b].cannotViewMap=true}};this.resumeMaps=function(c,f){f=f||c;var d=core.floorIds.indexOf(c),g=core.floorIds.indexOf(f);if(g<0){g=core.floorIds.length-1}flags.__removed__=flags.__removed__||[];for(var e=d;e<=g;++e){var b=core.floorIds[e];if(!core.status.maps[b].deleted){continue}flags.__removed__=flags.__removed__.filter(function(h){return h!=b});core.status.maps[b]=core.loadFloor(b)}};var a=function(b){var c=false;(core.floorPartitions||[]).forEach(function(d){var e=core.floorIds.indexOf(d[0]);var g=core.floorIds.indexOf(d[1]);var f=core.floorIds.indexOf(b);if(e<0||f<0){return}if(g<0){g=core.floorIds.length-1}if(f>=e&&f<=g){c=true}});return c};this.autoRemoveMaps=function(b){if(b=="MusicRoom"){core.resumeMaps(core.floorIds[0],core.floorIds[core.floorIds.length-1]);return}if(main.mode!="play"||!a(b)){return}var c=false;(core.floorPartitions||[]).forEach(function(d){if(c){return}var e=core.floorIds.indexOf(d[0]);var g=core.floorIds.indexOf(d[1]);var f=core.floorIds.indexOf(b);if(e<0||f<0){return}if(g<0){g=core.floorIds.length-1}if(f>=e&&f<=g){core.resumeMaps(core.floorIds[e],core.floorIds[g]);c=true}else{core.removeMaps(core.floorIds[e],core.floorIds[g])}})}},fiveLayers:function(){var a=true;if(!a){return}function d(p,q){if(!p){return}var n=document.createElement("canvas");n.id=p;n.className="gameCanvas";n.width=n.height=core.__PIXELS__;if(main.mode!="editor"){n.style.zIndex=q||0}document.getElementById("gameDraw").appendChild(n);var o=n.getContext("2d");core.canvas[p]=o;return n}var b=d("bg2",20);var g=d("fg2",63);core.bigmap.canvas=["bg2","fg2","bg","event","event2","fg","damage"];core.initStatus.bg2maps={};core.initStatus.fg2maps={};if(main.mode=="editor"){document.getElementById("mapEdit").insertBefore(b,document.getElementById("event"));document.getElementById("mapEdit").insertBefore(g,document.getElementById("ebm"));var j=4;editor.dom.bg2c=core.canvas.bg2.canvas;editor.dom.bg2Ctx=core.canvas.bg2;editor.dom.fg2c=core.canvas.fg2.canvas;editor.dom.fg2Ctx=core.canvas.fg2;editor.dom.maps.push("bg2map","fg2map");editor.dom.canvas.push("bg2","fg2");var e=function(p){var o=document.createElement("input");var n="layerMod"+j++;var q=p+"map";o.type="radio";o.name="layerMod";o.id=n;o.value=q;editor.dom[n]=o;o.onchange=function(){editor.uifunctions.setLayerMod(q)};return o};var f=function(p){var o=document.createElement("option");var n="layerMod"+j++;var q=p+"map";o.name="layerMod";o.value=q;editor.dom[n]=o;return o};if(!editor.isMobile){var h=e("bg2");var i=e("fg2");var c=document.getElementById("layerMod"),k=c.parentNode;k.insertBefore(h,c);var l=document.createTextNode("背景层2");k.insertBefore(l,c);k.appendChild(i);var m=document.createTextNode("前景层2");k.appendChild(m)}else{var h=f("bg2");var i=f("fg2");h.innerText="背景层2";i.innerText="前景层2";var k=document.getElementById("layerMod");k.insertBefore(h,k.children[1]);k.appendChild(i)}}core.maps._loadFloor_doNotCopy=function(){return["firstArrive","eachArrive","blocks","parallelDo","map","bgmap","fgmap","bg2map","fg2map","events","changeFloor","beforeBattle","afterBattle","afterGetItem","afterOpenDoor","cannotMove","cannotMoveIn"]};core.maps._drawBg_draw=function(p,q,n,o){o.ctx=n;core.maps._drawBg_drawBackground(p,o);core.maps._drawFloorImages(p,o.ctx,"bg",null,null,o.onMap);core.maps._drawBgFgMap(p,"bg",o);if(o.onMap){core.drawImage(q,n.canvas,core.bigmap.v2?-32:0,core.bigmap.v2?-32:0);core.clearMap("bg2");core.clearMap(n)}core.maps._drawBgFgMap(p,"bg2",o);if(o.onMap){core.drawImage("bg2",n.canvas,core.bigmap.v2?-32:0,core.bigmap.v2?-32:0)}o.ctx=q};core.maps._drawFg_draw=function(p,q,n,o){o.ctx=n;core.maps._drawFloorImages(p,o.ctx,"fg",null,null,o.onMap);core.maps._drawBgFgMap(p,"fg",o);if(o.onMap){core.drawImage(q,n.canvas,core.bigmap.v2?-32:0,core.bigmap.v2?-32:0);core.clearMap("fg2");core.clearMap(n)}core.maps._drawBgFgMap(p,"fg2",o);if(o.onMap){core.drawImage("fg2",n.canvas,core.bigmap.v2?-32:0,core.bigmap.v2?-32:0)}o.ctx=q};core.maps._generateMovableArray_arrays=function(n){return{bgArray:this.getBgMapArray(n),fgArray:this.getFgMapArray(n),eventArray:this.getMapArray(n),bg2Array:this._getBgFgMapArray("bg2",n),fg2Array:this._getBgFgMapArray("fg2",n)}}},itemShop:function(){var j=null;var n=0;var i=0;var h=0;var g=0;var m=0;var l=0;var e=[];var k=null;var d=[];var o="money";var p="金币";var c=core.ui._buildFont(20,false),f=core.ui._buildFont(18,false);this._drawItemShop=function(){core.ui._createUIEvent();core.clearMap("uievent");core.ui.clearUIEventSelector();core.setTextAlign("uievent","left");core.setTextBaseline("uievent","top");core.fillRect("uievent",0,0,416,416,"black");core.drawWindowSkin("winskin.png","uievent",0,0,416,56);core.drawWindowSkin("winskin.png","uievent",0,56,312,56);core.drawWindowSkin("winskin.png","uievent",0,112,312,304);core.drawWindowSkin("winskin.png","uievent",312,56,104,56);core.drawWindowSkin("winskin.png","uievent",312,112,104,304);core.setFillStyle("uievent","white");core.setStrokeStyle("uievent","white");core.fillText("uievent","购买",32,74,"white",c);core.fillText("uievent","卖出",132,74);core.fillText("uievent","离开",232,74);core.fillText("uievent","当前"+p,324,66,null,f);core.setTextAlign("uievent","right");core.fillText("uievent",core.formatBigNumber(core.status.hero[o]),405,89);core.setTextAlign("uievent","left");core.ui.drawUIEventSelector(1,"winskin.png",22+100*n,66,60,33);if(i!=null){core.setTextAlign("uievent","center");core.fillText("uievent",n==0?"买入个数":"卖出个数",364,320,null,c);core.fillText("uievent","<   "+h+"   >",364,350);core.fillText("uievent","确定",364,380)}e=d.filter(function(C){if(C.condition!=null&&C.condition!=""){try{if(!core.calValue(C.condition)){return false}}catch(B){console.log("触发未知的商店bug: ",B);alert("触发未知的商店bug，请联系作者并附上下列信息: ",B)}}return(n==0&&C.money!=null)||(n==1&&C.sell!=null)});var y=6;m=Math.ceil(e.length/y);g=Math.floor((i||0)/y)+1;if(m>1){var u=156;core.setTextAlign("uievent","center");core.fillText("uievent",g+" / "+m,u,388,null,f);if(g>1){core.fillText("uievent","上一页",u-80,388)}if(g<m){core.fillText("uievent","下一页",u+80,388)}}core.setTextAlign("uievent","left");var z=(g-1)*y;for(var w=0;w<y;++w){var r=z+w;if(r>=e.length){break}var x=e[r];core.drawIcon("uievent",x.id,10,125+w*40);core.setTextAlign("uievent","left");core.fillText("uievent",core.material.items[x.id].name,50,132+w*40,null,c);core.setTextAlign("uievent","right");core.fillText("uievent",(n==0?core.calValue(x.money):core.calValue(x.sell))+p+"/个",300,133+w*40,null,f);core.setTextAlign("uievent","left");if(r==i){var A=core.material.items[x.id].text||"该道具暂无描述";try{A=core.replaceText(A)}catch(s){console.log("触发未知的商店bug: ",s);alert("触发未知的商店bug，请联系作者并附上下列信息: ",s)}for(var t=20;t>=8;t-=2){var q={left:10,fontSize:t,maxWidth:403};var v=core.getTextContentHeight(A,q);if(v<=50){q.top=(56-v)/2;core.drawTextContent("uievent",A,q);break}}core.ui.drawUIEventSelector(2,"winskin.png",8,120+w*40,295,40);if(n==0&&x.number!=null){core.fillText("uievent","存货",324,132,null,c);core.setTextAlign("uievent","right");core.fillText("uievent",x.number,406,132,null,null,40)}else{if(n==1){core.fillText("uievent","数量",324,132,null,c);core.setTextAlign("uievent","right");core.fillText("uievent",core.itemCount(x.id),406,132,null,null,40)}}core.setTextAlign("uievent","left");core.fillText("uievent","预计"+p,324,250);core.setTextAlign("uievent","right");l=h*(n==0?core.calValue(x.money):core.calValue(x.sell));core.fillText("uievent",core.formatBigNumber(l),405,280);core.setTextAlign("uievent","left");core.fillText("uievent",n==0?"已购次数":"已卖次数",324,170);core.setTextAlign("uievent","right");core.fillText("uievent",(n==0?x.money_count:x.sell_count)||0,405,200)}}core.setTextAlign("uievent","left");core.setTextBaseline("uievent","alphabetic")};var a=function(r,q){if(r==null){return}h=core.clamp(h+q,0,Math.min(n==0?Math.floor(core.status.hero[o]/core.calValue(r.money)):core.itemCount(r.id),n==0&&r.number!=null?r.number:Number.MAX_SAFE_INTEGER))};var b=function(q){if(q==null||h==0){return}if(n==0){core.status.hero[o]-=l;core.getItem(q.id,h);core.stopSound();core.playSound("确定");if(q.number!=null){q.number-=h}q.money_count=(q.money_count||0)+h}else{core.status.hero[o]+=l;core.removeItem(q.id,h);core.playSound("确定");core.drawTip("成功卖出"+h+"个"+core.material.items[q.id].name,q.id);if(q.number!=null){q.number+=h}q.sell_count=(q.sell_count||0)+h}h=0};this._performItemShopKeyBoard=function(r){var q=e[i]||null;switch(r){case 38:if(i==null){break}if(i==0){i=null}else{i--}h=0;break;case 37:if(i==null){if(n>0){n--}break}a(q,-1);break;case 39:if(i==null){if(n<2){n++}break}a(q,1);break;case 40:if(i==null){if(e.length>0){i=0}break}if(e.length==0){break}i=Math.min(i+1,e.length-1);h=0;break;case 13:case 32:if(i==null){if(n==2){core.insertAction({type:"break"})}else{if(e.length>0){i=0}}break}b(q);break;case 27:if(i==null){core.insertAction({type:"break"});break}i=null;break}};this._performItemShopClick=function(t,u){var r=e[i]||null;if(t>=22&&t<=82&&u>=71&&u<=102){if(n!=0){n=0;i=null;h=0}return}if(t>=122&&t<=182&&u>=71&&u<=102){if(n!=1){n=1;i=null;h=0}return}if(t>=222&&t<=282&&u>=71&&u<=102){return core.insertAction({type:"break"})}if(t>=318&&t<=341&&u>=348&&u<=376){return a(r,-1)}if(t>=388&&t<=416&&u>=348&&u<=376){return a(r,1)}if(t>=341&&t<=387&&u>=380&&u<=407){return b(r)}if(t>=45&&t<=105&&u>=388){if(g>1){i-=6;h=0}return}if(t>=208&&t<=268&&u>=388){if(g<m){i=Math.min(i+6,e.length-1);h=0}return}if(t>=9&&t<=300&&u>=120&&u<360){if(e.length==0){return}var q=parseInt((u-120)/40);var s=6*(g-1)+q;if(s>=e.length){s=e.length-1}if(s!=i){i=s;h=0}return}};this._performItemShopAction=function(){if(flags.type==0){return this._performItemShopKeyBoard(flags.keycode)}else{return this._performItemShopClick(flags.px,flags.py)}};this.openItemShop=function(q){j=q;n=0;g=0;i=null;h=0;core.isShopVisited(q);k=flags.__shops__[j];if(k.choices==null){k.choices=core.clone(core.status.shops[j].choices)}d=k.choices;o=core.status.shops[j].use;if(o!="exp"){o="money"}p=o=="money"?"金币":"经验";core.insertAction([{type:"while",condition:"true",data:[{type:"function","function":"function () { core.plugin._drawItemShop(); }"},{type:"wait"},{type:"function","function":"function() { core.plugin._performItemShopAction(); }"}]},{type:"function","function":"function () { core.deleteCanvas('uievent'); core.ui.clearUIEventSelector(); }"}])}},enemyLevel:function(){var a=false;if(!a){return}var b={"萌新一阶":"red","萌新二阶":"#FF0000","萌新三阶":[255,0,0,1],};var c=core.ui._drawBook_drawName;core.ui._drawBook_drawName=function(e,d,j,f,l){if(!d.level){return c.call(core.ui,e,d,j,f,l)}core.setTextAlign("ui","center");if(d.specialText.length==0){core.fillText("ui",d.name,f+l/2,j+27,"#DDDDDD",this._buildFont(17,true));core.fillText("ui",d.level,f+l/2,j+51,core.arrayToRGBA(b[d.level]||"#DDDDDD"),this._buildFont(14,true))}else{core.fillText("ui",d.name,f+l/2,j+20,"#DDDDDD",this._buildFont(17,true),l);switch(d.specialText.length){case 1:core.fillText("ui",d.specialText[0],f+l/2,j+38,core.arrayToRGBA((d.specialColor||[])[0]||"#FF6A6A"),this._buildFont(14,true),l);break;case 2:var i=d.specialText[0]+"  "+d.specialText[1];core.setFontForMaxWidth("ui",i,l,this._buildFont(14,true));var k=core.calWidth("ui",i);var g=core.calWidth("ui",d.specialText[0]);var h=core.calWidth("ui",d.specialText[1]);core.fillText("ui",d.specialText[0],f+(l+g-k)/2,j+38,core.arrayToRGBA((d.specialColor||[])[0]||"#FF6A6A"));core.fillText("ui",d.specialText[1],f+(l+k-h)/2,j+38,core.arrayToRGBA((d.specialColor||[])[1]||"#FF6A6A"));break;default:core.fillText("ui","多属性...",f+l/2,j+38,"#FF6A6A",this._buildFont(14,true),l)}core.fillText("ui",d.level,f+l/2,j+56,core.arrayToRGBA(b[d.level]||"#DDDDDD"),this._buildFont(14,true))}};core.ui._drawBook_drawRow1=function(j,h,m,k,n,l){core.setTextAlign("ui","left");var d=this._buildFont(13,true),i=this._buildFont(13,false);var e=k,f=k+n*9/25,g=k+n*17/25;core.fillText("ui","生命",e,l,"#DDDDDD",i);core.fillText("ui",core.formatBigNumber(h.hp||0),e+30,l,null,d);core.fillText("ui","攻击",f,l,null,i);core.fillText("ui",core.formatBigNumber(h.atk||0),f+30,l,null,d);core.fillText("ui","防御",g,l,null,i);core.fillText("ui",core.formatBigNumber(h.def||0),g+30,l,null,d)}},dynamicHp:function(){var a=false;if(!a){return}var e=0.05;var c=null;var d=null;var b=function(){if(d!=core.status.hero){d=core.status.hero;c=core.status.hero.hp}};core.registerAnimationFrame("dynamicHp",true,function(){b();if(core.status.hero.hp!=c){var f=(c-core.status.hero.hp)*e;if(Math.abs(f)<2){c=core.status.hero.hp}else{c-=f}core.setStatusBarInnerHTML("hp",c)}})},multiHeros:function(){var a=false;if(!a){return}var c={floorId:"MT0",image:"brave.png",name:"1号角色",lv:1,hp:10000,atk:1000,def:1000,mdef:0,loc:{x:0,y:0,direction:"up"},items:{tools:{},equips:{},},equipment:[],};var d=2;this.initHeros=function(){core.setFlag("hero1",core.clone(c));if(c.equipment){if(!c.items||!c.items.equips){alert("多角色插件的equipment和道具中的equips必须拥有相同状态！")}var e=core.getFlag("saveEquips",[]);e[99]=[];core.setFlag("saveEquips",e)}else{if(c.items&&c.items.equips){alert("多角色插件的equipment和道具中的equips必须拥有相同状态！")}}};var b=core.events._startGame_setHard;core.events._startGame_setHard=function(){b.call(core.events);core.initHeros()};this.changeHero=function(k){var g=core.getFlag("heroId",0);if(k==null){k=(g+1)%d}if(g==k){return}var i=Object.keys(c);var m={};var e=core.ui.drawTip;core.ui.drawTip=function(){};var f=core.control.playSound;core.control.playSound=function(){};if(c.equipment){core.items.quickSaveEquip(100+g);core.items.quickLoadEquip(99)}i.forEach(function(n){if(n=="floorId"){m[n]=core.status.floorId}else{if(n=="items"){m.items=core.clone(core.status.hero.items);Object.keys(m.items).forEach(function(o){if(!c.items[o]){delete m.items[o]}})}else{m[n]=core.clone(core.status.hero[n])}}});core.setFlag("hero"+g,m);var h=core.getFlag("hero"+k);i.forEach(function(n){if(n=="floorId"){}else{if(n=="items"){Object.keys(core.status.hero.items).forEach(function(o){if(h.items[o]){core.status.hero.items[o]=core.clone(h.items[o])}})}else{core.status.hero[n]=core.clone(h[n])}}});if(c.equipment){core.items.quickLoadEquip(100+k)}core.ui.drawTip=e;core.control.playSound=f;var j=h.floorId||core.status.floorId;var l=h.loc||core.status.hero.loc;core.insertAction([{type:"setHeroIcon",name:h.image||"hero.png"},j!=core.status.floorId?{type:"changeFloor",floorId:j,loc:[l.x,l.y],direction:l.direction,time:0}:{type:"changePos",loc:[l.x,l.y],direction:l.direction}]);core.setFlag("heroId",k)}},custom:function(){core.actions._clickBookDetail=function(){core.clearMap("data");core.playSound("确定");core.status.event.id="book"};core.events.openQuickShop=function(a){if(core.isReplaying()){return}if(core.hasItem("talentTree")){if(core.status.event.id!=null){return}core.useItem("talentTree");return}else{if(core.hasItem("talentTree2")){if(core.status.event.id!=null){return}if(core.getFlag("Ch4_quickshop",0)==1){core.openShop("Chap4Shop4",false)}else{core.useItem("talentTree2")}return}else{if(core.hasItem("talentTree3")){if(core.status.event.id!=null){return}core.useItem("talentTree3");return}}}if(Object.keys(core.status.shops).length==0){core.playSound("操作失败");core.drawTip("目前没有快捷商店！");return}if(Object.keys(core.status.shops).length==1){var c=Object.keys(core.status.shops)[0];if(core.status.event.id!=null){return}if(!core.canOpenShop(c)){core.playSound("操作失败");core.drawTip("当前无法打开快捷商店！");return}var b=core.canUseQuickShop(c);if(b!=null){core.playSound("操作失败");core.drawTip(b);return}core.openShop(c,false);return}if(!this._checkStatus("selectShop",a)){return}core.ui._drawQuickShop()};core.enemys._nextCriticals_useBinarySearch=function(c,g,l,o,p,d){var f=100;if(this.hasSpecial(c.special,29)){f=100-c.value29}var j=g.mon_hp,e=core.status.hero.atk,i=g.mon_def+(g.spe46_buff||0)*100/f,m=g.damage;var h=[];var n=core.getRealStatus("atk");if(g.__over__){n=i+1;h.push([g.__overAtk__,-g.damage])}var a=function(q,s){var v=Math.floor(q),r=Math.floor(s);if(v>r){return null}while(v<r){var t=Math.floor((v+r)/2);if(t-v>r-t){t--}var u=core.enemys.getDamageInfo(c,{atk:Math.ceil(t/core.getBuff("atk"))},o,p,d);if(u==null||(typeof u=="number")){return null}if(m>u.damage){r=t}else{v=t+1}}var u=core.enemys.getDamageInfo(c,{atk:Math.ceil(v/core.getBuff("atk"))},o,p,d);return u==null||(typeof u=="number")||u.damage>=m?null:[v,u.damage]};var b=n;while(true){var k=a(b+1,j+i);if(k==null){break}b=k[0];m=k[1];h.push([Math.ceil(b/core.getBuff("atk"))-e,g.damage-m]);if(m<=0&&!core.flags.enableNegativeDamage){break}if(h.length>=l){break}}if(h.length==0){h.push([0,0])}return h};core.enemys._nextCriticals_useTurn=function(c,g,m,s,u,d){var j=g.mon_hp,e=core.status.hero.atk,i=g.mon_def,r=g.turn;if(r>=1000000||this.hasSpecial(c.special,29)){return this._nextCriticals_useBinarySearch(c,g,m,s,u,d)}var f=100;if(this.hasSpecial(c.special,29)){f=100-c.value29;i+=(g.spe46_buff||0)*100/f}var h=[],n=null;var o=e;if(g.__over__){o=i+1;h.push([g.__overAtk__,-g.damage])}var a=0;if(core.hasEquip("sword6")){a-=j*0.1}var q=core.getTalentLv(12);if(q>0){a-=core.getRealStatusOrDefault(null,"def")*(10+10*q)*0.1}for(var p=r-1;p>=1;p--){var b=1;if(core.hasEquip("sword5")){b=1.25}if(this.hasSpecial(c.special,1)&&c.value28<0){j+=(-c.value28)*(core.getRealStatus("atk")-i)*b;p-=c.value28}var k=Math.ceil(j/p/b)+i;if(this.hasSpecial(c.special,29)){k=Math.ceil(j/p/b*100/(100-c.value29))+i}if(this.hasSpecial(c.special,43)&&p<=10){break}k+=(g.spe46_buff||0);if(this.hasSpecial(c.special,60)){k=k*100/(100-c.value60)}k=Math.ceil(k/core.getBuff("atk"));if(k<=o){break}if(k!=n){var l=this.getDamageInfo(c,{atk:k},s,u,d);if(l==null||(typeof l=="number")){break}h.push([k-e,Math.floor(g.damage-l.damage)]);if(l.damage<=a&&!core.flags.enableNegativeDamage){break}n=k}if(h.length>=m){break}}if(h.length==0){h.push([0,0])}return h};core.enemys.nextCriticals=function(b,g,i,j,d){if(core.getFlag("rage_stack",0)!=0){return[[0,0]]}if(typeof b=="string"){b=core.material.enemys[b]}g=g||1;var h=this._nextCriticals_special(b,g,i,j,d);if(h!=null){return h}var e=this.getDamageInfo(b,null,i,j,d);if(e==null){var c=this.getEnemyInfo(b,null,i,j,d);if(c.def==null||c.def+(c.spe46_buff||0)<core.getRealStatus("atk")){return[]}var f;if(this.hasSpecial(b.special,60)){f=(c.def+(c.spe46_buff||0))*100/(100-b.value60)}else{f=c.def+(c.spe46_buff||0)}f=Math.ceil(f/core.getBuff("atk"))+1;e=this.getDamageInfo(b,{atk:f},i,j,d);if(e==null||e.mon_def!=c.def){return[]}e.__over__=true;e.__overAtk__=f-core.status.hero.atk}if(typeof e=="number"){return[[0,0]]}if(e.damage<=0&&!core.flags.enableNegativeDamage){return[[e.__overAtk__||0,0]]}var a=0;if(core.hasEquip("sword6")){a-=e.mon_hp*0.08}if(core.getTalentLv(12)>0){a-=core.status.hero.def*20*0.1*core.getTalentLv(12)}if(typeof e=="number"||(e.damage<=a&&!core.flags.enableNegativeDamage)){return[[0,0]]}if(core.flags.useLoop){if(core.status.hero.atk<=(main.criticalUseLoop||1)){return this._nextCriticals_useLoop(b,e,g,i,j,d)}else{return this._nextCriticals_useBinarySearch(b,e,g,i,j,d)}}else{return this._nextCriticals_useTurn(b,e,g,i,j,d)}};core.enemys._nextCriticals_special=function(a,c,d,e,b){if(this.hasSpecial(a.special,10)||this.hasSpecial(a.special,3)){return[]}if(this.hasSpecial(a.special,63)&&core.status.hero.hp<=a.hp){return[]}return null};core.maps._automaticRoute_deepAdd=function(e,f,b){var c=1;var a=b[e+","+f];if(a&&!a.disable){var d=a.event.id;if(core.getFlag("keysAreBad",0)>0){if(d=="yellowKey"){c+=50}if(d=="blueKey"){c+=150}if(d=="redKey"){c+=500}}if(d=="light"){c+=100}if(d.endsWith("Net")&&!core.hasFlag(d.substring(0,d.length-3))){c+=100}if(core.hasFlag("__potionNoRouting__")&&(d.endsWith("Potion")||d=="greenGem")){c+=100}}c+=(core.status.checkBlock.damage[e+","+f]||0)*100;if(core.status.checkBlock.ambush[e+","+f]){c+=1000}return c}},moreLight:function(){var b=0;var a=1;core.control._drawHero_draw=function(g,o,p,n,m,h){var c=core.getFlag("bgLight",[]);var e=core.floors[core.status.floorId];var l=core.getFlag("lightRadius",0);var f;if(e.color){f=core.floors[core.status.floorId].color[3]}else{f=0}var j=core.getFlag("heroLight",0);if(!j){f=0}var d=0;m=m||{x:0,y:0,offset:0,px:0,py:0};this._drawHero_getDrawObjs(g,o,p,n,m).forEach(function(i){core.drawImage("hero",i.img,(i.heroIcon[i.status]+(h||0))%4*i.width,i.heroIcon.loc*i.height,i.width,i.height,i.posx+(32-i.width)/2,i.posy+32-i.height,i.width,i.height);if(f!=0){core.canvas.curtain.globalAlpha=1;c.push([i.posx+16,i.posy+32-i.height+16,l]);d+=1}if(core.getFlag("moveShadow",0)==1){var q=core.getFlag("moveShadow_period",5);b++;if(b%q==0){core.hideImage(25+a,0);core.showImage(25+a,i.img,[(i.heroIcon[i.status]+(h||0))%4*i.width,i.heroIcon.loc*i.height,i.width,i.height],[i.posx+(32-i.width)/2,i.posy+32-i.height,i.width,i.height],0.5,0);core.hideImage(25+a,250);a++}b%=120;if(a>55){a-=55}}});if(f!=0){core.plugin.drawLight("curtain",f,c,0,e.color);for(var k=0;k<d;++k){c.pop()}}};this.setBgLight=function(d){var h=[];if(!d){core.setFlag("bgLight",[]);return}for(var c in d){var e=32*d[c][0]+16;var f=32*d[c][1]+16;var g=d[c][2];h.push([e,f,g])}core.setFlag("bgLight",h);core.drawMap();core.plugin.updateWeather()}},bookColor:function(){var b={"喽啰":"#63FF63","精英":"#406CC8","领主":"#A063C0","二等公民":"#A063C0",BOSS:"#FF0000","T-proto":"#FF00CC","人造神明":"#FF00CC","高级统领":"#FF00CC","大魔王":"#FF00CC","灾厄使者":"#FF7800","械灵之王":"#FF7800","第零公民":"#FF7800",};var a=core.ui._drawBook_drawName;core.ui._drawBook_drawName=function(d,c,i,e,k){if(!c.title||c.title=="普通"){return a.call(this,d,c,i,e,k)}core.setTextAlign("ui","center");if(c.specialText.length==0){core.fillText("ui",c.name,e+k/2,i+27,"#DDDDDD",this._buildFont(17,true),k);core.fillText("ui",c.title,e+k/2,i+51,core.arrayToRGBA(b[c.title]||"#DDDDDD"),this._buildFont(14,true,false,"幼圆"))}else{core.fillText("ui",c.name,e+k/2,i+20,"#DDDDDD",this._buildFont(17,true),k);switch(c.specialText.length){case 1:core.fillText("ui",c.specialText[0],e+k/2,i+38,core.arrayToRGBA((c.specialColor||[])[0]||"#FF6A6A"),this._buildFont(15,true),k);break;case 2:var h=c.specialText[0]+"  "+c.specialText[1];core.setFontForMaxWidth("ui",h,k,this._buildFont(15,true));var j=core.calWidth("ui",h);var f=core.calWidth("ui",c.specialText[0]);var g=core.calWidth("ui",c.specialText[1]);core.fillText("ui",c.specialText[0],e+(k+f-j)/2,i+38,core.arrayToRGBA((c.specialColor||[])[0]||"#FF6A6A"));core.fillText("ui",c.specialText[1],e+(k+j-g)/2,i+38,core.arrayToRGBA((c.specialColor||[])[1]||"#FF6A6A"));break;default:core.fillText("ui","多属性...",e+k/2,i+38,"#FF6A6A",this._buildFont(15,true),k)}core.fillText("ui",c.title,e+k/2,i+56,core.arrayToRGBA(b[c.title]||"#DDDDDD"),this._buildFont(14,true,false,"幼圆"))}};core.ui._drawBook_drawRow1=function(i,g,l,j,m,k){core.setTextAlign("ui","left");var c=this._buildFont(13,true),h=this._buildFont(13,false);var d=j,e=j+m*9/25,f=j+m*17/25;core.fillText("ui","生命",d,k,"#00FF00",h);core.fillText("ui",core.formatBigNumber(g.hp||0),d+30,k,null,c);core.fillText("ui","攻",e,k,"#FF5555",h);core.fillText("ui",core.formatBigNumber(g.atk||0),e+15,k,null,c);core.fillText("ui","防",f,k,"#45D1E0",h);core.fillText("ui",core.formatBigNumber(g.def||0),f+15,k,null,c)};core.ui._drawBook_drawRow3=function(k,h,p,l,r,o){var j=core.floorIds[(core.status.event.ui||{}).index]||core.status.floorId;var m=null,n=null;if(h.locs){m=h.locs[0][0];n=h.locs[0][1]}var g=core.getDamageInfo(h.id,null,m,n,j);var q=(g||{}).turn||0;if(q){q=core.formatBigNumber(q)}else{q="???"}core.setTextAlign("ui","left");var c=this._buildFont(13,true),i=this._buildFont(13,false);var d=l,e=l+r*9/25,f=l+r*17/25;core.fillText("ui","临界",d,o,"#DDDDDD",i);core.fillText("ui",core.formatBigNumber(h.critical||0),d+30,o,null,c);core.fillText("ui","减伤",e,o,null,i);core.fillText("ui",core.formatBigNumber(h.criticalDamage||0),e+26,o,null,c);core.fillText("ui","回合",f,o,null,i);core.fillText("ui",q,f+30,o,null,c)};core.ui._drawBookDetail_turnAndCriticals=function(d,e,i){if(core.getFlag("70F_boss_phase",0)==1||core.getFlag("Chap3_boss",0)==1){return}if(core.getFlag("A21boss",0)==1){return}var f=null,g=null;if(d.locs){f=d.locs[0][0];g=d.locs[0][1]}var h=8;var c=core.enemys.nextCriticals(d.id,h,f,g,e).map(function(j){return core.formatBigNumber(j[0])+":"+core.formatBigNumber(j[1])});while(c[0]=="0:0"){c.shift()}i.push("\r[#FF6A6A]\\d临界表：\\d\r[]"+JSON.stringify(c))};core.ui._drawBookDetail_origin=function(d,f){if(core.getFlag("A21boss",0)==1){return}var e=core.enemys._getCurrentEnemys_getEnemy(d.id);var c=[];if(d.locs!=null&&d.locs.length>=0){f.push("\r[#FF6A6A]\\d怪物坐标：\\d\r[]"+JSON.stringify(d.locs))}["hp","atk","def","point","money","exp"].forEach(function(g){if(d[g]==null||e[g]==null){return}if(d[g]!=e[g]){c.push(core.getStatusLabel(g)+" "+e[g])}});if(c.length>0){f.push("\r[#FF6A6A]\\d原始数值：\\d\r[]"+c.join("；"))}}},overwrite:function(){var b=core.events.changeFloor;core.events.changeFloor=function(g,j,i,k,f){var h=core.hasFlag("__fromLoad__");if(core.getFlag("temp_mdef_pp",0)>0){if(!h){core.plugin.addTempMdefpp(-core.getFlag("temp_mdef_pp",0));core.plugin.autoGetItem()}}b.call(this,g,j,i,k,f)};core.maps.initBlock=function(o,p,m,f,k){var i=null;var n=null;var l=null;if(k!=null){i=this.isMapBlockDisabled(k.floorId,o,p);n=this._getBlockOpacityFromFlag(k.floorId,o,p);l=this._getBlockFilterFromFlag(k.floorId,o,p)}var g={x:o,y:p,id:m};if(i!=null){g.disable=i}if(n!=null){g.opacity=n}if(l!=null){g.filter=l}if(m==17){g.event={cls:"terrains",id:"airwall",cannotIn:["up","down","left","right"]}}else{if(m in this.blocksInfo){g.event=JSON.parse(JSON.stringify(this.blocksInfo[m]))}else{if(core.icons.getTilesetOffset(m)){g.event={cls:"tileset",id:"X"+m}}else{g.event={cls:"terrains",id:"none",noPass:false}}}}if(g.event.noPass==null){if(g.event.canPass==null){g.event.noPass=g.event.cls!="items"}else{g.event.noPass=!g.event.canPass}}delete g.event.canPass;if(g.event.cls.indexOf("enemy")==0){var j=core.material.enemys[g.event.id];if(j&&j.faceIds){g.event.faceIds=j.faceIds}}var j=core.material.enemys[g.event.id];if(j&&core.hasSpecial(j.special,71)){g.opacity=0.5}if(f){this._addInfo(g)}if(k){this._addEvent(g,o,p,(k.events||{})[o+","+p]);var h=(k.changeFloor||{})[o+","+p];if(h){this._addEvent(g,o,p,{trigger:"changeFloor",data:h})}}if(main.mode=="editor"){delete g.disable}return g};core.control.setWeather=function(h,g){if(core.getFlag("no_weather",false)){h=null}if(h==null||!this.weathers[h]){core.deleteCanvas("weather");core.animateFrame.weather.type=null;core.animateFrame.weather.nodes=[];return}if(g==null){g=core.animateFrame.weather.level}g=core.clamp(parseInt(g)||5,1,10);if(h==core.animateFrame.weather.type&&g==core.animateFrame.weather.level){return}core.createCanvas("weather",0,0,core.__PIXELS__,core.__PIXELS__,80);core.setOpacity("weather",1);core.animateFrame.weather.type=h;core.animateFrame.weather.level=g;core.animateFrame.weather.nodes=[];try{core.doFunc(this.weathers[h].initFunc,this,g)}catch(f){main.log(f);main.log("ERROR in weather["+h+"]：已自动注销该项。");core.unregisterWeather(h)}};utils.prototype.formatBigNumber=function(m,f){if(f===true){f=5}if(!f||f<5){f=6}m=Math.trunc(parseFloat(m));if(m==null||!Number.isFinite(m)){return"???"}var l=[{val:10000,suffix:"w"},{val:100000000,suffix:"e"},{val:1000000000000,suffix:"z"},{val:1e+16,suffix:"j"},{val:1e+20,suffix:"g"},];if(Math.abs(m)>1e+20*Math.pow(10,f-2)){return m.toExponential(0)}var j=m<0?"-":"";m=Math.abs(m);if(m<Math.pow(10,f)){return j+m}for(var h=0;h<l.length;++h){var g=l[h];var k=(m/g.val).toFixed(f).substring(0,f);if(k.indexOf(".")<0){continue}k=k.substring(0,k[k.length-2]=="."?k.length-2:k.length-1);return j+k+g.suffix}return j+m.toExponential(0)};enemys.prototype._getCurrentEnemys_addEnemy=function(j,l,t,w,z,m){var h=this._getCurrentEnemys_getEnemy(j);if(h==null){return}var o=h.id;var k=this.getEnemyInfo(h,null,null,null,m);var p=this.getEnemyInfo(h,null,w,z,m);if(!core.flags.enableEnemyPoint||(p.atk==k.atk&&p.def==k.def&&p.hp==k.hp&&p.spe28_buff==0&&p.spe32_buff==0&&p.spe39_buff==0&&p.spe46_buff==0&&p.spe65_buff==0)){w=null;z=null}else{for(var n=0;n<l.length;++n){var q=l[n];if(o==q.id&&q.locs!=null&&p.atk==q.atk&&p.def==q.def&&p.hp==q.hp&&p.spe28_buff==q.spe28_buff&&p.spe32_buff==q.spe32_buff&&p.spe39_buff==q.spe39_buff&&p.spe46_buff==q.spe46_buff&&p.spe65_buff==q.spe65_buff){q.locs.push([w,z]);return}}k=p}var o=h.id+":"+w+":"+z;if(t[o]){return}t[o]=true;var s=core.enemys.getSpecialText(h);var r=core.enemys.getSpecialColor(h);var f=this.nextCriticals(h,1,w,z,m);if(f.length>0){f=f[0]}var g=core.clone(h);for(var u in k){g[u]=k[u]}if(w!=null&&z!=null){g.locs=[[w,z]]}g.name=core.getEnemyValue(h,"name",w,z,m);g.specialText=s;g.specialColor=r;g.damage=this.getDamage(h,w,z,m);g.critical=f[0];g.criticalDamage=f[1];g.defDamage=this._getCurrentEnemys_addEnemy_defDamage(h,w,z,m);l.push(g)};events.prototype._openDoor_check=function(f,n,o,m){var g=function(){core.clearContinueAutomaticRoute();return false};if(f==null||f.event==null){return g()}var i=f.event.id;if(core.material.icons.animates[i]==null&&core.material.icons.npc48[i]==null){return g()}if(i=="steelDoor"&&core.flags.steelDoorWithoutKey){m=false}if((i=="greenDoor"||i=="greenDoor2")&&core.hasItem("I_superGreenKey")){m=false}var h=f.event.doorInfo;if(h==null){return g()}var j=h.keys||{};if(m){for(var k in j){var l=j[k];if(k.endsWith(":o")){k=k.substring(0,k.length-2)}if(!core.material.items[k]){core.stopSound();core.playSound("操作失败");core.drawTip("无法开启此门");return g()}if(core.itemCount(k)<l){core.stopSound();core.playSound("操作失败");core.drawTip("你的"+((core.material.items[k]||{}).name||"钥匙")+"不足！",null,true);return false}}if(!core.status.event.id){core.autosave(true)}for(var k in j){if(!k.endsWith(":o")){core.removeItem(k,j[k])}}}core.playSound(h.openSound);return true};core.events.battle=function(i,l,m,h,f){core.saveAndStopAutomaticRoute();i=i||core.getBlockId(l,m);if(!i){return core.clearContinueAutomaticRoute(f)}if(!core.enemys.canBattle(i,l,m)&&!h&&!core.status.event.id){core.stopSound();core.playSound("操作失败");core.drawTip("你打不过此怪物！",i);return core.clearContinueAutomaticRoute(f)}var j=!core.status.event.id&&!core.getFlag("disable_autosave",0)&&!core.getFlag("disable_autosave2",0);var g=core.material.enemys[i];var k=g.special;if(core.enemys.hasSpecial(k,71)&&core.getFlag("invisible",false)){j=false}if(j){core.autosave(true)}if(!this.beforeBattle(i,l,m)){return core.clearContinueAutomaticRoute(f)}this.afterBattle(i,l,m);core.setFlag("disable_autosave",0);if(f){f()}};core.maps.noPass=function(j,k,h){var f=core.getBlock(j,k,h);if(f==null){return false}var i=f.event.id,g=core.material.enemys[i];if(g&&core.hasSpecial(g.special,71)&&core.getFlag("invisible",0)==1){return false}return f.event.noPass};core.control._moveAction_moving=function(f){core.setHeroMoveInterval(function(){core.setHeroLoc("x",core.nextX(),true);core.setHeroLoc("y",core.nextY(),true);var g=core.getHeroLoc("direction");core.setFlag("last_moved_direction",g);core.control._moveAction_popAutomaticRoute();core.status.route.push(g);core.moveOneStep();core.checkRouteFolding();if(f){f()}})};core.control._moveAction_popAutomaticRoute=function(){var f=core.status.automaticRoute;if(f.autoHeroMove){f.movedStep++;f.lastDirection=core.getHeroLoc("direction");if(f.destStep==f.movedStep){if(f.autoStep==f.autoStepRoutes.length){core.clearContinueAutomaticRoute();core.stopAutomaticRoute()}else{f.movedStep=0;f.destStep=f.autoStepRoutes[f.autoStep].step;if(core.getFlag("70F_boss_phase",0)!=1){core.setHeroLoc("direction",f.autoStepRoutes[f.autoStep].direction)}core.status.automaticRoute.autoStep++}}}};core.maps.setBlock=function(h,k,l,g){g=g||core.status.floorId;if(!g||h==null||k==null||l==null){return}if(k<0||k>=core.floors[g].width||l<0||l>=core.floors[g].height){return}if(typeof h=="string"){if(/^\d+$/.test(h)){h=parseInt(h)}else{h=core.getNumberById(h)}}var f=this.initBlock(k,l,h,true,core.floors[g]);if(f.id==0&&!f.event.trigger){core.removeBlock(k,l,g);return}var i=core.getBlock(k,l,g,true);var j=i==null?null:i.event;if(i==null){core.status.maps[g].blocks.push(f);if(core.status.mapBlockObjs[g]){core.status.mapBlockObjs[g][f.x+","+f.y]=f}core.setMapBlockDisabled(g,f.x,f.y,false);delete f.disable}else{i.id=h;i.event=f.event;f=i}this._updateMapArray(g,k,l);if(g==core.status.floorId&&!core.getFlag("setBlock_disable_refresh",false)){if((j!=null&&j.cls=="autotile")||f.event.cls=="autotile"){core.redrawMap()}else{if(j!=null){this._removeBlockFromMap(g,{x:k,y:l,event:j})}if(!f.disable){core.drawBlock(f);core.addGlobalAnimate(f);core.updateStatusBar()}}}};core.maps.setBgFgBlock=function(g,h,j,k,f){f=f||core.status.floorId;if(!f||h==null||j==null||k==null){return}if(j<0||j>=core.floors[f].width||k<0||k>=core.floors[f].height){return}if(!g||(!g.startsWith("bg")&&!g.startsWith("fg"))){return}if(typeof h=="string"){if(/^\d+$/.test(h)){h=parseInt(h)}else{h=core.getNumberById(h)}}var i=core.getFlag("__"+g+"v__",{});i[f]=(i[f]||[]).filter(function(l){return l[0]!=j||l[1]!=k});i[f].push([j,k,h]);core.setFlag("__"+g+"v__",i);core.status[g+"maps"][f]=null;if(f==core.status.floorId&&!core.getFlag("setBlock_disable_refresh",false)){core.clearMap(g);if(g.startsWith("bg")){core.drawBg(f)}else{core.drawFg(f)}}};maps.prototype._triggerBgFgMap=function(k,j,i,h,f){if(k!="show"){k="hide"}if(!j||(!j.startsWith("bg")&&!j.startsWith("fg"))){return}if(typeof i[0]=="number"&&typeof i[1]=="number"){i=[i]}h=h||core.status.floorId;if(!h){return}if(i.length==0){return}var g=core.getFlag("__"+j+"d__",{});g[h]=g[h]||[];i.forEach(function(l){if(k=="hide"){g[h].push([l[0],l[1]])}else{g[h]=g[h].filter(function(m){return m[0]!=l[0]||m[1]!=l[1]})}});core.setFlag("__"+j+"d__",g);core.status[j+"maps"][h]=null;if(h==core.status.floorId&&!core.getFlag("setBlock_disable_refresh",false)){core.drawMap()}if(f){f()}};this.my_keyDownCtrl=function(){if(core.status.event.id=="action"&&core.status.event.data.type=="animate"){var f=core.status.animateObjs[0];if(f){core.maps.stopAnimate(f.id,true)}return true}return core.actions._sys_keyDownCtrl()};core.registerAction("keyDownCtrl","_sys_keyDownCtrl",this.my_keyDownCtrl,0);this.my_longClick_lockControl=function(){if(core.status.event.id=="action"&&core.status.event.data.type=="animate"){var f=core.status.animateObjs[0];if(f){core.maps.stopAnimate(f.id,true)}return true}return core.actions._sys_longClick_lockControl()};core.registerAction("longClick","_sys_longClick_lockControl",this.my_longClick_lockControl,50);var d=core.events.getItem;core.events.getItem=function(g,i,j,k,h,f){if(core.getFlag("keysAreBad",0)>0&&h){if(g=="yellowKey"||g=="blueKey"||g=="redKey"||g=="yellowKey3"||g=="blueKey3"||g=="redKey3"){core.autosave(true)}}d.call(this,g,i,j,k,h,f)};var a=core.events._changeFloor_beforeChange;core.events._changeFloor_beforeChange=function(g,f){if(core.getFlag("disable_changefloor_sound",0)==0){core.playSound("floor.mp3")}a.call(this,g,f)};core.control._updateStatusBar_setToolboxIcon=function(){if(core.isReplaying()){core.statusBar.image.book.src=core.status.replay.pausing?core.statusBar.icons.play.src:core.statusBar.icons.pause.src;core.statusBar.image.book.style.opacity=1;core.statusBar.image.fly.src=core.statusBar.icons.stop.src;core.statusBar.image.fly.style.opacity=1;core.statusBar.image.toolbox.src=core.statusBar.icons.rewind.src;core.statusBar.image.keyboard.src=core.statusBar.icons.book.src;core.statusBar.image.shop.src=core.statusBar.icons.floor.src;core.statusBar.image.save.src=core.statusBar.icons.speedDown.src;core.statusBar.image.save.style.opacity=1;core.statusBar.image.load.src=core.statusBar.icons.speedUp.src;core.statusBar.image.settings.src=core.statusBar.icons.save.src}else{core.statusBar.image.book.src=core.statusBar.icons.book.src;core.statusBar.image.book.style.opacity=core.hasItem("book")?1:0.3;if(!core.flags.equipboxButton){core.statusBar.image.fly.src=core.statusBar.icons.fly.src;core.statusBar.image.fly.style.opacity=1;if(!core.canUseItem("fly")){core.statusBar.image.fly.style.opacity=0.3}if(!core.hasItem("fly")){core.statusBar.image.fly.style.opacity=0}}else{core.statusBar.image.fly.src=core.statusBar.icons.equipbox.src;core.statusBar.image.fly.style.opacity=1}core.statusBar.image.toolbox.src=core.statusBar.icons.toolbox.src;core.statusBar.image.keyboard.src=core.statusBar.icons.keyboard.src;if(core.hasItem("talentTree")&&core.getFlag("talentTree_unlocked",false)){core.statusBar.image.shop.src=core.statusBar.icons.talentTree.src}else{if(core.hasItem("talentTree2")&&core.getFlag("Ch4_quickshop",0)==0){core.statusBar.image.shop.src=core.statusBar.icons.talentTree2.src}else{if(core.hasItem("talentTree3")){core.statusBar.image.shop.src=core.statusBar.icons.talentTree3.src}else{core.statusBar.image.shop.src=core.statusBar.icons.shop.src}}}core.statusBar.image.save.src=core.statusBar.icons.save.src;core.statusBar.image.save.style.opacity=core.hasFlag("__forbidSave__")?0.3:1;core.statusBar.image.load.src=core.statusBar.icons.load.src;core.statusBar.image.settings.src=core.statusBar.icons.settings.src}};var e=core.control.moveHero;core.control.moveHero=function(g,f){if(core.status.heroMoving!=0){return}if(!core.isReplaying()&&core.getFlag("70F_boss_phase",0)==1){core.autosave(false)}e.call(this,g,f)};var c=core.ui._drawStatistics;core.ui._drawStatistics=function(){var g=core.getFlag("drawStat_start","undef");if(g!="undef"){var f=core.floorIds.indexOf(g);if(f!=-1){c.call(this,core.floorIds.slice(f));return}}c.call(this)};core.ui._drawStatistics_buildObj=function(){var l=this.uidata.drawStatistics();var i=l.filter(function(m){return m.endsWith("Door")||core.material.items[m]});var g={},f={},h={};i.forEach(function(m){if(m.endsWith("Door")){f[m]="doors"}else{if(m.endsWith("Key3")){f[m]="tools"}else{f[m]=core.material.items[m].cls}}g[m]=0});var k=["doors","items","tools","constants","equips"];i.sort(function(m,n){var o=k.indexOf(f[m]),p=k.indexOf(f[n]);if(o==p){return l.indexOf(m)-l.indexOf(n)}return o-p});var j={monster:{count:0,money:0,exp:0,point:0,},count:g,add:{hp:0,atk:0,def:0,mdef:0}};return{ids:i,cls:f,ext:h,total:core.clone(j),current:core.clone(j),marked:core.clone(j)}}},checkEnemy:function(){this.checkEnemy=function(c,g){var f=[];var a=0;var d=core.floorIds.indexOf(c),h=core.floorIds.indexOf(g);if(h<0){h=core.floorIds.length-1}for(var e=d;e<=h;++e){var b=core.floorIds[e];if(b.startsWith("Dungeon")){continue}if(core.enemys.getCurrentEnemys(b).length>0){core.status.maps[b].blocks.forEach(function(i){if(core.isset(i.event)&&!i.disable){var k=i.event.id,j=core.material.enemys[k];if(core.isset(j)&&!core.hasSpecial(k,87)){a++;if(j.name in f){f[j.name]++}else{f[j.name]=1}}}})}}core.setFlag("remainEnemyInfo",this.printEnemyInfo(f));core.setFlag("remainEnemyCount",a)};this.printEnemyInfo=function(a){var b="";for(var c in a){var d=a[c];b+="\n"+c+" * "+d}return b};this.checkKey=function(b,g){var c=core.floorIds.indexOf(b),h=core.floorIds.indexOf(g);var e=["yellowKey","blueKey","redKey","yellowKey3","blueKey3","redKey3"];var f=true;if(h<0){h=core.floorIds.length-1}for(var d=c;d<=h;++d){var a=core.floorIds[d];var j=core.enemys.getCurrentEnemys(a);core.status.maps[a].blocks.forEach(function(i){if(core.isset(i.event)&&!i.disable){var k=i.event.id;if(e.indexOf(k)!=-1){f=false}}})}return f};this.checkGem=function(b,f){var c=core.floorIds.indexOf(b),g=core.floorIds.indexOf(f);var e=true;if(g<0){g=core.floorIds.length-1}for(var d=c;d<=g;++d){var a=core.floorIds[d];var h=core.enemys.getCurrentEnemys(a);core.status.maps[a].blocks.forEach(function(i){if(core.isset(i.event)&&!i.disable){var j=i.event.id;if(j.indexOf("redGem")!=-1||j.indexOf("blueGem")!=-1||j.indexOf("greenGem")!=-1){e=false}}})}return e}},itemCategory2:function(){var a=false;if(!a){return}var c=["消耗道具","主动技能","永久道具",];var d=null;core.ui._drawToolbox_getInfo=function(k){if(!core.status.event.data||core.status.event.data.toolsPage==null){core.status.event.data={toolsPage:1,activeSkillPage:1,constantsPage:1,selectId:null}}var n=core.getToolboxItems("消耗道具"),e=core.getToolboxItems("主动技能"),h=core.getToolboxItems("永久道具");var o=core.status.event.data.toolsPage;var f=core.status.event.data.activeSkillPage;var i=core.status.event.data.constantsPage;var p=Math.ceil(n.length/this.LAST);var g=Math.ceil(e.length/this.LAST);var j=Math.ceil(h.length/this.LAST);if(k==null){if(n.length>0){k=0}else{if(e.length>0){k=this.LAST}else{if(h.length>0){k=2*this.LAST}else{k=0}}}}core.status.event.selection=k;var l,m;if(k<this.LAST){l=k+(o-1)*this.LAST;if(l>=n.length){l=Math.max(0,n.length-1)}m=n[l]}else{if(k<2*this.LAST){l=k%this.LAST+(f-1)*this.LAST;if(l>=e.length){l=Math.max(0,e.length-1)}m=e[l]}else{l=k%this.LAST+(i-1)*this.LAST;if(l>=h.length){l=Math.max(0,h.length-1)}m=h[l]}}if(!core.hasItem(m)){m=null}core.status.event.data.selectId=m;return{index:k,tools:n,active_skills:e,constants:h,toolsPage:o,activeSkillPage:f,constantsPage:i,toolsTotalPage:p,activeTotalPage:g,constantsTotalPage:j,selectId:m}};var b=core.ui._drawToolbox;core.ui._drawToolbox=function(e){var f=this._drawToolbox_getInfo(e);this._drawToolbox_drawBackground();core.setAlpha("ui",1);core.setStrokeStyle("ui","#DDDDDD");core.canvas.ui.lineWidth=2;core.canvas.ui.strokeWidth=2;core.setTextAlign("ui","right");var g=this.PIXEL-306;this._drawToolbox_drawLine(g,"消耗道具");var h=this.PIXEL-180;this._drawToolbox_drawLine(h,"主动技能");var i=this.PIXEL-116;this._drawToolbox_drawLine(i,"永久道具");this._drawToolbox_drawDescription(f,g);this._drawToolbox_drawContent(f,g,f.tools,f.toolsPage,true);this.drawPagination(f.toolsPage,f.toolsTotalPage,this.LAST-5);this._drawToolbox_drawContent(f,h,f.active_skills,f.activeSkillPage);this.drawPagination(f.activeSkillPage,f.activeTotalPage);this._drawToolbox_drawContent(f,i,f.constants,f.constantsPage);this.drawPagination(f.constantsPage,f.constantsTotalPage);core.setTextAlign("ui","center");core.fillText("ui","[装备栏]",this.PIXEL-46,25,"#DDDDDD",this._buildFont(15,true));core.fillText("ui","返回游戏",this.PIXEL-46,this.PIXEL-13)};core.ui.getToolboxItems=function(e){var f,g=true;if(e=="被动技能"){e="永久道具"}if(e=="消耗道具"){f="tools"}else{if(e=="主动技能"||e=="被动技能"||e=="永久道具"){f="constants"}else{f=e;g=false}}return Object.keys(core.status.hero.items[f]||{}).filter(function(h){if(e=="永久道具"){return !core.material.items[h].hideInToolbox&&(!g||core.material.items[h].category=="永久道具"||core.material.items[h].category=="被动技能")}else{return !core.material.items[h].hideInToolbox&&(!g||core.material.items[h].category==e)}}).sort()};core.actions._clickToolbox=function(f,g){if(f>=this.LAST-2&&g==0){core.ui.closePanel();if(core.isReplaying()){core.control._replay_equipbox()}else{core.openEquipbox()}return}if(f>=this.LAST-2&&g==this.LAST){core.ui.closePanel();return}var e=parseInt(f/2);if(g<=this.LAST-8&&g>=this.LAST-9){e+=0}else{if(g<=this.LAST-6&&g>=this.LAST-7){e+=this.LAST/2}else{if(g==this.LAST-4){e+=1*this.LAST}else{if(g==this.LAST-2){e+=2*this.LAST}else{if(g<=this.LAST&&g>=this.LAST-1){e+=2.5*this.LAST}else{e=-1}}}}}if(e>=0){this._clickToolboxIndex(e)}};core.actions._clickToolboxIndex=function(g){if(g<0){this._clickToolboxIndex(g+3*this.LAST);return}else{if(g>=3*this.LAST){this._clickToolboxIndex(g-3*this.LAST);return}}var k=core.getToolboxItems("tools"),e=core.getToolboxItems("主动技能"),f=core.getToolboxItems("永久道具");var i=null;var j;if(g<this.LAST){j=g+this.LAST*(core.status.event.data.toolsPage-1);i=k}else{if(g<2*this.LAST){j=g%this.LAST+this.LAST*(core.status.event.data.activeSkillPage-1);i=e}else{j=g%this.LAST+this.LAST*(core.status.event.data.constantsPage-1);i=f}}if(i==null){return}if(j>=i.length){return}var h=i[j];if(h==core.status.event.data.selectId){if(core.isReplaying()){return}core.events.tryUseItem(h)}else{core.ui._drawToolbox(g)}};core.actions._keyDownToolbox=function(h){if(core.status.event.data==null){return}var f=core.status.event.selection;var m=[];var k=[];var l=this.LAST/2;if(h==37){core.playSound("光标移动");m=core.arithProg(f+1,3*this.LAST-1,1)}if(h==38){core.playSound("光标移动");k=core.arithProg(f-f%l,f%l+1,1);for(var e=0;e<5;e++){for(var g in k){k[g]+=l}m=m.concat(k)}}if(h==39){core.playSound("光标移动");m=core.arithProg(f-1,3*this.LAST-1,-1)}if(h==40){core.playSound("光标移动");k=core.arithProg(f-f%l,f%l+1,1);for(var e=0;e<5;e++){for(var g in k){k[g]-=l}m=m.concat(k)}}for(var e in m){this._clickToolboxIndex(m[e])}};this.arithProg=function(e,g,f){if(g<=1){return[e]}else{return[e].concat(this.arithProg(e+f,g-1,f))}}},"70Fboss":function(){this.SpecialHeroMove=function(){core.addFlag("70F_p1_turn",1);var p=core.getHeroLoc("x"),q=core.getHeroLoc("y");var c=core.getMapBlocksObj(core.status.floorId);var a=[];var d;var j=[],r=[],e=[],i=[];for(var m in c){var b=c[m],s=b.x,t=b.y,k=b.event.id,h=core.material.enemys[k];if(b.disable){continue}if(h&&core.hasSpecial(h.special,58)){var n=s,o=t;var f=p-s;var g=q-t;if(Math.abs(f)>Math.abs(g)){if(f<0){n--;d="left"}else{n++;d="right"}if(n==6&&o==6){if(g<0){n=s;o=t-1;d="up"}else{n=s;o=t+1;d="down"}}}else{if(g<0){o--;d="up"}else{o++;d="down"}if(n==6&&o==6){if(f<0){n=s-1;o=t;d="left"}else{n=s+1;o=t;d="right"}}}if(n==p&&o==q){a.push({type:"function","function":"function() { core.battle('E363', "+s+","+t+", true, core.doAction); }",async:true})}else{if(r.find(function(u){return u[0]==n&&u[1]==o})){if(!i.find(function(u){return u[0]==n&&u[1]==o})){i.push([n,o])}}j.push([s,t]);r.push([n,o]);e.push(d)}}}a.push({type:"waitAsync"});for(var l in j){var s=j[l][0],t=j[l][1];var n=r[l][0],o=r[l][1];var d=e[l];if(!core.getBlock(n,o)||!core.getBlock(n,o).event){a.push({type:"function","function":"function(){core.plugin.MoveBomb("+s+","+t+',"'+d+'", true);}'})}else{if(core.getBlockId(n,o)=="lavaNet"){a.push({type:"function","function":"function(){core.plugin.MoveBomb("+s+","+t+',"'+d+'", false);}'});if(!i.find(function(u){return u[0]==n&&u[1]==o})){i.push([n,o])}}}}a.push({type:"waitAsync"});i.forEach(function(v){for(var u in r){if(r[u][0]==v[0]&&r[u][1]==v[1]){a.push({type:"function","function":"function(){core.plugin.BombExplode("+v[0]+","+v[1]+", 1222223);}"})}}});a.push({type:"waitAsync"});a.push({type:"function","function":"function(){core.plugin.BossSkill();}"},{type:"waitAsync"},{type:"insert",name:"70Fboss_round"},{type:"waitAsync"},{type:"function","function":"function(){core.plugin.SpecialWinLose();}"});core.insertAction(a)};this.MoveBomb=function(c,d,a,b){if(core.getBlockCls(c,d)=="enemys"){core.moveBlock(c,d,[a],300,b)}};this.BombExplode=function(g,h,a){core.drawAnimate("fire2",g,h);core.removeBlock(g,h);for(var e=g-1;e<=g+1;++e){for(var f=h-1;f<=h+1;++f){if(!core.getBlock(e,f)){core.setBlock("lavaNet",e,f)}else{if(core.getBlockCls(e,f)=="enemys"){var b=core.material.enemys[core.getBlockId(e,f)];if(core.hasSpecial(b.special,57)){core.plugin.BombExplode(e,f,b.damage)}}}}}if(core.getFlag("70F_boss_phase",0)==1&&g>=5&&g<=7&&h>=5&&h<=7){core.addFlag("70F_damage",a);core.plugin.popSkillDamage(a,6,6,"#FFFFFF")}var c=core.status.hero.loc.x;var d=core.status.hero.loc.y;if(g>=c-1&&g<=c+1&&h>=d-1&&h<=d+1){core.status.hero.hp-=a;core.plugin.popSkillDamage(a,c,d)}};this.BossSkill=function(){if(core.getFlag("70Fboss_skill2_ready",0)>0){core.addFlag("70Fboss_skill2_ready",-1);if(core.getFlag("70Fboss_skill2_ready",0)<=1){this.FireSlash()}}if(core.getFlag("70Fboss_skill3_ready",0)>0){core.addFlag("70Fboss_skill3_ready",-1);if(core.getFlag("70Fboss_skill3_ready",0)==0){this.IceMissile()}}};this.IceMissile=function(){core.hideImage(2,0);var g=core.getFlag("70Fboss_skill3_loc_x",641);var h=core.getFlag("70Fboss_skill3_loc_y",641);var d=1;function e(k,l){core.drawAnimate("ice2",k,l);if(k==core.status.hero.loc.x&&l==core.status.hero.loc.y){var i=core.status.hero.hp*0.05+1000000;i=Math.floor(i);core.status.hero.hp-=i;core.plugin.popSkillDamage(i,k,l)}if(core.getBlockCls(k,l)=="enemys"){var j=core.material.enemys[core.getBlockId(k,l)];if(core.hasSpecial(j.special,57)){core.plugin.BombExplode(k,l,j.damage)}}}function f(i,j){if(core.getBlockId(i,j)=="lavaNet"){core.removeBlock(i,j)}}if(!core.isReplaying()){var a=200;core.showImage(3,"iceMissileDown.png",[0,0,32,96],[g*32,h*32-256,32,96],1,0);core.moveImage(3,[g*32,h*32-64],1,null,a);setTimeout(function(){core.hideImage(3,0);core.playSound("VX_Crash.ogg");for(var i=g-2;i<=g+2;++i){for(var j=h-2;j<=h+2;++j){e(i,j)}}},a);setTimeout(function(){for(var i=g-2;i<=g+2;++i){for(var j=h-2;j<=h+2;++j){f(i,j)}}},a+100)}else{for(var b=g-2;b<=g+2;++b){for(var c=h-2;c<=h+2;++c){e(b,c)}}for(var b=g-2;b<=g+2;++b){for(var c=h-2;c<=h+2;++c){f(b,c)}}}};this.FireSlash=function(){core.hideImage(1,0);var d=core.getFlag("70Fboss_skill2_loc_x",641);var e=core.getFlag("70Fboss_skill2_loc_y",641);var b=1;function c(h,i){if(h==core.status.hero.loc.x&&i==core.status.hero.loc.y){var f=core.status.hero.hp*0.1+2000000;f=Math.floor(f);core.status.hero.hp-=f;core.plugin.popSkillDamage(f,h,i)}if(!core.getBlock(h,i)){core.setBlock("lavaNet",h,i)}else{if(core.getBlockCls(h,i)=="enemys"){var g=core.material.enemys[core.getBlockId(h,i)];if(core.hasSpecial(g.special,57)){core.plugin.BombExplode(h,i,g.damage)}}}}if(core.getFlag("70Fboss_skill2_dir",0)%2==0){if(!core.isReplaying()){var a=setInterval(function(){b+=1;if(b<11){core.drawAnimate("fire2",b,e);c(b,e);core.playSound("smallExplosion.mp3")}else{clearInterval(a)}},20)}else{b+=1;while(b<11){c(b,e);b+=1}}}else{if(!core.isReplaying()){var a=setInterval(function(){b+=1;if(b<11){core.drawAnimate("fire2",d,b);c(d,b);core.playSound("smallExplosion.mp3")}else{clearInterval(a)}},20)}else{b+=1;while(b<11){c(d,b);b+=1}}}core.addFlag("70Fboss_skill2_dir",1)};this.SpecialWinLose=function(){if(core.getHeroLoc("x")<2||core.getHeroLoc("x")>10||core.getHeroLoc("y")<2||core.getHeroLoc("y")>10){core.setFlag("70F_boss_phase",2221);core.lose("飞行")}if(core.status.hero.hp<=0){core.setFlag("70F_boss_phase",2221);core.lose()}var a=12222221;var c=core.getFlag("70F_damage",0);var b=a-c;if(b<=0){core.addFlag("70F_boss_phase",1);core.trigger(0,0)}}},popSkillDamage:function(){this.popSkillDamage=function(c,e,f,b){if(core.isReplaying()||core.getFlag("__statistics__",false)){return}if(!b){b="#FF6666"}var i=core.getFlag("popSkillDamageK",0);core.addFlag("popSkillDamageK",1);if(core.getFlag("popSkillDamageK",0)>=2221){core.setFlag("popSkillDamageK",0)}core.createCanvas("skillDamage"+i,0,0,480,480,150);var h;if(c==0){h="免疫"}else{h=core.formatBigNumber(c)}core.fillBoldText("skillDamage"+i,h,(e-core.bigmap.posX)*32,(f-core.bigmap.posY)*32,b,"#000000","18px Verdana");var a=0;var g=Math.random()-0.5;var l=-1+(Math.random()-0.5)/2;var j=0;var k=0;var d=setInterval(function(){a+=1;l+=0.015;k+=l;j+=g/2;if(a<150){core.relocateCanvas("skillDamage"+i,j,k);core.setOpacity("skillDamage"+i,3-a*0.02)}else{clearInterval(d);core.ui.deleteCanvas("skillDamage"+i)}},5)}},DANGER:function(){this.prepareForWarning=function(c,d){this._centerX=c;this._centerY=d;this._sprTopBoard={name:"topBoard",x:-32,y:-128,w:465,h:128,z:120};this._sprBotBoard={name:"botBoard",x:-32,y:416,w:465,h:128,z:120};this._sprWar1={name:"war1",x:416,y:162,w:294,h:93,z:120};this._sprWar2={name:"war2",x:710,y:162,w:294,h:93,z:120};this._sprWar3={name:"war3",x:1004,y:162,w:294,h:93,z:120};this._sprites=[this._sprTopBoard,this._sprBotBoard,this._sprWar1,this._sprWar2,this._sprWar3];this._warningSprs=[this._sprWar1,this._sprWar2,this._sprWar3];this._sprites.forEach(function(h){core.createCanvas(h.name,h.x,h.y,h.w,h.h,h.z)});this._warningCanvas=[core.ui.getContextByName("war1").canvas,core.ui.getContextByName("war2").canvas,core.ui.getContextByName("war3").canvas];core.createCanvas("viewport",0,0,416,416,115);this._bgCanvas=core.ui.getContextByName("viewport");this._bgCanvas.mozImageSmoothingEnabled=false;this._bgCanvas.webkitImageSmoothingEnabled=false;this._bgCanvas.msImageSmoothingEnabled=false;this._bgCanvas.imageSmoothingEnabled=false;this._bgCanvas.scale(1,1);var g=core.ui.getContextByName("topBoard");var a=core.ui.getContextByName("botBoard");g.beginPath();a.beginPath();g.moveTo(0,110);a.moveTo(0,17);for(var e=0;e<29;e++){g.lineTo(e*16+8,126);g.lineTo(e*16+16,110);a.lineTo(e*16+8,1);a.lineTo(e*16+16,17)}g.lineTo(464,0);g.lineTo(0,0);a.lineTo(464,127);a.lineTo(0,127);g.closePath();a.closePath();g.fillStyle="#000";a.fillStyle="#000";g.fill();a.fill();var f=core.material.images.images["warning.png"];for(var e=0;e<3;e++){var b=core.ui.getContextByName(this._sprites[e+2].name);b.drawImage(f,0,0)}this._timer=0;this._isWarning=true;this._vdisX=208-(c*32+16);this._vdisY=208-(d*32+4);this._boardSpeed=4;this._warningSpeed=4;this._opacity=1;this._opacityDec=true;this._scale=1;core.playSound("se_alert.wav")};this.isWarning=function(){return !!this._isWarning};this.drawAllCanvas=function(a,b){this._bgCanvas.drawImage(core.canvas.bg.canvas,a,b);this._bgCanvas.drawImage(core.canvas.bg2.canvas,a,b);this._bgCanvas.drawImage(core.canvas.fg.canvas,a,b);this._bgCanvas.drawImage(core.canvas.fg2.canvas,a,b);this._bgCanvas.drawImage(core.canvas.event.canvas,a,b);this._bgCanvas.drawImage(core.canvas.hero.canvas,a,b);this._bgCanvas.drawImage(core.canvas.event2.canvas,a,b);this._bgCanvas.restore()};this.drawWarningImage=function(b){if(this._opacityDec){this._opacity-=0.05;if(this._opacity<=0.5){this._opacity=0.5;this._opacityDec=!this._opacityDec}}else{this._opacity+=0.05;if(this._opacity>=1){this._opacity=1;this._opacityDec=!this._opacityDec}}for(var a=0;a<3;a++){var c=this._warningSprs[a];if(b){c.x-=this._warningSpeed;if(c.x<=-294){c.x=588}}else{c.x-=this._warningSpeed*3}this._warningCanvas[a].style.opacity=this._opacity}};this.updateWarning=function(){if(this._timer<200){if(this._timer<50){this._scale*=1.015;var d=(416-416/this._scale)/2;this._bgCanvas.clearRect(0,0,416,416);this._bgCanvas.save();this._bgCanvas.scale(this._scale,this._scale);var a=Math.ceil(this._vdisX*this._timer/50-d);var b=Math.ceil(this._vdisY*this._timer/50-d);this.drawAllCanvas(a,b)}else{this._scale*=1.002;var d=(416-416/this._scale)/2;this._bgCanvas.clearRect(0,0,416,416);this._bgCanvas.save();this._bgCanvas.scale(this._scale,this._scale);var a=Math.ceil(this._vdisX-d);var b=Math.ceil(this._vdisY-d);this.drawAllCanvas(a,b)}if(this._timer<140){this._sprTopBoard.y+=this._boardSpeed;if(this._sprTopBoard.y>0){this._sprTopBoard.y=0}this._sprBotBoard.y-=this._boardSpeed;if(this._sprBotBoard.y<298){this._sprBotBoard.y=298}}this._sprTopBoard.x+=this._boardSpeed;if(this._sprTopBoard.x>=-16){this._sprTopBoard.x=-32}this._sprBotBoard.x+=this._boardSpeed;if(this._sprBotBoard.x>=-16){this._sprBotBoard.x=-32}this.drawWarningImage(true)}else{if(this._timer<310){if(this._timer<250){var c=250-this._timer;if(this._scale>1){this._scale/=1.021}if(this._scale<1){this._scale=1}var d=(416-416/this._scale)/2;this._bgCanvas.clearRect(0,0,416,416);this._bgCanvas.save();this._bgCanvas.scale(this._scale,this._scale);var a=Math.ceil(this._vdisX*c/50-d);var b=Math.ceil(this._vdisY*c/50-d);this.drawAllCanvas(a,b)}else{if(this._timer==250){this._scale=1;this._bgCanvas.clearRect(0,0,416,416)}}this._sprTopBoard.y-=this._boardSpeed;this._sprTopBoard.x+=this._boardSpeed;if(this._sprTopBoard.x>=-16){this._sprTopBoard.x=-32}this._sprBotBoard.y+=this._boardSpeed;this._sprBotBoard.x+=this._boardSpeed;if(this._sprBotBoard.x>=-16){this._sprBotBoard.x=-32}this.drawWarningImage(false)}}this._sprites.forEach(function(e){core.relocateCanvas(e.name,e.x,e.y)});if(this._timer>310){this._isWarning=false}this._timer++};this.endWarning=function(){this._sprites.forEach(function(a){core.deleteCanvas(a.name)});core.deleteCanvas("viewport");delete this._boardSpeed;delete this._warningSpeed;delete this._centerX;delete this._centerY;delete this._sprTopBoard;delete this._sprBotBoard;delete this._sprWar1;delete this._sprWar2;delete this._sprWar3;delete this._bgCanvas;delete this._sprites;delete this._timer;delete this._isWarning;delete this._vdisX;delete this._vdisY;delete this._warningSprs;delete this._warningCanvas;delete this._opacityDec;delete this._opacity}},spriteFlasher:function(){["up","down","left","right"].forEach(function(e){core.material.icons.hero[e].midFoot=2});this.my_animationFrame_heroMoving=function(e){core.plugin.updateHeroDrawMain();if(core.status.heroMoving<=0){return}if(e-core.animateFrame.moveTime>core.values.moveSpeed){core.animateFrame.leftLeg++;core.animateFrame.moveTime=e}core.drawHero(["stop","leftFoot","midFoot","rightFoot"][core.animateFrame.leftLeg%4],4*core.status.heroMoving)};core.registerAnimationFrame("heroMoving",true,"my_animationFrame_heroMoving");this.initSpriteFlasher=function(){this._baseViewport=core.ui.getContextByName("fg2");this._rootSprite=new a()};function b(g,i,f,e){this.x=g;this.y=i;this.w=f;this.h=e;this.set=function(k,l,j,h){this.x=k;this.y=l;this.w=j;this.h=h}}function a(){this.initialize.apply(this,arguments)}a.prototype.initialize=function(){this._bitmap=null;this.opacity=1;this.x=0;this.y=0;this.rect=new b(0,0,0,0);this.visible=true;this.angel=0;this.parent=null;this.scale=1;this._children=[];this._locked=false};a.prototype.setLock=function(e){this._locked=e};a.prototype.render=function(i,g,h){var e=this.x+g;var f=this.y+h;if(this.bitmap&&this.visible){i.globalAlpha=this.opacity;if(this.angel){i.save();i.rotate(this.angel*Math.PI/180)}if(this.scale==1){i.drawImage(this.bitmap,this.rect.x,this.rect.y,this.rect.w,this.rect.h,e,f,this.rect.w,this.rect.h)}else{i.drawImage(this.bitmap,this.rect.x,this.rect.y,this.rect.w,this.rect.h,e,f,this.rect.w*this.scale,this.rect.h*this.scale)}if(this.angel){i.restore()}}if(this.visible){this._children.forEach(function(j){j.render(i,e,f)})}};a.prototype.canvasToLocalX=function(f){var e=this;while(e){f-=e.x;e=e.parent}return f};a.prototype.canvasToLocalY=function(f){var e=this;while(e){f-=e.y;e=e.parent}return f};a.prototype.isPosOver=function(e,f){if(this._locked){return false}var e=this.canvasToLocalX(e);var f=this.canvasToLocalY(f);return e>=0&&f>=0&&e<this.rect.w&&f<this.rect.h};a.prototype.addChild=function(e){this._children.push(e);e.parent=this};a.prototype.addChildAt=function(f,e){this._children.splice(e,0,f);f.parent=this};a.prototype.removeChild=function(f){var e=this._children.indexOf(f);if(e>=0){this._children.splice(e,1)}};a.prototype.clearChild=function(){this._children=[]};a.prototype.setChilds=function(e){this._children=e;this._children.forEach(function(f){f.parent=this},this)};a.prototype.update=function(){this._children.forEach(function(e){e.update()})};a.prototype.onBitmapLoaded=function(){};Object.defineProperties(a.prototype,{bitmap:{set:function(e){if(this._bitmap==e){return}this.rect.x=0;this.rect.y=0;if(e){this.rect.w=e.width;this.rect.h=e.height}else{this.rect.w=0;this.rect.h=0}this._bitmap=e;this.onBitmapLoaded()},get:function(){return this._bitmap}}});function c(){this.initialize.apply(this,arguments)}c.prototype=Object.create(a.prototype);c.prototype.constructor=c;c.prototype.initialize=function(e,j,k,h,i,g,f){a.prototype.initialize.call(this);this._srcBitmap=document.createElement("canvas");this._srcBitmap.width=g;this._srcBitmap.height=f;this._canvas=document.createElement("canvas");this._canvas.width=2;this._canvas.height=2;this._context=this._canvas.getContext("2d");this.bitmap=this._canvas;if(core.bigmap.width>13||core.bigmap.height>13){this.x=(j-core.bigmap.posX+1)*32-(g-32)/2;this.y=(k-core.bigmap.posY+1)*32-(f-32)}else{this.x=j*32-(g-32)/2;this.y=k*32-(f-32)}this._timer=0;this.createParticle(e,h,i,g,f)};c.prototype.createParticle=function(e,r,s,q,p){var g=this._srcBitmap.getContext("2d");g.drawImage(e,r,s,q,p,0,0,q,p);var h=g.getImageData(0,0,q,p).data;var l=h.length;var t=2;for(var j=0;j<l;j+=8*t){var k=Math.floor(j/4);if(Math.floor(k/q)%2==0){if(h[j+3]>0){var m=k%q;var n=Math.floor(k/q);var f="#"+h[j].toString(16)+h[j+1].toString(16)+h[j+2].toString(16);var o=new d(m,n,f);this.addChild(o)}}}};c.prototype.updateEffect=function(){this._timer++;if(this._timer>=60){this.parent.removeChild(this)}};c.prototype.update=function(){a.prototype.update.call(this);this.updateEffect()};function d(){this.initialize.apply(this,arguments)}d.prototype=Object.create(a.prototype);d.prototype.constructor=d;d.prototype.initialize=function(f,g,e){a.prototype.initialize.call(this);this._canvas=document.createElement("canvas");this._canvas.width=3;this._canvas.height=3;this._context=this._canvas.getContext("2d");this.bitmap=this._canvas;this._context.fillStyle=e;this._context.fillRect(0,0,3,3);this.x=f;this.y=g;this.vx=-0.5+Math.random();this.vy=-0.5+Math.random();this.dx=f;this.dy=g;this._timer=0};d.prototype.updateEffect=function(){this._timer++;if(this._timer<60){this.opacity=(60-this._timer)/60;this.dx+=this.vx;this.dy+=this.vy;if(this._timer%5==0){this.vx+=-0.1+Math.random()*0.2}this.x=Math.round(this.dx);this.y=Math.round(this.dy)}else{this.visible=false}};d.prototype.update=function(){this.updateEffect()};d.prototype.render=function(i,g,h){var e=this.x+g;var f=this.y+h;if(this.bitmap&&this.visible){i.globalAlpha=this.opacity;i.drawImage(this.bitmap,e,f)}};this.flashHide=function(k,l){if(core.isReplaying()||core.getFlag("no_flashHide",0)==1){return}if(core.bigmap.width>13||core.bigmap.height>13){return}var e=core.getBlock(k,l);if(e){var j=e.event.cls;var h=0;var i=core.icons.icons[j][e.event.id]*e.event.height;var f=core.material.images[j];var g=new c(f,e.x,e.y,h,i,32,e.event.height);this._rootSprite.addChild(g)}};this.updateHeroDrawMain=function(){this._rootSprite.update();this._baseViewport.canvas.width=this._baseViewport.canvas.width;this._rootSprite.render(this._baseViewport,0,0)};this.clearSpriteFlasher=function(){this._rootSprite.clearChild()}},talentTree:function(){var h=[{name:"攻击强化",images:["talent0.png",64,30],description:function(i){var j=[0,500,1000,1500,2000,3000][i];return"增加"+j+"点基础攻击"},cost:function(l){var i=[30,60,-1,300][l];var k=core.status.hero.money>=i;if(l<2||l==3){return(k?"\r[green]":"\r[yellow]")+"提升需消耗"+i+"金币\r"}else{if(l==2){k=core.getFlag("talent0_up2",0)>=50;return(k?"\r[green]":"\r[yellow]")+"提升需打败50只怪物("+core.getFlag("talent0_up2",0)+"/50)\r"}else{if(l==4){var j=core.getTalentLv(1)>=5&&core.getTalentLv(2)>=5;k=core.itemCount("yellowGem")>=5&&!j;return(j?"\r[red]":(k?"\r[green]":"\r[yellow]"))+"提升需防御和护盾强化之一未达到5级，并消耗5颗黄宝石("+core.itemCount("yellowGem")+"/5)\r"}}}return"已达到满级。"},upgrade:function(k){var i=[30,60,-1,300][k];var j=core.status.hero.money>=i;if((k<2||k==3)&&j){core.addFlag("talent0_lv",1);core.status.hero.atk+=500;core.status.hero.money-=i;return true}j=core.getFlag("talent0_up2",0)>=50;if(k==2&&j){core.addFlag("talent0_lv",1);core.status.hero.atk+=500;if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【攻击强化】已提升至\r[yellow]3\r级。")}return true}j=core.itemCount("yellowGem")>=5&&(core.getTalentLv(1)<5||core.getTalentLv(2)<5);if(k==4&&j){core.addFlag("talent0_lv",1);core.status.hero.atk+=1000;core.getItem("yellowGem",-5);if(core.getFlag("talent3_spe4","disabled")=="disabled"){core.setFlag("talent3_spe4","atk")}else{core.setFlag("talent3_spe7","atk")}core.drawHeroAnimate("yongchang");if(core.getFlag("autoUpgradeTalent",0)>0&&(core.getTalentLv(3)==4||core.getTalentLv(3)==7)){core.plugin._tryUpgrade(3)}return true}return false},maxlv:5},{name:"防御强化",images:["talent1.png",144,30],description:function(i){var j=[0,500,1000,1500,2000,3000][i];return"增加"+j+"点基础防御"},cost:function(l){var i=[30,60,-1,300][l];var k=core.status.hero.money>=i;if(l<2||l==3){return(k?"\r[green]":"\r[yellow]")+"提升需消耗"+i+"金币\r"}else{if(l==2){k=core.getFlag("talent1_up2",0)>=50;return(k?"\r[green]":"\r[yellow]")+"提升需打败50只怪物("+core.getFlag("talent1_up2",0)+"/50)\r"}else{if(l==4){var j=core.getTalentLv(0)>=5&&core.getTalentLv(2)>=5;k=core.itemCount("yellowGem")>=5&&!j;return(j?"\r[red]":(k?"\r[green]":"\r[yellow]"))+"提升需攻击和护盾强化之一未达到5级，并消耗5颗黄宝石("+core.itemCount("yellowGem")+"/5)\r"}}}return"已达到满级。"},upgrade:function(k){var i=[30,60,-1,300][k];var j=core.status.hero.money>=i;if((k<2||k==3)&&j){core.addFlag("talent1_lv",1);core.status.hero.def+=500;core.status.hero.money-=i;return true}j=core.getFlag("talent1_up2",0)>=50;if(k==2&&j){core.addFlag("talent1_lv",1);core.status.hero.def+=500;if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【防御强化】已提升至\r[yellow]3\r级。")}return true}j=core.itemCount("yellowGem")>=5&&(core.getTalentLv(0)<5||core.getTalentLv(2)<5);if(k==4&&j){core.addFlag("talent1_lv",1);core.status.hero.def+=1000;core.getItem("yellowGem",-5);if(core.getFlag("talent3_spe4","disabled")=="disabled"){core.setFlag("talent3_spe4","def")}else{core.setFlag("talent3_spe7","def")}core.drawHeroAnimate("yongchang");if(core.getFlag("autoUpgradeTalent",0)>0&&(core.getTalentLv(3)==4||core.getTalentLv(3)==7)){core.plugin._tryUpgrade(3)}return true}return false},maxlv:5},{name:"护盾强化",images:["talent2.png",224,30],description:function(i){var j=[0,2500,5000,7500,10000,15000][i];return"增加"+j+"点基础护盾"},cost:function(l){var i=[30,60,-1,300][l];var k=core.status.hero.money>=i;if(l<2||l==3){return(k?"\r[green]":"\r[yellow]")+"提升需消耗"+i+"金币\r"}else{if(l==2){k=core.getFlag("talent2_up2",0)>=50;return(k?"\r[green]":"\r[yellow]")+"提升需打败50只怪物("+core.getFlag("talent2_up2",0)+"/50)\r"}else{if(l==4){var j=core.getTalentLv(0)>=5&&core.getTalentLv(1)>=5;k=core.itemCount("yellowGem")>=5&&!j;return(j?"\r[red]":(k?"\r[green]":"\r[yellow]"))+"提升需攻击和防御强化之一未达到5级，并消耗5颗黄宝石("+core.itemCount("yellowGem")+"/5)\r"}}}return"已达到满级。"},upgrade:function(k){var i=[30,60,-1,300][k];var j=core.status.hero.money>=i;if((k<2||k==3)&&j){core.addFlag("talent2_lv",1);core.status.hero.mdef+=2500;core.status.hero.money-=i;return true}j=core.getFlag("talent2_up2",0)>=50;if(k==2&&j){core.addFlag("talent2_lv",1);core.status.hero.mdef+=2500;if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【护盾强化】已提升至\r[yellow]3\r级。")}return true}j=core.itemCount("yellowGem")>=5&&(core.getTalentLv(0)<5||core.getTalentLv(1)<5);if(k==4&&j){core.addFlag("talent2_lv",1);core.status.hero.mdef+=5000;core.getItem("yellowGem",-5);if(core.getFlag("talent3_spe4","disabled")=="disabled"){core.setFlag("talent3_spe4","mdef")}else{core.setFlag("talent3_spe7","mdef")}core.drawHeroAnimate("yongchang");if(core.getFlag("autoUpgradeTalent",0)>0&&(core.getTalentLv(3)==4||core.getTalentLv(3)==7)){core.plugin._tryUpgrade(3)}return true}return false},maxlv:5},{name:"神秘力量",images:["talent3.png",304,30],description:function(j){var i=["无效果。","获得技能【轻风】：将面前的敌人往后推一格，消耗50能量。对拥有特殊头衔的敌人无效。","强化【能量回复】：战斗后回复能量+1。","攻击、防御、护盾提升30%","强化【能量回复】：战斗后回复能量+1。能量块回复效果增加10点","在攻击、防御、护盾三项强化中，最先到达5级的属性提升100%","强化【轻风】：能量消耗减少为40点，并且推动距离变为无限。","强化【能量回复】：进行一次总伤害不大于0的战斗后，回复10能量。","在攻击、防御、护盾三项强化中，第二个到达5级的属性提升100%","强化【轻风】：面前为空地时会推动自己，路径上不会触发地图事件。"];return i[j]},cost:function(j){var i=core.status.hero.money>=1;if(j==0){return(i?"\r[green]":"\r[yellow]")+"提升需消耗1金币\r"}else{if(j==1){i=core.getFlag("talent3_up1",0)>=5;return(i?"\r[green]":"\r[yellow]")+"提升需打败5只怪物("+core.getFlag("talent3_up1",0)+"/5)\r"}else{if(j==2){i=core.getFlag("talent3_up2_spe",0)>=10;return(i?"\r[green]":"\r[yellow]")+"提升需进行10次总伤害不大于0的战斗("+core.getFlag("talent3_up2_spe",0)+"/10)\r"}else{if(j==3){i=core.getFlag("talent3_up3_spe",0)>=20;return(i?"\r[green]":"\r[yellow]")+"提升需开启20个黄门("+core.getFlag("talent3_up3_spe",0)+"/20)\r"}else{if(j==4){i=core.getFlag("talent3_spe4","disabled")!="disabled";return(i?"\r[green]":"\r[yellow]")+"提升需攻击/防御/护盾强化中任意一项达到5级\r"}else{if(j==5){i=core.getFlag("talent3_up5_spe",0)>=20;return(i?"\r[green]":"\r[yellow]")+"提升需使用20次【轻风】("+core.getFlag("talent3_up5_spe",0)+"/20)\r"}else{if(j==6){i=core.getFlag("talent3_up6_spe",0)>=50;return(i?"\r[green]":"\r[yellow]")+"提升需进行50次总伤害不大于0的战斗("+core.getFlag("talent3_up6_spe",0)+"/50)\r"}else{if(j==7){i=core.getFlag("talent3_spe7","disabled")!="disabled";return(i?"\r[green]":"\r[yellow]")+"提升需攻击/防御/护盾强化中任意两项达到5级\r"}else{if(j==8){if(flags.hard==1){i=core.getFlag("talent3_up8_spe",0)>=35;return(i?"\r[green]":"\r[yellow]")+"提升需使用35次【轻风】("+core.getFlag("talent3_up8_spe",0)+"/35)\r"}i=core.getFlag("talent3_up8_spe",0)>=50;return(i?"\r[green]":"\r[yellow]")+"提升需使用50次【轻风】("+core.getFlag("talent3_up8_spe",0)+"/50)\r"}}}}}}}}}return"已达到满级"},upgrade:function(j){var i=core.status.hero.money>=1;if(j==0&&i){core.status.hero.money-=1;core.addFlag("talent3_lv",1);core.getItem("skill3",1);core.setFlag("skill3_cost",50);return true}if(j==1){i=core.getFlag("talent3_up1",0)>=5;if(i){core.addFlag("talent3_lv",1);core.addFlag("mana_regen",1);if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【神秘力量】已提升至\r[yellow]2\r级。\n效果：战斗后回复能量+1。")}return true}}else{if(j==2){i=core.getFlag("talent3_up2_spe",0)>=10;if(i){core.addFlag("talent3_lv",1);core.plugin.addValpp("atk",30);core.plugin.addValpp("def",30);core.plugin.addValpp("mdef",30);if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【神秘力量】已提升至\r[yellow]3\r级。\n效果：攻击、防御、护盾提升30%")}return true}}else{if(j==3){i=core.getFlag("talent3_up3_spe",0)>=20;if(i){core.addFlag("mana_regen",1);core.addFlag("mana_item",10);core.plugin.clearItemDetailCache("manaItem");core.plugin.clearItemDetailCache("bigManaitem");core.addFlag("talent3_lv",1);if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【神秘力量】已提升至\r[yellow]4\r级。\n效果：战斗后回复能量+1。能量块回复效果增加10点");core.plugin._tryUpgrade(3)}return true}}else{if(j==4){i=core.getFlag("talent3_spe4","disabled")!="disabled";if(i){core.addFlag("talent3_lv",1);core.addValpp(core.getFlag("talent3_spe4"),100);if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【神秘力量】已提升至\r[yellow]5\r级。\n效果：在攻击、防御、护盾三项强化中，最先到达5级的属性提升100%")}return true}}else{if(j==5){i=core.getFlag("talent3_up5_spe",0)>=20;if(i){core.addFlag("talent3_lv",1);core.setFlag("skill3_cost",40);core.setFlag("skill3_range",2221);if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【神秘力量】已提升至\r[yellow]6\r级。\n效果：【轻风】能量消耗减少为40点，并且推动距离变为无限。")}return true}}else{if(j==6){i=core.getFlag("talent3_up6_spe",0)>=50;if(i){core.setFlag("I62_extra_description","，若战斗总伤害不大于0，额外回复10点能量");core.setFlag("I62_extra_mana_regen",10);core.addFlag("talent3_lv",1);if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【神秘力量】已提升至\r[yellow]7\r级。\n效果：进行一次总伤害不大于0的战斗后，回复10能量。");core.plugin._tryUpgrade(3)}return true}}else{if(j==7){i=core.getFlag("talent3_spe7","disabled")!="disabled";if(i){core.addFlag("talent3_lv",1);core.addValpp(core.getFlag("talent3_spe7"),100);if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【神秘力量】已提升至\r[yellow]8\r级。\n效果：在攻击、防御、护盾三项强化中，第二个到达5级的属性提升100%")}return true}}else{if(j==8){i=core.getFlag("talent3_up8_spe",0)>=50;if(flags.hard==1){i=core.getFlag("talent3_up8_spe",0)>=35}if(i){core.addFlag("talent3_lv",1);core.setFlag("skill3_push_self",1);core.setFlag("skill3_extra_description","面前为空地时会推动自己。");if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【神秘力量】已提升至\r[yellow]9\r级。\n效果：面前为空地时使用【轻风】会推动自己，路径上不会触发地图事件。")}return true}}}}}}}}}return false},reading:"提供各种永久类的增益，有着奇特的作用",maxlv:9},{name:"先手突袭",images:["talent4.png",44,110],description:function(j){var i=["首次攻击时额外附加0次攻击","首次攻击时额外附加1次攻击","首次攻击时额外附加2次攻击","首次攻击时额外附加3次攻击"];return i[j]},cost:function(k){var j=core.plugin.getTalentLv(0)>=5&&core.status.hero.money>=300&&core.itemCount("yellowGem")>=3;if(k==0){var i=core.getTalentLv(1)>=5&&core.getTalentLv(2)>=5;if(i){return"\r[red]提升需攻击强化达到5级，并消耗300金币和3黄宝石\r"}return(j?"\r[green]":"\r[yellow]")+"提升需攻击强化达到5级，并消耗300金币和3黄宝石\r"}else{if(k==1){j=core.getFlag("talent4_up1",0)>=50;return"提升需打败"+(j?"\r[green]":"\r[yellow]")+"50只怪物("+core.getFlag("talent4_up1",0)+"/50)\r"}else{if(k==2){j=core.status.hero.money>=1000;return(j?"\r[green]":"\r[yellow]")+"提升需消耗1000金币\r"}}}return"已达到满级"},upgrade:function(j){var i=core.plugin.getTalentLv(0)>=5&&core.status.hero.money>=300&&core.itemCount("yellowGem")>=3;if(j==0&&i){core.status.hero.money-=300;core.getItem("yellowGem",-3);core.addFlag("talent4_lv",1);return true}else{if(j==1){i=core.getFlag("talent4_up1",0)>=50;if(i){core.addFlag("talent4_lv",1);if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【先手突袭】已提升至\r[yellow]2\r级。\n效果：首次攻击时额外附加2次攻击")}return true}}else{if(j==2){i=core.status.hero.money>=1000;if(i){core.status.hero.money-=1000;core.addFlag("talent4_lv",1);return true}}}}return false},maxlv:3,reading:"用狂风骤雨般的攻击快速击败对手"},{name:"穿甲攻击",images:["talent5.png",84,110],description:function(j){var i=["无视对方0%防御力","无视对方10%防御力","无视对方20%防御力","无视对方30%防御力"];return i[j]},cost:function(k){var j=core.plugin.getTalentLv(0)>=5&&core.status.hero.money>=300&&core.itemCount("yellowGem")>=3;if(k==0){var i=core.getTalentLv(1)>=5&&core.getTalentLv(2)>=5;if(i){return"\r[red]提升需攻击强化达到5级，并消耗300金币和3黄宝石\r"}return(j?"\r[green]":"\r[yellow]")+"提升需攻击强化达到5级，并消耗300金币和3黄宝石\r"}else{if(k==1){j=core.getFlag("talent5_up1",0)>=50;return"提升需打败"+(j?"\r[green]":"\r[yellow]")+"50只怪物("+core.getFlag("talent5_up1",0)+"/50)\r"}else{if(k==2){j=core.status.hero.money>=1000;return(j?"\r[green]":"\r[yellow]")+"提升需消耗1000金币\r"}}}return"已达到满级"},upgrade:function(j){var i=core.plugin.getTalentLv(0)>=5&&core.status.hero.money>=300&&core.itemCount("yellowGem")>=3;if(j==0&&i){core.status.hero.money-=300;core.getItem("yellowGem",-3);core.addFlag("talent5_lv",1);return true}else{if(j==1){i=core.getFlag("talent5_up1",0)>=50;if(i){core.addFlag("talent5_lv",1);if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【穿甲攻击】已提升至\r[yellow]2\r级。\n效果：无视对方20%防御力")}return true}}else{if(j==2){i=core.status.hero.money>=1000;if(i){core.status.hero.money-=1000;core.addFlag("talent5_lv",1);return true}}}}return false},maxlv:3,reading:"专门打击对手弱点"},{name:"越战越强",images:["talent6.png",124,110],description:function(j){var i=["战斗中，每回合提升0%减伤，最多提升0%。","战斗中，每回合提升1%减伤，最多提升30%。","战斗中，每回合提升2%减伤，最多提升40%。","战斗中，每回合提升3%减伤，最多提升50%。"];return i[j]},cost:function(k){var j=core.plugin.getTalentLv(1)>=5&&core.status.hero.money>=300&&core.itemCount("yellowGem")>=3;if(k==0){var i=core.getTalentLv(0)>=5&&core.getTalentLv(2)>=5;if(i){return"\r[red]提升需防御强化达到5级，并消耗300金币和3黄宝石\r"}return(j?"\r[green]":"\r[yellow]")+"提升需防御强化达到5级，并消耗300金币和3黄宝石\r"}else{if(k==1){j=core.getFlag("talent6_up1",0)>=50;return"提升需打败"+(j?"\r[green]":"\r[yellow]")+"50只怪物("+core.getFlag("talent6_up1",0)+"/50)\r"}else{if(k==2){j=core.status.hero.money>=1000;return(j?"\r[green]":"\r[yellow]")+"提升需消耗1000金币\r"}}}return"已达到满级"},upgrade:function(j){var i=core.plugin.getTalentLv(1)>=5&&core.status.hero.money>=300&&core.itemCount("yellowGem")>=3;if(j==0&&i){core.status.hero.money-=300;core.getItem("yellowGem",-3);core.addFlag("talent6_lv",1);return true}else{if(j==1){i=core.getFlag("talent6_up1",0)>=50;if(i){core.addFlag("talent6_lv",1);if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【越战越强】已提升至\r[yellow]2\r级。\n效果：战斗中，每回合提升2%减伤，最多提升40%。")}return true}}else{if(j==2){i=core.status.hero.money>=1000;if(i){core.status.hero.money-=1000;core.addFlag("talent6_lv",1);return true}}}}return false},maxlv:3,reading:"越打越硬。注：减伤计算早于护盾"},{name:"化防为盾",images:["talent7.png",164,110],description:function(j){var i=["战斗中，每回合获得相当于0%防御力的护盾。","战斗中，每回合获得相当于2%防御力的护盾。","战斗中，每回合获得相当于4%防御力的护盾。","战斗中，每回合获得相当于6%防御力的护盾。"];return i[j]},cost:function(k){var j=core.plugin.getTalentLv(1)>=5&&core.status.hero.money>=300&&core.itemCount("yellowGem")>=3;if(k==0){var i=core.getTalentLv(0)>=5&&core.getTalentLv(2)>=5;if(i){return"\r[red]提升需防御强化达到5级，并消耗300金币和3黄宝石\r"}return(j?"\r[green]":"\r[yellow]")+"提升需防御强化达到5级，并消耗300金币和3黄宝石\r"}else{if(k==1){j=core.getFlag("talent7_up1",0)>=50;return"提升需打败"+(j?"\r[green]":"\r[yellow]")+"50只怪物("+core.getFlag("talent7_up1",0)+"/50)\r"}else{if(k==2){j=core.status.hero.money>=1000;return(j?"\r[green]":"\r[yellow]")+"提升需消耗1000金币\r"}}}return"已达到满级"},upgrade:function(j){var i=core.plugin.getTalentLv(1)>=5&&core.status.hero.money>=300&&core.itemCount("yellowGem")>=3;if(j==0&&i){core.status.hero.money-=300;core.getItem("yellowGem",-3);core.addFlag("talent7_lv",1);return true}else{if(j==1){i=core.getFlag("talent7_up1",0)>=50;if(i){core.addFlag("talent7_lv",1);if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【化防为盾】已提升至\r[yellow]2\r级。\n效果：战斗中，每回合获得相当于4%防御力的护盾。")}return true}}else{if(j==2){i=core.status.hero.money>=1000;if(i){core.status.hero.money-=1000;core.addFlag("talent7_lv",1);return true}}}}return false},maxlv:3,reading:"真空把的克星。"},{name:"强化护盾",images:["talent8.png",204,110],description:function(j){var i=["每点护盾额外抵挡0点伤害","每点护盾额外抵挡0.4点伤害","每点护盾额外抵挡0.7点伤害","每点护盾额外抵挡1点伤害"];return i[j]},cost:function(k){var j=core.plugin.getTalentLv(2)>=5&&core.status.hero.money>=300&&core.itemCount("yellowGem")>=3;if(k==0){var i=core.getTalentLv(0)>=5&&core.getTalentLv(1)>=5;if(i){return"\r[red]提升需护盾强化达到5级，并消耗300金币和3黄宝石\r"}return(j?"\r[green]":"\r[yellow]")+"提升需护盾强化达到5级，并消耗300金币和3黄宝石\r"}else{if(k==1){j=core.getFlag("talent8_up1",0)>=50;return"提升需打败"+(j?"\r[green]":"\r[yellow]")+"50只怪物("+core.getFlag("talent8_up1",0)+"/50)\r"}else{if(k==2){j=core.status.hero.money>=1000;return(j?"\r[green]":"\r[yellow]")+"提升需消耗1000金币\r"}}}return"已达到满级"},upgrade:function(j){var i=core.plugin.getTalentLv(2)>=5&&core.status.hero.money>=300&&core.itemCount("yellowGem")>=3;var k=core.getFlag("mdef_ratio",1)*10;if(j==0&&i){core.status.hero.money-=300;core.getItem("yellowGem",-3);core.addFlag("talent8_lv",1);core.setFlag("mdef_ratio",(k+4)/10);return true}else{if(j==1){i=core.getFlag("talent8_up1",0)>=50;if(i){core.addFlag("talent8_lv",1);core.setFlag("mdef_ratio",(k+3)/10);if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【强化护盾】已提升至\r[yellow]2\r级。\n效果：每点护盾额外抵挡0.7点伤害")}return true}}else{if(j==2){i=core.status.hero.money>=1000;if(i){core.status.hero.money-=1000;core.addFlag("talent8_lv",1);core.setFlag("mdef_ratio",(k+3)/10);return true}}}}return false},maxlv:3,reading:"你害怕净化是因为你护盾不够高"},{name:"自闭防守",images:["talent9.png",244,110],description:function(j){var i=["减免0%自身首次攻击前受到的战斗伤害；受到的地图伤害减少0%护盾值。","减免30%自身首次攻击前受到的战斗伤害；受到的地图伤害减少1/3护盾值。","减免40%自身首次攻击前受到的战斗伤害；受到的地图伤害减少2/3护盾值。","减免50%自身首次攻击前受到的战斗伤害；受到的地图伤害减少1倍护盾值。"];return i[j]},cost:function(k){var j=core.plugin.getTalentLv(2)>=5&&core.status.hero.money>=300&&core.itemCount("yellowGem")>=3;if(k==0){var i=core.getTalentLv(0)>=5&&core.getTalentLv(1)>=5;if(i){return"\r[red]提升需护盾强化达到5级，并消耗300金币和3黄宝石\r"}return(j?"\r[green]":"\r[yellow]")+"提升需护盾强化达到5级，并消耗300金币和3黄宝石\r"}else{if(k==1){j=core.getFlag("talent9_up1",0)>=50;return"提升需打败"+(j?"\r[green]":"\r[yellow]")+"50只怪物("+core.getFlag("talent9_up1",0)+"/50)\r"}else{if(k==2){j=core.status.hero.money>=1000;return(j?"\r[green]":"\r[yellow]")+"提升需消耗1000金币\r"}}}return"已达到满级"},upgrade:function(j){var i=core.plugin.getTalentLv(2)>=5&&core.status.hero.money>=300&&core.itemCount("yellowGem")>=3;if(j==0&&i){core.status.hero.money-=300;core.getItem("yellowGem",-3);core.addFlag("talent9_lv",1);return true}else{if(j==1){i=core.getFlag("talent9_up1",0)>=50;if(i){core.addFlag("talent9_lv",1);if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【自闭防守】已提升至\r[yellow]2\r级。\n效果：减免40%自身首次攻击前受到的战斗伤害；受到的地图伤害减少2/3护盾值。")}return true}}else{if(j==2){i=core.status.hero.money>=1000;if(i){core.status.hero.money-=1000;core.addFlag("talent9_lv",1);return true}}}}return false},maxlv:3,reading:"在展开进攻前抵挡全方位的伤害"},{name:"旅行者",images:["talent10.png",64,190],description:function(j){var i=["未解锁","增加2000基础攻击和防御，拾取的血瓶效果增加20%","增加4000基础攻击和防御，拾取的血瓶效果增加40%"];return i[j]},cost:function(k){var j=core.getTalentLv(4)==3&&core.getTalentLv(5)==3&&core.getTalentLv(6)==3&&core.getTalentLv(7)==3&&core.itemCount("yellowGem")>=10&&core.status.hero.money>=2500;var i=core.getTalentLv(2)==5;if(k==0){return(i?"\r[red]":"")+"需前置天赋全满\r，消耗"+(j?"\r[green]":"\r[yellow]")+"10黄宝石和2500金币\r"}else{if(k==1){j=core.status.hero.money>=7500;return(j?"\r[green]":"\r[yellow]")+"提升需消耗7500金币\r"}else{if(k==114514){j=false;return"需累计拾取"+(j?"\r[green]":"\r[yellow]")+"114514个血瓶("+core.getFlag("talent10_up2_spe",0)+"/114514)\r"}}}return"已达到满级"},upgrade:function(j){var i=core.getTalentLv(4)==3&&core.getTalentLv(5)==3&&core.getTalentLv(6)==3&&core.getTalentLv(7)==3&&core.itemCount("yellowGem")>=10&&core.status.hero.money>=2500;if(j==0&&i){core.getItem("yellowGem",-10);core.status.hero.money-=2500;core.addFlag("talent10_lv",1);core.addFlag("potion_extra_ratio",2);core.setFlag("itemDetailCache",{});core.status.hero.atk+=2000;core.status.hero.def+=2000;return true}else{if(j==1){i=core.status.hero.money>=7500;if(i){core.status.hero.money-=7500;core.addFlag("talent10_lv",1);core.addFlag("potion_extra_ratio",2);core.setFlag("itemDetailCache",{});core.status.hero.atk+=2000;core.status.hero.def+=2000;return true}}else{if(core.getFlag("talent10_up2_spe",0)>=114514){core.addFlag("talent10_lv",1);core.addFlag("potion_extra_ratio",1);core.status.hero.atk+=2000;core.status.hero.def+=2000;return true}}}return false},maxlv:2,reading:"经典而朴素的体验"},{name:"探险者",images:["talent11.png",144,190],description:function(j){var i=["未解锁","增加2000基础攻击和护盾，首次攻击时造成50%攻击和护盾能力之和的技能伤害","增加4000基础攻击和护盾，首次攻击时造成100%攻击和护盾能力之和的技能伤害"];return i[j]},cost:function(k){var j=core.getTalentLv(4)==3&&core.getTalentLv(5)==3&&core.getTalentLv(8)==3&&core.getTalentLv(9)==3&&core.itemCount("yellowGem")>=10&&core.status.hero.money>=2500;var i=core.getTalentLv(1)==5;if(k==0){return(i?"\r[red]":"")+"需前置天赋全满\r，消耗"+(j?"\r[green]":"\r[yellow]")+"10黄宝石和2500金币\r"}else{if(k==1){j=core.status.hero.money>=7500;return(j?"\r[green]":"\r[yellow]")+"提升需消耗7500金币\r"}else{if(k==114514){j=false;return"需进行"+(j?"\r[green]":"\r[yellow]")+"114514次回合数不大于5的战斗("+core.getFlag("talent11_up2_spe",0)+"/114514)\r"}}}return"已达到满级"},upgrade:function(j){var i=core.getTalentLv(4)==3&&core.getTalentLv(5)==3&&core.getTalentLv(8)==3&&core.getTalentLv(9)==3&&core.itemCount("yellowGem")>=10&&core.status.hero.money>=2500;if(j==0&&i){core.getItem("yellowGem",-10);core.status.hero.money-=2500;core.addFlag("talent11_lv",1);core.status.hero.atk+=2000;core.status.hero.mdef+=2000;return true}else{if(j==1){i=core.status.hero.money>=7500;if(i){core.status.hero.money-=7500;core.addFlag("talent11_lv",1);core.status.hero.atk+=2000;core.status.hero.mdef+=2000;return true}}else{if(core.getFlag("talent11_up2_spe",0)>=114514){core.addFlag("talent11_lv",1);core.status.hero.atk+=2000;core.status.hero.mdef+=2000;return true}}}return false},maxlv:2,reading:"再也不怕被先攻怪打护盾影响伤害值了"},{name:"开拓者",images:["talent12.png",224,190],description:function(j){var i=["未解锁","增加2000基础防御和护盾，每5回合恢复10%防御值的生命，最多回复20次。","增加4000基础防御和护盾，每5回合恢复10%防御值的生命，最多回复30次。"];return i[j]},cost:function(k){var j=core.getTalentLv(6)==3&&core.getTalentLv(7)==3&&core.getTalentLv(8)==3&&core.getTalentLv(9)==3&&core.itemCount("yellowGem")>=10&&core.status.hero.money>=2500;var i=core.getTalentLv(0)==5;if(k==0){return(i?"\r[red]":"")+"需前置天赋全满\r，消耗"+(j?"\r[green]":"\r[yellow]")+"10黄宝石和2500金币\r"}else{if(k==1){j=core.status.hero.money>=7500;return(j?"\r[green]":"\r[yellow]")+"提升需消耗7500金币\r"}else{if(k==114514){j=false;return"需累计触发本技能"+(j?"\r[green]":"\r[yellow]")+"114514次("+core.getFlag("talent12_up2_spe",0)+"/114514)\r"}}}return"已达到满级"},upgrade:function(j){var i=core.getTalentLv(6)==3&&core.getTalentLv(7)==3&&core.getTalentLv(8)==3&&core.getTalentLv(9)==3&&core.itemCount("yellowGem")>=10&&core.status.hero.money>=2500;if(j==0&&i){core.getItem("yellowGem",-10);core.status.hero.money-=2500;core.addFlag("talent12_lv",1);core.status.hero.def+=2000;core.status.hero.mdef+=2000;return true}else{if(j==1){i=core.status.hero.money>=7500;if(i){core.status.hero.money-=7500;core.addFlag("talent12_lv",1);core.status.hero.def+=2000;core.status.hero.mdef+=2000;return true}}else{if(core.getFlag("talent12_up2_spe",0)>=114514){core.addFlag("talent12_lv",1);core.addFlag("talent12_lv",1);core.status.hero.def+=2000;core.status.hero.mdef+=2000;return true}}}return false},maxlv:2,reading:"改版的真空把"},{name:"鸽化",images:["talent13.png",304,190],description:function(j){var i=["未解锁。","暂时进入鸽化形态，冷却若干次战斗。"];if(core.getTalentLv(10)>0){i[1]="基础攻防提升10000，捡到的血瓶总效果变为3倍，无视地图伤害，但行走第x步时消耗2x能量，可主动取消。冷却10次战斗。"}else{if(core.getTalentLv(11)>0){i[1]="暂时获得5000攻击和25000护盾，在战斗中造成伤害的10%回复自身生命，但只能往同一个方向移动，否则在移动后效果消失。效果期间无法使用楼层传送器。消耗60能量，冷却8次战斗（使用后立即开始计算）。"}else{if(core.getTalentLv(12)>0){i[1]="暂时获得5000防御，每点护盾额外抵挡0.4点伤害，并在战斗后将护盾按吸收伤害的点数转化为生命值，但战斗的总伤害不能低于-3倍护盾值；第x次战斗后消耗20x点能量，可主动取消。冷却10次战斗。"}}}return i[j]},cost:function(j){var i=core.getFlag("talent13_enabled",false);if(j==0){return"提升需消耗"+(i?"\r[green]":"\r[yellow]")+"？？？\r"}return"已达到满级"},upgrade:function(j){var i=core.getFlag("talent13_enabled",false);if(i){if(core.getTalentLv(10)>0){core.setFlag("skill5_description","基础攻防提升10000，捡到的血瓶总效果变为3倍，无视地图伤害，但行走第x步时消耗2x能量，可主动取消。")}else{if(core.getTalentLv(11)>0){core.setFlag("skill5_description","暂时获得5000攻击和25000护盾，在战斗中造成伤害的10%回复自身生命，但只能往同一个方向移动，否则在移动后效果消失。效果期间无法使用楼层传送器。消耗60能量。")}else{if(core.getTalentLv(12)>0){core.setFlag("skill5_description","暂时获得5000防御，每点护盾额外抵挡0.4点伤害，并在战斗后将护盾按吸收伤害的点数转化为生命值，但战斗的总伤害不能低于-3倍护盾值；第x次战斗后消耗20x点能量，可主动取消。")}}}core.getItem("skill5");core.addFlag("talent13_lv",1);return true}return false},reading:"鸽者，诡道也。故鸽而示之不鸽，饼而示之非饼。",maxlv:1}];var c=[[0,4],[0,5],[1,6],[1,7],[2,8],[2,9]];var d=[[4,5,10],[6,7,10],[4,5,11],[8,9,11],[6,7,12],[8,9,12]];var e=[-1,-1,-1,-1,0,0,1,1,2,2,5,7,9,3];var g=[4,6,8,13,10,10,11,11,12,12,-1,-1,-1,-1];var b,f;var a="";this.getTalentLv=function(i){if(!core.hasItem("talentTree")){return 0}return core.getFlag("talent"+i+"_lv",0)};this.getTalentDescription=function(i){var j=h[i];var k=this.getTalentLv(i);var l=j.description(k)+"\n";if(k<j.maxlv){l+="\r[yellow]下一级\r："+j.cost(k)+"\n\r[gray]"+j.description(k+1)+"\r\n";l+="下一级的升级条件："+j.cost(k+1)+"\n"}if(j.reading){l+="\\c[14]"+j.reading+"\\c\n"}return l};this._inRect=function(i,j,k,l){return(i>=k)&&(i<=k+32)&&(j>=l)&&(j<=l+32)};this._drawEdge=function(j,l,k,m,i){if(l<m){core.drawLine("uievent",j,l+32,k,m,i)}else{core.drawLine("uievent",j,l,k,m+32,i)}};this._tryUpgrade=function(k){var i=h[k];var j=this.getTalentLv(k);if(j==i.maxlv){if(!core.isReplaying()){core.playSound("操作失败")}core.insertAction({type:"tip",text:"已升至最高等级，不可再升级！"});return}if(!i.upgrade(j)){if(!core.isReplaying()){core.playSound("操作失败")}core.insertAction({type:"tip",text:"升级条件不足！"});return}core.playSound("确定");core.insertAction({type:"tip",text:"升级成功！"});a=this.getTalentDescription(k);core.updateStatusBar()};this._drawSkillTree=function(){core.deleteCanvas("uievent");core.ui._createUIEvent();core.clearMap("uievent");core.ui._uievent_drawBackground({background:[0,0,0,0.85],x:0,y:0,width:416,height:416});var l=function(s){var r="#63FF63";var i="white";switch(s){case 0:if(core.getTalentLv(4)==3){return r}if(core.getTalentLv(0)==5){return i}break;case 1:if(core.getTalentLv(5)==3){return r}if(core.getTalentLv(0)==5){return i}break;case 2:if(core.getTalentLv(6)==3){return r}if(core.getTalentLv(1)==5){return i}break;case 3:if(core.getTalentLv(7)==3){return r}if(core.getTalentLv(1)==5){return i}break;case 4:if(core.getTalentLv(8)==3){return r}if(core.getTalentLv(2)==5){return i}break;case 5:if(core.getTalentLv(9)==3){return r}if(core.getTalentLv(2)==5){return i}break;case 6:if(core.getTalentLv(10)==2){return r}if(core.getTalentLv(4)==3&&core.getTalentLv(5)==3){return i}break;case 8:if(core.getTalentLv(11)==2){return r}if(core.getTalentLv(4)==3&&core.getTalentLv(5)==3){return i}break;case 7:if(core.getTalentLv(10)==2){return r}if(core.getTalentLv(6)==3&&core.getTalentLv(7)==3){return i}break;case 10:if(core.getTalentLv(12)==2){return r}if(core.getTalentLv(6)==3&&core.getTalentLv(7)==3){return i}break;case 9:if(core.getTalentLv(11)==2){return r}if(core.getTalentLv(8)==3&&core.getTalentLv(9)==3){return i}break;case 11:if(core.getTalentLv(12)==2){return r}if(core.getTalentLv(8)==3&&core.getTalentLv(9)==3){return i}break}return"gray"};for(var m in c){this._drawEdge(h[c[m][0]].images[1]+16,h[c[m][0]].images[2],h[c[m][1]].images[1]+16,h[c[m][1]].images[2],l(Number(m)))}for(var m in d){this._drawEdge((h[d[m][0]].images[1]+h[d[m][1]].images[1])/2+16,h[d[m][0]].images[2],h[d[m][2]].images[1]+16,h[d[m][2]].images[2],l(Number(m)+6))}for(var m in h){core.drawImage("uievent",h[m].images[0],h[m].images[1],h[m].images[2]);var p=h[m].images[1],q=h[m].images[2];if(m==b){var o=2;core.ui.strokeRoundRect("uievent",p-o,q-o,32+2*o,32+2*o,o,"#FFFF00",o)}if(core.getTalentLv(m)<h[m].maxlv){var j="#FFFFFF";if(h[m].cost(core.getTalentLv(m)).indexOf("green")>0){j="#00FF00"}if(h[m].cost(core.getTalentLv(m)).indexOf("red")>0){j="#FF0000"}core.ui.fillText("uievent","("+core.getTalentLv(m)+"/"+h[m].maxlv+")",p,q+48,j,"15px Georgia")}}var k=h[b];var n=this.getTalentLv(b);core.ui._uievent_drawTextContent({text:"\r[yellow]【"+k.name+"】("+n+"/"+k.maxlv+")\r",left:10,top:245,maxWidth:396,align:"center"});core.ui._uievent_drawTextContent({text:a,left:10,top:265,maxWidth:396,align:"center"});core.ui._uievent_drawTextContent({text:"离开",left:368,top:388,bold:true,fontSize:20})};this._clickedSkill=function(k,l){for(var j in h){if(this._inRect(k,l,h[j].images[1],h[j].images[2])){f=b;b=Number(j);a=this.getTalentDescription(b);if(f==b){this._tryUpgrade(j)}}}if(k>=368&&l>=388){core.setFlag("talentTree_isOpen",false);if(!core.isReplaying()){core.playSound("取消")}core.setFlag("talentTree_last_current",b);return core.insertAction({type:"break"})}};this._keySkill=function(k){var j=0;switch(k){case 88:case 89:case 27:core.setFlag("talentTree_isOpen",false);if(!core.isReplaying()){core.playSound("取消")}core.setFlag("talentTree_last_current",b);core.insertAction({type:"break"});break;case 38:if(!core.isReplaying()){core.playSound("光标移动")}if(e[b]!=-1){f=b;b=e[b]}a=this.getTalentDescription(b);break;case 40:if(!core.isReplaying()){core.playSound("光标移动")}if(g[b]!=-1){f=b;b=g[b]}a=this.getTalentDescription(b);break;case 37:if(!core.isReplaying()){core.playSound("光标移动")}f=b;b-=1;if(b<0){b+=14}a=this.getTalentDescription(b);break;case 39:if(!core.isReplaying()){core.playSound("光标移动")}f=b;b+=1;if(b>=14){b-=14}a=this.getTalentDescription(b);break;case 13:case 32:this._tryUpgrade(b)}};this._activateSkill=function(){if(flags.type==0){this._keySkill(flags.keycode)}else{this._clickedSkill(flags.px,flags.py)}};this.openSkillTree=function(){clearTimeout(core.timeout.turnHeroTimeout);core.timeout.turnHeroTimeout=null;core.playSound("打开界面");core.setFlag("talentTree_isOpen",true);b=Number(core.getFlag("talentTree_last_current",0));f=-1;a=this.getTalentDescription(b);core.insertAction([{type:"while",condition:"true",data:[{type:"function","function":"function () { core.plugin._drawSkillTree(); }"},{type:"wait"},{type:"function","function":"function() { core.plugin._activateSkill(); }"}]},{type:"function","function":"function () { core.deleteCanvas('uievent');core.clearUI(); core.clearMap('uievent');}"}])}},talentTree2:function(){var h=[{name:"后抛",images:["talentT2_0.png",64,30],description:function(i){return"获得技能【后抛】：将面前的怪物抛到身后！背后是空地才能使用，消耗50能量。对拥有特殊头衔的对手无效。"},cost:function(i){return"已达到满级。"},upgrade:function(i){return false},canUpgrade:function(i){return false},reading:"胆小者和莽夫都喜欢",maxlv:1},{name:"气旋",images:["talentT2_1.png",144,30],description:function(i){if(i==0){return"未解锁"}var j=[0,0,1][i];return"身后非空地时也可以使用【后抛】！你会与对手战斗，使对方的先攻类效果失效，且对方被额外先攻"+j+"次"},cost:function(k){var i=[1500,4000][k];var j=core.status.hero.money>=i;if(k<2){return(j?"\r[green]":"\r[yellow]")+"提升需消耗"+i+"金币\r"}return"已达到满级。"},upgrade:function(k){var i=[1500,4000][k];var l=[0,0,1][k+1];var j=core.status.hero.money>=i;if(k<2&&j){core.addFlag("talent2_1_lv",1);core.status.hero.money-=i;core.setFlag("skill6_battle_round",l);if(k==0){core.setFlag("skill6_extra_description","背后不是空地则强制战斗。")}else{core.setFlag("skill6_extra_description","背后不是空地则强制战斗，且对手被额外先攻"+l+"次。")}return true}return false},canUpgrade:function(j){if(j>=2){return false}var i=[1500,4000][j];return core.status.hero.money>=i},reading:"抛来抛去头好晕~",maxlv:2},{name:"跳跃",images:["talentT2_2.png",224,30],description:function(i){if(i==0){return"未解锁"}return"获得技能【跳跃】：跳向面前2格的空地，消耗200能量。能跃过空地、敌人或物品，不能跃过障碍物。"},cost:function(k){var i=6000;var j=core.status.hero.money>=i&&core.getTalentLv2(1)>=2;if(k<1){return(j?"\r[green]":"\r[yellow]")+"提升需气旋达到2级，并消耗"+i+"金币\r"}return"已达到满级。"},upgrade:function(k){var i=6000;var j=core.status.hero.money>=i&&core.getTalentLv2(1)>=2;if(k==0&&j){core.status.hero.money-=i;core.getItem("skill8",1);core.setFlag("skill8_extra_description","能跃过空地、敌人或物品，不能跃过障碍物。");core.addFlag("talent2_2_lv",1);return true}return false},canUpgrade:function(i){if(i>=1){return false}return core.status.hero.money>=6000&&core.getTalentLv2(1)>=2},reading:"跳来跳去头好晕~",maxlv:1},{name:"大跳",images:["talentT2_3.png",304,30],description:function(i){if(i==0){return"未解锁"}return"【跳跃】可以越过墙或门！"},cost:function(j){var i=core.status.hero.money>=10000&&core.itemCount("yellowGem")>=10;if(j<1){return(i?"\r[green]":"\r[yellow]")+"提升需消耗10000金币和10黄宝石\r"}return"已达到满级"},upgrade:function(j){var i=core.status.hero.money>=10000&&core.itemCount("yellowGem")>=10;if(j<1&&i){core.status.hero.money-=10000;core.getItem("yellowGem",-10);core.addFlag("talent2_3_lv",1);core.setFlag("skill8_extra_description","可以跃过墙或门。");return true}return false},canUpgrade:function(i){if(i>=1){return false}return core.status.hero.money>=10000&&core.itemCount("yellowGem")>=10},reading:"如入无人之境",maxlv:1},{name:"潜行",images:["talentT2_4.png",64,110],description:function(i){if(i==0){return"未解锁"}return"获得技能【潜行】：进入隐身状态，无视地图伤害，直到发起战斗或主动退出。消耗100能量。"},cost:function(j){if(j==1){return"已达到满级。"}var i=core.itemCount("yellowGem")>=2;return(i?"\r[green]":"\r[yellow]")+"提升需消耗2颗黄宝石("+core.itemCount("yellowGem")+"/2)\r"},upgrade:function(j){if(j==1){return false}var i=core.itemCount("yellowGem")>=2;if(i){core.getItem("yellowGem",-2);core.addFlag("talent2_4_lv",1);core.setFlag("skill7_cost",100);core.setFlag("skill7_cancel_return_cost",0);core.getItem("skill7",1);return true}return false},canUpgrade:function(i){if(i>=1){return false}return core.itemCount("yellowGem")>=2},reading:"进行移动前就退出隐身会返还全部消耗的能量。",maxlv:1},{name:"偷袭",images:["talentT2_5.png",144,110],description:function(i){if(i==0){return"未解锁"}if(i==1){return"在隐身状态下发起战斗时，在战斗中降低敌人100000点防御。"}return"【潜行】消耗能量提升25点；通过总伤害不大于0的战斗、或移动后主动取消退出隐身时，返还50点能量。在隐身状态下发起战斗时，在战斗中降低敌人200000点防御。"},cost:function(k){var i=[4,6][k];var j=core.itemCount("yellowGem")>=i;if(k<2){return(j?"\r[green]":"\r[yellow]")+"提升需消耗"+i+"黄宝石("+core.itemCount("yellowGem")+"/"+i+")\r"}return"已达到满级。"},upgrade:function(k){var i=[4,6][k];var j=core.itemCount("yellowGem")>=i;if(j){if(k==0){core.getItem("yellowGem",-i);core.addFlag("talent2_5_lv",1);return true}else{if(k==1){core.getItem("yellowGem",-i);core.addFlag("talent2_5_lv",1);core.setFlag("skill7_cost",125);core.setFlag("skill7_cancel_return_cost",50);if(core.getFlag("invisible",0)&&!core.getFlag("invisible_moved",1)){core.setFlag("invisible_moved",2221)}return true}}}return false},canUpgrade:function(j){if(j>=2){return false}var i=[4,6][j];return core.itemCount("yellowGem")>=i},reading:"为什么隐身发起突袭还是会被对手先攻？\n因为对手实际上是完全闪避了前几回合的攻击。（强行解释，太屑了",maxlv:2},{name:"搬箱子",images:["talentT2_6.png",224,110],description:function(i){if(i==0){return"未解锁"}return"面前是黄门或物品时也可以使用【后抛】！"},cost:function(j){var i=core.status.hero.money>=7000&&core.itemCount("yellowGem")>=5&&core.getTalentLv2(1)>=2;if(j<1){return(i?"\r[green]":"\r[yellow]")+"提升需气旋达到2级，并消耗7000金币和5黄宝石\r"}return"已达到满级。"},upgrade:function(j){var i=core.status.hero.money>=7000&&core.itemCount("yellowGem")>=5&&core.getTalentLv2(1)>=2;if(j==0&&i){core.addFlag("talent2_6_lv",1);core.status.hero.money-=7000;core.getItem("yellowGem",-5);return true}return false},canUpgrade:function(i){if(i>=1){return false}return core.status.hero.money>=7000&&core.itemCount("yellowGem")>=5&&core.getTalentLv2(1)>=2},reading:"想要撬动黄门，或者使血瓶被抛起后不会摔碎，需要非常巧妙地控制魔法力量",maxlv:1},{name:"破竹之势",images:["talentT2_7.png",304,110],description:function(i){if(i==0){return"未解锁"}return"强化【跳跃】：使用跳跃后获得75%最终战斗减伤，持续到改变移动方向为止。"},cost:function(j){var i=core.status.hero.money>=10000&&core.itemCount("yellowGem")>=10&&core.getTalentLv2(3)==1;if(j<1){return(i?"\r[green]":"\r[yellow]")+"提升需解锁前置天赋，并消耗10000金币和10黄宝石\r"}return"已达到满级"},upgrade:function(j){var i=core.status.hero.money>=10000&&core.itemCount("yellowGem")>=10&&core.getTalentLv2(3)==1;if(j==0&&i){core.addFlag("talent2_7_lv",1);core.status.hero.money-=10000;core.getItem("yellowGem",-10);return true}return false},canUpgrade:function(i){if(i>=1){return false}return core.status.hero.money>=10000&&core.itemCount("yellowGem")>=10&&core.getTalentLv2(3)==1},reading:"一夜暴毙:rework",maxlv:1}];var c=[[0,1],[1,2],[2,3],[4,5]];var d=[[1,6],[3,7]];var e=[-1,-1,-1,-1,0,1,2,3];var g=[4,5,6,7,-1,-1,-1,-1];var b,f;var a="";this.getTalentLv2=function(i){if(!core.hasItem("talentTree2")){return 0}return core.getFlag("talent2_"+i+"_lv",0)};this.getTalentDescription2=function(i){var j=h[i];var k=this.getTalentLv2(i);var l=j.description(k)+"\n";if(k<j.maxlv){l+="\r[yellow]下一级\r："+j.cost(k)+"\n\r[gray]"+j.description(k+1)+"\r\n";l+="下一级的升级条件："+j.cost(k+1)+"\n"}if(j.reading){l+="\\c[14]"+j.reading+"\\c\n"}return l};this.canUpgradeTalent2=function(i){var j=this.getTalentLv2(i);return h[i].canUpgrade(j)};this._tryUpgrade2=function(k){var i=h[k];var j=this.getTalentLv2(k);if(j==i.maxlv){if(!core.isReplaying()){core.playSound("操作失败")}core.insertAction({type:"tip",text:"已升至最高等级，不可再升级！"});return}if(!i.upgrade(j)){if(!core.isReplaying()){core.playSound("操作失败")}core.insertAction({type:"tip",text:"升级条件不足！"});return}core.playSound("确定");core.insertAction({type:"tip",text:"升级成功！"});a=this.getTalentDescription2(k);core.updateStatusBar()};this._drawSkillTree2=function(){core.deleteCanvas("uievent");core.ui._createUIEvent();core.clearMap("uievent");core.ui._uievent_drawBackground({background:[0,0,0,0.85],x:0,y:0,width:416,height:416});var l=function(s){var i="#63FF63";switch(s){case 0:return i;case 1:if(core.getTalentLv2(1)==2){return i}break;case 2:if(core.getTalentLv2(2)==1){return i}break;case 3:if(core.getTalentLv2(4)==1){return i}break;case 4:if(core.getTalentLv2(1)==2){return i}break;case 5:if(core.getTalentLv2(3)==1){return i}break}return"gray"};var o=h;for(var m in c){this._drawEdge(o[c[m][0]].images[1]+32,o[c[m][0]].images[2]+16,o[c[m][1]].images[1],o[c[m][1]].images[2]-16,l(Number(m)))}for(var m in d){this._drawEdge(o[d[m][0]].images[1]+16,o[d[m][0]].images[2],o[d[m][1]].images[1]+16,o[d[m][1]].images[2],l(Number(m)+4))}for(var m in o){core.drawImage("uievent",o[m].images[0],o[m].images[1],o[m].images[2]);var q=o[m].images[1],r=o[m].images[2];if(m==b){var p=2;core.ui.strokeRoundRect("uievent",q-p,r-p,32+2*p,32+2*p,p,"#FFFF00",p)}if(core.getTalentLv2(m)<o[m].maxlv){var j="#FFFFFF";if(o[m].cost(core.getTalentLv2(m)).indexOf("green")>0){j="#00FF00"}if(o[m].cost(core.getTalentLv2(m)).indexOf("red")>0){j="#FF0000"}core.ui.fillText("uievent","("+core.getTalentLv2(m)+"/"+o[m].maxlv+")",q,r+48,j,"15px Georgia")}}var k=o[b];var n=this.getTalentLv2(b);core.ui._uievent_drawTextContent({text:"\r[yellow]【"+k.name+"】("+n+"/"+k.maxlv+")\r",left:10,top:175,maxWidth:396,align:"center"});core.ui._uievent_drawTextContent({text:a,left:10,top:195,maxWidth:396,align:"center"});core.ui._uievent_drawTextContent({text:"离开",left:368,top:388,bold:true,fontSize:20})};this._clickedSkill2=function(k,l){for(var j in h){if(this._inRect(k,l,h[j].images[1],h[j].images[2])){f=b;b=Number(j);if(!core.isReplaying()){core.playSound("光标移动")}a=this.getTalentDescription2(b);if(f==b){this._tryUpgrade2(j)}}}if(k>=368&&l>=388){core.setFlag("talentTree_isOpen",false);if(!core.isReplaying()){core.playSound("取消")}core.setFlag("talentTree_last_current",b);return core.insertAction({type:"break"})}};this._keySkill2=function(k){var l=8;var j=0;switch(k){case 88:case 89:case 27:core.setFlag("talentTree_isOpen",false);if(!core.isReplaying()){core.playSound("取消")}core.setFlag("talentTree_last_current",b);core.insertAction({type:"break"});break;case 38:if(!core.isReplaying()){core.playSound("光标移动")}if(e[b]!=-1){f=b;b=e[b]}a=this.getTalentDescription2(b);break;case 40:if(!core.isReplaying()){core.playSound("光标移动")}if(g[b]!=-1){f=b;b=g[b]}a=this.getTalentDescription2(b);break;case 37:if(!core.isReplaying()){core.playSound("光标移动")}f=b;b-=1;if(b<0){b+=l}a=this.getTalentDescription2(b);break;case 39:if(!core.isReplaying()){core.playSound("光标移动")}f=b;b+=1;if(b>=l){b-=l}a=this.getTalentDescription2(b);break;case 13:case 32:this._tryUpgrade2(b)}};this._activateSkill2=function(){if(flags.type==0){this._keySkill2(flags.keycode)}else{this._clickedSkill2(flags.px,flags.py)}};this.openSkillTree2=function(){clearTimeout(core.timeout.turnHeroTimeout);core.timeout.turnHeroTimeout=null;core.playSound("打开界面");core.setFlag("talentTree_isOpen",true);b=Number(core.getFlag("talentTree_last_current",0));f=-1;a=this.getTalentDescription2(b);core.insertAction([{type:"while",condition:"true",data:[{type:"function","function":"function () { core.plugin._drawSkillTree2(); }"},{type:"wait"},{type:"function","function":"function() { core.plugin._activateSkill2(); }"}]},{type:"function","function":"function () { core.deleteCanvas('uievent');core.clearUI(); core.clearMap('uievent');}"}])}},checkBlock:function(){core.maps._canMoveDirectly_checkGlobal=function(){if(!core.flags.enableMoveDirectly){return false}if(core.status.thisMap.cannotMoveDirectly){return false}if(core.hasFlag("cannotMoveDirectly")){return false}if(core.getFlag("spe92_debuff",0)>0){return false}return true};var a=core.maps._canMoveDirectly_checkNextPoint;core.maps._canMoveDirectly_checkNextPoint=function(b,d,e){var c=d+","+e;if(core.status.checkBlock.visible[c]){return false}if(core.status.checkBlock.lose_key[c]){return false}if(core.status.checkBlock.seal_hp[c]){return false}if(core.status.checkBlock.spe_69[c]){return false}if(core.status.checkBlock.spe_72[c]){return false}if(core.status.checkBlock.chase[c]){return false}return a.call(this,b,d,e)};this._checkBlock_chase=function(c){if(!c||c.length==0){return}var b=[];c.forEach(function(k){if(!core.hasSpecial(core.getBlockId(k[0],k[1]),81)){return}var d=core.status.hero.loc.x,e=core.status.hero.loc.y;var f=k[0],g=k[1];var j=false;var h=false;var i;switch(k[3]){case"right":f+=1;i="left";if(d==f+1&&e==g){j=true}break;case"left":f-=1;i="right";if(d==f-1&&e==g){j=true}break;case"up":g-=1;i="down";if(d==f&&e==g-1){j=true}break;case"down":i="up";g+=1;if(d==f&&e==g+1){j=true}break}if(f==d&&g==e){h=true;f=k[0];g=k[1]}if(!h){b.push({type:"if",condition:"!core.getBlock("+f+","+g+") || core.getBlockCls("+f+","+g+') == "items"',"true":[{type:"move",loc:[k[0],k[1]],steps:[k[3]],time:150,keep:true,async:true},{type:"move",loc:[f,g],steps:[i],time:150,keep:true},{type:"function","function":"function(){\ncore.moveEnemyOnPoint("+k[0]+","+k[1]+","+f+","+g+");\n}"},{type:"waitAsync",excludeAnimates:true}]})}if(j||h){b.push({type:"if",condition:"core.getBlockId("+f+", "+g+") =='"+k[2]+"'","true":[{type:"function","function":"function() { core.battle('"+k[2]+"', "+f+","+g+", true, core.doAction); }",async:true},]})}});b.push({type:"waitAsync",excludeAnimates:true});core.insertAction(b)};this._checkBlock_spe_69=function(f){var b=[];var c={};for(var d in f){var e=f[d];var g=[e[2],e[3]];if(c[g]){if(c[g][0]*100+c[g][1]<e[0]*100+e[1]){continue}}c[g]=e}for(var d in c){var e=c[d];var g=[e[2],e[3]];b.push({type:"playSound",name:"jump.mp3"},{type:"if",condition:"!core.getBlock("+e[2]+","+e[3]+")","true":[{type:"jump",from:[e[0],e[1]],to:g,time:300,keep:true,async:false}]})}if(b.length>0){core.insertAction(b)}};this._checkBlock_spe_72=function(f){var b=[];for(var d in f){var e=f[d];var h=[e[0],e[1]];var j=[e[2],e[3]];var g=core.getBlockId(e[0],e[1]);var c=core.getBlockId(e[2],e[3]);core.moveEnemyOnPoint(e[2],e[3],114,514);core.moveEnemyOnPoint(e[0],e[1],e[2],e[3]);core.moveEnemyOnPoint(114,514,e[0],e[1]);core.setBlock(g,e[2],e[3]);core.setBlock(c,e[0],e[1]);b.push({type:"animate",name:"yongchang",loc:j,async:true})}if(b.length>0){core.insertAction(b)}};core.control._checkBlock_ambush=function(c){if(!c||c.length==0){return false}var b=[];c.forEach(function(d){b.push({type:"function","function":"function() { core.battle('"+d[2]+"', "+d[0]+","+d[1]+", true, core.doAction); }",async:true})});core.insertAction(b);return true};core.control._checkBlock_repulse=function(d){if(!d||d.length==0){return}var b=[];var c=[];d.forEach(function(j){var e=core.status.hero.loc.x,f=core.status.hero.loc.y;var g=j[0],h=j[1];var i=false;switch(j[3]){case"right":g+=1;if(g==e&&h==f){i=true}break;case"left":g-=1;if(g==e&&h==f){i=true}break;case"up":h-=1;if(g==e&&h==f){i=true}break;case"down":h+=1;if(g==e&&h==f){i=true}break}if(i){b.push({type:"function","function":"function() { core.battle('"+j[2]+"', "+j[0]+","+j[1]+", true, core.doAction); }",async:true})}else{if(c.indexOf(g+","+h)==-1){c.push(g+","+h);b.push({type:"if",condition:"!core.getBlock("+g+","+h+") && core.getBlockId("+j[0]+","+j[1]+') =="'+j[2]+'"',"true":[{type:"move",loc:[j[0],j[1]],steps:[j[3]],time:150,keep:true,async:true}]})}}});b.push({type:"waitAsync",excludeAnimates:true});core.insertAction(b)};core.control.checkBlock=function(){var f=false;var j=core.getHeroLoc("x"),k=core.getHeroLoc("y"),d=j+","+k;var i=core.status.checkBlock.visible?core.status.checkBlock.visible[d]:false;if(i){core.plugin.exit_invisible();f=true;core.setFlag("disable_autosave",1);core.updateCheckBlock()}var e=core.status.checkBlock.lose_key[d];if(e){if(core.itemCount("yellowKey")>=e){core.getItem("yellowKey",-e);core.drawTip("失去"+e+"把黄钥匙");core.drawHeroAnimate("hand")}else{core.status.hero.hp=0;core.drawHeroAnimate("explosion_small")}if(core.status.hero.hp<=0){core.status.hero.hp=0;core.updateStatusBar();core.events.lose();return}else{f=true}}var g=core.status.checkBlock.seal_hp[d];if(g){core.addFlag("spe62_seal_hp",g);core.status.hero.hp-=g;f=true;core.drawHeroAnimate("seal")}var c=core.status.checkBlock.damage[d];if(c&&core.getTalentLv3(7)>=6&&core.getFlag("temp_mdef_pp")>0){c=0;core.drawHeroAnimate("def_buff")}if(c){core.status.hero.hp-=c;var h=(Object.keys(core.status.checkBlock.type[d]||{}).join("，"))||"伤害";core.drawTip("受到"+h+c+"点");if(h.indexOf("射击伤害")!=-1||h.indexOf("游猎伤害")!=-1){core.drawHeroAnimate(core.getFlag("snipe_animate","snipe"));core.plugin.popSkillDamage(c,j,k)}else{if(h=="血网伤害"){core.drawHeroAnimate("fire");core.plugin.popSkillDamage(c,j,k)}else{if(c>=99*core.status.hero.hp){core.drawHeroAnimate("explosion")}else{core.drawHeroAnimate(core.getFlag("zone_animate","zone"))}core.plugin.popSkillDamage(c,j,k)}}this._checkBlock_disableQuickShop();core.status.hero.statistics.extraDamage+=c;if(core.status.hero.hp<=0){core.status.hero.hp=0;core.updateStatusBar();core.events.lose();return}f=true}var b=core.getFlag("spe92_debuff",0);if(core.status.checkBlock.spe_92[d]){core.addFlag("spe92_debuff",1)}else{core.setFlag("spe92_debuff",0)}if(core.getFlag("spe92_debuff",0)!=b){f=true}if(f){core.updateStatusBar()}core.plugin._checkBlock_spe_72(core.status.checkBlock.spe_72[d]);this._checkBlock_repulse(core.status.checkBlock.repulse[d]);core.plugin._checkBlock_spe_69(core.status.checkBlock.spe_69[d]);core.plugin._checkBlock_chase(core.status.checkBlock.chase[d]);this._checkBlock_ambush(core.status.checkBlock.ambush[d])};core.control._updateDamage_extraDamage=function(h,k){core.status.damage.extraData=[];if(!core.flags.displayExtraDamage){return}var r=core.floors[h].width,i=core.floors[h].height;var o=k&&core.bigmap.v2?Math.max(0,core.bigmap.posX-core.bigmap.extend):0;var f=k&&core.bigmap.v2?Math.min(r,core.bigmap.posX+core.__SIZE__+core.bigmap.extend+1):r;var p=k&&core.bigmap.v2?Math.max(0,core.bigmap.posY-core.bigmap.extend):0;var g=k&&core.bigmap.v2?Math.min(i,core.bigmap.posY+core.__SIZE__+core.bigmap.extend+1):i;for(var s=o;s<f;s++){for(var t=p;t<g;t++){var d=core.status.checkBlock.damage[s+","+t]||0;var j=core.status.checkBlock.lose_key[s+","+t]||0;var l=core.status.checkBlock.seal_hp[s+","+t]||0;var q=core.status.checkBlock.visible[s+","+t]||0;var b=core.status.checkBlock.ambush[s+","+t]||0;var m=core.status.checkBlock.spe_69[s+","+t]||0;var n=core.status.checkBlock.spe_72[s+","+t]||0;var e="卒";if(q){core.status.damage.extraData.push({text:"目",px:32*s+16,py:32*(t+1)-14,color:"#ffaa33"})}if(j){if(core.itemCount("yellowKey")>0){core.status.damage.extraData.push({text:"匙",px:32*s+16,py:32*(t+1)-14,color:"#ffaa33"})}else{core.status.damage.extraData.push({text:e,px:32*s+16,py:32*(t+1)-14,color:"#ffaa33"})}}else{if(l>0){if(d==0){core.status.damage.extraData.push({text:"封",px:32*s+16,py:32*(t+1)-14,color:"#ffaa33"})}else{core.status.damage.extraData.push({text:e,px:32*s+16,py:32*(t+1)-14,color:"#ffaa33"})}}else{if(b){if(core.status.checkBlock.ambush[s+","+t]){core.status.damage.extraData.push({text:"!",px:32*s+16,py:32*(t+1)-14,color:"#ffaa33"})}}else{if(m||n){core.status.damage.extraData.push({text:"@",px:32*s+16,py:32*(t+1)-14,color:"#ffaa33"})}else{if(d>0){var c="#ffaa33";if(core.plugin.getTalentLv3(7)>=6&&(core.getFlag("temp_mdef_pp",0)/core.getFlag("skill11_add",0)*100>core.getFlag("skill11_decay_pp",0)||core.getFlag("skill11_feat1",false))){c="#777777"}if(d>=core.status.hero.hp){core.status.damage.extraData.push({text:e,px:32*s+16,py:32*(t+1)-14,color:c})}else{d=core.formatBigNumber(d,true);core.status.damage.extraData.push({text:d,px:32*s+16,py:32*(t+1)-14,color:c})}}}}}}}}}},Chap4_2Skills:function(){this.willNotBlockSkill12=function(b,c){return core.getBlockId(b,c)==null||core.plugin.isEnemy(b,c)||core.getBlockCls(b,c)=="items"};this.addTempMdefpp=function(f){if(!core.hasItem("skill11")){return}var b=core.getFlag("temp_mdef_pp",0);var e=core.getFlag("skill11_upbound",0)*core.getFlag("skill11_add",100);var c=0;if(f>0){c=Math.min(f,e-b)}else{c=Math.max(f,-b)}core.addFlag("temp_mdef_pp",c);var d=core.getFlag("__mdef_buff__",1);d=(Math.fround(d*1000)+c*10)/100/10;core.setFlag("__mdef_buff__",d);if(!core.getFlag("__statistics__")){if(core.getFlag("temp_mdef_pp")>0){core.setHeroIcon("hero_rage2.png")}else{core.setHeroIcon("hero.png")}}};core.plugin.doSkill10=function(){var m=1,c=0,l=[];var d=core.status.hero.loc.x,e=core.status.hero.loc.y;var o=core.getFlag("temp_mdef_pp",0)*core.status.hero.mdef/100;for(var g=d-m;g<=d+m;++g){for(var k=e-m;k<=e+m;++k){var b=core.getBlockCls(g,k);if(core.plugin.isEnemy(g,k)){l.push([g,k]);c+=1}else{if(b=="items"){var h=core.getBlockId(g,k);if(false){core.removeBlock(g,k)}}}}}var n=0;if(core.getFlag("temp_mdef_pp",0)>0&&core.getFlag("skill10_basedmg",0)>0&&c>0){n=Math.floor((core.getFlag("skill10_basedmg")+core.getFlag("skill10_mdefdmgratio",0)*o)/c)}for(var p in l){if(n>0){core.events.setEnemyOnPointAdd(l[p][0],l[p][1],core.status.floorId,"hp",n,"-=")}core.setEnemyOnPoint(l[p][0],l[p][1],core.status.floorId,"def",core.getFlag("skill10_ddef"),"-=")}var f=-core.getFlag("skill11_add")*core.getFlag("skill11_decay_pp")/100;core.plugin.addTempMdefpp(f)};core.registerReplayAction("skill12dir",function(b){if(b.indexOf("skill12dir:")!==0){return false}if(!core.plugin.canUseSkill12()){core.control._replay_error(b);return true}var c=b.substring(11);core.status.route.push(b);core.setFlag("temp_skill12_dir",c);core.replay();return true});core.plugin.canUseSkill12=function(){var e=core.nextX(2),f=core.nextY(2);var c=e>=0&&e<core.bigmap.width&&f>=0&&f<core.bigmap.height&&core.getBlockId(e,f)==null;var g="落脚点不是空地！";if(core.plugin.getTalentLv3(2)<=5){var b=core.getBlockCls(core.nextX(1),core.nextY(1));if(core.getBlockId(core.nextX(1),core.nextY(1))!=null&&b!="enemys"&&b!="enemy48"&&b!="items"){c=false;g="只能跃过敌人或物品上方！"}}var d=core.getFlag("skill12_cost")+core.getTalentLv3(3);if(c){if(core.status.hero.mana<d){core.drawTip("能量不足。");if(!core.isReplaying()){core.playSound("057-Wrong01.ogg")}}else{return true}}else{core.drawTip(g);if(!core.isReplaying()){core.playSound("057-Wrong01.ogg")}}return false};core.ui._drawSkill12=function(){if(!core.plugin.canUseSkill12()){return}clearTimeout(core.timeout.turnHeroTimeout);core.timeout.turnHeroTimeout=null;core.lockControl();core.status.event.id="skill12";this.clearUI();if(!core.isReplaying()){core.drawTip("选择跳跃后的攻击方向，点击中间或按 X/空格/esc 取消");core.playSound("confirm.mp3")}core.setFlag("stopBlinking",0);core.setFlag("doSkill12",0);core.setFlag("previewSkill12",1);core.updateDamage();core.updateStatusBar();var d=0;var c;if(!core.dymCanvas.animate2){c=core.createCanvas("animate2",0,0,416,416,71)}else{c=core.dymCanvas.animate2}var b=setInterval(function(){var f=32*core.nextX(2)+16,g=32*core.nextY(2)+16;if(!core.getFlag("stopBlinking",0)){core.canvas.hero.canvas.style.filter=("brightness("+(1+0.5*(Math.sin(0.5*d)))+")");++d;core.clearMap(c);var e="rgba(99,147,255,0.5)";core.fillArc(c,core.nextX(2)*32+16,core.nextY(2)*32,96,0.3*Math.PI,0.7*Math.PI,e);core.fillArc(c,core.nextX(2)*32+16,core.nextY(2)*32+32,96,1.3*Math.PI,1.7*Math.PI,e);core.fillArc(c,core.nextX(2)*32,core.nextY(2)*32+16,96,1.8*Math.PI,2.2*Math.PI,e);core.fillArc(c,core.nextX(2)*32+32,core.nextY(2)*32+16,96,0.8*Math.PI,1.2*Math.PI,e);e="#ffbb00";core.fillArc(c,f,g-48-8*Math.sin(0.2*d),24,0.4*Math.PI,0.6*Math.PI,e);core.dymCanvas.animate2.stroke();core.fillArc(c,f,g+48+8*Math.sin(0.2*d),24,1.4*Math.PI,1.6*Math.PI,e);core.dymCanvas.animate2.stroke();core.fillArc(c,f-48-8*Math.sin(0.2*d),g,24,1.9*Math.PI,2.1*Math.PI,e);core.dymCanvas.animate2.stroke();core.fillArc(c,f+48+8*Math.sin(0.2*d),g,24,0.9*Math.PI,1.1*Math.PI,e);core.dymCanvas.animate2.stroke();core.fillRect(c,core.nextX(2)*32,core.nextY(2)*32,32,32,"rgba(255,0,0,1)")}else{core.canvas.hero.canvas.style.filter=("brightness(1)");clearInterval(b);core.clearMap("animate2")}},33);core.status.event.data={centerX:core.nextX(2),centerY:core.nextY(2)}};core.actions._clickSkill12=function(e,f){var b=core.status.event.data.centerX,c=core.status.event.data.centerY;var d="init";if(e==b&&f==c){core.setFlag("stopBlinking",1);core.setFlag("doSkill12",0);core.setFlag("previewSkill12",0);core.ui.closePanel();core.updateStatusBar();return}else{if((e==b-2&&f>=c-1&&f<=c+1)||(e==b-1&&f==c)){d="left"}else{if((f==c-2&&e>=b-1&&e<=b+1)||(f==c-1&&e==b)){d="up"}else{if((e==b+2&&f>=c-1&&f<=c+1)||(e==b+1&&f==c)){d="right"}else{if((f==c+2&&e>=b-1&&e<=b+1)||(f==c+1&&e==b)){d="down"}}}}}if(d!="init"){core.setFlag("stopBlinking",1);core.setFlag("doSkill12",0);core.setFlag("previewSkill12",0);core.ui.closePanel();core.autosave();core.setFlag("temp_skill12_dir",d);core.status.route.push("skill12dir:"+d);core.setFlag("previewSkill12",1);core.useItem("skill12")}};core.actions._keyUpSkill12=function(c){var b="init";if(c==88||c==27||c==32){core.setFlag("stopBlinking",1);core.setFlag("doSkill12",0);core.setFlag("previewSkill12",0);core.ui.closePanel();core.updateStatusBar();return}else{if(c==37){b="left"}else{if(c==38){b="up"}else{if(c==39){b="right"}else{if(c==40){b="down"}}}}}if(b!="init"){core.setFlag("stopBlinking",1);core.setFlag("doSkill12",0);core.setFlag("previewSkill12",0);core.ui.closePanel();core.autosave();core.setFlag("temp_skill12_dir",b);core.status.route.push("skill12dir:"+b);core.setFlag("previewSkill12",1);core.useItem("skill12")}};core.registerReplayAction("skill13i",function(b){if(b.indexOf("skill13i:")!==0){return false}if(core.status.hero.mana<core.getFlag("skill13_cost")){core.control._replay_error(b);return true}var c=parseInt(b.substring(9));if(c!=0&&c!=1){return false}core.status.route.push(b);core.setFlag("temp_skill13_i",c);if(c==0){core.setFlag("temp_skill13_x",core.bigmap.width-1-core.getHeroLoc("x"));core.setFlag("temp_skill13_y",core.bigmap.height-1-core.getHeroLoc("y"))}else{core.setFlag("temp_skill13_x",core.getHeroLoc("x"));core.setFlag("temp_skill13_y",core.getHeroLoc("y"))}core.replay();return true});core.ui._drawSkill13=function(){if(core.status.hero.mana<core.getFlag("skill13_cost")){core.drawTip("能量不足。");if(!core.isReplaying()){core.playSound("057-Wrong01.ogg")}return}clearTimeout(core.timeout.turnHeroTimeout);core.timeout.turnHeroTimeout=null;core.lockControl();core.status.event.id="skill13";core.status.event.mydata={};var b=function(){var i=core.getFlag("temp_skill13_x"),j=core.getFlag("temp_skill13_y");var h=i+","+j;var f=core.clamp(i-core.__HALF_SIZE__,0,core.bigmap.width-core.__SIZE__),g=core.clamp(j-core.__HALF_SIZE__,0,core.bigmap.height-core.__SIZE__);core.status.event.mydata[h]={x:i,y:j,posX:i-f,posY:j-g}};core.setFlag("temp_skill13_x",core.bigmap.width-1-core.getHeroLoc("x"));core.setFlag("temp_skill13_y",core.bigmap.height-1-core.getHeroLoc("y"));b();if(!(core.getHeroLoc("x")==core.bigmap.width-1-core.getHeroLoc("x")&&core.getHeroLoc("y")==core.bigmap.height-1-core.getHeroLoc("y"))){core.setFlag("temp_skill13_x",core.getHeroLoc("x"));core.setFlag("temp_skill13_y",core.getHeroLoc("y"));b()}this.clearUI();if(!core.isReplaying()){core.playSound("打开界面");core.drawTip("确认"+core.material.items.skill13.name+"的落点")}core.setFlag("stopBlinking",0);core.setFlag("previewSkill13",1);core.setFlag("temp_skill13_i",0);core.setFlag("temp_skill13_x",core.bigmap.width-1-core.getHeroLoc("x"));core.setFlag("temp_skill13_y",core.bigmap.height-1-core.getHeroLoc("y"));core.updateDamage();core.updateStatusBar();var e=0;var d;if(!core.dymCanvas.animate2){d=core.createCanvas("animate2",0,0,416,416,71)}else{d=core.dymCanvas.animate2}var c=setInterval(function(){if(!core.getFlag("stopBlinking",0)){var h=Object.keys(core.status.event.mydata);++e;core.clearMap(d);for(var g in h){var m=core.status.event.mydata[h[g]].posX,n=core.status.event.mydata[h[g]].posY;var l=m+","+n;var j=core.clamp(m-core.__HALF_SIZE__,0,core.bigmap.width-core.__SIZE__),k=core.clamp(n-core.__HALF_SIZE__,0,core.bigmap.height-core.__SIZE__);var f="rgba(99,147,255,0.5)";core.fillArc(d,(m-j)*32+16,(n-k)*32+16,80,0,2*Math.PI,f);core.fillArc(d,(m-j)*32+16,(n-k)*32+16,20,0,2*Math.PI,f);core.status.event.mydata[l]={x:m,y:n,posX:m-j,posY:n-k};if(g==core.getFlag("temp_skill13_i",0)){core.canvas.hero.canvas.style.filter=("brightness("+(1+0.5*(Math.sin(0.5*e)))+")");var i=0;f="#ff0000";if(core.getBlockId(m,n)==null||core.plugin.isEnemy(m,n)||core.getBlockCls(m,n)=="items"){f="#ffbb00";i=-8*Math.sin(0.2*e)}core.fillArc(d,(m-j)*32+16,(n-k)*32+i,24,1.4*Math.PI,1.6*Math.PI,f);core.dymCanvas.animate2.stroke();core.fillArc(d,(m-j)*32+16,(n+k)*32+32-i,24,0.4*Math.PI,0.6*Math.PI,f);core.dymCanvas.animate2.stroke();core.fillArc(d,(m+j)*32+32-i,(n-k)*32+16,24,1.9*Math.PI,2.1*Math.PI,f);core.dymCanvas.animate2.stroke();core.fillArc(d,(m+j)*32+i,(n+k)*32+16,24,0.9*Math.PI,1.1*Math.PI,f);core.dymCanvas.animate2.stroke()}}}else{core.canvas.hero.canvas.style.filter=("brightness(1)");clearInterval(c);core.clearMap(d)}},33);return};core.actions._clickSkill13=function(e,f){var b=e+","+f;if(b in core.status.event.mydata){core.status.event.data=core.status.event.mydata[b];var c=core.status.event.data.posX,d=core.status.event.data.posY;if(c==core.getHeroLoc("x")&&d==core.getHeroLoc("y")){core.setFlag("temp_skill13_i",1)}else{core.setFlag("temp_skill13_i",0)}core.setFlag("temp_skill13_x",c);core.setFlag("temp_skill13_y",d);core.setFlag("previewSkill13",0);core.setFlag("stopBlinking",1);core.ui.closePanel();if(core.canUseItem("skill13")){core.autosave();core.status.route.push("skill13i:"+core.getFlag("temp_skill13_i",0));core.setFlag("previewSkill13",1);core.useItem("skill13")}else{core.drawTip("无法使用"+core.material.items.skill13.name+"落到那个位置")}}else{core.setFlag("previewSkill13",0);core.setFlag("stopBlinking",1);core.ui.closePanel()}};core.actions._keyUpSkill13=function(c){var d=Object.keys(core.status.event.mydata);var b=core.getFlag("temp_skill13_i",0);core.status.event.data=core.status.event.mydata[d[b]];if(c==37||c==38||c==39||c==40){b=(b+1)%d.length;core.setFlag("temp_skill13_i",b);core.status.event.data=core.status.event.mydata[d[b]];var e=core.status.event.data.posX,f=core.status.event.data.posY;core.setFlag("temp_skill13_x",e);core.setFlag("temp_skill13_y",f);core.updateDamage();return}if(c==51||c==13||c==32||c==67){var e=core.status.event.data.posX,f=core.status.event.data.posY;core.setFlag("temp_skill13_x",e);core.setFlag("temp_skill13_y",f);core.setFlag("previewSkill13",0);core.setFlag("stopBlinking",1);core.ui.closePanel();if(core.canUseItem("skill13")){core.autosave();core.status.route.push("skill13i:"+core.getFlag("temp_skill13_i",0));core.setFlag("previewSkill13",1);core.useItem("skill13")}else{core.drawTip("无法使用"+core.material.items.skill13.name+"落到那个位置")}}else{core.setFlag("previewSkill13",0);core.setFlag("stopBlinking",1);core.ui.closePanel()}};core.registerAction("keyUp","my_sys_keyUp_skill13",function(c,b){if(!core.status.lockControl){return false}switch(core.status.event.id){case"skill12":this._keyUpSkill12(c);return true;case"skill13":this._keyUpSkill13(c);return true}return false},51);core.registerAction("onclick","my_sys_onclick_skill13",function(d,e,b,c){if(!core.status.lockControl){return false}switch(core.status.event.id){case"skill12":this._clickSkill12(d,e,b,c);return true;case"skill13":this._clickSkill13(d,e,b,c);return true}return false},51);var a=core.events.tryUseItem;core.events.tryUseItem=function(b){if(b=="skill12"){core.ui.closePanel();return core.ui._drawSkill12()}if(b=="skill13"){core.ui.closePanel();return core.ui._drawSkill13()}a.call(this,b)}},talentTree3:function(){var h=[{name:"最佳防守",images:["talentT3_0.png",64,30],description:function(j){var i=["未解锁。","被动技能【最佳防守】：每次战斗后获得1层临时护盾，每移动一格失去1层临时护盾。每层提供50%基础值的护盾。最多拥有2层。","临时护盾叠加层数上限提升至3层，并且移动造成的衰减效果降低20%","临时护盾叠加层数上限提升至4层，并且移动造成的衰减效果降低35%","移动造成的临时护盾衰减效果降低50%"];return i[j]},cost:function(l){var i=[100,5,15,30][l];var k=core.status.hero.money>=i;switch(l){case 0:return(k?"\r[green]":"\r[yellow]")+"提升需消耗"+i+"金币\r";case 1:var j=core.getTalentLv3(3);k=j>=i;return(k?"\r[green]":"\r[yellow]")+"提升需【至尊飞升】达到"+i+"级("+j+"/"+i+")\r";case 2:var j=core.getTalentLv3(3);k=j>=i;return(k?"\r[green]":"\r[yellow]")+"提升需【至尊飞升】达到"+i+"级("+j+"/"+i+")\r";case 3:var j=core.getTalentLv3(3);k=j>=i;return(k?"\r[green]":"\r[yellow]")+"提升需【至尊飞升】达到"+i+"级("+j+"/"+i+")\r"}return"已达到满级。"},upgrade:function(k){var i=[100,5,15,30][k];var j;switch(k){case 0:j=core.status.hero.money>=i;if(j){core.addFlag("talent3_0_lv",1);core.status.hero.money-=i;core.setFlag("skill11_upbound",2);core.setFlag("skill11_add",50);core.setFlag("skill11_decay_pp",100);if(core.getFlag("autoGetItem",0)>0){core.insertAction("\t[系统提示]拥有临时护盾时不会触发自动拾取。")}else{core.insertAction("\t[系统提示]你可以在道具栏“系统设置”中打开自动拾取，但拥有临时护盾时不会触发自动拾取。")}core.getItem("skill11");return true}break;case 1:j=core.getTalentLv3(3)>=i;if(j){core.addFlag("talent3_0_lv",1);core.addFlag("skill11_upbound",1);core.setFlag("skill11_decay_pp",80);if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【最佳防守】已提升至\r[yellow]2\r级。\n效果：临时护盾叠加层数上限提升至3层，并且移动造成的衰减效果降低20%")}return true}break;case 2:j=core.getTalentLv3(3)>=i;if(j){core.addFlag("talent3_0_lv",1);core.addFlag("skill11_upbound",1);core.setFlag("skill11_decay_pp",65);if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【最佳防守】已提升至\r[yellow]3\r级。\n效果：临时护盾叠加层数上限提升至4层，并且移动造成的衰减效果降低35%")}return true}break;case 3:j=core.getTalentLv3(3)>=i;if(j){core.addFlag("talent3_0_lv",1);core.setFlag("skill11_decay_pp",50);if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【最佳防守】已提升至\r[yellow]4\r级。\n效果：移动造成的临时护盾衰减效果降低50%")}return true}break;default:break}return false},reading:"补充说明：转换地图前会失去所有临时护盾（包括使用楼层传送器传送到同一层）。有临时护盾时不会触发自动拾取/清怪。",maxlv:4},{name:"毁灭重拳",images:["talentT3_1.png",144,30],description:function(j){var i=["未解锁。","主动技能【毁灭重拳】：向前冲刺并降低敌人的防御，如果击中敌人时拥有临时护盾，还会造成伤害。","冲刺距离从2格提升至4格，并且如果没有击中敌人，返还25能量。","冲刺距离从4格提升至6格，并且如果没有击中敌人，返还50能量。","【毁灭重拳】临时护盾爆炸的伤害提升至(400w+1.5*临时护盾数值)点。","【毁灭重拳】临时护盾爆炸的伤害提升至(600w+2*临时护盾数值)点。","冲刺距离从6格提升至2221格，并且临时护盾爆炸会破坏范围内的非绿色门。"];return i[j]},cost:function(k){var i=[300,10,50,25,60][k];var j;var l=core.getFlag("skill10_use_time",0);switch(k){case 0:j=core.getTalentLv3(0)>0&&core.status.hero.money>=i;return(j?"\r[green]":"\r[yellow]")+"提升需解锁【最佳防守】并消耗"+i+"金币\r";case 1:j=l>=i;return(j?"\r[green]":"\r[yellow]")+"提升需使用"+i+"次本技能("+l+"/"+i+")\r";case 2:l=core.getFlag("skill10_hit_enemy",0);j=l>=i;return(j?"\r[green]":"\r[yellow]")+"提升需使用本技能击中"+i+"个敌人("+l+"/"+i+")\r";case 3:j=core.getTalentLv3(3)>=i;return(j?"\r[green]":"\r[yellow]")+"提升需【至尊飞升】达到"+i+"级\r";case 4:j=core.getTalentLv3(3)>=i&&core.getTalentLv3(5)>=3;return(j?"\r[green]":"\r[yellow]")+"提升需【重拳强化】达到3级，且【至尊飞升】达到"+i+"级\r"}return"已达到满级。"},upgrade:function(k){var i=[300,10,50,25,60][k];var j;switch(k){case 0:j=core.getTalentLv3(0)>0&&core.status.hero.money>=i;if(j){core.addFlag("talent3_1_lv",1);core.status.hero.money-=i;core.setFlag("skill10_desc3","");core.setFlag("skill10_range",2);core.setFlag("skill10_ddef",100000);core.setFlag("skill10_basedmg",0);core.setFlag("skill10_cost",125);core.setFlag("skill10_use_time",0);core.setFlag("skill10_hit_enemy",0);core.setFlag("skill10_basedmg",2000000);core.setFlag("skill10_mdefdmgratio",1);core.setFlag("skill10_desc2","如果有临时护盾，会令敌人分摊(200w+临时护盾数值)点伤害");core.getItem("skill10");return true}break;case 1:j=core.getFlag("skill10_use_time",0)>=i;if(j){core.addFlag("talent3_1_lv",1);core.setFlag("skill10_desc3","如果没有击中敌人，返还25能量。");core.setFlag("skill10_range",4);core.setFlag("skill10_use_time",0);core.setFlag("skill10_hit_enemy",0);core.setFlag("skill10_ret_mana",25);if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【毁灭重拳】已提升至\r[yellow]2\r级。\n效果：冲刺距离从2格提升至4格，并且如果没有击中敌人，返还25能量。")}return true}break;case 2:j=core.getFlag("skill10_hit_enemy",0)>=i;if(j){core.addFlag("talent3_1_lv",1);core.setFlag("skill10_desc3","如果没有击中敌人，返还50能量。");core.setFlag("skill10_range",6);core.setFlag("skill10_use_time",0);core.setFlag("skill10_hit_enemy",0);core.setFlag("skill10_ret_mana",50);if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【毁灭重拳】已提升至\r[yellow]3\r级。\n效果：冲刺距离从4格提升至6格，并且如果没有击中敌人，返还50能量。")}return true}break;case 3:j=core.getTalentLv3(3)>=i;if(j){core.addFlag("talent3_1_lv",1);core.setFlag("skill10_basedmg",4000000);core.setFlag("skill10_mdefdmgratio",1.5);core.setFlag("skill10_desc2","如果有临时护盾，会令敌人分摊(400w+1.5*临时护盾数值)点伤害");if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【毁灭重拳】已提升至\r[yellow]4\r级。\n效果：【毁灭重拳】临时护盾爆炸的伤害提升至(400w+1.5*临时护盾数值)点。")}return true}break;case 4:j=core.getTalentLv3(3)>=i&&core.getTalentLv3(5)>=3;if(j){core.addFlag("talent3_1_lv",1);core.setFlag("skill10_basedmg",6000000);core.setFlag("skill10_mdefdmgratio",2);core.setFlag("skill10_desc2","如果有临时护盾，会令敌人分摊(600w+2*临时护盾数值)点伤害");if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【毁灭重拳】已提升至\r[yellow]5\r级。\n效果：【毁灭重拳】临时护盾爆炸的伤害提升至(600w+2*临时护盾数值)点。")}return true}break;default:return false}return false},reading:"补充说明：冲刺路径上不会受到地图伤害影响。\n使用此技能的快捷键是1。",maxlv:5},{name:"裂地重拳",images:["talentT3_2.png",224,30],description:function(j){var i=["未解锁。","主动技能【裂地重拳】：向前跳跃并降低敌人的攻击，如果击中敌人时拥有临时护盾，还会回复生命。","【裂地重拳】每击中一个敌人便返还25点能量","【裂地重拳】每击中一个敌人便返还50点能量，并且拉动效果能够对[喽啰]级别敌人生效。","使用【裂地重拳】与敌人战斗结束时，回复等同于临时护盾数值100%的生命。","【裂地重拳】每击中一个敌人便返还75点能量，并且拉动效果能够对[精英]级别敌人生效。","【裂地重拳】每击中一个敌人便获得一层临时护盾（在强制战斗开始前）。"];return i[j]},cost:function(k){var i=[2000,10,30,55,90][k];var j;var l=core.getFlag("skill12_use_time",0);switch(k){case 0:j=core.getTalentLv3(0)>0&&core.status.hero.money>=i;return(j?"\r[green]":"\r[yellow]")+"提升需解锁【最佳防守】并消耗"+i+"金币\r";case 1:j=l>=i;return(j?"\r[green]":"\r[yellow]")+"提升需使用"+i+"次本技能("+l+"/"+i+")\r";case 2:l=core.getFlag("skill12_hit_num",0);j=l>=i;return(j?"\r[green]":"\r[yellow]")+"提升需使用本技能击中过"+i+"个敌人("+l+"/"+i+")\r";case 3:case 4:j=core.getTalentLv3(3)>=i;return(j?"\r[green]":"\r[yellow]")+"提升需【至尊飞升】达到"+i+"级\r"}return"已达到满级。"},upgrade:function(k){var i=[2000,10,30,55,90][k];var j;switch(k){case 0:j=core.getTalentLv3(0)>0&&core.status.hero.money>=i;if(j){core.status.hero.money-=i;core.addFlag("talent3_2_lv",1);core.setFlag("skill12_datk",100000);core.setFlag("skill12_cost",200);core.setFlag("skill12_hit_ret",0);core.setFlag("skill12_drain_ratio",50);core.setFlag("skill12_desc1","每击中一个敌人回复临时护盾数值50%的生命。");core.getItem("skill12",1);core.setFlag("skill12_use_time",0);core.setFlag("skill12_hit_num",0);return true}break;case 1:j=core.getFlag("skill12_use_time",0)>=i;if(j){core.addFlag("talent3_2_lv",1);core.setFlag("skill12_use_time",0);core.setFlag("skill12_hit_num",0);core.setFlag("skill12_hit_ret",25);core.setFlag("skill12_desc1","每击中一个敌人获得25能量，并回复临时护盾数值50%的生命。");if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【裂地重拳】已提升至\r[yellow]2\r级。\n效果：【裂地重拳】每击中一个敌人便返还25点能量")}return true}break;case 2:j=core.getFlag("skill12_hit_num",0)>=i;if(j){core.addFlag("talent3_2_lv",1);core.setFlag("skill12_use_time",0);core.setFlag("skill12_hit_num",0);core.setFlag("skill12_hit_ret",50);core.setFlag("skill12_desc1","每击中一个敌人获得50能量，并回复临时护盾数值50%的生命。");if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【裂地重拳】已提升至\r[yellow]3\r级。\n效果：【裂地重拳】每击中一个敌人便返还50点能量")}return true}break;case 3:j=core.getTalentLv3(3)>=i;if(j){core.addFlag("talent3_2_lv",1);core.setFlag("skill12_drain_ratio",100);core.setFlag("skill12_desc1","每击中一个敌人获得50能量，并回复临时护盾数值100%的生命。");if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【裂地重拳】已提升至\r[yellow]4\r级。\n效果：使用【裂地重拳】与敌人战斗结束时，回复等同于临时护盾数值100%的生命。")}return true}break;case 4:j=core.getTalentLv3(3)>=i;if(j){core.addFlag("talent3_2_lv",1);core.setFlag("skill12_hit_ret",75);core.setFlag("skill12_desc1","每击中一个敌人获得75能量，并回复临时护盾数值100%的生命。");if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【裂地重拳】已提升至\r[yellow]5\r级。\n效果：【裂地重拳】每击中一个敌人便返还75点能量，并且拉动效果能够对[精英]级别敌人生效。")}return true}break}return false},reading:"补充说明：1.此技能会“触发”面前一排：如果是物品则立即拾取，如果是敌人则立即战斗。2.如果第一排某列有障碍物，则技能无法影响到第二排对应列的物体。3.触发顺序是左上优先。\n使用此技能的快捷键是2。",maxlv:5},{name:"至尊飞升",images:["talentT3_3.png",304,30],description:function(i){return"每击杀10个敌人提升一级，攻击、防御、护盾永久+10%，但使用技能时也额外消耗1点能量。"},cost:function(k){var j=false;var i,l;if(k<100){l=10;i=core.getFlag("talentT3_3_upX",0);j=i>=l;return(j?"\r[green]":"\r[yellow]")+"提升需击杀"+l+"个敌人("+i+"/"+l+")\r"}return"已达到满级。"},upgrade:function(k){var j=false;var i,l;if(k<100){l=10;i=core.getFlag("talentT3_3_upX",0);j=i>=l;if(j){core.addFlag("talent3_3_lv",1);core.addFlag("talentT3_3_upX",-10);core.plugin.addValpp("atk",10);core.plugin.addValpp("def",10);core.plugin.addValpp("mdef",10);core.drawHeroAnimate("rage_buff");if(k==9||k==24||k==39||k==54||k==69||k==84||k==99){core.plugin._tryUpgrade3(7)}if(core.getFlag("autoUpgradeTalent",0)>0){if(k==4||k==14||k==29){core.plugin._tryUpgrade3(0)}if(k==24){core.plugin._tryUpgrade3(1)}if(k==59&&core.getTalentLv3(5)==3){core.plugin._tryUpgrade3(1)}if(k==54||k==89){core.plugin._tryUpgrade3(2)}}return true}}return false},reading:"此天赋会在满足条件时自动升级。\n不经历冲突，怎能不断进化",maxlv:100},{name:"强化防守",images:["talent7.png",64,110],description:function(j){var i=["未解锁。每层临时护盾的效果为基础护盾的50%。","每层临时护盾的效果增加至基础护盾的100%。基础护盾永久提升30000点。","每层临时护盾的效果增加至基础护盾的150%。基础护盾额外提升50000点（共80000点）。","每层临时护盾的效果增加至基础护盾的220%。基础护盾额外提升70000点（共150000点）。","压缩临时护盾，使其叠加层数上限减少至3层，但每层效果增加至基础护盾的300%。基础护盾额外提升90000点（共240000点）。"];return i[j]},cost:function(l){var i=[2000,8000,20000,64100][l];var j=[1,2,3,4][l];var k=core.status.hero.money>=i&&core.getTalentLv3(0)>=j;if(l<4){return(k?"\r[green]":"\r[yellow]")+"提升需【最佳防守】达到"+j+"级，并消耗"+i+"金币\r"}return"已达到满级"},upgrade:function(m){var j=[2000,8000,20000,64100][m];var k=[1,2,3,4][m];var l=core.status.hero.money>=j&&core.getTalentLv3(0)>=k;if(l){switch(m){case 0:core.status.hero.money-=j;core.status.hero.mdef+=30000;var i=core.getFlag("skill11_add",0);var n=core.getFlag("temp_mdef_pp",0)/i;core.setFlag("skill11_add",100);core.addTempMdefpp(n*(core.getFlag("skill11_add")-i));core.addFlag("talent3_4_lv",1);return true;case 1:core.status.hero.money-=j;core.status.hero.mdef+=50000;var i=core.getFlag("skill11_add",0);var n=core.getFlag("temp_mdef_pp",0)/i;core.setFlag("skill11_add",150);core.addTempMdefpp(n*(core.getFlag("skill11_add")-i));core.addFlag("talent3_4_lv",1);return true;case 2:core.status.hero.money-=j;core.status.hero.mdef+=70000;var i=core.getFlag("skill11_add",0);var n=core.getFlag("temp_mdef_pp",0)/i;core.setFlag("skill11_add",220);core.addTempMdefpp(n*(core.getFlag("skill11_add")-i));core.addFlag("talent3_4_lv",1);return true;case 3:core.status.hero.money-=j;core.status.hero.mdef+=90000;var i=core.getFlag("skill11_add",0);var n=core.getFlag("temp_mdef_pp",0)/i;core.setFlag("skill11_add",300);core.addFlag("skill11_upbound",-1);core.addTempMdefpp(n*(core.getFlag("skill11_add")-i));core.addFlag("talent3_4_lv",1);return true}}return false},maxlv:4,reading:"在连续的战斗中变得更加强大"},{name:"重拳强化",images:["talent5.png",144,110],description:function(j){var i=["未解锁。【毁灭重拳】降低敌人100000点防御，不可叠加。","【毁灭重拳】降低防御的效果提升至250000点。","【毁灭重拳】降低防御的效果提升至500000点。","【毁灭重拳】降低防御的效果提升至1000000点。"];return i[j]},cost:function(l){var i=[4000,20000,40000][l];var j=[2,3,4][l];var k=core.status.hero.money>=i&&core.getTalentLv3(1)>=j;if(l<3){return(k?"\r[green]":"\r[yellow]")+"提升需【毁灭重拳】达到"+j+"级，并消耗"+i+"金币\r"}return"已达到满级"},upgrade:function(l){var i=[4000,20000,40000][l];var j=[2,3,4][l];var k=core.status.hero.money>=i&&core.getTalentLv3(1)>=j;if(k){switch(l){case 0:core.status.hero.money-=i;core.setFlag("skill10_ddef",250000);core.addFlag("talent3_5_lv",1);return true;case 1:core.status.hero.money-=i;core.setFlag("skill10_ddef",500000);core.addFlag("talent3_5_lv",1);return true;case 2:core.status.hero.money-=i;core.setFlag("skill10_ddef",1000000);core.addFlag("talent3_5_lv",1);return true}}return false},maxlv:3},{name:"震撼大地",images:["talentT3_6.png",224,110],description:function(j){var i=["未解锁。【裂地重拳】降低敌人100000点攻击，不可叠加。","【裂地重拳】降低攻击的效果增加至250000点。","【裂地重拳】降低攻击的效果增加至500000点。","【裂地重拳】降低攻击的效果增加至1000000点。"];return i[j]},cost:function(l){var i=[4500,22500,45000][l];var j=[2,3,4][l];var k=core.status.hero.money>=i&&core.getTalentLv3(2)>=j;if(l<3){return(k?"\r[green]":"\r[yellow]")+"提升需【裂地重拳】达到"+j+"级，并消耗"+i+"金币\r"}return"已达到满级"},upgrade:function(l){var i=[4500,22500,45000][l];var j=[2,3,4][l];var k=core.status.hero.money>=i&&core.getTalentLv3(2)>=j;if(k){switch(l){case 0:core.status.hero.money-=i;core.setFlag("skill12_datk",250000);core.addFlag("talent3_6_lv",1);return true;case 1:core.status.hero.money-=i;core.setFlag("skill12_datk",500000);core.addFlag("talent3_6_lv",1);return true;case 2:core.status.hero.money-=i;core.setFlag("skill12_datk",1000000);core.addFlag("talent3_6_lv",1);return true}}return false},maxlv:3},{name:"能量强化",images:["talent3.png",304,110],description:function(j){var i=["每场战斗后回复5点能量，如果战斗总伤害不大于0则额外回复10点。拾取能量块回复150能量。","每场战斗后回复能量增加至10点，战斗总伤害不大于0时的额外能量回复从10点增加至20点。","拾取能量块时回复能量从150点提升至175点。","每场战斗后回复能量增加至15点，战斗总伤害不大于0时的额外能量回复从20点增加至30点。","拾取能量块时回复能量从175点提升至200点。","每次战斗后移动的第一步不再会使临时护盾衰减。","移动后如果拥有临时护盾，免疫地图伤害。","解锁全部力量，成就真正的至尊强者！基础攻防永久提升50000点，并获得终极技能。"];return i[j]},cost:function(k){var j=false;var i;var l=[10,25,40,55,70,85,100];switch(k){case 0:case 1:case 2:case 3:case 4:case 5:case 6:j=core.getTalentLv3(3)>=l[k];return(j?"\r[green]":"\r[yellow]")+"提升需【至尊飞升】达到"+l[k]+"级\r";case 114:l=50;i=core.getFlag("talentT3_7_upn",0);j=i>=l;return(j?"\r[green]":"\r[yellow]")+"提升需在拥有临时护盾的情况下战斗"+l+"次("+i+"/"+l+")\r"}return"已达到满级。"},upgrade:function(k){var l=[10,25,40,55,70,85,100];var j=core.getTalentLv3(3)>=l[k];var i;switch(k){case 0:if(j){core.addFlag("talent3_7_lv",1);core.setFlag("mana_regen",10);core.setFlag("I62_extra_mana_regen",20);core.setFlag("I62_extra_description","。若战斗总伤害不大于0，额外回复20点能量");if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【能量强化】已提升至\r[yellow]1\r级。\n效果：每场战斗后回复能量增加至10点，战斗总伤害不大于0时的额外能量回复从10点增加至20点。")}return true}break;case 1:if(j){core.addFlag("talent3_7_lv",1);core.setFlag("mana_item",175);core.plugin.clearItemDetailCache("manaItem");core.plugin.clearItemDetailCache("bigManaitem");if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【能量强化】已提升至\r[yellow]2\r级。\n效果：拾取能量块时回复能量从150点提升至175点。")}return true}break;case 2:if(j){core.addFlag("talent3_7_lv",1);core.setFlag("mana_regen",15);core.setFlag("I62_extra_mana_regen",30);core.setFlag("I62_extra_description","。若战斗总伤害不大于0，额外回复30点能量");if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【能量强化】已提升至\r[yellow]3\r级。\n效果：每场战斗后回复能量增加至15点，战斗总伤害不大于0时的额外能量回复从20点增加至30点。")}return true}break;case 3:if(j){core.addFlag("talent3_7_lv",1);core.setFlag("mana_item",200);core.plugin.clearItemDetailCache("manaItem");core.plugin.clearItemDetailCache("bigManaitem");if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【能量强化】已提升至\r[yellow]4\r级。\n效果：拾取能量块时回复能量从175点提升至200点。")}return true}break;case 4:if(j){core.addFlag("talent3_7_lv",1);if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【能量强化】已提升至\r[yellow]5\r级。\n效果：每次战斗后移动的第一步不再会使临时护盾衰减。")}return true}break;case 5:if(j){core.addFlag("talent3_7_lv",1);core.setFlag("skill11_desc","移动后如果拥有临时护盾，免疫地图伤害。");if(core.getFlag("autoUpgradeTalent",0)>0){core.insertAction("\t[系统提示]【能量强化】已提升至\r[yellow]6\r级。\n效果：移动后如果拥有临时护盾，免疫地图伤害。")}return true}break;case 6:if(j){core.insertCommonEvent("100级");return true}break;case 114:l=50;i=core.getFlag("talentT3_7_upn",0);j=i>=l;if(j){core.addFlag("talent3_7_lv",1);return true}break}return false},maxlv:7,reading:"此天赋会在满足条件时自动升级。"}];var c=[[0,4],[1,5],[2,6]];var d=[];var e=[-1,-1,-1,-1,0,1,2,3];var g=[4,5,6,7,-1,-1,-1,-1];var b,f;var a="";this.getTalentLv3=function(i){if(!core.hasItem("talentTree3")){return 0}return core.getFlag("talent3_"+i+"_lv",0)};this.getTalentDescription3=function(i){var j=h[i];var k=this.getTalentLv3(i);var l=j.description(k)+"\n";if(k<j.maxlv){l+="\r[yellow]下一级\r："+j.cost(k)+"\n\r[gray]"+j.description(k+1)+"\r\n";l+="下次升级条件："+j.cost(k+1)+"\n"}if(j.reading){l+="\\c[14]"+j.reading+"\\c\n"}return l};this._tryUpgrade3=function(l,k){var i=h[l];var j=this.getTalentLv3(l);if(j==i.maxlv){if(!k){if(!core.isReplaying()){core.playSound("操作失败")}core.insertAction({type:"tip",text:"已升至最高等级，不可再升级！"})}return}if(!i.upgrade(j)){if(!k){if(!core.isReplaying()){core.playSound("操作失败")}core.insertAction({type:"tip",text:"升级条件不足！"})}return}core.playSound("确定");core.insertAction({type:"tip",text:"升级成功！"});a=this.getTalentDescription3(l);core.updateStatusBar()};this._drawSkillTree3=function(){core.deleteCanvas("uievent");core.ui._createUIEvent();core.clearMap("uievent");core.ui._uievent_drawBackground({background:[0,0,0,0.85],x:0,y:0,width:416,height:416});var l=function(s){var i="#63FF63";switch(s){case 0:if(core.getTalentLv3(0)>=1){return i}break;case 1:if(core.getTalentLv3(1)>=1){return i}break;case 2:if(core.getTalentLv3(2)>=1){return i}break}return"gray"};var o=h;for(var m in c){this._drawEdge(o[c[m][0]].images[1]+16,o[c[m][0]].images[2],o[c[m][1]].images[1]+16,o[c[m][1]].images[2],l(Number(m)))}for(var m in d){this._drawEdge(o[d[m][0]].images[1]+16,o[d[m][0]].images[2],o[d[m][1]].images[1]+16,o[d[m][1]].images[2],l(Number(m)+4))}for(var m in o){core.drawImage("uievent",o[m].images[0],o[m].images[1],o[m].images[2]);var q=o[m].images[1],r=o[m].images[2];if(m==b){var p=2;core.ui.strokeRoundRect("uievent",q-p,r-p,32+2*p,32+2*p,p,"#FFFF00",p)}if(core.getTalentLv3(m)<o[m].maxlv){var j="#FFFFFF";if(o[m].cost(core.getTalentLv3(m)).indexOf("green")>0){j="#00FF00"}if(o[m].cost(core.getTalentLv3(m)).indexOf("red")>0){j="#FF0000"}core.ui.fillText("uievent","("+core.getTalentLv3(m)+"/"+o[m].maxlv+")",q,r+48,j,"15px Georgia")}}var k=o[b];var n=this.getTalentLv3(b);core.ui._uievent_drawTextContent({text:"\r[yellow]【"+k.name+"】("+n+"/"+k.maxlv+")\r",left:10,top:175,maxWidth:396,align:"center"});core.ui._uievent_drawTextContent({text:a,left:10,top:195,maxWidth:396,align:"center"});core.ui._uievent_drawTextContent({text:"离开",left:368,top:388,bold:true,fontSize:20})};this._clickedSkill3=function(k,l){for(var j in h){if(this._inRect(k,l,h[j].images[1],h[j].images[2])){f=b;b=Number(j);if(!core.isReplaying()){core.playSound("光标移动")}a=this.getTalentDescription3(b);if(f==b){this._tryUpgrade3(j)}}}if(k>=368&&l>=388){core.setFlag("talentTree_isOpen",false);if(!core.isReplaying()){core.playSound("取消")}core.setFlag("talentTree_last_current",b);return core.insertAction({type:"break"})}};this._keySkill3=function(k){var l=8;var j=0;switch(k){case 88:case 89:case 27:core.setFlag("talentTree_isOpen",false);if(!core.isReplaying()){core.playSound("取消")}core.setFlag("talentTree_last_current",b);core.insertAction({type:"break"});break;case 38:if(!core.isReplaying()){core.playSound("光标移动")}if(e[b]!=-1){f=b;b=e[b]}a=this.getTalentDescription3(b);break;case 40:if(!core.isReplaying()){core.playSound("光标移动")}if(g[b]!=-1){f=b;b=g[b]}a=this.getTalentDescription3(b);break;case 37:if(!core.isReplaying()){core.playSound("光标移动")}f=b;b-=1;if(b<0){b+=l}a=this.getTalentDescription3(b);break;case 39:if(!core.isReplaying()){core.playSound("光标移动")}f=b;b+=1;if(b>=l){b-=l}a=this.getTalentDescription3(b);break;case 13:case 32:this._tryUpgrade3(b)}};this._activateSkill3=function(){if(flags.type==0){this._keySkill3(flags.keycode)}else{this._clickedSkill3(flags.px,flags.py)}};this.openSkillTree3=function(){clearTimeout(core.timeout.turnHeroTimeout);core.timeout.turnHeroTimeout=null;core.playSound("打开界面");core.setFlag("talentTree_isOpen",true);b=Number(core.getFlag("talentTree_last_current",0));f=-1;a=this.getTalentDescription3(b);core.insertAction([{type:"while",condition:"true",data:[{type:"function","function":"function () { core.plugin._drawSkillTree3(); }"},{type:"wait"},{type:"function","function":"function() { core.plugin._activateSkill3(); }"}]},{type:"function","function":"function () { core.deleteCanvas('uievent');core.clearUI(); core.clearMap('uievent');}"}])}},displayDamage:function(){core.control._updateDamage_damage=function(a,b){core.status.damage.data=[];if(!core.flags.displayEnemyDamage&&!core.flags.displayExtraDamage){return}core.extractBlocks(a);core.status.maps[a].blocks.forEach(function(c){var i=c.x,j=c.y;if(b&&core.bigmap.v2){if(i<core.bigmap.posX-core.bigmap.extend||i>core.bigmap.posX+core.__SIZE__+core.bigmap.extend||j<core.bigmap.posY-core.bigmap.extend||j>core.bigmap.posY+core.__SIZE__+core.bigmap.extend){return}}if(!c.disable&&c.event.cls.indexOf("enemy")==0&&c.event.displayDamage!==false){if(core.flags.displayEnemyDamage){var e=core.enemys.getDamageString(c.event.id,i,j,a);core.status.damage.data.push({text:e.damage,px:32*i+1,py:32*(j+1)-1,color:e.color})}if(core.flags.displayCritical){var d=core.enemys.nextCriticals(c.event.id,1,i,j,a);d=core.formatBigNumber((d[0]||[])[0],true);if(d=="???"){d="?"}core.status.damage.data.push({text:d,px:32*i+1,py:32*(j+1)-11,color:"#FFFFFF"});var g=core.events.getEnemyOnPoint(i,j,a);var f=core.material.enemys[c.event.id];if(g.hp&&g.hp!=f.hp){if(core.getFlag("MonHPMode",0)==0){var h=Math.floor(g.hp*100/f.hp);core.status.damage.data.push({text:h+"%",px:32*i+11,py:32*(j+1)-21,color:"#aa0088"})}else{core.status.damage.data.push({text:core.formatBigNumber(g.hp),px:32*i+1,py:32*(j+1)-21,color:"#aa0088"})}}}}})};core.enemys.getDamageString=function(c,f,g,d){if(typeof c=="string"){c=core.material.enemys[c]}var b=this.getDamage(c,f,g,d);var a="#000000";if(b==null){b="???";a="#FF2222"}else{if(b<=0){a="#11FF11"}else{if(b<core.status.hero.hp/3){a="#FFFFFF"}else{if(b<core.status.hero.hp*2/3){a="#FFFF00"}else{if(b<core.status.hero.hp){a="#FF9933"}else{a="#FF2222"}}}}b=core.formatBigNumber(b,true);if(core.enemys.hasSpecial(c,19)){b+="+"}if(core.enemys.hasSpecial(c,21)){b+="-"}if(core.enemys.hasSpecial(c,11)&&!core.hasItem("I_noVampire")){b+="^"}if(core.enemys.hasSpecial(c,25)||core.enemys.hasSpecial(c,28)||core.enemys.hasSpecial(c,39)||core.enemys.hasSpecial(c,65)){b+="*"}}var e=core.events.getEnemyOnPoint(f,g,d);if(e.atk&&e.atk!=c.atk){b+="A"}if(e.def&&e.def!=c.def){b+="D"}return{damage:b,color:a}}},autoGetItem:function(){core.control.my_replayAction_moveDirectly=function(d){if(d.indexOf("move:")!=0){return false}if(!core.getFlag("autoGetItem")&&!core.hasFlag("poison")&&core.status.thisMap.width<2*core.bigmap.extend+core.__SIZE__&&core.status.thisMap.height<2*core.bigmap.extend+core.__SIZE__){while(core.status.replay.toReplay.length>0&&core.status.replay.toReplay[0].indexOf("move:")==0){core.status.route.push(d);d=core.status.replay.toReplay.shift()}}var h=d.substring(5).split(":");var j=parseInt(h[0]),k=parseInt(h[1]);var f=core.getHeroLoc("x"),g=core.getHeroLoc("y");var e=core.canMoveDirectly(j,k);if(!core.moveDirectly(j,k,e)){return false}if(core.status.replay.speed==24){core.replay();return true}core.ui.drawArrow("ui",32*f+16-core.bigmap.offsetX,32*g+16-core.bigmap.offsetY,32*j+16-core.bigmap.offsetX,32*k+16-core.bigmap.offsetY,"#FF0000",3);var i=this.__replay_getTimeout();if(e<10){i=i*e/10}setTimeout(function(){core.clearMap("ui");core.replay()},i);return true};core.registerReplayAction("moveDirectly",core.control.my_replayAction_moveDirectly);function c(n,o,e){var g=core.generateMovableArray();var f=core.getMapBlocksObj();var d=core.getBgMapArray();var p=[],m=[];p[n+","+o]=0;m.push(n+","+o);while(m.length>0){var j=m.shift().split(","),q=~~j[0],r=~~j[1];for(var h in core.utils.scan){if(!core.inArray(g[q][r],h)){continue}var k=q+core.utils.scan[h].x,l=r+core.utils.scan[h].y,i=k+","+l;if(p[i]){continue}if(core.onSki(d[l][k])){continue}if(e&&!e(f,k,l)){continue}p[i]=p[j]+1;m.push(i)}}}function b(){var f="attractAnimate";var d=false;this.nodes=[];this.add=function(i,j,k,h){this.nodes.push({id:i,x:j-core.bigmap.posX*32,y:k-core.bigmap.posY*32,callback:h})};this.start=function(){if(d){return}d=true;core.registerAnimationFrame(f,true,this.update);if(!core.dymCanvas[f]){this.ctx=core.createCanvas(f,0,0,core.__PIXELS__,core.__PIXELS__,120)}else{this.ctx=core.dymCanvas[f]}};this.remove=function(){core.unregisterAnimationFrame(f);core.clearMap(f);d=false};this.clear=function(){this.nodes=[];this.remove()};var e=-1;var g=this;this.update=function(k){if(e<0){e=k}if(k-e<20){return}e=k;core.clearMap(f);var h=core.status.heroCenter.px-16-core.bigmap.posX*32,i=core.status.heroCenter.py-16-core.bigmap.posY*32;var j=3;g.nodes.forEach(function(o){var l=h-o.x,m=i-o.y;if(Math.abs(l)<=j&&Math.abs(m)<=j){o.dead=true}else{o.x+=~~(l/j);o.y+=~~(m/j)}core.drawIcon(f,o.id,o.x,o.y,32,32)});g.nodes=g.nodes.filter(function(l){if(l.dead&&l.callback){l.callback()}return !l.dead});if(g.nodes.length==0){g.remove()}}}var a=new b();this.stopAttractAnimate=function(){a.clear()};this.autoGetItem=function(){if(core.getFlag("autoGetItem",0)==0){return}if(core.getFlag("temp_mdef_pp",0)>0){return}var f={};var m=[];var g=function(k,x){var i=k?k.event.id:"";var y=core.getFlag("keysAreBad",0)&&k&&!k.disable&&(i=="yellowKey"||i=="blueKey"||i=="redKey"||i=="yellowKey3"||i=="blueKey3"||i=="redKey3");y|=core.status.checkBlock.no_autopick[x];if(["superPotion_s","redRHeart","blueRHeart","yellowRHeart","greenRHeart"].indexOf(i)!=-1){y=true}return k&&!k.disable&&k.event.cls=="items"&&!core.isMapBlockDisabled(core.status.floorId,k.x,k.y)&&k.event.trigger=="getItem"&&!y};var e=function(k,A,B){var z=A+","+B;if(z in f){return false}var i=k[z];if(g(i,z)){f[z]={x:A,y:B,id:i.event.id};m.push(z);return !core.status.checkBlock.damage[z]&&!core.status.checkBlock.repulse[z]&&!core.status.checkBlock.ambush[z]&&!core.status.checkBlock.chase[z]&&!core.status.checkBlock.visible[z]&&!core.status.checkBlock.lose_key[z]&&!core.status.checkBlock.seal_hp[z]&&!core.status.checkBlock.spe_69[z]&&!core.status.checkBlock.spe_72[z]}return core.maps._canMoveDirectly_checkNextPoint(k,A,B)};if(!core.status.floorId||!core.status.checkBlock.damage||core.status.event.id=="action"||core.status.lockControl){return}var r=false;var p=core.status.hero.loc.x,q=core.status.hero.loc.y,o=p+","+q;if(Object.keys(core.status.checkBlock.damage).indexOf(o)!=-1){r=true}if(Object.keys(core.status.checkBlock.repulse).indexOf(o)!=-1){r=true}if(Object.keys(core.status.checkBlock.ambush).indexOf(o)!=-1){r=true}if(Object.keys(core.status.checkBlock.chase).indexOf(o)!=-1){r=true}if(Object.keys(core.status.checkBlock.visible).indexOf(o)!=-1){r=true}if(Object.keys(core.status.checkBlock.lose_key).indexOf(o)!=-1){r=true}if(Object.keys(core.status.checkBlock.seal_hp).indexOf(o)!=-1){r=true}if(Object.keys(core.status.checkBlock.spe_69).indexOf(o)!=-1){r=true}if(Object.keys(core.status.checkBlock.spe_72).indexOf(o)!=-1){r=true}if(r){for(var h in core.utils.scan){var t=p+core.utils.scan[h].x,u=q+core.utils.scan[h].y,s=t+","+u;var d=core.getMapBlocksObj()[s];if(g(d,s)){f[s]={x:t,y:u,id:d.event.id};m.push(s)}}}else{c(core.getHeroLoc("x"),core.getHeroLoc("y"),e)}for(var j=0;j<m.length;++j){var n=m[j];var v=f[n].x,w=f[n].y,l=f[n].id;core.trigger(v,w);if(!core.isReplaying()){a.add(l,v*32,w*32)}}if(!core.isReplaying()){a.start()}};this.addAutoGetItemAnimate=function(d,e,f){if(core.isReplaying()){return}a.add(d,e*32,f*32)};this.startAutoGetItemAnimate=function(){if(core.isReplaying()){return}a.start()}},enemyOnPoint:function(){core.events.setEnemyOnPointAdd=function(l,m,c,g,k,i,j,h){c=c||core.status.floorId;var a=core.getBlock(l,m,c);if(a==null){return}if(a.event.cls.indexOf("enemy")!=0){return}var b=core.material.enemys[a.event.id];if(b==null){return}if(g=="hp"){var e=false;if(a.event.id=="E888"&&core.getFlag("A21boss_1p",0)>=4){e=true}if(core.hasSpecial(b.special,20)){e=true}if(e){core.plugin.popSkillDamage(0,l,m,"#eeee28");return}if(i=="-="){core.plugin.popSkillDamage(k,l,m,"#eeee28");var d=core.getEnemyInfo(b,null,l,m,null).hp_buff||0;var f=100/(100+d);k*=f;k=Math.floor(k);k=Math.max(k,0)}}if(typeof k==="string"&&g=="name"){k=k.replaceAll(/\r/g,"\\r")}k=this._updateValueByOperator(core.calValue(k,j),core.getEnemyValue(b,g,l,m,c),i);flags.enemyOnPoint=flags.enemyOnPoint||{};flags.enemyOnPoint[c]=flags.enemyOnPoint[c]||{};flags.enemyOnPoint[c][l+","+m]=flags.enemyOnPoint[c][l+","+m]||{};flags.enemyOnPoint[c][l+","+m][g]=k;if(g=="hp"&&core.getEnemyInfo(b,null,l,m,c).hp<=0&&c==core.status.floorId){if(core.hasSpecial(a.event.id,87)){core.insertAction({type:"choices",text:"\t[系统提示]恭喜获得成就【\r[yellow]痛击我的队友\r】：使用毁灭重拳的护盾爆炸使一名友军生命值降低至0%！\n没有奖励。",choices:[{text:"？？？",action:[]},]})}core.battle(a.event.id,l,m)}if(!h){core.updateStatusBar()}};core.events.setEnemyOnPoint=function(l,m,d,f,k,h,i,g){d=d||core.status.floorId;var a=core.getBlock(l,m,d);if(a==null){return}if(a.event.cls.indexOf("enemy")!=0){return}var c=core.material.enemys[a.event.id];if(c==null){return}if(typeof k==="string"&&f=="name"){k=k.replaceAll(/\r/g,"\\r")}var b=core.getEnemyValue(c,f,l,m,d);var e=c[f];k=this._updateValueByOperator(core.calValue(k,i),c[f],h);var j=false;if(b==e){j=true}else{if(Math.abs(b-e)<Math.abs(k-e)){j=true}}if(!j){return}flags.enemyOnPoint=flags.enemyOnPoint||{};flags.enemyOnPoint[d]=flags.enemyOnPoint[d]||{};flags.enemyOnPoint[d][l+","+m]=flags.enemyOnPoint[d][l+","+m]||{};flags.enemyOnPoint[d][l+","+m][f]=k;if(!g){core.updateStatusBar()}};core.events.getEnemyOnPoint=function(d,e,c){c=c||core.status.floorId;var a=core.getBlock(d,e,c);if(a==null){return{}}if(a.event.cls.indexOf("enemy")!=0){return{}}var b=core.material.enemys[a.event.id];if(b==null){return{}}flags.enemyOnPoint=flags.enemyOnPoint||{};flags.enemyOnPoint[c]=flags.enemyOnPoint[c]||{};return flags.enemyOnPoint[c][d+","+e]||{}};this.calcBoss17Info=function(c){var e=core.material.enemys.E767;var f=null;var g=flags.enemyOnPoint.Ch4_5F;if(g){f=g["6,3"]}var d=0,a=0,b=0;if(f&&f.hp){d=e.hp-f.hp}if(f&&f.atk){a=e.atk-f.atk}if(f&&f.def){b=e.def-f.def}var h=Math.pow(0.9300000000000001,c);core.events.setEnemy("E767","hp",Math.ceil(h*e.hp));core.events.setEnemy("E767","atk",Math.ceil(h*e.atk));core.events.setEnemy("E767","def",Math.ceil(h*e.def));core.events.resetEnemyOnPoint(6,3,"Ch4_5F");if(d>0){core.events.setEnemyOnPoint(6,3,"Ch4_5F","hp",d,"-=","",true)}if(a>0){core.events.setEnemyOnPoint(6,3,"Ch4_5F","atk",a,"-=","",true)}if(b>0){core.events.setEnemyOnPoint(6,3,"Ch4_5F","def",b,"-=","",true)}core.updateStatusBar()};this.updateBoss21Info=function(k){if(k<=2){var b,c;var d=250000,e=500000;var h=core.getFlag("A21boss_1p");var g=[400000000,500000000,600000000,800000000,1000000000][h];var a=[25500000,27000000,28500000,31000000,34000000][h];var f=[22500000,23500000,25000000,27500000,30000000][h];if(k==1){core.setFlag("A21boss_1p_debuff",0);core.events.resetEnemyOnPoint(4,6,"Ch4_130");core.events.setEnemy("E888","hp",g)}else{a-=core.getFlag("A21boss_1p_debuff")*d;f-=core.getFlag("A21boss_1p_debuff")*e;var j=null;var l=flags.enemyOnPoint.Ch4_130;if(l){j=l["4,6"]}if(j&&j.atk){b=a-j.atk}if(j&&j.def){c=f-j.def}core.addFlag("A21boss_1p_debuff",1);core.insertCommonEvent("Ch4_2BossDraw");a-=d;f-=e}core.events.setEnemy("E888","atk",a);core.events.setEnemy("E888","def",f);if(b>0){core.events.setEnemyOnPoint(4,6,"Ch4_130","atk",b,"-=","",true)}if(c>0){core.events.setEnemyOnPoint(4,6,"Ch4_130","def",c,"-=","",true)}}else{var b,c;var d=500000,e=250000;var h=core.getFlag("A21boss_2p");var g=[360000000,395000000,430000000,465000000,500000000][h];var a=[35000000,37500000,40000000,42500000,45000000][h];var f=[16000000,17000000,18000000,19000000,20000000][h];if(k==3){core.setFlag("A21boss_2p_debuff",0);core.events.resetEnemyOnPoint(8,6,"Ch4_130");core.events.setEnemy("E889","hp",g)}else{a-=core.getFlag("A21boss_2p_debuff")*d;f-=core.getFlag("A21boss_2p_debuff")*e;var j=null;var l=flags.enemyOnPoint.Ch4_130;if(l){j=l["8,6"]}if(j&&j.atk){b=a-j.atk}if(j&&j.def){c=f-j.def}core.addFlag("A21boss_2p_debuff",1);core.insertCommonEvent("Ch4_2BossDraw");a-=d;f-=e}core.events.setEnemy("E889","atk",a);core.events.setEnemy("E889","def",f);if(b>0){core.events.setEnemyOnPoint(8,6,"Ch4_130","atk",b,"-=","",true)}if(c>0){core.events.setEnemyOnPoint(8,6,"Ch4_130","def",c,"-=","",true)}}core.updateStatusBar()}},itemDetail:function(){core.control.updateDamage=function(floorId,ctx){floorId=floorId||core.status.floorId;if(!floorId||core.status.gameOver||main.mode!="play"){return}var onMap=ctx==null;if(!core.hasItem("book")){return}core.status.damage.posX=core.bigmap.posX;core.status.damage.posY=core.bigmap.posY;if(!onMap){var width=core.floors[floorId].width,height=core.floors[floorId].height;if(width*height>core.bigmap.threshold){return}}this._updateDamage_damage(floorId,onMap);this._updateDamage_extraDamage(floorId,onMap);core.getItemDetail(floorId);this.drawDamage(ctx)};control.prototype._drawDamage_draw=function(ctx,onMap){if(!core.hasItem("book")){return}core.setFont(ctx,"bold 11px Arial");core.setTextAlign(ctx,"left");core.status.damage.data.forEach(function(one){var px=one.px,py=one.py;if(onMap&&core.bigmap.v2){px-=core.bigmap.posX*32;py-=core.bigmap.posY*32;if(px<-32*2||px>core.__PIXELS__+32||py<-32||py>core.__PIXELS__+32){return}}core.fillBoldText(ctx,one.text,px,py,one.color)});core.setTextAlign(ctx,"center");core.status.damage.extraData.forEach(function(one){var px=one.px,py=one.py;if(onMap&&core.bigmap.v2){px-=core.bigmap.posX*32;py-=core.bigmap.posY*32;if(px<-32||px>core.__PIXELS__+32||py<-32||py>core.__PIXELS__+32){return}}core.fillBoldText(ctx,one.text,px,py,one.color)})};maps.prototype.resizeMap=function(floorId){floorId=floorId||core.status.floorId;if(!floorId){return}core.bigmap.width=core.floors[floorId].width;core.bigmap.height=core.floors[floorId].height;core.bigmap.posX=core.bigmap.posY=0;core.bigmap.v2=core.bigmap.width*core.bigmap.height>core.bigmap.threshold/4;var width=core.bigmap.v2?core.__PIXELS__+64:core.bigmap.width*32;var height=core.bigmap.v2?core.__PIXELS__+64:core.bigmap.height*32;core.bigmap.canvas.forEach(function(cn){if(core.domStyle.hdCanvas.indexOf(cn)>=0){core.maps._setHDCanvasSize(core.canvas[cn],width,height)}else{core.canvas[cn].canvas.width=width;core.canvas[cn].canvas.height=height}core.canvas[cn].canvas.style.width=width*core.domStyle.scale+"px";core.canvas[cn].canvas.style.height=height*core.domStyle.scale+"px";core.canvas[cn].translate(core.bigmap.v2?32:0,core.bigmap.v2?32:0);if(main.mode==="editor"&&editor.isMobile){core.canvas[cn].canvas.style.width=width/core.__PIXELS__*96+"vw";core.canvas[cn].canvas.style.height=height/core.__PIXELS__*96+"vw"}})};this.clearItemDetailCache=function(key){var cache=core.getFlag("itemDetailCache",{});cache[key]={};core.setFlag("itemDetailCache",cache)};this.clearItemDetailCacheAll=function(){core.removeFlag("itemDetailCache");core.updateDamage()};this.getItemDetail=function(floorId){var cache=core.getFlag("itemDetailCache",{});floorId=floorId||core.status.thisMap.floorId;core.status.maps[floorId].blocks.forEach(function(block){var x=block.x,y=block.y;if(core.bigmap.v2){if(x<core.bigmap.posX-core.bigmap.extend||x>core.bigmap.posX+core.__SIZE__+core.bigmap.extend||y<core.bigmap.posY-core.bigmap.extend||y>core.bigmap.posY+core.__SIZE__+core.bigmap.extend){return}}if(block.event.cls=="items"){var id=block.event.id;var whitelist=["redRHeart","blueRHeart","yellowRHeart","greenRHeart"];if(whitelist.indexOf(id)==-1&&!core.getFlag("itemDetail")){return}var diff=cache[id];var nocachelist=["superPotion_s","redRHeart","blueRHeart","yellowRHeart","greenRHeart"];if(nocachelist.indexOf(id)!=-1){diff={}}if(!diff||core.same(diff,{})){var before=core.clone(core.status.hero);core.setFlag("__statistics__",true);try{eval(core.material.items[id].itemEffect)}catch(error){}diff=core.compareObject(before,core.status.hero);cache[id]=diff;core.status.hero=before;window.hero=core.status.hero;window.flags=core.status.hero.flags}else{diff=cache[id]}core.drawItemDetail(diff,block.x,block.y,floorId,id)}});core.setFlag("itemDetailCache",cache)};this.compareObject=function(a,b){a=a||{};b=b||{};var diff={};for(var name in a){if(a[name]!=b[name]){try{diff[name]=b[name]-(a[name]||0)}catch(error){}if(isNaN(diff[name])){delete diff[name]}if(diff[name]==0){delete diff[name]}}}return diff};this.drawItemDetail=function(diff,x,y,floorId,id){if(core.same(diff,{})||!diff){return}var px=32*x+2,py=32*y+30;var content="";var i=0;for(var name in diff){var color="#ffffff";var damage=-diff[name];content=core.formatBigNumber(diff[name],true);switch(name){case"atk":color="#FF7A7A";break;case"def":color="#00E6F1";break;case"mdef":color="#6EFF83";break;case"hp":color="#A4FF00";if(damage>0){if(damage<core.status.hero.hp/3){color="#FFFFFF"}else{if(damage<core.status.hero.hp*2/3){color="#FFFF00"}else{if(damage<core.status.hero.hp){color="#FF9933"}else{color="#FF2222"}}}content=core.formatBigNumber(damage,true)}break;case"hpmax":color="#F9FF00";break;case"mana":color="#008CFF";break}core.status.damage.data.push({text:content,px:px,py:py-10*i,color:color});i++}}},autoBattle:function(){var b=true;if(!b){return}function a(m,n,d){var f=core.generateMovableArray();var e=core.getMapBlocksObj();var c=core.getBgMapArray();var o=[],l=[];o[m+","+n]=0;l.push(m+","+n);while(l.length>0){var i=l.shift().split(","),p=~~i[0],q=~~i[1];for(var g in core.utils.scan){if(!core.inArray(f[p][q],g)){continue}var j=p+core.utils.scan[g].x,k=q+core.utils.scan[g].y,h=j+","+k;if(o[h]){continue}if(core.onSki(c[k][j])){continue}if(d&&!d(e,j,k)){continue}o[h]=o[i]+1;l.push(h)}}}this.autoBattle=function(){if(core.getFlag("autoBattle",0)==0){return}if(core.getFlag("used_potion",0)>0){return}if(core.getFlag("70F_boss_phase",0)==1){return}if(core.getFlag("spe62_seal_hp",0)>0){return}if(core.getFlag("skill5_is_on",0)){return}if(core.getFlag("invisible",0)){return}if(core.hasItem("skill11")){return}var e={};var l=[];var f=function(k,z,B,C){var i=k?k.event.id:"";var A=k&&!k.disable&&core.plugin.isEnemy(B,C)&&!core.isMapBlockDisabled(core.status.floorId,k.x,k.y)&&k.event.trigger=="battle";if(!A){return false}var w=core.material.enemys[i];if(core.status.checkBlock.no_autobattle[z]){return false}if(core.getDamage(i,B,C)==null||core.getDamage(i,B,C)>0){return false}if(core.enemys.hasSpecial(i,36)||core.enemys.hasSpecial(i,103)){return false}if(core.enemys.hasSpecial(i,25)&&(w.atkValue<0||w.defValue<0||w.hpValue<0)){return false}if(core.enemys.hasSpecial(i,28)&&(w.value28<0)){return false}if(core.enemys.hasSpecial(i,40)&&core.getFlag("rage_stack",0)>=90){return false}if(core.enemys.hasSpecial(i,47)&&core.getFlag("rage_stack",0)<=-90){return false}if(core.enemys.hasSpecial(i,49)||core.enemys.hasSpecial(i,50)){return false}if(core.enemys.hasSpecial(i,52)||core.enemys.hasSpecial(i,53)||core.enemys.hasSpecial(i,54)){return false}if(core.enemys.hasSpecial(i,62)){return false}if(core.enemys.hasSpecial(i,73)){return false}if(core.enemys.hasSpecial(i,64)||core.enemys.hasSpecial(i,74)||core.enemys.hasSpecial(i,83)||core.enemys.hasSpecial(i,86)){return false}if(core.enemys.hasSpecial(i,75)||core.enemys.hasSpecial(i,78)){return false}return true};var d=function(k,z,A){var w=z+","+A;if(w in e){return false}var i=k[w];if(f(i,w,z,A)){e[w]={x:z,y:A,id:i.event.id};l.push(w);return !core.status.checkBlock.damage[w]&&!core.status.checkBlock.repulse[w]&&!core.status.checkBlock.ambush[w]&&!core.status.checkBlock.chase[w]&&!core.status.checkBlock.visible[w]&&!core.status.checkBlock.lose_key[w]&&!core.status.checkBlock.seal_hp[w]&&!core.status.checkBlock.spe_69[w]&&!core.status.checkBlock.spe_72[w]}return core.maps._canMoveDirectly_checkNextPoint(k,z,A)};if(!core.status.floorId||!core.status.checkBlock.damage||core.status.event.id=="action"||core.status.lockControl){return}var q=false;var o=core.status.hero.loc.x,p=core.status.hero.loc.y,n=o+","+p;if(Object.keys(core.status.checkBlock.damage).indexOf(n)!=-1){q=true}if(Object.keys(core.status.checkBlock.repulse).indexOf(n)!=-1){q=true}if(Object.keys(core.status.checkBlock.ambush).indexOf(n)!=-1){q=true}if(Object.keys(core.status.checkBlock.chase).indexOf(n)!=-1){q=true}if(Object.keys(core.status.checkBlock.visible).indexOf(n)!=-1){q=true}if(Object.keys(core.status.checkBlock.lose_key).indexOf(n)!=-1){q=true}if(Object.keys(core.status.checkBlock.seal_hp).indexOf(n)!=-1){q=true}if(Object.keys(core.status.checkBlock.spe_69).indexOf(n)!=-1){q=true}if(Object.keys(core.status.checkBlock.spe_72).indexOf(n)!=-1){q=true}if(q){for(var g in core.utils.scan){var s=o+core.utils.scan[g].x,t=p+core.utils.scan[g].y,r=s+","+t;var c=core.getMapBlocksObj()[r];if(f(c,r,s,t)){e[r]={x:s,y:t,id:c.event.id};l.push(r)}}}else{a(core.getHeroLoc("x"),core.getHeroLoc("y"),d)}core.setFlag("disable_autosave2",1);for(var h=0;h<l.length;++h){var m=l[h];var u=e[m].x,v=e[m].y,j=e[m].id;if(core.getDamage(j,u,v)<=0){core.battle(j,u,v)}}core.setFlag("disable_autosave2",0)}},bugfix:function(){core.maps._getBgFgNumber=function(b,c,d,a){if(c==null){c=core.getHeroLoc("x")}if(d==null){d=core.getHeroLoc("y")}return this._getBgFgMapArray(b,a,true)[d][c]};core.maps._drawBlockInfo_shouldBlurFg=function(b,c){if(main.mode=="play"&&!core.flags.blurFg){return false}var a=this.getBlock(b,c);if(a==null||a.id==0||a.id==17){return false}if(a.event.cls=="autotile"||a.event.cls=="tileset"||a.event.cls=="terrains"){return a.event.script||a.event.event}return true};core.control._getSaveIndexes_getIndex=function(b,c){var a=new RegExp("^"+core.firstData.name+"_(save\\d+|autoSave)$").exec(c);if(a){if(a[1]=="autoSave"){b[0]=true}else{b[parseInt(a[1].substring(4))]=true}return}a=new RegExp("^(save\\d+|autoSave)$").exec(c);if(a){if(a[1]=="autoSave"){b[0]=true}else{b[parseInt(a[1].substring(4))]=true}}};maps.prototype._drawFloorImage=function(a,f,g,d,b,h){var c=d.height;var e=g.name+(g.reverse||"");var k=parseInt((g.w==null?d.width:g.w)/(g.frame||1));var c=g.h==null?d.height:g.h;var i=(g.sx||0)+(b||0)%(g.frame||1)*k;var j=g.sy||0;var l=g.x||0,m=g.y||0;if(h&&core.bigmap.v2){if(l>32*core.bigmap.posX+core.__PIXELS__+32||l+k<32*core.bigmap.posX-32||m>32*core.bigmap.posY+core.__PIXELS__+32||m+c<32*core.bigmap.posY-32){return}l-=32*core.bigmap.posX;m-=32*core.bigmap.posY}if(g.canvas!="auto"&&g.canvas!=f){return}if(g.canvas!="auto"){if(b!=null){core.clearMap(a,l,m,k,c)}core.drawImage(a,e,i,j,k,c,l,m,k,c)}else{if(f=="bg"){if(b!=null){core.clearMap(a,l,m+c-32,k,32)}core.drawImage(a,e,i,j+c-32,k,32,l,m+c-32,k,32)}else{if(f=="fg"){if(b!=null){core.clearMap(a,l,m,k,c-32)}core.drawImage(a,e,i,j,k,c-32,l,m,k,c-32)}}}};core.maps._removeBlockFromMap=function(c,a){if(c!=core.status.floorId){return}var b=a.filter||{};if(a.event.cls=="autotile"||b.blur>0||b.shadow>0){core.drawMap()}else{var g=a.x,h=a.y;var e=32*g-core.bigmap.posX*32;var f=32*h-core.bigmap.posY*32;core.removeGlobalAnimate(g,h);core.clearMap("event",e,f,32,32);var d=a.event.height||32;if(d>32){core.clearMap("event2",e,f+32-d,32,d-32)}core.deleteCanvas("_bigImage_header_"+g+"_"+h);core.deleteCanvas("_bigImage_body_"+g+"_"+h);core.updateStatusBar()}}}};